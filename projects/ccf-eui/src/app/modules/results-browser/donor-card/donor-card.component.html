<div class="main-container">
  <div class="checkbox-background" [class.selected]="selected"
       [ngStyle]="{'background-color': selected ? color : 'transparent'}" (click)="handleCheckbox()">
    <ng-container *ngIf="selected; else unselected">
      <mat-icon fontSet="material-icons-outlined" class="checkbox selected">check_box_outlined</mat-icon>
    </ng-container>

    <ng-template #unselected>
      <mat-icon class="checkbox unselected">check_box_outline_blank</mat-icon>
    </ng-template>
  </div>

  <div class="hoverable default-padding donor mat-elevation-z2" [class.hover-enabled]="selected" [class.expanded]="expanded">
    <div class="d-flex">
      <mat-icon class="icon-size icon-dark mr-5">person</mat-icon>

      <div class="donor-info">
        <div class="title description">{{ donor.donor.label }}</div>
        <div class="description">{{ donor.donor.description }}</div>
      </div>
    </div>
    <div class="hover-state mat-elevation-z4" (click)="linkHandler(donor.donor.link)">
      <div class="hover-title">DONOR</div>
      <mat-icon class="icon-size hover-icon">open_in_new</mat-icon>
    </div>

    <mat-icon (click)="toggleExpansion()" class="icon-size ml-5 selectable" *ngIf="selected">{{ expanded ? "expand_less" : "expand_more" }}</mat-icon>
  </div>
</div>

<ng-container *ngIf="expanded">
  <div class="expanded-view mat-elevation-z2 align-end">
    <div class="info-block hover-enabled default-padding">
      <mat-icon class="icon-size icon-dark mr-5">bubble_chart</mat-icon>
      <div class="text-content">
        <div class="description">{{ donor.label }}</div>
        <div class="description">{{ donor.description }}</div>
      </div>

      <div class="hover-state mat-elevation-z4" (click)="linkHandler(donor.link)">
        <div class="hover-title">TISSUE SECTION</div>
        <mat-icon class="icon-size hover-icon">open_in_new</mat-icon>
      </div>
    </div>

    <ng-container *ngIf="donor.datasets.length > 0">
      <ccf-thumbnail-carousel (linkClicked)="linkHandler($event.link)" class="mt-05" [data]="donor.datasets">
      </ccf-thumbnail-carousel>
    </ng-container>

    <!--
      Line graph goes here.
     -->
  </div>

  <div class="expanded-view w-80 mat-elevation-z2 align-end" *ngFor="let section of donor.sections">
    <div class="default-padding info-block hover-enabled">
      <mat-icon class="icon-size mr-5 icon-light">bubble_chart</mat-icon>
      <div class="text-content">
        <div class="description">{{ section.label }}</div>
        <div class="description">{{ section.description }}</div>
      </div>

      <div class="hover-state mat-elevation-z4" (click)="linkHandler(section.link)">
        <div class="hover-title">DONOR TISSUE SECTION</div>
        <mat-icon class="icon-size hover-icon">open_in_new</mat-icon>
      </div>
    </div>

    <ng-container *ngIf="section.datasets.length > 0">
      <ccf-thumbnail-carousel (linkClicked)="linkHandler($event.link)" class="mt-05" [data]="section.datasets">
      </ccf-thumbnail-carousel>
    </ng-container>
  </div>
</ng-container>
