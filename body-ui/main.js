var pke=Object.defineProperty,gke=Object.defineProperties,mke=Object.getOwnPropertyDescriptors,R1=Object.getOwnPropertySymbols,qq=Object.prototype.hasOwnProperty,Yq=Object.prototype.propertyIsEnumerable,Er=Math.pow,Kq=(Ut,it,Je)=>it in Ut?pke(Ut,it,{enumerable:!0,configurable:!0,writable:!0,value:Je}):Ut[it]=Je,ot=(Ut,it)=>{for(var Je in it||(it={}))qq.call(it,Je)&&Kq(Ut,Je,it[Je]);if(R1)for(var Je of R1(it))Yq.call(it,Je)&&Kq(Ut,Je,it[Je]);return Ut},Sn=(Ut,it)=>gke(Ut,mke(it)),Xq=(Ut,it)=>{var Je={};for(var yt in Ut)qq.call(Ut,yt)&&it.indexOf(yt)<0&&(Je[yt]=Ut[yt]);if(null!=Ut&&R1)for(var yt of R1(Ut))it.indexOf(yt)<0&&Yq.call(Ut,yt)&&(Je[yt]=Ut[yt]);return Je};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(Ut,it,Je)=>{var yt=Je(52).default;Ut.exports=function Y(Se,he,W){function j(z,v){if(!he[z]){if(!Se[z]){if(P)return P(z,!0);var O=new Error("Cannot find module '"+z+"'");throw O.code="MODULE_NOT_FOUND",O}var A=he[z]={exports:{}};Se[z][0].call(A.exports,function(b){return j(Se[z][1][b]||b)},A,A.exports,Y,Se,he,W)}return he[z].exports}for(var P=void 0,Q=0;Q<W.length;Q++)j(W[Q]);return j}({1:[function(Y,Se,he){var W,j;W=this,j=function(W,j,P,Q,z){"use strict";function T(Me,Ve,$e,Ne){return new($e||($e=Promise))(function(G,pe){function ue(pt){try{_t(Ne.next(pt))}catch(ve){pe(ve)}}function je(pt){try{_t(Ne.throw(pt))}catch(ve){pe(ve)}}function _t(pt){pt.done?G(pt.value):function(G){return G instanceof $e?G:new $e(function(pe){pe(G)})}(pt.value).then(ue,je)}_t((Ne=Ne.apply(Me,Ve||[])).next())})}function V(Me,Ve){var Ne,q,G,pe,$e={label:0,sent:function(){if(1&G[0])throw G[1];return G[1]},trys:[],ops:[]};return pe={next:ue(0),throw:ue(1),return:ue(2)},"function"==typeof Symbol&&(pe[Symbol.iterator]=function(){return this}),pe;function ue(_t){return function(pt){return function(_t){if(Ne)throw new TypeError("Generator is already executing.");for(;$e;)try{if(Ne=1,q&&(G=2&_t[0]?q.return:_t[0]?q.throw||((G=q.return)&&G.call(q),0):q.next)&&!(G=G.call(q,_t[1])).done)return G;switch(q=0,G&&(_t=[2&_t[0],G.value]),_t[0]){case 0:case 1:G=_t;break;case 4:return $e.label++,{value:_t[1],done:!1};case 5:$e.label++,q=_t[1],_t=[0];continue;case 7:_t=$e.ops.pop(),$e.trys.pop();continue;default:if(!(G=(G=$e.trys).length>0&&G[G.length-1])&&(6===_t[0]||2===_t[0])){$e=0;continue}if(3===_t[0]&&(!G||_t[1]>G[0]&&_t[1]<G[3])){$e.label=_t[1];break}if(6===_t[0]&&$e.label<G[1]){$e.label=G[1],G=_t;break}if(G&&$e.label<G[2]){$e.label=G[2],$e.ops.push(_t);break}G[2]&&$e.ops.pop(),$e.trys.pop();continue}_t=Ve.call(Me,$e)}catch(pt){_t=[6,pt],q=0}finally{Ne=G=0}if(5&_t[0])throw _t[1];return{value:_t[0]?_t[1]:void 0,done:!0}}([_t,pt])}}}function Xe(Me){var Ve=Me.length,$e=0;return new z.Readable({objectMode:!0,read:function(){this.push($e<Ve?Me[$e++]:null)}})}W.addJsonLdToStore=function(Me,Ve){return T(this,void 0,void 0,function(){var $e,Ne,q;return V(this,function(G){switch(G.label){case 0:return"string"!=typeof Me?[3,4]:[4,fetch(Me,{redirect:"follow"})];case 1:return(Ne=G.sent()).ok?[4,Ne.json()]:[3,3];case 2:$e=G.sent(),G.label=3;case 3:return[3,5];case 4:$e=Me,G.label=5;case 5:return $e?[4,j.toRDF($e)]:[3,7];case 6:q=G.sent(),Ve.import(Xe(q)),G.label=7;case 7:return[2,Ve]}})})},W.addN3ToStore=function(Me,Ve){return T(this,void 0,void 0,function(){var $e,Ne,q;return V(this,function(G){switch(G.label){case 0:return"string"==typeof Me&&(null==Me?void 0:Me.startsWith("http"))?[4,fetch(Me,{redirect:"follow"})]:[3,4];case 1:return(Ne=G.sent()).ok?[4,Ne.text()]:[3,3];case 2:$e=G.sent(),G.label=3;case 3:return[3,5];case 4:$e=Me,G.label=5;case 5:return $e&&(q=new P.Parser({format:"n3"}).parse($e),Ve.import(Xe(q))),[2,Ve]}})})},W.addRdfXmlToStore=function(Me,Ve){return T(this,void 0,void 0,function(){var $e,Ne,q,G;return V(this,function(pe){switch(pe.label){case 0:return"string"==typeof Me&&(null==Me?void 0:Me.startsWith("http"))?[4,fetch(Me,{redirect:"follow"})]:[3,4];case 1:return(Ne=pe.sent()).ok?[4,Ne.text()]:[3,3];case 2:$e=pe.sent(),pe.label=3;case 3:return[3,5];case 4:$e=Me,pe.label=5;case 5:return $e?(q=new Q.RdfXmlParser({dataFactory:P.DataFactory,strict:!0}),G=new Promise(function(ue){q.once("end",function(){return ue(Ve)})}),Ve.import(q),q.write($e),q.end(),[2,G]):[2,Ve]}})})},W.arrayToStream=Xe,W.deserializeN3Store=function(Me,Ve){var $e=JSON.parse(Me),Ne=new P.Store;return Object.assign(Ne,$e,{_factory:null!=Ve?Ve:P.DataFactory}),Ne},W.readQuads=function(Me,Ve,$e,Ne,q){return Me.readQuads(Ve,$e,Ne,q)},W.serializeN3Store=function(Me){var Ve=Object.assign({},Me);return delete Ve._factory,JSON.stringify(Ve)},W.streamToArray=function(Me){return new Promise(function(Ve,$e){var Ne=[];Me.on("data",function(q){Ne.push(q)}).once("end",function(){Ve(Ne)}).once("error",function(q){$e(q)})})},Object.keys(P).forEach(function(Me){"default"!==Me&&!W.hasOwnProperty(Me)&&Object.defineProperty(W,Me,{enumerable:!0,get:function(){return P[Me]}})}),Object.defineProperty(W,"__esModule",{value:!0})},"object"==typeof he&&void 0!==Se?j(he,Y("jsonld"),Y("n3"),Y("rdfxml-streaming-parser"),Y("readable-stream")):j((W="undefined"!=typeof globalThis?globalThis:W||self).tripleStoreUtils={},W.jsonld,W.n3,W.rdfxmlStreamingParser,W.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(Y,Se,he){"use strict";he.byteLength=function(V){var R=x(V),ce=R[1];return 3*(R[0]+ce)/4-ce},he.toByteArray=function(V){var R,$,K=x(V),ce=K[0],D=K[1],I=new P(function(V,R,K){return 3*(R+K)/4-K}(0,ce,D)),X=0,E=D>0?ce-4:ce;for($=0;$<E;$+=4)R=j[V.charCodeAt($)]<<18|j[V.charCodeAt($+1)]<<12|j[V.charCodeAt($+2)]<<6|j[V.charCodeAt($+3)],I[X++]=R>>16&255,I[X++]=R>>8&255,I[X++]=255&R;return 2===D&&(R=j[V.charCodeAt($)]<<2|j[V.charCodeAt($+1)]>>4,I[X++]=255&R),1===D&&(R=j[V.charCodeAt($)]<<10|j[V.charCodeAt($+1)]<<4|j[V.charCodeAt($+2)]>>2,I[X++]=R>>8&255,I[X++]=255&R),I},he.fromByteArray=function(V){for(var R,K=V.length,ce=K%3,D=[],I=16383,X=0,E=K-ce;X<E;X+=I)D.push(S(V,X,X+I>E?E:X+I));return 1===ce?D.push(W[(R=V[K-1])>>2]+W[R<<4&63]+"=="):2===ce&&D.push(W[(R=(V[K-2]<<8)+V[K-1])>>10]+W[R>>4&63]+W[R<<2&63]+"="),D.join("")};for(var W=[],j=[],P="undefined"!=typeof Uint8Array?Uint8Array:Array,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",z=0,v=Q.length;z<v;++z)W[z]=Q[z],j[Q.charCodeAt(z)]=z;function x(V){var R=V.length;if(R%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var K=V.indexOf("=");return-1===K&&(K=R),[K,K===R?0:4-K%4]}function y(V){return W[V>>18&63]+W[V>>12&63]+W[V>>6&63]+W[63&V]}function S(V,R,K){for(var D=[],I=R;I<K;I+=3)D.push(y((V[I]<<16&16711680)+(V[I+1]<<8&65280)+(255&V[I+2])));return D.join("")}j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63},{}],3:[function(Y,Se,he){},{}],4:[function(Y,Se,he){var W=Y("buffer"),j=W.Buffer;function P(z,v){for(var x in z)v[x]=z[x]}function Q(z,v,x){return j(z,v,x)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Se.exports=W:(P(W,he),he.Buffer=Q),P(j,Q),Q.from=function(z,v,x){if("number"==typeof z)throw new TypeError("Argument must not be a number");return j(z,v,x)},Q.alloc=function(z,v,x){if("number"!=typeof z)throw new TypeError("Argument must be a number");var O=j(z);return void 0!==v?"string"==typeof x?O.fill(v,x):O.fill(v):O.fill(0),O},Q.allocUnsafe=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return j(z)},Q.allocUnsafeSlow=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return W.SlowBuffer(z)}},{buffer:6}],5:[function(Y,Se,he){"use strict";var W=Y("safe-buffer").Buffer,j=W.isEncoding||function(D){switch((D=""+D)&&D.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function z(D){var I;switch(this.encoding=function(D){var I=function(D){if(!D)return"utf8";for(var I;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(I)return;D=(""+D).toLowerCase(),I=!0}}(D);if("string"!=typeof I&&(W.isEncoding===j||!j(D)))throw new Error("Unknown encoding: "+D);return I||D}(D),this.encoding){case"utf16le":this.text=S,this.end=T,I=4;break;case"utf8":this.fillLast=A,I=4;break;case"base64":this.text=V,this.end=R,I=3;break;default:return this.write=K,void(this.end=ce)}this.lastNeed=0,this.lastTotal=0,this.lastChar=W.allocUnsafe(I)}function v(D){return D<=127?0:D>>5==6?2:D>>4==14?3:D>>3==30?4:D>>6==2?-1:-2}function A(D){var I=this.lastTotal-this.lastNeed,X=function(D,I,X){if(128!=(192&I[0]))return D.lastNeed=0,"\ufffd";if(D.lastNeed>1&&I.length>1){if(128!=(192&I[1]))return D.lastNeed=1,"\ufffd";if(D.lastNeed>2&&I.length>2&&128!=(192&I[2]))return D.lastNeed=2,"\ufffd"}}(this,D);return void 0!==X?X:this.lastNeed<=D.length?(D.copy(this.lastChar,I,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(D.copy(this.lastChar,I,0,D.length),void(this.lastNeed-=D.length))}function S(D,I){if((D.length-I)%2==0){var X=D.toString("utf16le",I);if(X){var E=X.charCodeAt(X.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1],X.slice(0,-1)}return X}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=D[D.length-1],D.toString("utf16le",I,D.length-1)}function T(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):I}function V(D,I){var X=(D.length-I)%3;return 0===X?D.toString("base64",I):(this.lastNeed=3-X,this.lastTotal=3,1===X?this.lastChar[0]=D[D.length-1]:(this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1]),D.toString("base64",I,D.length-X))}function R(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("base64",0,3-this.lastNeed):I}function K(D){return D.toString(this.encoding)}function ce(D){return D&&D.length?this.write(D):""}he.StringDecoder=z,z.prototype.write=function(D){if(0===D.length)return"";var I,X;if(this.lastNeed){if(void 0===(I=this.fillLast(D)))return"";X=this.lastNeed,this.lastNeed=0}else X=0;return X<D.length?I?I+this.text(D,X):this.text(D,X):I||""},z.prototype.end=function(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+"\ufffd":I},z.prototype.text=function(D,I){var X=function(D,I,X){var E=I.length-1;if(E<X)return 0;var $=v(I[E]);return $>=0?($>0&&(D.lastNeed=$-1),$):--E<X||-2===$?0:($=v(I[E]))>=0?($>0&&(D.lastNeed=$-2),$):--E<X||-2===$?0:($=v(I[E]))>=0?($>0&&(2===$?$=0:D.lastNeed=$-3),$):0}(this,D,I);if(!this.lastNeed)return D.toString("utf8",I);this.lastTotal=X;var E=D.length-(X-this.lastNeed);return D.copy(this.lastChar,0,E),D.toString("utf8",I,E)},z.prototype.fillLast=function(D){if(this.lastNeed<=D.length)return D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,D.length),this.lastNeed-=D.length}},{"safe-buffer":4}],6:[function(Y,Se,he){(function(W){(function(){"use strict";var j=Y("base64-js"),P=Y("ieee754");he.Buffer=x,he.SlowBuffer=function(L){return+L!=L&&(L=0),x.alloc(+L)},he.INSPECT_MAX_BYTES=50;var Q=2147483647;function v(L){if(L>Q)throw new RangeError('The value "'+L+'" is invalid for option "size"');var N=new Uint8Array(L);return N.__proto__=x.prototype,N}function x(L,N,B){if("number"==typeof L){if("string"==typeof N)throw new TypeError('The "string" argument must be of type string. Received type number');return y(L)}return O(L,N,B)}function O(L,N,B){if("string"==typeof L)return function(L,N){if(("string"!=typeof N||""===N)&&(N="utf8"),!x.isEncoding(N))throw new TypeError("Unknown encoding: "+N);var B=0|D(L,N),Re=v(B),Qe=Re.write(L,N);return Qe!==B&&(Re=Re.slice(0,Qe)),Re}(L,N);if(ArrayBuffer.isView(L))return T(L);if(null==L)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(pt(L,ArrayBuffer)||L&&pt(L.buffer,ArrayBuffer))return function(L,N,B){if(N<0||L.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(L.byteLength<N+(B||0))throw new RangeError('"length" is outside of buffer bounds');var Re;return(Re=void 0===N&&void 0===B?new Uint8Array(L):void 0===B?new Uint8Array(L,N):new Uint8Array(L,N,B)).__proto__=x.prototype,Re}(L,N,B);if("number"==typeof L)throw new TypeError('The "value" argument must not be of type number. Received type number');var Re=L.valueOf&&L.valueOf();if(null!=Re&&Re!==L)return x.from(Re,N,B);var Qe=function(L){if(x.isBuffer(L)){var N=0|K(L.length),B=v(N);return 0===B.length||L.copy(B,0,0,N),B}return void 0!==L.length?"number"!=typeof L.length||ve(L.length)?v(0):T(L):"Buffer"===L.type&&Array.isArray(L.data)?T(L.data):void 0}(L);if(Qe)return Qe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof L[Symbol.toPrimitive])return x.from(L[Symbol.toPrimitive]("string"),N,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}function A(L){if("number"!=typeof L)throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function y(L){return A(L),v(L<0?0:0|K(L))}function T(L){for(var N=L.length<0?0:0|K(L.length),B=v(N),Re=0;Re<N;Re+=1)B[Re]=255&L[Re];return B}function K(L){if(L>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return 0|L}function D(L,N){if(x.isBuffer(L))return L.length;if(ArrayBuffer.isView(L)||pt(L,ArrayBuffer))return L.byteLength;if("string"!=typeof L)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);var B=L.length,Re=arguments.length>2&&!0===arguments[2];if(!Re&&0===B)return 0;for(var Qe=!1;;)switch(N){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return G(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*B;case"hex":return B>>>1;case"base64":return je(L).length;default:if(Qe)return Re?-1:G(L).length;N=(""+N).toLowerCase(),Qe=!0}}function I(L,N,B){var Re=!1;if((void 0===N||N<0)&&(N=0),N>this.length||((void 0===B||B>this.length)&&(B=this.length),B<=0)||(B>>>=0)<=(N>>>=0))return"";for(L||(L="utf8");;)switch(L){case"hex":return tt(this,N,B);case"utf8":case"utf-8":return _e(this,N,B);case"ascii":return st(this,N,B);case"latin1":case"binary":return Xe(this,N,B);case"base64":return ne(this,N,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ye(this,N,B);default:if(Re)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),Re=!0}}function X(L,N,B){var Re=L[N];L[N]=L[B],L[B]=Re}function E(L,N,B,Re,Qe){if(0===L.length)return-1;if("string"==typeof B?(Re=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),ve(B=+B)&&(B=Qe?0:L.length-1),B<0&&(B=L.length+B),B>=L.length){if(Qe)return-1;B=L.length-1}else if(B<0){if(!Qe)return-1;B=0}if("string"==typeof N&&(N=x.from(N,Re)),x.isBuffer(N))return 0===N.length?-1:$(L,N,B,Re,Qe);if("number"==typeof N)return N&=255,"function"==typeof Uint8Array.prototype.indexOf?Qe?Uint8Array.prototype.indexOf.call(L,N,B):Uint8Array.prototype.lastIndexOf.call(L,N,B):$(L,[N],B,Re,Qe);throw new TypeError("val must be string, number or Buffer")}function $(L,N,B,Re,Qe){var Yn,St=1,Nt=L.length,On=N.length;if(void 0!==Re&&("ucs2"===(Re=String(Re).toLowerCase())||"ucs-2"===Re||"utf16le"===Re||"utf-16le"===Re)){if(L.length<2||N.length<2)return-1;St=2,Nt/=2,On/=2,B/=2}function kn(Ls,gs){return 1===St?Ls[gs]:Ls.readUInt16BE(gs*St)}if(Qe){var Ti=-1;for(Yn=B;Yn<Nt;Yn++)if(kn(L,Yn)===kn(N,-1===Ti?0:Yn-Ti)){if(-1===Ti&&(Ti=Yn),Yn-Ti+1===On)return Ti*St}else-1!==Ti&&(Yn-=Yn-Ti),Ti=-1}else for(B+On>Nt&&(B=Nt-On),Yn=B;Yn>=0;Yn--){for(var wi=!0,Kr=0;Kr<On;Kr++)if(kn(L,Yn+Kr)!==kn(N,Kr)){wi=!1;break}if(wi)return Yn}return-1}function Z(L,N,B,Re){B=Number(B)||0;var Qe=L.length-B;Re?(Re=Number(Re))>Qe&&(Re=Qe):Re=Qe;var St=N.length;Re>St/2&&(Re=St/2);for(var Nt=0;Nt<Re;++Nt){var On=parseInt(N.substr(2*Nt,2),16);if(ve(On))return Nt;L[B+Nt]=On}return Nt}function oe(L,N,B,Re){return _t(G(N,L.length-B),L,B,Re)}function se(L,N,B,Re){return _t(function(L){for(var N=[],B=0;B<L.length;++B)N.push(255&L.charCodeAt(B));return N}(N),L,B,Re)}function te(L,N,B,Re){return se(L,N,B,Re)}function Ce(L,N,B,Re){return _t(je(N),L,B,Re)}function me(L,N,B,Re){return _t(function(L,N){for(var B,Re,St=[],Nt=0;Nt<L.length&&!((N-=2)<0);++Nt)Re=(B=L.charCodeAt(Nt))>>8,St.push(B%256),St.push(Re);return St}(N,L.length-B),L,B,Re)}function ne(L,N,B){return j.fromByteArray(0===N&&B===L.length?L:L.slice(N,B))}function _e(L,N,B){B=Math.min(L.length,B);for(var Re=[],Qe=N;Qe<B;){var kn,Yn,Ti,wi,St=L[Qe],Nt=null,On=St>239?4:St>223?3:St>191?2:1;if(Qe+On<=B)switch(On){case 1:St<128&&(Nt=St);break;case 2:128==(192&(kn=L[Qe+1]))&&(wi=(31&St)<<6|63&kn)>127&&(Nt=wi);break;case 3:Yn=L[Qe+2],128==(192&(kn=L[Qe+1]))&&128==(192&Yn)&&(wi=(15&St)<<12|(63&kn)<<6|63&Yn)>2047&&(wi<55296||wi>57343)&&(Nt=wi);break;case 4:Yn=L[Qe+2],Ti=L[Qe+3],128==(192&(kn=L[Qe+1]))&&128==(192&Yn)&&128==(192&Ti)&&(wi=(15&St)<<18|(63&kn)<<12|(63&Yn)<<6|63&Ti)>65535&&wi<1114112&&(Nt=wi)}null===Nt?(Nt=65533,On=1):Nt>65535&&(Re.push((Nt-=65536)>>>10&1023|55296),Nt=56320|1023&Nt),Re.push(Nt),Qe+=On}return function(L){var N=L.length;if(N<=4096)return String.fromCharCode.apply(String,L);for(var B="",Re=0;Re<N;)B+=String.fromCharCode.apply(String,L.slice(Re,Re+=4096));return B}(Re)}he.kMaxLength=Q,!(x.TYPED_ARRAY_SUPPORT=function(){try{var L=new Uint8Array(1);return L.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===L.foo()}catch(N){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&x[Symbol.species]===x&&Object.defineProperty(x,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),x.poolSize=8192,x.from=function(L,N,B){return O(L,N,B)},x.prototype.__proto__=Uint8Array.prototype,x.__proto__=Uint8Array,x.alloc=function(L,N,B){return function(L,N,B){return A(L),L<=0?v(L):void 0!==N?"string"==typeof B?v(L).fill(N,B):v(L).fill(N):v(L)}(L,N,B)},x.allocUnsafe=function(L){return y(L)},x.allocUnsafeSlow=function(L){return y(L)},x.isBuffer=function(N){return null!=N&&!0===N._isBuffer&&N!==x.prototype},x.compare=function(N,B){if(pt(N,Uint8Array)&&(N=x.from(N,N.offset,N.byteLength)),pt(B,Uint8Array)&&(B=x.from(B,B.offset,B.byteLength)),!x.isBuffer(N)||!x.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===B)return 0;for(var Re=N.length,Qe=B.length,St=0,Nt=Math.min(Re,Qe);St<Nt;++St)if(N[St]!==B[St]){Re=N[St],Qe=B[St];break}return Re<Qe?-1:Qe<Re?1:0},x.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(N,B){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(0===N.length)return x.alloc(0);var Re;if(void 0===B)for(B=0,Re=0;Re<N.length;++Re)B+=N[Re].length;var Qe=x.allocUnsafe(B),St=0;for(Re=0;Re<N.length;++Re){var Nt=N[Re];if(pt(Nt,Uint8Array)&&(Nt=x.from(Nt)),!x.isBuffer(Nt))throw new TypeError('"list" argument must be an Array of Buffers');Nt.copy(Qe,St),St+=Nt.length}return Qe},x.byteLength=D,x.prototype._isBuffer=!0,x.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<N;B+=2)X(this,B,B+1);return this},x.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<N;B+=4)X(this,B,B+3),X(this,B+1,B+2);return this},x.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<N;B+=8)X(this,B,B+7),X(this,B+1,B+6),X(this,B+2,B+5),X(this,B+3,B+4);return this},x.prototype.toLocaleString=x.prototype.toString=function(){var N=this.length;return 0===N?"":0===arguments.length?_e(this,0,N):I.apply(this,arguments)},x.prototype.equals=function(N){if(!x.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||0===x.compare(this,N)},x.prototype.inspect=function(){var N="",B=he.INSPECT_MAX_BYTES;return N=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(N+=" ... "),"<Buffer "+N+">"},x.prototype.compare=function(N,B,Re,Qe,St){if(pt(N,Uint8Array)&&(N=x.from(N,N.offset,N.byteLength)),!x.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(void 0===B&&(B=0),void 0===Re&&(Re=N?N.length:0),void 0===Qe&&(Qe=0),void 0===St&&(St=this.length),B<0||Re>N.length||Qe<0||St>this.length)throw new RangeError("out of range index");if(Qe>=St&&B>=Re)return 0;if(Qe>=St)return-1;if(B>=Re)return 1;if(this===N)return 0;for(var Nt=(St>>>=0)-(Qe>>>=0),On=(Re>>>=0)-(B>>>=0),kn=Math.min(Nt,On),Yn=this.slice(Qe,St),Ti=N.slice(B,Re),wi=0;wi<kn;++wi)if(Yn[wi]!==Ti[wi]){Nt=Yn[wi],On=Ti[wi];break}return Nt<On?-1:On<Nt?1:0},x.prototype.includes=function(N,B,Re){return-1!==this.indexOf(N,B,Re)},x.prototype.indexOf=function(N,B,Re){return E(this,N,B,Re,!0)},x.prototype.lastIndexOf=function(N,B,Re){return E(this,N,B,Re,!1)},x.prototype.write=function(N,B,Re,Qe){if(void 0===B)Qe="utf8",Re=this.length,B=0;else if(void 0===Re&&"string"==typeof B)Qe=B,Re=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(Re)?(Re>>>=0,void 0===Qe&&(Qe="utf8")):(Qe=Re,Re=void 0)}var St=this.length-B;if((void 0===Re||Re>St)&&(Re=St),N.length>0&&(Re<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qe||(Qe="utf8");for(var Nt=!1;;)switch(Qe){case"hex":return Z(this,N,B,Re);case"utf8":case"utf-8":return oe(this,N,B,Re);case"ascii":return se(this,N,B,Re);case"latin1":case"binary":return te(this,N,B,Re);case"base64":return Ce(this,N,B,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,N,B,Re);default:if(Nt)throw new TypeError("Unknown encoding: "+Qe);Qe=(""+Qe).toLowerCase(),Nt=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function st(L,N,B){var Re="";B=Math.min(L.length,B);for(var Qe=N;Qe<B;++Qe)Re+=String.fromCharCode(127&L[Qe]);return Re}function Xe(L,N,B){var Re="";B=Math.min(L.length,B);for(var Qe=N;Qe<B;++Qe)Re+=String.fromCharCode(L[Qe]);return Re}function tt(L,N,B){var Re=L.length;(!N||N<0)&&(N=0),(!B||B<0||B>Re)&&(B=Re);for(var Qe="",St=N;St<B;++St)Qe+=q(L[St]);return Qe}function Ye(L,N,B){for(var Re=L.slice(N,B),Qe="",St=0;St<Re.length;St+=2)Qe+=String.fromCharCode(Re[St]+256*Re[St+1]);return Qe}function Ue(L,N,B){if(L%1!=0||L<0)throw new RangeError("offset is not uint");if(L+N>B)throw new RangeError("Trying to access beyond buffer length")}function ke(L,N,B,Re,Qe,St){if(!x.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>Qe||N<St)throw new RangeError('"value" argument is out of bounds');if(B+Re>L.length)throw new RangeError("Index out of range")}function Ke(L,N,B,Re,Qe,St){if(B+Re>L.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function Me(L,N,B,Re,Qe){return N=+N,B>>>=0,Qe||Ke(L,0,B,4),P.write(L,N,B,Re,23,4),B+4}function Ve(L,N,B,Re,Qe){return N=+N,B>>>=0,Qe||Ke(L,0,B,8),P.write(L,N,B,Re,52,8),B+8}x.prototype.slice=function(N,B){var Re=this.length;(N=~~N)<0?(N+=Re)<0&&(N=0):N>Re&&(N=Re),(B=void 0===B?Re:~~B)<0?(B+=Re)<0&&(B=0):B>Re&&(B=Re),B<N&&(B=N);var Qe=this.subarray(N,B);return Qe.__proto__=x.prototype,Qe},x.prototype.readUIntLE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=this[N],St=1,Nt=0;++Nt<B&&(St*=256);)Qe+=this[N+Nt]*St;return Qe},x.prototype.readUIntBE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=this[N+--B],St=1;B>0&&(St*=256);)Qe+=this[N+--B]*St;return Qe},x.prototype.readUInt8=function(N,B){return N>>>=0,B||Ue(N,1,this.length),this[N]},x.prototype.readUInt16LE=function(N,B){return N>>>=0,B||Ue(N,2,this.length),this[N]|this[N+1]<<8},x.prototype.readUInt16BE=function(N,B){return N>>>=0,B||Ue(N,2,this.length),this[N]<<8|this[N+1]},x.prototype.readUInt32LE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},x.prototype.readUInt32BE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},x.prototype.readIntLE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=this[N],St=1,Nt=0;++Nt<B&&(St*=256);)Qe+=this[N+Nt]*St;return Qe>=(St*=128)&&(Qe-=Math.pow(2,8*B)),Qe},x.prototype.readIntBE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=B,St=1,Nt=this[N+--Qe];Qe>0&&(St*=256);)Nt+=this[N+--Qe]*St;return Nt>=(St*=128)&&(Nt-=Math.pow(2,8*B)),Nt},x.prototype.readInt8=function(N,B){return N>>>=0,B||Ue(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},x.prototype.readInt16LE=function(N,B){N>>>=0,B||Ue(N,2,this.length);var Re=this[N]|this[N+1]<<8;return 32768&Re?4294901760|Re:Re},x.prototype.readInt16BE=function(N,B){N>>>=0,B||Ue(N,2,this.length);var Re=this[N+1]|this[N]<<8;return 32768&Re?4294901760|Re:Re},x.prototype.readInt32LE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},x.prototype.readInt32BE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},x.prototype.readFloatLE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),P.read(this,N,!0,23,4)},x.prototype.readFloatBE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),P.read(this,N,!1,23,4)},x.prototype.readDoubleLE=function(N,B){return N>>>=0,B||Ue(N,8,this.length),P.read(this,N,!0,52,8)},x.prototype.readDoubleBE=function(N,B){return N>>>=0,B||Ue(N,8,this.length),P.read(this,N,!1,52,8)},x.prototype.writeUIntLE=function(N,B,Re,Qe){N=+N,B>>>=0,Re>>>=0,Qe||ke(this,N,B,Re,Math.pow(2,8*Re)-1,0);var Nt=1,On=0;for(this[B]=255&N;++On<Re&&(Nt*=256);)this[B+On]=N/Nt&255;return B+Re},x.prototype.writeUIntBE=function(N,B,Re,Qe){N=+N,B>>>=0,Re>>>=0,Qe||ke(this,N,B,Re,Math.pow(2,8*Re)-1,0);var Nt=Re-1,On=1;for(this[B+Nt]=255&N;--Nt>=0&&(On*=256);)this[B+Nt]=N/On&255;return B+Re},x.prototype.writeUInt8=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,1,255,0),this[B]=255&N,B+1},x.prototype.writeUInt16LE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,2,65535,0),this[B]=255&N,this[B+1]=N>>>8,B+2},x.prototype.writeUInt16BE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,2,65535,0),this[B]=N>>>8,this[B+1]=255&N,B+2},x.prototype.writeUInt32LE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,4,4294967295,0),this[B+3]=N>>>24,this[B+2]=N>>>16,this[B+1]=N>>>8,this[B]=255&N,B+4},x.prototype.writeUInt32BE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,4,4294967295,0),this[B]=N>>>24,this[B+1]=N>>>16,this[B+2]=N>>>8,this[B+3]=255&N,B+4},x.prototype.writeIntLE=function(N,B,Re,Qe){if(N=+N,B>>>=0,!Qe){var St=Math.pow(2,8*Re-1);ke(this,N,B,Re,St-1,-St)}var Nt=0,On=1,kn=0;for(this[B]=255&N;++Nt<Re&&(On*=256);)N<0&&0===kn&&0!==this[B+Nt-1]&&(kn=1),this[B+Nt]=(N/On>>0)-kn&255;return B+Re},x.prototype.writeIntBE=function(N,B,Re,Qe){if(N=+N,B>>>=0,!Qe){var St=Math.pow(2,8*Re-1);ke(this,N,B,Re,St-1,-St)}var Nt=Re-1,On=1,kn=0;for(this[B+Nt]=255&N;--Nt>=0&&(On*=256);)N<0&&0===kn&&0!==this[B+Nt+1]&&(kn=1),this[B+Nt]=(N/On>>0)-kn&255;return B+Re},x.prototype.writeInt8=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,1,127,-128),N<0&&(N=255+N+1),this[B]=255&N,B+1},x.prototype.writeInt16LE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,2,32767,-32768),this[B]=255&N,this[B+1]=N>>>8,B+2},x.prototype.writeInt16BE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,2,32767,-32768),this[B]=N>>>8,this[B+1]=255&N,B+2},x.prototype.writeInt32LE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,4,2147483647,-2147483648),this[B]=255&N,this[B+1]=N>>>8,this[B+2]=N>>>16,this[B+3]=N>>>24,B+4},x.prototype.writeInt32BE=function(N,B,Re){return N=+N,B>>>=0,Re||ke(this,N,B,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[B]=N>>>24,this[B+1]=N>>>16,this[B+2]=N>>>8,this[B+3]=255&N,B+4},x.prototype.writeFloatLE=function(N,B,Re){return Me(this,N,B,!0,Re)},x.prototype.writeFloatBE=function(N,B,Re){return Me(this,N,B,!1,Re)},x.prototype.writeDoubleLE=function(N,B,Re){return Ve(this,N,B,!0,Re)},x.prototype.writeDoubleBE=function(N,B,Re){return Ve(this,N,B,!1,Re)},x.prototype.copy=function(N,B,Re,Qe){if(!x.isBuffer(N))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!Qe&&0!==Qe&&(Qe=this.length),B>=N.length&&(B=N.length),B||(B=0),Qe>0&&Qe<Re&&(Qe=Re),Qe===Re||0===N.length||0===this.length)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(Qe<0)throw new RangeError("sourceEnd out of bounds");Qe>this.length&&(Qe=this.length),N.length-B<Qe-Re&&(Qe=N.length-B+Re);var St=Qe-Re;if(this===N&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(B,Re,Qe);else if(this===N&&Re<B&&B<Qe)for(var Nt=St-1;Nt>=0;--Nt)N[Nt+B]=this[Nt+Re];else Uint8Array.prototype.set.call(N,this.subarray(Re,Qe),B);return St},x.prototype.fill=function(N,B,Re,Qe){if("string"==typeof N){if("string"==typeof B?(Qe=B,B=0,Re=this.length):"string"==typeof Re&&(Qe=Re,Re=this.length),void 0!==Qe&&"string"!=typeof Qe)throw new TypeError("encoding must be a string");if("string"==typeof Qe&&!x.isEncoding(Qe))throw new TypeError("Unknown encoding: "+Qe);if(1===N.length){var St=N.charCodeAt(0);("utf8"===Qe&&St<128||"latin1"===Qe)&&(N=St)}}else"number"==typeof N&&(N&=255);if(B<0||this.length<B||this.length<Re)throw new RangeError("Out of range index");if(Re<=B)return this;var Nt;if(B>>>=0,Re=void 0===Re?this.length:Re>>>0,N||(N=0),"number"==typeof N)for(Nt=B;Nt<Re;++Nt)this[Nt]=N;else{var On=x.isBuffer(N)?N:x.from(N,Qe),kn=On.length;if(0===kn)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Nt=0;Nt<Re-B;++Nt)this[Nt+B]=On[Nt%kn]}return this};var $e=/[^+/0-9A-Za-z-_]/g;function q(L){return L<16?"0"+L.toString(16):L.toString(16)}function G(L,N){N=N||1/0;for(var B,Re=L.length,Qe=null,St=[],Nt=0;Nt<Re;++Nt){if((B=L.charCodeAt(Nt))>55295&&B<57344){if(!Qe){if(B>56319){(N-=3)>-1&&St.push(239,191,189);continue}if(Nt+1===Re){(N-=3)>-1&&St.push(239,191,189);continue}Qe=B;continue}if(B<56320){(N-=3)>-1&&St.push(239,191,189),Qe=B;continue}B=65536+(Qe-55296<<10|B-56320)}else Qe&&(N-=3)>-1&&St.push(239,191,189);if(Qe=null,B<128){if((N-=1)<0)break;St.push(B)}else if(B<2048){if((N-=2)<0)break;St.push(B>>6|192,63&B|128)}else if(B<65536){if((N-=3)<0)break;St.push(B>>12|224,B>>6&63|128,63&B|128)}else{if(!(B<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;St.push(B>>18|240,B>>12&63|128,B>>6&63|128,63&B|128)}}return St}function je(L){return j.toByteArray(function(L){if((L=(L=L.split("=")[0]).trim().replace($e,"")).length<2)return"";for(;L.length%4!=0;)L+="=";return L}(L))}function _t(L,N,B,Re){for(var Qe=0;Qe<Re&&!(Qe+B>=N.length||Qe>=L.length);++Qe)N[Qe+B]=L[Qe];return Qe}function pt(L,N){return L instanceof N||null!=L&&null!=L.constructor&&null!=L.constructor.name&&L.constructor.name===N.name}function ve(L){return L!=L}}).call(this)}).call(this,Y("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(Y,Se,he){"use strict";Se.exports=function W(j){return null===j||"object"!=typeof j||null!=j.toJSON?JSON.stringify(j):Array.isArray(j)?"["+j.reduce((P,Q,z)=>P+(0===z?"":",")+W(void 0===Q||"symbol"==typeof Q?null:Q),"")+"]":"{"+Object.keys(j).sort().reduce((P,Q,z)=>void 0===j[Q]||"symbol"==typeof j[Q]?P:P+(0===P.length?"":",")+W(Q)+":"+W(j[Q]),"")+"}"}},{}],8:[function(Y,Se,he){"use strict";var P,W="object"==typeof Reflect?Reflect:null,j=W&&"function"==typeof W.apply?W.apply:function($,Z,oe){return Function.prototype.apply.call($,Z,oe)};P=W&&"function"==typeof W.ownKeys?W.ownKeys:Object.getOwnPropertySymbols?function($){return Object.getOwnPropertyNames($).concat(Object.getOwnPropertySymbols($))}:function($){return Object.getOwnPropertyNames($)};var z=Number.isNaN||function($){return $!=$};function v(){v.init.call(this)}Se.exports=v,Se.exports.once=function(E,$){return new Promise(function(Z,oe){function se(Ce){E.removeListener($,te),oe(Ce)}function te(){"function"==typeof E.removeListener&&E.removeListener("error",se),Z([].slice.call(arguments))}X(E,$,te,{once:!0}),"error"!==$&&function(E,$,Z){"function"==typeof E.on&&X(E,"error",$,Z)}(E,se,{once:!0})})},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var x=10;function O(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function A(E){return void 0===E._maxListeners?v.defaultMaxListeners:E._maxListeners}function b(E,$,Z,oe){var se,te,Ce;if(O(Z),void 0===(te=E._events)?(te=E._events=Object.create(null),E._eventsCount=0):(void 0!==te.newListener&&(E.emit("newListener",$,Z.listener?Z.listener:Z),te=E._events),Ce=te[$]),void 0===Ce)Ce=te[$]=Z,++E._eventsCount;else if("function"==typeof Ce?Ce=te[$]=oe?[Z,Ce]:[Ce,Z]:oe?Ce.unshift(Z):Ce.push(Z),(se=A(E))>0&&Ce.length>se&&!Ce.warned){Ce.warned=!0;var me=new Error("Possible EventEmitter memory leak detected. "+Ce.length+" "+String($)+" listeners added. Use emitter.setMaxListeners() to increase limit");me.name="MaxListenersExceededWarning",me.emitter=E,me.type=$,me.count=Ce.length,function(E){console&&console.warn&&console.warn(E)}(me)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function S(E,$,Z){var oe={fired:!1,wrapFn:void 0,target:E,type:$,listener:Z},se=y.bind(oe);return se.listener=Z,oe.wrapFn=se,se}function T(E,$,Z){var oe=E._events;if(void 0===oe)return[];var se=oe[$];return void 0===se?[]:"function"==typeof se?Z?[se.listener||se]:[se]:Z?function(E){for(var $=new Array(E.length),Z=0;Z<$.length;++Z)$[Z]=E[Z].listener||E[Z];return $}(se):R(se,se.length)}function V(E){var $=this._events;if(void 0!==$){var Z=$[E];if("function"==typeof Z)return 1;if(void 0!==Z)return Z.length}return 0}function R(E,$){for(var Z=new Array($),oe=0;oe<$;++oe)Z[oe]=E[oe];return Z}function X(E,$,Z,oe){if("function"==typeof E.on)oe.once?E.once($,Z):E.on($,Z);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener($,function se(te){oe.once&&E.removeEventListener($,se),Z(te)})}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(E){if("number"!=typeof E||E<0||z(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");x=E}}),v.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function($){if("number"!=typeof $||$<0||z($))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+$+".");return this._maxListeners=$,this},v.prototype.getMaxListeners=function(){return A(this)},v.prototype.emit=function($){for(var Z=[],oe=1;oe<arguments.length;oe++)Z.push(arguments[oe]);var se="error"===$,te=this._events;if(void 0!==te)se=se&&void 0===te.error;else if(!se)return!1;if(se){var Ce;if(Z.length>0&&(Ce=Z[0]),Ce instanceof Error)throw Ce;var me=new Error("Unhandled error."+(Ce?" ("+Ce.message+")":""));throw me.context=Ce,me}var ne=te[$];if(void 0===ne)return!1;if("function"==typeof ne)j(ne,this,Z);else{var _e=ne.length,Ie=R(ne,_e);for(oe=0;oe<_e;++oe)j(Ie[oe],this,Z)}return!0},v.prototype.on=v.prototype.addListener=function($,Z){return b(this,$,Z,!1)},v.prototype.prependListener=function($,Z){return b(this,$,Z,!0)},v.prototype.once=function($,Z){return O(Z),this.on($,S(this,$,Z)),this},v.prototype.prependOnceListener=function($,Z){return O(Z),this.prependListener($,S(this,$,Z)),this},v.prototype.off=v.prototype.removeListener=function($,Z){var oe,se,te,Ce,me;if(O(Z),void 0===(se=this._events))return this;if(void 0===(oe=se[$]))return this;if(oe===Z||oe.listener===Z)0==--this._eventsCount?this._events=Object.create(null):(delete se[$],se.removeListener&&this.emit("removeListener",$,oe.listener||Z));else if("function"!=typeof oe){for(te=-1,Ce=oe.length-1;Ce>=0;Ce--)if(oe[Ce]===Z||oe[Ce].listener===Z){me=oe[Ce].listener,te=Ce;break}if(te<0)return this;0===te?oe.shift():function(E,$){for(;$+1<E.length;$++)E[$]=E[$+1];E.pop()}(oe,te),1===oe.length&&(se[$]=oe[0]),void 0!==se.removeListener&&this.emit("removeListener",$,me||Z)}return this},v.prototype.removeAllListeners=function($){var Z,oe,se;if(void 0===(oe=this._events))return this;if(void 0===oe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==oe[$]&&(0==--this._eventsCount?this._events=Object.create(null):delete oe[$]),this;if(0===arguments.length){var Ce,te=Object.keys(oe);for(se=0;se<te.length;++se)"removeListener"!==(Ce=te[se])&&this.removeAllListeners(Ce);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Z=oe[$]))this.removeListener($,Z);else if(void 0!==Z)for(se=Z.length-1;se>=0;se--)this.removeListener($,Z[se]);return this},v.prototype.listeners=function($){return T(this,$,!0)},v.prototype.rawListeners=function($){return T(this,$,!1)},v.listenerCount=function(E,$){return"function"==typeof E.listenerCount?E.listenerCount($):V.call(E,$)},v.prototype.listenerCount=V,v.prototype.eventNames=function(){return this._eventsCount>0?P(this._events):[]}},{}],9:[function(Y,Se,he){he.read=function(W,j,P,Q,z){var v,x,O=8*z-Q-1,A=(1<<O)-1,b=A>>1,y=-7,S=P?z-1:0,T=P?-1:1,V=W[j+S];for(S+=T,v=V&(1<<-y)-1,V>>=-y,y+=O;y>0;v=256*v+W[j+S],S+=T,y-=8);for(x=v&(1<<-y)-1,v>>=-y,y+=Q;y>0;x=256*x+W[j+S],S+=T,y-=8);if(0===v)v=1-b;else{if(v===A)return x?NaN:1/0*(V?-1:1);x+=Math.pow(2,Q),v-=b}return(V?-1:1)*x*Math.pow(2,v-Q)},he.write=function(W,j,P,Q,z,v){var x,O,A,b=8*v-z-1,y=(1<<b)-1,S=y>>1,T=23===z?Math.pow(2,-24)-Math.pow(2,-77):0,V=Q?0:v-1,R=Q?1:-1,K=j<0||0===j&&1/j<0?1:0;for(j=Math.abs(j),isNaN(j)||j===1/0?(O=isNaN(j)?1:0,x=y):(x=Math.floor(Math.log(j)/Math.LN2),j*(A=Math.pow(2,-x))<1&&(x--,A*=2),(j+=x+S>=1?T/A:T*Math.pow(2,1-S))*A>=2&&(x++,A/=2),x+S>=y?(O=0,x=y):x+S>=1?(O=(j*A-1)*Math.pow(2,z),x+=S):(O=j*Math.pow(2,S-1)*Math.pow(2,z),x=0));z>=8;W[P+V]=255&O,V+=R,O/=256,z-=8);for(x=x<<z|O,b+=z;b>0;W[P+V]=255&x,V+=R,x/=256,b-=8);W[P+V-R]|=128*K}},{}],10:[function(Y,Se,he){Se.exports="function"==typeof Object.create?function(j,P){P&&(j.super_=P,j.prototype=Object.create(P.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}))}:function(j,P){if(P){j.super_=P;var Q=function(){};Q.prototype=P.prototype,j.prototype=new Q,j.prototype.constructor=j}}},{}],11:[function(Y,Se,he){"use strict";const{isArray:W,isObject:j,isString:P}=Y("./types"),{asArray:Q}=Y("./util"),{prependBase:z}=Y("./url"),v=Y("./JsonLdError"),x=Y("./ResolvedContext");function A(y){throw new v("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function b({context:y,base:S}){if(!y)return;const T=y["@context"];if(P(T))y["@context"]=z(S,T);else if(W(T))for(let V=0;V<T.length;++V){const R=T[V];P(R)?T[V]=z(S,R):j(R)&&b({context:{"@context":R},base:S})}else if(j(T))for(const V in T)b({context:T[V],base:S})}Se.exports=class{constructor({sharedCache:S}){this.perOpCache=new Map,this.sharedCache=S}resolve({activeCtx:S,context:T,documentLoader:V,base:R,cycles:K=new Set}){var ce=this;return yt(function*(){T&&j(T)&&T["@context"]&&(T=T["@context"]),T=Q(T);const D=[];for(const I of T){if(P(I)){let $=ce._get(I);$||($=yield ce._resolveRemoteContext({activeCtx:S,url:I,documentLoader:V,base:R,cycles:K})),W($)?D.push(...$):D.push($);continue}if(null===I){D.push(new x({document:null}));continue}j(I)||A(T);const X=JSON.stringify(I);let E=ce._get(X);E||(E=new x({document:I}),ce._cacheResolvedContext({key:X,resolved:E,tag:"static"})),D.push(E)}return D})()}_get(S){let T=this.perOpCache.get(S);if(!T){const V=this.sharedCache.get(S);V&&(T=V.get("static"),T&&this.perOpCache.set(S,T))}return T}_cacheResolvedContext({key:S,resolved:T,tag:V}){if(this.perOpCache.set(S,T),void 0!==V){let R=this.sharedCache.get(S);R||(R=new Map,this.sharedCache.set(S,R)),R.set(V,T)}return T}_resolveRemoteContext({activeCtx:S,url:T,documentLoader:V,base:R,cycles:K}){var ce=this;return yt(function*(){T=z(R,T);const{context:D,remoteDoc:I}=yield ce._fetchContext({activeCtx:S,url:T,documentLoader:V,cycles:K});b({context:D,base:R=I.documentUrl||T});const X=yield ce.resolve({activeCtx:S,context:D,documentLoader:V,base:R,cycles:K});return ce._cacheResolvedContext({key:T,resolved:X,tag:I.tag}),X})()}_fetchContext({activeCtx:S,url:T,documentLoader:V,cycles:R}){return yt(function*(){if(R.size>10)throw new v("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"loading remote context failed":"context overflow",max:10});if(R.has(T))throw new v("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"recursive context inclusion":"context overflow",url:T});let K,ce;R.add(T);try{ce=yield V(T),K=ce.document||null,P(K)&&(K=JSON.parse(K))}catch(D){throw new v("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:T,cause:D})}if(!j(K))throw new v("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:T});return K="@context"in K?{"@context":K["@context"]}:{"@context":{}},ce.contextUrl&&(W(K["@context"])||(K["@context"]=[K["@context"]]),K["@context"].push(ce.contextUrl)),{context:K,remoteDoc:ce}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(Y,Se,he){"use strict";Se.exports=class extends Error{constructor(j="An unspecified JSON-LD error occurred.",P="jsonld.Error",Q={}){super(j),this.name=P,this.message=j,this.details=Q}}},{}],13:[function(Y,Se,he){"use strict";Se.exports=W=>{class j{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(j,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(j.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:j}),j.compact=function(P,Q){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):W.compact(P,Q)},j.expand=function(P){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):W.expand(P)},j.flatten=function(P){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):W.flatten(P)},j}},{}],14:[function(Y,Se,he){"use strict";Se.exports=Y("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(Y,Se,he){"use strict";Se.exports=class{constructor(){this._requests={}}wrapLoader(j){const P=this;return P._loader=j,function(){return P.add.apply(P,arguments)}}add(j){var P=this;return yt(function*(){let Q=P._requests[j];if(Q)return Promise.resolve(Q);Q=P._requests[j]=P._loader(j);try{return yield Q}finally{delete P._requests[j]}})()}}},{}],16:[function(Y,Se,he){"use strict";const W=Y("lru-cache");Se.exports=class{constructor({document:Q}){this.document=Q,this.cache=new W({max:10})}getProcessed(Q){return this.cache.get(Q)}setProcessed(Q,z){this.cache.set(Q,z)}}},{"lru-cache":33}],17:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:P,isString:Q,isUndefined:z}=Y("./types"),{isList:v,isValue:x,isGraph:O,isSimpleGraph:A,isSubjectReference:b}=Y("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:V,processingMode:R}=Y("./context"),{removeBase:K,prependBase:ce}=Y("./url"),{addValue:D,asArray:I,compareShortestLeast:X}=Y("./util"),E={};function Z(oe,se,te){if("@nest"!==y(oe,se,{vocab:!0},te))throw new W("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Se.exports=E,E.compact=function(){var oe=yt(function*({activeCtx:se,activeProperty:te=null,element:Ce,options:me={},compactionMap:ne=(()=>{})}){if(j(Ce)){let Ie=[];for(let Ge=0;Ge<Ce.length;++Ge){let st=yield E.compact({activeCtx:se,activeProperty:te,element:Ce[Ge],options:me,compactionMap:ne});null===st&&(st=yield ne({unmappedValue:Ce[Ge],activeCtx:se,activeProperty:te,parent:Ce,index:Ge,options:me}),void 0===st)||Ie.push(st)}return me.compactArrays&&1===Ie.length&&0===(S(se,te,"@container")||[]).length&&(Ie=Ie[0]),Ie}const _e=S(se,te,"@context");if(z(_e)||(se=yield V({activeCtx:se,localCtx:_e,propagate:!0,overrideProtected:!0,options:me})),P(Ce)){if(me.link&&"@id"in Ce&&me.link.hasOwnProperty(Ce["@id"])){const ke=me.link[Ce["@id"]];for(let Ke=0;Ke<ke.length;++Ke)if(ke[Ke].expanded===Ce)return ke[Ke].compacted}if(x(Ce)||b(Ce)){const ke=E.compactValue({activeCtx:se,activeProperty:te,value:Ce,options:me});return me.link&&b(Ce)&&(me.link.hasOwnProperty(Ce["@id"])||(me.link[Ce["@id"]]=[]),me.link[Ce["@id"]].push({expanded:Ce,compacted:ke})),ke}if(v(Ce)&&(S(se,te,"@container")||[]).includes("@list"))return E.compact({activeCtx:se,activeProperty:te,element:Ce["@list"],options:me,compactionMap:ne});const Ie="@reverse"===te,Ge={},st=se;!x(Ce)&&!b(Ce)&&(se=se.revertToPreviousContext());const Xe=S(st,te,"@context");z(Xe)||(se=yield V({activeCtx:se,localCtx:Xe,propagate:!0,overrideProtected:!0,options:me})),me.link&&"@id"in Ce&&(me.link.hasOwnProperty(Ce["@id"])||(me.link[Ce["@id"]]=[]),me.link[Ce["@id"]].push({expanded:Ce,compacted:Ge}));let tt=Ce["@type"]||[];tt.length>1&&(tt=Array.from(tt).sort());const Ye=se;for(const ke of tt){const Ke=E.compactIri({activeCtx:Ye,iri:ke,relativeTo:{vocab:!0}}),Me=S(st,Ke,"@context");z(Me)||(se=yield V({activeCtx:se,localCtx:Me,options:me,propagate:!1}))}const Ue=Object.keys(Ce).sort();for(const ke of Ue){const Ke=Ce[ke];if("@id"!==ke)if("@type"!==ke)if("@reverse"!==ke)if("@preserve"!==ke)if("@index"!==ke)if("@graph"!==ke&&"@list"!==ke&&"@included"!==ke&&T(ke)){const Me=E.compactIri({activeCtx:se,iri:ke,relativeTo:{vocab:!0}});D(Ge,Me,Ke)}else{if(!j(Ke))throw new W("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ke.length){const Me=E.compactIri({activeCtx:se,iri:ke,value:Ke,relativeTo:{vocab:!0},reverse:Ie}),Ve=se.mappings.has(Me)?se.mappings.get(Me)["@nest"]:null;let $e=Ge;Ve&&(Z(se,Ve,me),P(Ge[Ve])||(Ge[Ve]={}),$e=Ge[Ve]),D($e,Me,Ke,{propertyIsArray:!0})}for(const Me of Ke){const Ve=E.compactIri({activeCtx:se,iri:ke,value:Me,relativeTo:{vocab:!0},reverse:Ie}),$e=se.mappings.has(Ve)?se.mappings.get(Ve)["@nest"]:null;let Ne=Ge;$e&&(Z(se,$e,me),P(Ge[$e])||(Ge[$e]={}),Ne=Ge[$e]);const q=S(se,Ve,"@container")||[],G=O(Me),pe=v(Me);let ue;pe?ue=Me["@list"]:G&&(ue=Me["@graph"]);let je=yield E.compact({activeCtx:se,activeProperty:Ve,element:pe||G?ue:Me,options:me,compactionMap:ne});if(pe){if(j(je)||(je=[je]),q.includes("@list")){D(Ne,Ve,je,{valueIsArray:!0,allowDuplicate:!0});continue}je={[E.compactIri({activeCtx:se,iri:"@list",relativeTo:{vocab:!0}})]:je},"@index"in Me&&(je[E.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=Me["@index"])}if(G)if(q.includes("@graph")&&(q.includes("@id")||q.includes("@index")&&A(Me))){let _t;Ne.hasOwnProperty(Ve)?_t=Ne[Ve]:Ne[Ve]=_t={};const pt=(q.includes("@id")?Me["@id"]:Me["@index"])||E.compactIri({activeCtx:se,iri:"@none",relativeTo:{vocab:!0}});D(_t,pt,je,{propertyIsArray:!me.compactArrays||q.includes("@set")})}else q.includes("@graph")&&A(Me)?(j(je)&&je.length>1&&(je={"@included":je}),D(Ne,Ve,je,{propertyIsArray:!me.compactArrays||q.includes("@set")})):(j(je)&&1===je.length&&me.compactArrays&&(je=je[0]),je={[E.compactIri({activeCtx:se,iri:"@graph",relativeTo:{vocab:!0}})]:je},"@id"in Me&&(je[E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]=Me["@id"]),"@index"in Me&&(je[E.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=Me["@index"]),D(Ne,Ve,je,{propertyIsArray:!me.compactArrays||q.includes("@set")}));else if(q.includes("@language")||q.includes("@index")||q.includes("@id")||q.includes("@type")){let _t,pt;if(Ne.hasOwnProperty(Ve)?_t=Ne[Ve]:Ne[Ve]=_t={},q.includes("@language"))x(je)&&(je=je["@value"]),pt=Me["@language"];else if(q.includes("@index")){const ve=S(se,Ve,"@index")||"@index",L=E.compactIri({activeCtx:se,iri:ve,relativeTo:{vocab:!0}});if("@index"===ve)pt=Me["@index"],delete je[L];else{let N;if([pt,...N]=I(je[ve]||[]),Q(pt))switch(N.length){case 0:delete je[ve];break;case 1:je[ve]=N[0];break;default:je[ve]=N}else pt=null}}else if(q.includes("@id")){const ve=E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}});pt=je[ve],delete je[ve]}else if(q.includes("@type")){const ve=E.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}});let L;switch([pt,...L]=I(je[ve]||[]),L.length){case 0:delete je[ve];break;case 1:je[ve]=L[0];break;default:je[ve]=L}1===Object.keys(je).length&&"@id"in Me&&(je=yield E.compact({activeCtx:se,activeProperty:Ve,element:{"@id":Me["@id"]},options:me,compactionMap:ne}))}pt||(pt=E.compactIri({activeCtx:se,iri:"@none",relativeTo:{vocab:!0}})),D(_t,pt,je,{propertyIsArray:q.includes("@set")})}else{const _t=!me.compactArrays||q.includes("@set")||q.includes("@list")||j(je)&&0===je.length||"@list"===ke||"@graph"===ke;D(Ne,Ve,je,{propertyIsArray:_t})}}}else{if((S(se,te,"@container")||[]).includes("@index"))continue;const Ve=E.compactIri({activeCtx:se,iri:ke,relativeTo:{vocab:!0}});D(Ge,Ve,Ke)}else{const Me=yield E.compact({activeCtx:se,activeProperty:te,element:Ke,options:me,compactionMap:ne});j(Me)&&0===Me.length||D(Ge,ke,Me)}else{const Me=yield E.compact({activeCtx:se,activeProperty:"@reverse",element:Ke,options:me,compactionMap:ne});for(const Ve in Me)if(se.mappings.has(Ve)&&se.mappings.get(Ve).reverse){const $e=Me[Ve],q=(S(se,Ve,"@container")||[]).includes("@set")||!me.compactArrays;D(Ge,Ve,$e,{propertyIsArray:q}),delete Me[Ve]}if(Object.keys(Me).length>0){const Ve=E.compactIri({activeCtx:se,iri:ke,relativeTo:{vocab:!0}});D(Ge,Ve,Me)}}else{let Me=I(Ke).map(G=>E.compactIri({activeCtx:st,iri:G,relativeTo:{vocab:!0}}));1===Me.length&&(Me=Me[0]);const Ve=E.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}}),q=(S(se,Ve,"@container")||[]).includes("@set")&&R(se,1.1)||j(Me)&&0===Ke.length;D(Ge,Ve,Me,{propertyIsArray:q})}else{let Me=I(Ke).map($e=>E.compactIri({activeCtx:se,iri:$e,relativeTo:{vocab:!1},base:me.base}));1===Me.length&&(Me=Me[0]),Ge[E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]=Me}}return Ge}return Ce});return function(se){return oe.apply(this,arguments)}}(),E.compactIri=({activeCtx:oe,iri:se,value:te=null,relativeTo:Ce={vocab:!1},reverse:me=!1,base:ne=null})=>{if(null===se)return se;oe.isPropertyTermScoped&&oe.previousContext&&(oe=oe.previousContext);const _e=oe.getInverse();if(T(se)&&se in _e&&"@none"in _e[se]&&"@type"in _e[se]["@none"]&&"@none"in _e[se]["@none"]["@type"])return _e[se]["@none"]["@type"]["@none"];if(Ce.vocab&&se in _e){const tt=oe["@language"]||"@none",Ye=[];P(te)&&"@index"in te&&!("@graph"in te)&&Ye.push("@index","@index@set"),P(te)&&"@preserve"in te&&(te=te["@preserve"][0]),O(te)?("@index"in te&&Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te&&Ye.push("@graph@id","@graph@id@set"),Ye.push("@graph","@graph@set","@set"),"@index"in te||Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te||Ye.push("@graph@id","@graph@id@set")):P(te)&&!x(te)&&Ye.push("@id","@id@set","@type","@set@type");let Ue="@language",ke="@null";if(me)Ue="@type",ke="@reverse",Ye.push("@set");else if(v(te)){"@index"in te||Ye.push("@list");const Me=te["@list"];if(0===Me.length)Ue="@any",ke="@none";else{let Ve=0===Me.length?tt:null,$e=null;for(let Ne=0;Ne<Me.length;++Ne){const q=Me[Ne];let G="@none",pe="@none";if(x(q)?"@direction"in q?G=`${(q["@language"]||"").toLowerCase()}_${q["@direction"]}`:"@language"in q?G=q["@language"].toLowerCase():"@type"in q?pe=q["@type"]:G="@null":pe="@id",null===Ve?Ve=G:G!==Ve&&x(q)&&(Ve="@none"),null===$e?$e=pe:pe!==$e&&($e="@none"),"@none"===Ve&&"@none"===$e)break}Ve=Ve||"@none",$e=$e||"@none","@none"!==$e?(Ue="@type",ke=$e):ke=Ve}}else{if(x(te))if("@language"in te&&!("@index"in te)){Ye.push("@language","@language@set"),ke=te["@language"];const Me=te["@direction"];Me&&(ke=`${ke}_${Me}`)}else"@direction"in te&&!("@index"in te)?ke=`_${te["@direction"]}`:"@type"in te&&(Ue="@type",ke=te["@type"]);else Ue="@type",ke="@id";Ye.push("@set")}Ye.push("@none"),P(te)&&!("@index"in te)&&Ye.push("@index","@index@set"),x(te)&&1===Object.keys(te).length&&Ye.push("@language","@language@set");const Ke=function(oe,se,te,Ce,me,ne){null===ne&&(ne="@null");const _e=[];if(("@id"===ne||"@reverse"===ne)&&P(te)&&"@id"in te){"@reverse"===ne&&_e.push("@reverse");const Ge=E.compactIri({activeCtx:oe,iri:te["@id"],relativeTo:{vocab:!0}});oe.mappings.has(Ge)&&oe.mappings.get(Ge)&&oe.mappings.get(Ge)["@id"]===te["@id"]?_e.push.apply(_e,["@vocab","@id"]):_e.push.apply(_e,["@id","@vocab"])}else{_e.push(ne);const Ge=_e.find(st=>st.includes("_"));Ge&&_e.push(Ge.replace(/^[^_]+_/,"_"))}_e.push("@none");const Ie=oe.inverse[se];for(const Ge of Ce){if(!(Ge in Ie))continue;const st=Ie[Ge][me];for(const Xe of _e)if(Xe in st)return st[Xe]}return null}(oe,se,te,Ye,Ue,ke);if(null!==Ke)return Ke}if(Ce.vocab&&"@vocab"in oe){const tt=oe["@vocab"];if(0===se.indexOf(tt)&&se!==tt){const Ye=se.substr(tt.length);if(!oe.mappings.has(Ye))return Ye}}let Ie=null;const Ge=[];let st=oe.fastCurieMap;const Xe=se.length-1;for(let tt=0;tt<Xe&&se[tt]in st;++tt)st=st[se[tt]],""in st&&Ge.push(st[""][0]);for(let tt=Ge.length-1;tt>=0;--tt){const Ye=Ge[tt],Ue=Ye.terms;for(const ke of Ue){const Ke=ke+":"+se.substr(Ye.iri.length);oe.mappings.get(ke)._prefix&&(!oe.mappings.has(Ke)||null===te&&oe.mappings.get(Ke)["@id"]===se)&&(null===Ie||X(Ke,Ie)<0)&&(Ie=Ke)}}if(null!==Ie)return Ie;for(const[tt,Ye]of oe.mappings)if(Ye&&Ye._prefix&&se.startsWith(tt+":"))throw new W(`Absolute IRI "${se}" confused with prefix "${tt}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:oe});return Ce.vocab?se:"@base"in oe?oe["@base"]?K(ce(ne,oe["@base"]),se):se:K(ne,se)},E.compactValue=({activeCtx:oe,activeProperty:se,value:te,options:Ce})=>{if(x(te)){const Ie=S(oe,se,"@type"),Ge=S(oe,se,"@language"),st=S(oe,se,"@direction"),Xe=S(oe,se,"@container")||[],tt="@index"in te&&!Xe.includes("@index");if(!tt&&"@none"!==Ie&&(te["@type"]===Ie||"@language"in te&&te["@language"]===Ge&&"@direction"in te&&te["@direction"]===st||"@language"in te&&te["@language"]===Ge||"@direction"in te&&te["@direction"]===st))return te["@value"];const Ye=Object.keys(te).length,Ue=1===Ye||2===Ye&&"@index"in te&&!tt,ke="@language"in oe,Ke=Q(te["@value"]),Me=oe.mappings.has(se)&&null===oe.mappings.get(se)["@language"];if(Ue&&"@none"!==Ie&&(!ke||!Ke||Me))return te["@value"];const Ve={};return tt&&(Ve[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=te["@index"]),"@type"in te?Ve[E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:oe,iri:te["@type"],relativeTo:{vocab:!0}}):"@language"in te&&(Ve[E.compactIri({activeCtx:oe,iri:"@language",relativeTo:{vocab:!0}})]=te["@language"]),"@direction"in te&&(Ve[E.compactIri({activeCtx:oe,iri:"@direction",relativeTo:{vocab:!0}})]=te["@direction"]),Ve[E.compactIri({activeCtx:oe,iri:"@value",relativeTo:{vocab:!0}})]=te["@value"],Ve}const me=y(oe,se,{vocab:!0},Ce),ne=S(oe,se,"@type"),_e=E.compactIri({activeCtx:oe,iri:te["@id"],relativeTo:{vocab:"@vocab"===ne},base:Ce.base});return"@id"===ne||"@vocab"===ne||"@graph"===me?_e:{[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]:_e}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(Y,Se,he){"use strict";const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#";Se.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:W,RDF_LIST:W+"List",RDF_FIRST:W+"first",RDF_REST:W+"rest",RDF_NIL:W+"nil",RDF_TYPE:W+"type",RDF_PLAIN_LITERAL:W+"PlainLiteral",RDF_XML_LITERAL:W+"XMLLiteral",RDF_JSON_LITERAL:W+"JSON",RDF_OBJECT:W+"object",RDF_LANGSTRING:W+"langString",XSD:j,XSD_BOOLEAN:j+"boolean",XSD_DOUBLE:j+"double",XSD_INTEGER:j+"integer",XSD_STRING:j+"string"}},{}],19:[function(Y,Se,he){"use strict";const W=Y("./util"),j=Y("./JsonLdError"),{isArray:P,isObject:Q,isString:z,isUndefined:v}=Y("./types"),{isAbsolute:x,isRelative:O,prependBase:A}=Y("./url"),{asArray:b,compareShortestLeast:y}=Y("./util"),S=new Map,V=/^@[a-zA-Z]+$/,R={};function K(D,I,X,E,$,Z){if(null===I||!z(I)||R.isKeyword(I))return I;if(I.match(V))return null;if(E&&E.hasOwnProperty(I)&&!0!==$.get(I)&&R.createTermDefinition({activeCtx:D,localCtx:E,term:I,defined:$,options:Z}),(X=X||{}).vocab){const se=D.mappings.get(I);if(null===se)return null;if(Q(se)&&"@id"in se)return se["@id"]}const oe=I.indexOf(":");if(oe>0){const se=I.substr(0,oe),te=I.substr(oe+1);if("_"===se||0===te.indexOf("//"))return I;E&&E.hasOwnProperty(se)&&R.createTermDefinition({activeCtx:D,localCtx:E,term:se,defined:$,options:Z});const Ce=D.mappings.get(se);if(Ce&&Ce._prefix)return Ce["@id"]+te;if(x(I))return I}if(X.vocab&&"@vocab"in D)return D["@vocab"]+I;if(X.base&&"@base"in D){if(D["@base"])return A(A(Z.base,D["@base"]),I)}else if(X.base)return A(Z.base,I);return I}function ce(D,I){if(!D||"object"!=typeof D||!I||"object"!=typeof I)return D===I;const X=Array.isArray(D);if(X!==Array.isArray(I))return!1;if(X){if(D.length!==I.length)return!1;for(let Z=0;Z<D.length;++Z)if(!ce(D[Z],I[Z]))return!1;return!0}const E=Object.keys(D),$=Object.keys(I);if(E.length!==$.length)return!1;for(const Z in D){let oe=D[Z],se=I[Z];if("@container"===Z&&Array.isArray(oe)&&Array.isArray(se)&&(oe=oe.slice().sort(),se=se.slice().sort()),!ce(oe,se))return!1}return!0}Se.exports=R,R.process=function(){var D=yt(function*({activeCtx:I,localCtx:X,options:E,propagate:$=!0,overrideProtected:Z=!1,cycles:oe=new Set}){if(Q(X)&&"@context"in X&&P(X["@context"])&&(X=X["@context"]),0===b(X).length)return I;const te=yield E.contextResolver.resolve({activeCtx:I,context:X,documentLoader:E.documentLoader,base:E.base});Q(te[0].document)&&"boolean"==typeof te[0].document["@propagate"]&&($=te[0].document["@propagate"]);let Ce=I;!$&&!Ce.previousContext&&(Ce=Ce.clone(),Ce.previousContext=I);for(const me of te){let{document:ne}=me;if(I=Ce,null===ne){if(!Z&&0!==Object.keys(I.protected).length){const Ge=E&&E.protectedMode||"error";if("error"===Ge)throw new j("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===Ge){console.warn("WARNING: invalid context nullification");const st=me.getProcessed(I);if(st){Ce=I=st;continue}const Xe=I;Ce=I=R.getInitialContext(E).clone();for(const[tt,Ye]of Object.entries(Xe.protected))Ye&&(I.mappings[tt]=W.clone(Xe.mappings[tt]));I.protected=W.clone(Xe.protected),me.setProcessed(Xe,Ce);continue}throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:X,protectedMode:Ge})}Ce=I=R.getInitialContext(E).clone();continue}const _e=me.getProcessed(I);if(_e){Ce=I=_e;continue}if(Q(ne)&&"@context"in ne&&(ne=ne["@context"]),!Q(ne))throw new j("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ne});Ce=Ce.clone();const Ie=new Map;if("@version"in ne){if(1.1!==ne["@version"])throw new j("Unsupported JSON-LD version: "+ne["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:ne});if(I.processingMode&&"json-ld-1.0"===I.processingMode)throw new j("@version: "+ne["@version"]+" not compatible with "+I.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:ne});Ce.processingMode="json-ld-1.1",Ce["@version"]=ne["@version"],Ie.set("@version",!0)}if(Ce.processingMode=Ce.processingMode||I.processingMode,"@base"in ne){let Ge=ne["@base"];if(null!==Ge&&!x(Ge)){if(!O(Ge))throw new j('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:ne});Ge=A(Ce["@base"],Ge)}Ce["@base"]=Ge,Ie.set("@base",!0)}if("@vocab"in ne){const Ge=ne["@vocab"];if(null===Ge)delete Ce["@vocab"];else{if(!z(Ge))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});if(!x(Ge)&&R.processingMode(Ce,1))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});Ce["@vocab"]=K(Ce,Ge,{vocab:!0,base:!0},void 0,void 0,E)}Ie.set("@vocab",!0)}if("@language"in ne){const Ge=ne["@language"];if(null===Ge)delete Ce["@language"];else{if(!z(Ge))throw new j('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:ne});Ce["@language"]=Ge.toLowerCase()}Ie.set("@language",!0)}if("@direction"in ne){const Ge=ne["@direction"];if("json-ld-1.0"===I.processingMode)throw new j("Invalid JSON-LD syntax; @direction not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:ne});if(null===Ge)delete Ce["@direction"];else{if("ltr"!==Ge&&"rtl"!==Ge)throw new j('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:ne});Ce["@direction"]=Ge}Ie.set("@direction",!0)}if("@propagate"in ne){const Ge=ne["@propagate"];if("json-ld-1.0"===I.processingMode)throw new j("Invalid JSON-LD syntax; @propagate not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if("boolean"!=typeof Ge)throw new j("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:X});Ie.set("@propagate",!0)}if("@import"in ne){const Ge=ne["@import"];if("json-ld-1.0"===I.processingMode)throw new j("Invalid JSON-LD syntax; @import not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if(!z(Ge))throw new j("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:X});const st=yield E.contextResolver.resolve({activeCtx:I,context:Ge,documentLoader:E.documentLoader,base:E.base});if(1!==st.length)throw new j("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:X});const Xe=st[0].getProcessed(I);if(Xe)ne=Xe;else{const tt=st[0].document;if("@import"in tt)throw new j("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:X});for(const Ye in tt)ne.hasOwnProperty(Ye)||(ne[Ye]=tt[Ye]);st[0].setProcessed(I,ne)}Ie.set("@import",!0)}Ie.set("@protected",ne["@protected"]||!1);for(const Ge in ne)if(R.createTermDefinition({activeCtx:Ce,localCtx:ne,term:Ge,defined:Ie,options:E,overrideProtected:Z}),Q(ne[Ge])&&"@context"in ne[Ge]){const st=ne[Ge]["@context"];let Xe=!0;if(z(st)){const tt=A(E.base,st);oe.has(tt)?Xe=!1:oe.add(tt)}if(Xe)try{yield R.process({activeCtx:Ce.clone(),localCtx:ne[Ge]["@context"],overrideProtected:!0,options:E,cycles:oe})}catch(tt){throw new j("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:ne[Ge]["@context"],term:Ge})}}me.setProcessed(I,Ce)}return Ce});return function(I){return D.apply(this,arguments)}}(),R.createTermDefinition=({activeCtx:D,localCtx:I,term:X,defined:E,options:$,overrideProtected:Z=!1})=>{if(E.has(X)){if(E.get(X))return;throw new j("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:I,term:X})}let oe;if(E.set(X,!1),I.hasOwnProperty(X)&&(oe=I[X]),"@type"===X&&Q(oe)&&"@set"===(oe["@container"]||"@set")&&R.processingMode(D,1.1)){const Ie=["@container","@id","@protected"],Ge=Object.keys(oe);if(0===Ge.length||Ge.some(st=>!Ie.includes(st)))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X})}else{if(R.isKeyword(X))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X});if(X.match(V))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:X});if(""===X)throw new j("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:I})}const se=D.mappings.get(X);D.mappings.has(X)&&D.mappings.delete(X);let te=!1;if((z(oe)||null===oe)&&(te=!0,oe={"@id":oe}),!Q(oe))throw new j("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:I});const Ce={};D.mappings.set(X,Ce),Ce.reverse=!1;const me=["@container","@id","@language","@reverse","@type"];R.processingMode(D,1.1)&&me.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Ie in oe)if(!me.includes(Ie))throw new j("Invalid JSON-LD syntax; a term definition must not contain "+Ie,"jsonld.SyntaxError",{code:"invalid term definition",context:I});const ne=X.indexOf(":");if(Ce._termHasColon=ne>0,"@reverse"in oe){if("@id"in oe)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});if("@nest"in oe)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});const Ie=oe["@reverse"];if(!z(Ie))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(!R.isKeyword(Ie)&&Ie.match(V))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Ie}),void(se?D.mappings.set(X,se):D.mappings.delete(X));const Ge=K(D,Ie,{vocab:!0,base:!1},I,E,$);if(!x(Ge))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});Ce["@id"]=Ge,Ce.reverse=!0}else if("@id"in oe){let Ie=oe["@id"];if(Ie&&!z(Ie))throw new j("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(null===Ie)Ce["@id"]=null;else{if(!R.isKeyword(Ie)&&Ie.match(V))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Ie}),void(se?D.mappings.set(X,se):D.mappings.delete(X));if(Ie!==X){if(Ie=K(D,Ie,{vocab:!0,base:!1},I,E,$),!x(Ie)&&!R.isKeyword(Ie))throw new j("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(X.match(/(?::[^:])|\//)&&K(D,X,{vocab:!0,base:!1},I,new Map(E).set(X,!0),$)!==Ie)throw new j("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});Ce["@id"]=Ie,Ce._prefix=te&&!Ce._termHasColon&&Ie.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Ce))if(Ce._termHasColon){const Ie=X.substr(0,ne);if(I.hasOwnProperty(Ie)&&R.createTermDefinition({activeCtx:D,localCtx:I,term:Ie,defined:E,options:$}),D.mappings.has(Ie)){const Ge=X.substr(ne+1);Ce["@id"]=D.mappings.get(Ie)["@id"]+Ge}else Ce["@id"]=X}else if("@type"===X)Ce["@id"]=X;else{if(!("@vocab"in D))throw new j("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I,term:X});Ce["@id"]=D["@vocab"]+X}if((!0===oe["@protected"]||!0===E.get("@protected")&&!1!==oe["@protected"])&&(D.protected[X]=!0,Ce.protected=!0),E.set(X,!0),"@type"in oe){let Ie=oe["@type"];if(!z(Ie))throw new j("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if("@json"===Ie||"@none"===Ie){if(R.processingMode(D,1))throw new j(`Invalid JSON-LD syntax; an @context @type value must not be "${Ie}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else if("@id"!==Ie&&"@vocab"!==Ie){if(Ie=K(D,Ie,{vocab:!0,base:!1},I,E,$),!x(Ie))throw new j("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if(0===Ie.indexOf("_:"))throw new j("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}Ce["@type"]=Ie}if("@container"in oe){const Ie=z(oe["@container"])?[oe["@container"]]:oe["@container"]||[],Ge=["@list","@set","@index","@language"];let st=!0;const Xe=Ie.includes("@set");if(R.processingMode(D,1.1)){if(Ge.push("@graph","@id","@type"),Ie.includes("@list")){if(1!==Ie.length)throw new j("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else if(Ie.includes("@graph")){if(Ie.some(tt=>"@graph"!==tt&&"@id"!==tt&&"@index"!==tt&&"@set"!==tt))throw new j("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else st&=Ie.length<=(Xe?2:1);if(Ie.includes("@type")&&(Ce["@type"]=Ce["@type"]||"@id",!["@id","@vocab"].includes(Ce["@type"])))throw new j("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else st&=!P(oe["@container"]),st&=Ie.length<=1;if(st&=Ie.every(tt=>Ge.includes(tt)),st&=!(Xe&&Ie.includes("@list")),!st)throw new j("Invalid JSON-LD syntax; @context @container value must be one of the following: "+Ge.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:I});if(Ce.reverse&&!Ie.every(tt=>["@index","@set"].includes(tt)))throw new j("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});Ce["@container"]=Ie}if("@index"in oe){if(!("@container"in oe)||!Ce["@container"].includes("@index"))throw new j(`Invalid JSON-LD syntax; @index without @index in @container: "${oe["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});if(!z(oe["@index"])||0===oe["@index"].indexOf("@"))throw new j(`Invalid JSON-LD syntax; @index must expand to an IRI: "${oe["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});Ce["@index"]=oe["@index"]}if("@context"in oe&&(Ce["@context"]=oe["@context"]),"@language"in oe&&!("@type"in oe)){let Ie=oe["@language"];if(null!==Ie&&!z(Ie))throw new j("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:I});null!==Ie&&(Ie=Ie.toLowerCase()),Ce["@language"]=Ie}if("@prefix"in oe){if(X.match(/:|\//))throw new j("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:I});if(R.isKeyword(Ce["@id"]))throw new j("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:I});if("boolean"!=typeof oe["@prefix"])throw new j("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:I});Ce._prefix=!0===oe["@prefix"]}if("@direction"in oe){const Ie=oe["@direction"];if(null!==Ie&&"ltr"!==Ie&&"rtl"!==Ie)throw new j('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:I});Ce["@direction"]=Ie}if("@nest"in oe){const Ie=oe["@nest"];if(!z(Ie)||"@nest"!==Ie&&0===Ie.indexOf("@"))throw new j("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:I});Ce["@nest"]=Ie}const _e=Ce["@id"];if("@context"===_e||"@preserve"===_e)throw new j("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:I});if(se&&se.protected&&!Z&&(D.protected[X]=!0,Ce.protected=!0,!ce(se,Ce))){const Ie=$&&$.protectedMode||"error";if("error"===Ie)throw new j(`Invalid JSON-LD syntax; tried to redefine "${X}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:I,term:X});if("warn"===Ie)return void console.warn("WARNING: protected term redefinition",{term:X});throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:I,term:X,protectedMode:Ie})}},R.expandIri=(D,I,X,E)=>K(D,I,X,void 0,void 0,E),R.getInitialContext=D=>{const I=JSON.stringify({processingMode:D.processingMode}),X=S.get(I);if(X)return X;const E={processingMode:D.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Ce=this;if(Ce.inverse)return Ce.inverse;const me=Ce.inverse={},ne=Ce.fastCurieMap={},_e={},Ie=(Ce["@language"]||"@none").toLowerCase(),Ge=Ce["@direction"],st=Ce.mappings,Xe=[...st.keys()].sort(y);for(const tt of Xe){const Ye=st.get(tt);if(null===Ye)continue;let Ue=Ye["@container"]||"@none";if(Ue=[].concat(Ue).sort().join(""),null===Ye["@id"])continue;const ke=b(Ye["@id"]);for(const Ke of ke){let Me=me[Ke];const Ve=R.isKeyword(Ke);if(Me)!Ve&&!Ye._termHasColon&&_e[Ke].push(tt);else if(me[Ke]=Me={},!Ve&&!Ye._termHasColon){_e[Ke]=[tt];const $e={iri:Ke,terms:_e[Ke]};Ke[0]in ne?ne[Ke[0]].push($e):ne[Ke[0]]=[$e]}if(Me[Ue]||(Me[Ue]={"@language":{},"@type":{},"@any":{}}),Me=Me[Ue],oe(tt,Me["@any"],"@none"),Ye.reverse)oe(tt,Me["@type"],"@reverse");else if("@none"===Ye["@type"])oe(tt,Me["@any"],"@none"),oe(tt,Me["@language"],"@none"),oe(tt,Me["@type"],"@none");else if("@type"in Ye)oe(tt,Me["@type"],Ye["@type"]);else if("@language"in Ye&&"@direction"in Ye){const $e=Ye["@language"],Ne=Ye["@direction"];oe(tt,Me["@language"],$e&&Ne?`${$e}_${Ne}`.toLowerCase():$e?$e.toLowerCase():Ne?`_${Ne}`:"@null")}else"@language"in Ye?oe(tt,Me["@language"],(Ye["@language"]||"@null").toLowerCase()):"@direction"in Ye?oe(tt,Me["@language"],Ye["@direction"]?`_${Ye["@direction"]}`:"@none"):Ge?(oe(tt,Me["@language"],`_${Ge}`),oe(tt,Me["@language"],"@none"),oe(tt,Me["@type"],"@none")):(oe(tt,Me["@language"],Ie),oe(tt,Me["@language"],"@none"),oe(tt,Me["@type"],"@none"))}}for(const tt in ne)Z(ne,tt,1);return me},clone:function(){const Ce={};return Ce.mappings=W.clone(this.mappings),Ce.clone=this.clone,Ce.inverse=null,Ce.getInverse=this.getInverse,Ce.protected=W.clone(this.protected),this.previousContext&&(Ce.previousContext=this.previousContext.clone()),Ce.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Ce["@base"]=this["@base"]),"@language"in this&&(Ce["@language"]=this["@language"]),"@vocab"in this&&(Ce["@vocab"]=this["@vocab"]),Ce},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===S.size&&S.clear(),S.set(I,E),E;function Z(Ce,me,ne){const _e=Ce[me],Ie=Ce[me]={};let Ge,st;for(const Xe of _e)Ge=Xe.iri,st=ne>=Ge.length?"":Ge[ne],st in Ie?Ie[st].push(Xe):Ie[st]=[Xe];for(const Xe in Ie)""!==Xe&&Z(Ie,Xe,ne+1)}function oe(Ce,me,ne){me.hasOwnProperty(ne)||(me[ne]=Ce)}},R.getContextValue=(D,I,X)=>{if(null===I)return"@context"===X?void 0:null;if(D.mappings.has(I)){const E=D.mappings.get(I);if(v(X))return E;if(E.hasOwnProperty(X))return E[X]}return"@language"===X&&X in D||"@direction"===X&&X in D?D[X]:"@context"!==X?null:void 0},R.processingMode=(D,I)=>I.toString()>="1.1"?!D.processingMode||D.processingMode>="json-ld-"+I.toString():"json-ld-1.0"===D.processingMode,R.isKeyword=D=>{if(!z(D)||"@"!==D[0])return!1;switch(D){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(Y,Se,he){"use strict";const{parseLinkHeader:W,buildHeaders:j}=Y("../util"),{LINK_HEADER_CONTEXT:P}=Y("../constants"),Q=Y("../JsonLdError"),z=Y("../RequestQueue"),{prependBase:v}=Y("../url"),x=/(^|(\r\n))link:/i;function O(A,b,y){const S=new(A=A||XMLHttpRequest);return new Promise((T,V)=>{S.onload=()=>T(S),S.onerror=R=>V(R),S.open("GET",b,!0);for(const R in y)S.setRequestHeader(R,y[R]);S.send()})}Se.exports=({secure:A,headers:b={},xhr:y}={headers:{}})=>{return b=j(b),(new z).wrapLoader(T);function T(R){return V.apply(this,arguments)}function V(){return(V=yt(function*(R){if(0!==R.indexOf("http:")&&0!==R.indexOf("https:"))throw new Q('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:R});if(A&&0!==R.indexOf("https"))throw new Q('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:R});let K;try{K=yield O(y,R,b)}catch(E){throw new Q("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:R,cause:E})}if(K.status>=400)throw new Q("URL could not be dereferenced: "+K.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:R,httpStatusCode:K.status});let ce={contextUrl:null,documentUrl:R,document:K.response},D=null;const I=K.getResponseHeader("Content-Type");let X;if(x.test(K.getAllResponseHeaders())&&(X=K.getResponseHeader("Link")),X&&"application/ld+json"!==I){const E=W(X),$=E[P];if(Array.isArray($))throw new Q("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:R});$&&(ce.contextUrl=$.target),D=E.alternate,D&&"application/ld+json"==D.type&&!(I||"").match(/^application\/(\w*\+)?json$/)&&(ce=yield T(v(R,D.target)))}return ce})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:P,isEmptyObject:Q,isString:z,isUndefined:v}=Y("./types"),{isList:x,isValue:O,isGraph:A,isSubject:b}=Y("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:V,processingMode:R}=Y("./context"),{isAbsolute:K}=Y("./url"),{addValue:ce,asArray:D,getValues:I,validateTypeValue:X}=Y("./util"),E={};Se.exports=E;const $=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Z(ne){return oe.apply(this,arguments)}function oe(){return(oe=yt(function*({activeCtx:ne,activeProperty:_e,expandedActiveProperty:Ie,element:Ge,expandedParent:st,options:Xe={},insideList:tt,typeKey:Ye,typeScopedContext:Ue,expansionMap:ke}){const Ke=Object.keys(Ge).sort(),Me=[];let Ve;const $e=Ge[Ye]&&"@json"===y(ne,j(Ge[Ye])?Ge[Ye][0]:Ge[Ye],{vocab:!0},Xe);for(const Ne of Ke){let G,q=Ge[Ne];if("@context"===Ne)continue;let pe=y(ne,Ne,{vocab:!0},Xe);if((null===pe||!K(pe)&&!T(pe))&&(pe=ke({unmappedProperty:Ne,activeCtx:ne,activeProperty:_e,parent:Ge,options:Xe,insideList:tt,value:q,expandedParent:st}),void 0===pe))continue;if(T(pe)){if("@reverse"===Ie)throw new W("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:q});if(pe in st&&"@included"!==pe&&"@type"!==pe)throw new W("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:pe})}if("@id"===pe){if(!z(q)){if(!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(P(q)){if(!Q(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}else{if(!j(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(!q.every(pt=>z(pt)))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}}ce(st,"@id",D(q).map(pt=>z(pt)?y(ne,pt,{base:!0},Xe):pt),{propertyIsArray:Xe.isFrame});continue}if("@type"===pe){P(q)&&(q=Object.fromEntries(Object.entries(q).map(([pt,ve])=>[y(Ue,pt,{vocab:!0}),D(ve).map(L=>y(Ue,L,{base:!0,vocab:!0}))]))),X(q,Xe.isFrame),ce(st,"@type",D(q).map(pt=>z(pt)?y(Ue,pt,{base:!0,vocab:!0},Xe):pt),{propertyIsArray:Xe.isFrame});continue}if("@included"===pe&&R(ne,1.1)){const pt=D(yield E.expand({activeCtx:ne,activeProperty:_e,element:q,options:Xe,expansionMap:ke}));if(!pt.every(ve=>b(ve)))throw new W("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:q});ce(st,"@included",pt,{propertyIsArray:!0});continue}if("@graph"===pe&&!P(q)&&!j(q))throw new W('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:q});if("@value"===pe){Ve=q,$e&&R(ne,1.1)?st["@value"]=q:ce(st,"@value",q,{propertyIsArray:Xe.isFrame});continue}if("@language"===pe){if(null===q)continue;if(!z(q)&&!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:q});q=D(q).map(pt=>z(pt)?pt.toLowerCase():pt);for(const pt of q)z(pt)&&!pt.match($)&&console.warn(`@language must be valid BCP47: ${pt}`);ce(st,"@language",q,{propertyIsArray:Xe.isFrame});continue}if("@direction"===pe){if(!z(q)&&!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:q});q=D(q);for(const pt of q)if(z(pt)&&"ltr"!==pt&&"rtl"!==pt)throw new W('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:q});ce(st,"@direction",q,{propertyIsArray:Xe.isFrame});continue}if("@index"===pe){if(!z(q))throw new W('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:q});ce(st,"@index",q);continue}if("@reverse"===pe){if(!P(q))throw new W('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:q});if(G=yield E.expand({activeCtx:ne,activeProperty:"@reverse",element:q,options:Xe,expansionMap:ke}),"@reverse"in G)for(const ve in G["@reverse"])ce(st,ve,G["@reverse"][ve],{propertyIsArray:!0});let pt=st["@reverse"]||null;for(const ve in G){if("@reverse"===ve)continue;null===pt&&(pt=st["@reverse"]={}),ce(pt,ve,[],{propertyIsArray:!0});const L=G[ve];for(let N=0;N<L.length;++N){const B=L[N];if(O(B)||x(B))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ce(pt,ve,B,{propertyIsArray:!0})}}continue}if("@nest"===pe){Me.push(Ne);continue}let ue=ne;const je=S(ne,Ne,"@context");v(je)||(ue=yield V({activeCtx:ne,localCtx:je,propagate:!0,overrideProtected:!0,options:Xe}));const _t=S(ue,Ne,"@container")||[];if(_t.includes("@language")&&P(q))G=te(ue,q,S(ue,Ne,"@direction"),Xe);else if(_t.includes("@index")&&P(q)){const pt=_t.includes("@graph"),ve=S(ue,Ne,"@index")||"@index",L="@index"!==ve&&y(ne,ve,{vocab:!0},Xe);G=yield Ce({activeCtx:ue,options:Xe,activeProperty:Ne,value:q,expansionMap:ke,asGraph:pt,indexKey:ve,propertyIndex:L})}else if(_t.includes("@id")&&P(q)){const pt=_t.includes("@graph");G=yield Ce({activeCtx:ue,options:Xe,activeProperty:Ne,value:q,expansionMap:ke,asGraph:pt,indexKey:"@id"})}else if(_t.includes("@type")&&P(q))G=yield Ce({activeCtx:ue.revertToPreviousContext(),options:Xe,activeProperty:Ne,value:q,expansionMap:ke,asGraph:!1,indexKey:"@type"});else{const pt="@list"===pe;if(pt||"@set"===pe){let ve=_e;pt&&"@graph"===Ie&&(ve=null),G=yield E.expand({activeCtx:ue,activeProperty:ve,element:q,options:Xe,insideList:pt,expansionMap:ke})}else G="@json"===S(ne,Ne,"@type")?{"@type":"@json","@value":q}:yield E.expand({activeCtx:ue,activeProperty:Ne,element:q,options:Xe,insideList:!1,expansionMap:ke})}if(null!==G||"@value"===pe||(G=ke({unmappedValue:q,expandedProperty:pe,activeCtx:ue,activeProperty:_e,parent:Ge,options:Xe,insideList:tt,key:Ne,expandedParent:st}),void 0!==G)){if("@list"!==pe&&!x(G)&&_t.includes("@list")&&(G={"@list":D(G)}),_t.includes("@graph")&&!_t.some(pt=>"@id"===pt||"@index"===pt)&&(G=D(G).map(pt=>({"@graph":D(pt)}))),ue.mappings.has(Ne)&&ue.mappings.get(Ne).reverse){const pt=st["@reverse"]=st["@reverse"]||{};G=D(G);for(let ve=0;ve<G.length;++ve){const L=G[ve];if(O(L)||x(L))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ce(pt,pe,L,{propertyIsArray:!0})}continue}ce(st,pe,G,{propertyIsArray:!0})}}if("@value"in st&&("@json"!==st["@type"]||!R(ne,1.1))&&(P(Ve)||j(Ve))&&!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Ve});for(const Ne of Me){const q=j(Ge[Ne])?Ge[Ne]:[Ge[Ne]];for(const G of q){if(!P(G)||Object.keys(G).some(pe=>"@value"===y(ne,pe,{vocab:!0},Xe)))throw new W("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:G});yield Z({activeCtx:ne,activeProperty:_e,expandedActiveProperty:Ie,element:G,expandedParent:st,options:Xe,insideList:tt,typeScopedContext:Ue,typeKey:Ye,expansionMap:ke})}}})).apply(this,arguments)}function se({activeCtx:ne,activeProperty:_e,value:Ie,options:Ge}){if(null==Ie)return null;const st=y(ne,_e,{vocab:!0},Ge);if("@id"===st)return y(ne,Ie,{base:!0},Ge);if("@type"===st)return y(ne,Ie,{vocab:!0,base:!0},Ge);const Xe=S(ne,_e,"@type");if(("@id"===Xe||"@graph"===st)&&z(Ie))return{"@id":y(ne,Ie,{base:!0},Ge)};if("@vocab"===Xe&&z(Ie))return{"@id":y(ne,Ie,{vocab:!0,base:!0},Ge)};if(T(st))return Ie;const tt={};if(Xe&&!["@id","@vocab","@none"].includes(Xe))tt["@type"]=Xe;else if(z(Ie)){const Ye=S(ne,_e,"@language");null!==Ye&&(tt["@language"]=Ye);const Ue=S(ne,_e,"@direction");null!==Ue&&(tt["@direction"]=Ue)}return["boolean","number","string"].includes(typeof Ie)||(Ie=Ie.toString()),tt["@value"]=Ie,tt}function te(ne,_e,Ie,Ge){const st=[],Xe=Object.keys(_e).sort();for(const tt of Xe){const Ye=y(ne,tt,{vocab:!0},Ge);let Ue=_e[tt];j(Ue)||(Ue=[Ue]);for(const ke of Ue){if(null===ke)continue;if(!z(ke))throw new W("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:_e});const Ke={"@value":ke};"@none"!==Ye&&(Ke["@language"]=tt.toLowerCase()),Ie&&(Ke["@direction"]=Ie),st.push(Ke)}}return st}function Ce(ne){return me.apply(this,arguments)}function me(){return(me=yt(function*({activeCtx:ne,options:_e,activeProperty:Ie,value:Ge,expansionMap:st,asGraph:Xe,indexKey:tt,propertyIndex:Ye}){const Ue=[],ke=Object.keys(Ge).sort(),Ke="@type"===tt;for(let Me of ke){if(Ke){const Ne=S(ne,Me,"@context");v(Ne)||(ne=yield V({activeCtx:ne,localCtx:Ne,propagate:!1,options:_e}))}let $e,Ve=Ge[Me];j(Ve)||(Ve=[Ve]),Ve=yield E.expand({activeCtx:ne,activeProperty:Ie,element:Ve,options:_e,insideList:!1,insideIndex:!0,expansionMap:st}),$e=Ye?"@none"===Me?"@none":se({activeCtx:ne,activeProperty:tt,value:Me,options:_e}):y(ne,Me,{vocab:!0},_e),"@id"===tt?Me=y(ne,Me,{base:!0},_e):Ke&&(Me=$e);for(let Ne of Ve){if(Xe&&!A(Ne)&&(Ne={"@graph":[Ne]}),"@type"===tt)"@none"===$e||(Ne["@type"]=Ne["@type"]?[Me].concat(Ne["@type"]):[Me]);else{if(O(Ne)&&!["@language","@type","@index"].includes(tt))throw new W(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${tt}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Ne});Ye?"@none"!==$e&&ce(Ne,Ye,$e,{propertyIsArray:!0,prependValue:!0}):"@none"!==$e&&!(tt in Ne)&&(Ne[tt]=Me)}Ue.push(Ne)}}return Ue})).apply(this,arguments)}E.expand=function(){var ne=yt(function*({activeCtx:_e,activeProperty:Ie=null,element:Ge,options:st={},insideList:Xe=!1,insideIndex:tt=!1,typeScopedContext:Ye=null,expansionMap:Ue=(()=>{})}){if(null==Ge)return null;if("@default"===Ie&&(st=Object.assign({},st,{isFrame:!1})),!j(Ge)&&!P(Ge)){if(!Xe&&(null===Ie||"@graph"===y(_e,Ie,{vocab:!0},st))){const G=yield Ue({unmappedValue:Ge,activeCtx:_e,activeProperty:Ie,options:st,insideList:Xe});return void 0===G?null:G}return se({activeCtx:_e,activeProperty:Ie,value:Ge,options:st})}if(j(Ge)){let G=[];const pe=S(_e,Ie,"@container")||[];Xe=Xe||pe.includes("@list");for(let ue=0;ue<Ge.length;++ue){let je=yield E.expand({activeCtx:_e,activeProperty:Ie,element:Ge[ue],options:st,expansionMap:Ue,insideIndex:tt,typeScopedContext:Ye});Xe&&j(je)&&(je={"@list":je}),(null!==je||(je=yield Ue({unmappedValue:Ge[ue],activeCtx:_e,activeProperty:Ie,parent:Ge,index:ue,options:st,expandedParent:G,insideList:Xe}),void 0!==je))&&(j(je)?G=G.concat(je):G.push(je))}return G}const ke=y(_e,Ie,{vocab:!0},st),Ke=S(_e,Ie,"@context");Ye=Ye||(_e.previousContext?_e:null);let Me=Object.keys(Ge).sort(),Ve=!tt;if(Ve&&Ye&&Me.length<=2&&!Me.includes("@context"))for(const G of Me){const pe=y(Ye,G,{vocab:!0},st);if("@value"===pe){Ve=!1,_e=Ye;break}if("@id"===pe&&1===Me.length){Ve=!1;break}}Ve&&(_e=_e.revertToPreviousContext()),v(Ke)||(_e=yield V({activeCtx:_e,localCtx:Ke,propagate:!0,overrideProtected:!0,options:st})),"@context"in Ge&&(_e=yield V({activeCtx:_e,localCtx:Ge["@context"],options:st})),Ye=_e;let $e=null;for(const G of Me)if("@type"===y(_e,G,{vocab:!0},st)){$e=$e||G;const ue=Ge[G],je=Array.isArray(ue)?ue.length>1?ue.slice().sort():ue:[ue];for(const _t of je){const pt=S(Ye,_t,"@context");v(pt)||(_e=yield V({activeCtx:_e,localCtx:pt,options:st,propagate:!1}))}}let Ne={};yield Z({activeCtx:_e,activeProperty:Ie,expandedActiveProperty:ke,element:Ge,expandedParent:Ne,options:st,insideList:Xe,typeKey:$e,typeScopedContext:Ye,expansionMap:Ue}),Me=Object.keys(Ne);let q=Me.length;if("@value"in Ne){if("@type"in Ne&&("@language"in Ne||"@direction"in Ne))throw new W('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});let G=q-1;if("@type"in Ne&&(G-=1),"@index"in Ne&&(G-=1),"@language"in Ne&&(G-=1),"@direction"in Ne&&(G-=1),0!==G)throw new W('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});const pe=null===Ne["@value"]?[]:D(Ne["@value"]),ue=I(Ne,"@type");if(!R(_e,1.1)||!ue.includes("@json")||1!==ue.length)if(0===pe.length){const je=yield Ue({unmappedValue:Ne,activeCtx:_e,activeProperty:Ie,element:Ge,options:st,insideList:Xe});Ne=void 0!==je?je:null}else{if(!pe.every(je=>z(je)||Q(je))&&"@language"in Ne)throw new W("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Ne});if(!ue.every(je=>K(je)&&!(z(je)&&0===je.indexOf("_:"))||Q(je)))throw new W('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Ne})}}else if("@type"in Ne&&!j(Ne["@type"]))Ne["@type"]=[Ne["@type"]];else if("@set"in Ne||"@list"in Ne){if(q>1&&(2!==q||!("@index"in Ne)))throw new W('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Ne});"@set"in Ne&&(Ne=Ne["@set"],Me=Object.keys(Ne),q=Me.length)}else if(1===q&&"@language"in Ne){const G=yield Ue(Ne,{unmappedValue:Ne,activeCtx:_e,activeProperty:Ie,element:Ge,options:st,insideList:Xe});Ne=void 0!==G?G:null}if(P(Ne)&&!st.keepFreeFloatingNodes&&!Xe&&(null===Ie||"@graph"===ke)&&(0===q||"@value"in Ne||"@list"in Ne||1===q&&"@id"in Ne)){const G=yield Ue({unmappedValue:Ne,activeCtx:_e,activeProperty:Ie,element:Ge,options:st,insideList:Xe});Ne=void 0!==G?G:null}return Ne});return function(_e){return ne.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(Y,Se,he){"use strict";const{isSubjectReference:W}=Y("./graphTypes"),{createMergedNodeMap:j}=Y("./nodeMap"),P={};Se.exports=P,P.flatten=Q=>{const z=j(Q),v=[],x=Object.keys(z).sort();for(let O=0;O<x.length;++O){const A=z[x[O]];W(A)||v.push(A)}return v}},{"./graphTypes":25,"./nodeMap":27}],23:[function(Y,Se,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),P=Y("./types"),Q=Y("./util"),z=Y("./url"),v=Y("./JsonLdError"),{createNodeMap:x,mergeNodeMapGraphs:O}=Y("./nodeMap"),A={};function b(E){const $={};for(const Z in E)void 0!==E[Z]&&($["@"+Z]=[E[Z]]);return[$]}function y(E,$,Z){for(let oe=Z.length-1;oe>=0;--oe){const se=Z[oe];if(se.graph===$&&se.subject["@id"]===E["@id"])return!0}return!1}function S(E,$,Z){const oe="@"+Z;let se=oe in E?E[oe][0]:$[Z];if("embed"===Z)if(!0===se)se="@once";else if(!1===se)se="@never";else if("@always"!==se&&"@never"!==se&&"@link"!==se&&"@first"!==se&&"@last"!==se&&"@once"!==se)throw new v("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return se}function T(E){if(!P.isArray(E)||1!==E.length||!P.isObject(E[0]))throw new v("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const $ of Q.asArray(E[0]["@id"]))if(!P.isObject($)&&!z.isAbsolute($)||P.isString($)&&0===$.indexOf("_:"))throw new v("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const $ of Q.asArray(E[0]["@type"]))if(!P.isObject($)&&!z.isAbsolute($)||P.isString($)&&0===$.indexOf("_:"))throw new v("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function R(E,$,Z,oe){let se=!0,te=!1;for(const Ce in Z){let me=!1;const ne=Q.getValues($,Ce),_e=0===Q.getValues(Z,Ce).length;if("@id"===Ce){if(P.isEmptyObject(Z["@id"][0]||{})?me=!0:Z["@id"].length>=0&&(me=Z["@id"].includes(ne[0])),!oe.requireAll)return me}else if("@type"===Ce){if(se=!1,_e){if(ne.length>0)return!1;me=!0}else if(1===Z["@type"].length&&P.isEmptyObject(Z["@type"][0]))me=ne.length>0;else for(const Ie of Z["@type"])me=!(!P.isObject(Ie)||!("@default"in Ie))||me||ne.some(Ge=>Ge===Ie);if(!oe.requireAll)return me}else{if(W(Ce))continue;{const Ie=Q.getValues(Z,Ce)[0];let Ge=!1;if(Ie&&(T([Ie]),Ge="@default"in Ie),se=!1,0===ne.length&&Ge)continue;if(ne.length>0&&_e)return!1;if(void 0===Ie){if(ne.length>0)return!1;me=!0}else if(j.isList(Ie)){const st=Ie["@list"][0];if(j.isList(ne[0])){const Xe=ne[0]["@list"];j.isValue(st)?me=Xe.some(tt=>X(st,tt)):(j.isSubject(st)||j.isSubjectReference(st))&&(me=Xe.some(tt=>I(E,st,tt,oe)))}}else me=j.isValue(Ie)?ne.some(st=>X(Ie,st)):j.isSubjectReference(Ie)?ne.some(st=>I(E,Ie,st,oe)):!!P.isObject(Ie)&&ne.length>0}}if(!me&&oe.requireAll)return!1;te=te||me}return se||te}function K(E,$){const Z=E.uniqueEmbeds[E.graph],oe=Z[$],se=oe.parent,te=oe.property,Ce={"@id":$};if(P.isArray(se)){for(let ne=0;ne<se.length;++ne)if(Q.compareValues(se[ne],Ce)){se[ne]=Ce;break}}else{const ne=P.isArray(se[te]);Q.removeValue(se,te,Ce,{propertyIsArray:ne}),Q.addValue(se,te,Ce,{propertyIsArray:ne})}const me=ne=>{const _e=Object.keys(Z);for(const Ie of _e)Ie in Z&&P.isObject(Z[Ie].parent)&&Z[Ie].parent["@id"]===ne&&(delete Z[Ie],me(Ie))};me($)}function ce(E,$){if(P.isArray(E))return E.map(Z=>ce(Z,$));if(P.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(j.isValue(E))return E;if(j.isList(E))return E["@list"]=ce(E["@list"],$),E;if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const oe=$.link[Z].indexOf(E);if(-1!==oe)return $.link[Z][oe];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)"@id"===Z&&$.bnodesToClear.includes(E[Z])?delete E["@id"]:E[Z]=ce(E[Z],$)}return E}function D(E,$,Z){P.isObject(E)?Q.addValue(E,$,Z,{propertyIsArray:!0}):E.push(Z)}function I(E,$,Z,oe){if(!("@id"in Z))return!1;const se=E.subjects[Z["@id"]];return se&&R(E,se,$,oe)}function X(E,$){const Z=$["@value"],oe=$["@type"],se=$["@language"],te=E["@value"]?P.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],Ce=E["@type"]?P.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],me=E["@language"]?P.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===te.length&&0===Ce.length&&0===me.length||!(!te.includes(Z)&&!P.isEmptyObject(te[0])||!(!oe&&0===Ce.length||Ce.includes(oe)||oe&&P.isEmptyObject(Ce[0]))||!(!se&&0===me.length||me.includes(se)||se&&P.isEmptyObject(me[0])))}Se.exports=A,A.frameMergedOrDefault=(E,$,Z)=>{const oe={options:Z,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},se=new Q.IdentifierIssuer("_:b");x(E,oe.graphMap,"@default",se),Z.merged&&(oe.graphMap["@merged"]=O(oe.graphMap),oe.graph="@merged"),oe.subjects=oe.graphMap[oe.graph];const te=[];return A.frame(oe,Object.keys(oe.subjects).sort(),$,te),Z.pruneBlankNodeIdentifiers&&(Z.bnodesToClear=Object.keys(oe.bnodeMap).filter(Ce=>1===oe.bnodeMap[Ce].length)),Z.link={},ce(te,Z)},A.frame=(E,$,Z,oe,se=null)=>{T(Z);const te=E.options,Ce={embed:S(Z=Z[0],te,"embed"),explicit:S(Z,te,"explicit"),requireAll:S(Z,te,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const me=E.link[E.graph],ne=function(E,$,Z,oe){const se={};for(const te of $){const Ce=E.graphMap[E.graph][te];R(E,Ce,Z,oe)&&(se[te]=Ce)}return se}(E,$,Z,Ce),_e=Object.keys(ne).sort();for(const Ie of _e){const Ge=ne[Ie];if(null===se?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===Ce.embed&&Ie in me){D(oe,se,me[Ie]);continue}const st={"@id":Ie};if(0===Ie.indexOf("_:")&&Q.addValue(E.bnodeMap,Ie,st,{propertyIsArray:!0}),me[Ie]=st,("@first"===Ce.embed||"@last"===Ce.embed)&&E.is11)throw new v("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Z});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Ie)){if(E.embedded&&("@never"===Ce.embed||y(Ge,E.graph,E.subjectStack))){D(oe,se,st);continue}if(E.embedded&&("@first"==Ce.embed||"@once"==Ce.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Ie)){D(oe,se,st);continue}if("@last"===Ce.embed&&Ie in E.uniqueEmbeds[E.graph]&&K(E,Ie),E.uniqueEmbeds[E.graph][Ie]={parent:oe,property:se},E.subjectStack.push({subject:Ge,graph:E.graph}),Ie in E.graphMap){let Xe=!1,tt=null;"@graph"in Z?(tt=Z["@graph"][0],Xe=!("@merged"===Ie||"@default"===Ie),P.isObject(tt)||(tt={})):(Xe="@merged"!==E.graph,tt={}),Xe&&A.frame(Sn(ot({},E),{graph:Ie,embedded:!1}),Object.keys(E.graphMap[Ie]).sort(),[tt],st,"@graph")}"@included"in Z&&A.frame(Sn(ot({},E),{embedded:!1}),$,Z["@included"],st,"@included");for(const Xe of Object.keys(Ge).sort())if(W(Xe)){if(st[Xe]=Q.clone(Ge[Xe]),"@type"===Xe)for(const tt of Ge["@type"])0===tt.indexOf("_:")&&Q.addValue(E.bnodeMap,tt,st,{propertyIsArray:!0})}else if(!Ce.explicit||Xe in Z)for(const tt of Ge[Xe]){const Ye=Xe in Z?Z[Xe]:b(Ce);if(j.isList(tt)){const Ue=Z[Xe]&&Z[Xe][0]&&Z[Xe][0]["@list"]?Z[Xe][0]["@list"]:b(Ce),ke={"@list":[]};D(st,Xe,ke);const Ke=tt["@list"];for(const Me of Ke)j.isSubjectReference(Me)?A.frame(Sn(ot({},E),{embedded:!0}),[Me["@id"]],Ue,ke,"@list"):D(ke,"@list",Q.clone(Me))}else j.isSubjectReference(tt)?A.frame(Sn(ot({},E),{embedded:!0}),[tt["@id"]],Ye,st,Xe):X(Ye[0],tt)&&D(st,Xe,Q.clone(tt))}for(const Xe of Object.keys(Z).sort()){if("@type"===Xe){if(!P.isObject(Z[Xe][0])||!("@default"in Z[Xe][0]))continue}else if(W(Xe))continue;const tt=Z[Xe][0]||{};if(!S(tt,te,"omitDefault")&&!(Xe in st)){let Ue="@null";"@default"in tt&&(Ue=Q.clone(tt["@default"])),P.isArray(Ue)||(Ue=[Ue]),st[Xe]=[{"@preserve":Ue}]}}for(const Xe of Object.keys(Z["@reverse"]||{}).sort()){const tt=Z["@reverse"][Xe];for(const Ye of Object.keys(E.subjects))Q.getValues(E.subjects[Ye],Xe).some(ke=>ke["@id"]===Ie)&&(st["@reverse"]=st["@reverse"]||{},Q.addValue(st["@reverse"],Xe,[],{propertyIsArray:!0}),A.frame(Sn(ot({},E),{embedded:!0}),[Ye],tt,st["@reverse"][Xe],se))}D(oe,se,st),E.subjectStack.pop()}}},A.cleanupNull=(E,$)=>{if(P.isArray(E))return E.map(oe=>A.cleanupNull(oe,$)).filter(oe=>oe);if("@null"===E)return null;if(P.isObject(E)){if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const oe=$.link[Z].indexOf(E);if(-1!==oe)return $.link[Z][oe];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)E[Z]=A.cleanupNull(E[Z],$)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),j=Y("./graphTypes"),P=Y("./types"),Q=Y("./util"),{RDF_LIST:z,RDF_FIRST:v,RDF_REST:x,RDF_NIL:O,RDF_TYPE:A,RDF_JSON_LITERAL:b,XSD_BOOLEAN:y,XSD_DOUBLE:S,XSD_INTEGER:T,XSD_STRING:V}=Y("./constants"),R=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,K={};function ce(D,I,X){if(D.termType.endsWith("Node"))return{"@id":D.value};const E={"@value":D.value};if(D.language)E["@language"]=D.language;else{let $=D.datatype.value;if($||($=V),$===b){$="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(Z){throw new W("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:Z})}}if(I){if($===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(P.isNumeric(E["@value"]))if($===T){const Z=parseInt(E["@value"],10);Z.toFixed(0)===E["@value"]&&(E["@value"]=Z)}else $===S&&(E["@value"]=parseFloat(E["@value"]));[y,T,S,V].includes($)||(E["@type"]=$)}else if("i18n-datatype"===X&&$.startsWith("https://www.w3.org/ns/i18n#")){const[,Z,oe]=$.split(/[#_]/);Z.length>0&&(E["@language"]=Z,Z.match(R)||console.warn(`@language must be valid BCP47: ${Z}`)),E["@direction"]=oe}else $!==V&&(E["@type"]=$)}return E}Se.exports=K,K.fromRDF=function(){var D=yt(function*(I,{useRdfType:X=!1,useNativeTypes:E=!1,rdfDirection:$=null}){const Z={},oe={"@default":Z},se={};for(const me of I){const ne="DefaultGraph"===me.graph.termType?"@default":me.graph.value;ne in oe||(oe[ne]={}),"@default"!==ne&&!(ne in Z)&&(Z[ne]={"@id":ne});const _e=oe[ne],Ie=me.subject.value,Ge=me.predicate.value,st=me.object;Ie in _e||(_e[Ie]={"@id":Ie});const Xe=_e[Ie],tt=st.termType.endsWith("Node");if(tt&&!(st.value in _e)&&(_e[st.value]={"@id":st.value}),Ge===A&&!X&&tt){Q.addValue(Xe,"@type",st.value,{propertyIsArray:!0});continue}const Ye=ce(st,E,$);if(Q.addValue(Xe,Ge,Ye,{propertyIsArray:!0}),tt)if(st.value===O){const Ue=_e[st.value];"usages"in Ue||(Ue.usages=[]),Ue.usages.push({node:Xe,property:Ge,value:Ye})}else se[st.value]=!(st.value in se)&&{node:Xe,property:Ge,value:Ye}}for(const me in oe){const ne=oe[me];if(!(O in ne))continue;const _e=ne[O];if(_e.usages){for(let Ie of _e.usages){let Ge=Ie.node,st=Ie.property,Xe=Ie.value;const tt=[],Ye=[];let Ue=Object.keys(Ge).length;for(;st===x&&P.isObject(se[Ge["@id"]])&&P.isArray(Ge[v])&&1===Ge[v].length&&P.isArray(Ge[x])&&1===Ge[x].length&&(3===Ue||4===Ue&&P.isArray(Ge["@type"])&&1===Ge["@type"].length&&Ge["@type"][0]===z)&&(tt.push(Ge[v][0]),Ye.push(Ge["@id"]),Ie=se[Ge["@id"]],Ge=Ie.node,st=Ie.property,Xe=Ie.value,Ue=Object.keys(Ge).length,j.isBlankNode(Ge)););delete Xe["@id"],Xe["@list"]=tt.reverse();for(const ke of Ye)delete ne[ke]}delete _e.usages}}const te=[],Ce=Object.keys(Z).sort();for(const me of Ce){const ne=Z[me];if(me in oe){const _e=ne["@graph"]=[],Ie=oe[me],Ge=Object.keys(Ie).sort();for(const st of Ge){const Xe=Ie[st];j.isSubjectReference(Xe)||_e.push(Xe)}}j.isSubjectReference(ne)||te.push(ne)}return te});return function(I,X){return D.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(Y,Se,he){"use strict";const W=Y("./types"),j={};Se.exports=j,j.isSubject=P=>!(!W.isObject(P)||"@value"in P||"@set"in P||"@list"in P)&&(Object.keys(P).length>1||!("@id"in P)),j.isSubjectReference=P=>W.isObject(P)&&1===Object.keys(P).length&&"@id"in P,j.isValue=P=>W.isObject(P)&&"@value"in P,j.isList=P=>W.isObject(P)&&"@list"in P,j.isGraph=P=>W.isObject(P)&&"@graph"in P&&1===Object.keys(P).filter(Q=>"@id"!==Q&&"@index"!==Q).length,j.isSimpleGraph=P=>j.isGraph(P)&&!("@id"in P),j.isBlankNode=P=>!!W.isObject(P)&&("@id"in P?0===P["@id"].indexOf("_:"):0===Object.keys(P).length||!("@value"in P||"@set"in P||"@list"in P))},{"./types":30}],26:[function(Y,Se,he){const W=Y("rdf-canonize"),j=Y("./platform"),P=Y("./util"),Q=Y("./ContextResolver"),z=P.IdentifierIssuer,v=Y("./JsonLdError"),x=Y("lru-cache"),O=Y("./NQuads"),{expand:A}=Y("./expand"),{flatten:b}=Y("./flatten"),{fromRDF:y}=Y("./fromRdf"),{toRDF:S}=Y("./toRdf"),{frameMergedOrDefault:T,cleanupNull:V}=Y("./frame"),{isArray:R,isObject:K,isString:ce}=Y("./types"),{isSubjectReference:D}=Y("./graphTypes"),{expandIri:I,getInitialContext:X,process:E,processingMode:$}=Y("./context"),{compact:Z,compactIri:oe}=Y("./compact"),{createNodeMap:se,createMergedNodeMap:te,mergeNodeMaps:Ce}=Y("./nodeMap"),me=function(_e){const Ie={},st=new x({max:100});function Xe(tt,ke){var Ke=ke,{documentLoader:Ye=_e.documentLoader}=Ke,Ue=Xq(Ke,["documentLoader"]);return Object.assign({},{documentLoader:Ye},Ue,tt)}return _e.compact=function(){var tt=yt(function*(Ye,Ue,ke){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===Ue)throw new v("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ye)return null;let Ke;(ke=Xe(ke,{base:ce(Ye)?Ye:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new z("_:b"),contextResolver:new Q({sharedCache:st})})).link&&(ke.skipExpansion=!0),ke.compactToRelative||delete ke.base,Ke=ke.skipExpansion?Ye:yield _e.expand(Ye,ke);const Me=yield _e.processContext(X(ke),Ue,ke);let Ve=yield Z({activeCtx:Me,element:Ke,options:ke,compactionMap:ke.compactionMap});ke.compactArrays&&!ke.graph&&R(Ve)?1===Ve.length?Ve=Ve[0]:0===Ve.length&&(Ve={}):ke.graph&&K(Ve)&&(Ve=[Ve]),K(Ue)&&"@context"in Ue&&(Ue=Ue["@context"]),Ue=P.clone(Ue),R(Ue)||(Ue=[Ue]);const $e=Ue;Ue=[];for(let q=0;q<$e.length;++q)(!K($e[q])||Object.keys($e[q]).length>0)&&Ue.push($e[q]);const Ne=Ue.length>0;if(1===Ue.length&&(Ue=Ue[0]),R(Ve)){const q=oe({activeCtx:Me,iri:"@graph",relativeTo:{vocab:!0}}),G=Ve;Ve={},Ne&&(Ve["@context"]=Ue),Ve[q]=G}else if(K(Ve)&&Ne){const q=Ve;Ve={"@context":Ue};for(const G in q)Ve[G]=q[G]}return Ve});return function(Ye,Ue,ke){return tt.apply(this,arguments)}}(),_e.expand=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(Ue=Xe(Ue,{keepFreeFloatingNodes:!1,contextResolver:new Q({sharedCache:st})})).expansionMap&&(Ue.expansionMap=void 0);const ke={},Ke=[];if("expandContext"in Ue){const Ne=P.clone(Ue.expandContext);ke.expandContext=K(Ne)&&"@context"in Ne?Ne:{"@context":Ne},Ke.push(ke.expandContext)}let Me;if(ce(Ye)){const Ne=yield _e.get(Ye,Ue);Me=Ne.documentUrl,ke.input=Ne.document,Ne.contextUrl&&(ke.remoteContext={"@context":Ne.contextUrl},Ke.push(ke.remoteContext))}else ke.input=P.clone(Ye);"base"in Ue||(Ue.base=Me||"");let Ve=X(Ue);for(const Ne of Ke)Ve=yield E({activeCtx:Ve,localCtx:Ne,options:Ue});let $e=yield A({activeCtx:Ve,element:ke.input,options:Ue,expansionMap:Ue.expansionMap});return K($e)&&"@graph"in $e&&1===Object.keys($e).length?$e=$e["@graph"]:null===$e&&($e=[]),R($e)||($e=[$e]),$e});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.flatten=function(){var tt=yt(function*(Ye,Ue,ke){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");Ue="function"==typeof Ue?null:Ue||null,ke=Xe(ke,{base:ce(Ye)?Ye:"",contextResolver:new Q({sharedCache:st})});const Ke=yield _e.expand(Ye,ke),Me=b(Ke);return null===Ue?Me:(ke.graph=!0,ke.skipExpansion=!0,yield _e.compact(Me,Ue,ke))});return function(Ye,Ue,ke){return tt.apply(this,arguments)}}(),_e.frame=function(){var tt=yt(function*(Ye,Ue,ke){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(ke=Xe(ke,{base:ce(Ye)?Ye:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new Q({sharedCache:st})}),ce(Ue)){const ue=yield _e.get(Ue,ke);if(Ue=ue.document,ue.contextUrl){let je=Ue["@context"];je?R(je)?je.push(ue.contextUrl):je=[je,ue.contextUrl]:je=ue.contextUrl,Ue["@context"]=je}}const Ke=Ue&&Ue["@context"]||{},Me=yield _e.processContext(X(ke),Ke,ke);ke.hasOwnProperty("omitGraph")||(ke.omitGraph=$(Me,1.1)),ke.hasOwnProperty("pruneBlankNodeIdentifiers")||(ke.pruneBlankNodeIdentifiers=$(Me,1.1));const Ve=yield _e.expand(Ye,ke),$e=ot({},ke);$e.isFrame=!0,$e.keepFreeFloatingNodes=!0;const Ne=yield _e.expand(Ue,$e),q=Object.keys(Ue).map(ue=>I(Me,ue,{vocab:!0}));$e.merged=!q.includes("@graph"),$e.is11=$(Me,1.1);const G=T(Ve,Ne,$e);$e.graph=!ke.omitGraph,$e.skipExpansion=!0,$e.link={},$e.framing=!0;let pe=yield _e.compact(G,Ke,$e);return $e.link={},pe=V(pe,$e),pe});return function(Ye,Ue,ke){return tt.apply(this,arguments)}}(),_e.link=function(){var tt=yt(function*(Ye,Ue,ke){const Ke={};return Ue&&(Ke["@context"]=Ue),Ke["@embed"]="@link",_e.frame(Ye,Ke,ke)});return function(Ye,Ue,ke){return tt.apply(this,arguments)}}(),_e.normalize=_e.canonize=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(Ue=Xe(Ue,{base:ce(Ye)?Ye:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new Q({sharedCache:st})}))){if("application/n-quads"!==Ue.inputFormat&&"application/nquads"!==Ue.inputFormat)throw new v("Unknown canonicalization input format.","jsonld.CanonizeError");const Me=O.parse(Ye);return W.canonize(Me,Ue)}const ke=ot({},Ue);delete ke.format,ke.produceGeneralizedRdf=!1;const Ke=yield _e.toRDF(Ye,ke);return W.canonize(Ke,Ue)});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.fromRDF=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");Ue=Xe(Ue,{format:ce(Ye)?"application/n-quads":void 0});const{format:ke}=Ue;let{rdfParser:Ke}=Ue;if(ke){if(Ke=Ke||Ie[ke],!Ke)throw new v("Unknown input format.","jsonld.UnknownFormat",{format:ke})}else Ke=()=>Ye;const Me=yield Ke(Ye);return y(Me,Ue)});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.toRDF=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let ke;ke=(Ue=Xe(Ue,{base:ce(Ye)?Ye:"",skipExpansion:!1,contextResolver:new Q({sharedCache:st})})).skipExpansion?Ye:yield _e.expand(Ye,Ue);const Ke=S(ke,Ue);if(Ue.format){if("application/n-quads"===Ue.format||"application/nquads"===Ue.format)return O.serialize(Ke);throw new v("Unknown output format.","jsonld.UnknownFormat",{format:Ue.format})}return Ke});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.createNodeMap=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");Ue=Xe(Ue,{base:ce(Ye)?Ye:"",contextResolver:new Q({sharedCache:st})});const ke=yield _e.expand(Ye,Ue);return te(ke,Ue)});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.merge=function(){var tt=yt(function*(Ye,Ue,ke){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!R(Ye))throw new TypeError('Could not merge, "docs" must be an array.');Ue="function"==typeof Ue?null:Ue||null,ke=Xe(ke,{contextResolver:new Q({sharedCache:st})});const Ke=yield Promise.all(Ye.map(ue=>{const je=ot({},ke);return _e.expand(ue,je)}));let Me=!0;"mergeNodes"in ke&&(Me=ke.mergeNodes);const Ve=ke.issuer||new z("_:b"),$e={"@default":{}};for(let ue=0;ue<Ke.length;++ue){const je=P.relabelBlankNodes(Ke[ue],{issuer:new z("_:b"+ue+"-")}),_t=Me||0===ue?$e:{"@default":{}};if(se(je,_t,"@default",Ve),_t!==$e)for(const pt in _t){const ve=_t[pt];if(!(pt in $e)){$e[pt]=ve;continue}const L=$e[pt];for(const N in ve)N in L||(L[N]=ve[N])}}const Ne=Ce($e),q=[],G=Object.keys(Ne).sort();for(let ue=0;ue<G.length;++ue){const je=Ne[G[ue]];D(je)||q.push(je)}return null===Ue?q:(ke.graph=!0,ke.skipExpansion=!0,yield _e.compact(q,Ue,ke))});return function(Ye,Ue,ke){return tt.apply(this,arguments)}}(),Object.defineProperty(_e,"documentLoader",{get:()=>_e._documentLoader,set:tt=>_e._documentLoader=tt}),_e.documentLoader=function(){var tt=yt(function*(Ye){throw new v("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ye})});return function(Ye){return tt.apply(this,arguments)}}(),_e.get=function(){var tt=yt(function*(Ye,Ue){let ke;ke="function"==typeof Ue.documentLoader?Ue.documentLoader:_e.documentLoader;const Ke=yield ke(Ye);try{if(!Ke.document)throw new v("No remote document found at the given URL.","jsonld.NullRemoteDocument");ce(Ke.document)&&(Ke.document=JSON.parse(Ke.document))}catch(Me){throw new v("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Me,remoteDoc:Ke})}return Ke});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.processContext=function(){var tt=yt(function*(Ye,Ue,ke){return ke=Xe(ke,{base:"",contextResolver:new Q({sharedCache:st})}),null===Ue?X(ke):(Ue=P.clone(Ue),K(Ue)&&"@context"in Ue||(Ue={"@context":Ue}),E({activeCtx:Ye,localCtx:Ue,options:ke}))});return function(Ye,Ue,ke){return tt.apply(this,arguments)}}(),_e.getContextValue=Y("./context").getContextValue,_e.documentLoaders={},_e.useDocumentLoader=function(tt){if(!(tt in _e.documentLoaders))throw new v('Unknown document loader type: "'+tt+'"',"jsonld.UnknownDocumentLoader",{type:tt});_e.documentLoader=_e.documentLoaders[tt].apply(_e,Array.prototype.slice.call(arguments,1))},_e.registerRDFParser=function(tt,Ye){Ie[tt]=Ye},_e.unregisterRDFParser=function(tt){delete Ie[tt]},_e.registerRDFParser("application/n-quads",O.parse),_e.registerRDFParser("application/nquads",O.parse),_e.url=Y("./url"),_e.util=P,Object.assign(_e,P),_e.promises=_e,_e.RequestQueue=Y("./RequestQueue"),_e.JsonLdProcessor=Y("./JsonLdProcessor")(_e),j.setupGlobals(_e),j.setupDocumentLoaders(_e),_e},ne=function(){return me(function(){return ne()})};me(ne),Se.exports=ne},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(Y,Se,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),P=Y("./types"),Q=Y("./util"),z=Y("./JsonLdError"),v={};Se.exports=v,v.createMergedNodeMap=(x,O)=>{const A=(O=O||{}).issuer||new Q.IdentifierIssuer("_:b"),b={"@default":{}};return v.createNodeMap(x,b,"@default",A),v.mergeNodeMaps(b)},v.createNodeMap=(x,O,A,b,y,S)=>{if(P.isArray(x)){for(const K of x)v.createNodeMap(K,O,A,b,void 0,S);return}if(!P.isObject(x))return void(S&&S.push(x));if(j.isValue(x)){if("@type"in x){let K=x["@type"];0===K.indexOf("_:")&&(x["@type"]=K=b.getId(K))}return void(S&&S.push(x))}if(S&&j.isList(x)){const K=[];return v.createNodeMap(x["@list"],O,A,b,y,K),void S.push({"@list":K})}if("@type"in x){const K=x["@type"];for(const ce of K)0===ce.indexOf("_:")&&b.getId(ce)}P.isUndefined(y)&&(y=j.isBlankNode(x)?b.getId(x["@id"]):x["@id"]),S&&S.push({"@id":y});const T=O[A],V=T[y]=T[y]||{};V["@id"]=y;const R=Object.keys(x).sort();for(let K of R){if("@id"===K)continue;if("@reverse"===K){const D={"@id":y},I=x["@reverse"];for(const X in I){const E=I[X];for(const $ of E){let Z=$["@id"];j.isBlankNode($)&&(Z=b.getId(Z)),v.createNodeMap($,O,A,b,Z),Q.addValue(T[Z],X,D,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===K){y in O||(O[y]={}),v.createNodeMap(x[K],O,y,b);continue}if("@included"===K){v.createNodeMap(x[K],O,A,b);continue}if("@type"!==K&&W(K)){if("@index"===K&&K in V&&(x[K]!==V[K]||x[K]["@id"]!==V[K]["@id"]))throw new z("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:V});V[K]=x[K];continue}const ce=x[K];if(0===K.indexOf("_:")&&(K=b.getId(K)),0!==ce.length)for(let D of ce)if("@type"===K&&(D=0===D.indexOf("_:")?b.getId(D):D),j.isSubject(D)||j.isSubjectReference(D)){if("@id"in D&&!D["@id"])continue;const I=j.isBlankNode(D)?b.getId(D["@id"]):D["@id"];Q.addValue(V,K,{"@id":I},{propertyIsArray:!0,allowDuplicate:!1}),v.createNodeMap(D,O,A,b,I)}else if(j.isValue(D))Q.addValue(V,K,D,{propertyIsArray:!0,allowDuplicate:!1});else if(j.isList(D)){const I=[];v.createNodeMap(D["@list"],O,A,b,y,I),D={"@list":I},Q.addValue(V,K,D,{propertyIsArray:!0,allowDuplicate:!1})}else v.createNodeMap(D,O,A,b,y),Q.addValue(V,K,D,{propertyIsArray:!0,allowDuplicate:!1});else Q.addValue(V,K,[],{propertyIsArray:!0})}},v.mergeNodeMapGraphs=x=>{const O={};for(const A of Object.keys(x).sort())for(const b of Object.keys(x[A]).sort()){const y=x[A][b];b in O||(O[b]={"@id":b});const S=O[b];for(const T of Object.keys(y).sort())if(W(T)&&"@type"!==T)S[T]=Q.clone(y[T]);else for(const V of y[T])Q.addValue(S,T,Q.clone(V),{propertyIsArray:!0,allowDuplicate:!1})}return O},v.mergeNodeMaps=x=>{const O=x["@default"],A=Object.keys(x).sort();for(const b of A){if("@default"===b)continue;const y=x[b];let S=O[b];S?"@graph"in S||(S["@graph"]=[]):O[b]=S={"@id":b,"@graph":[]};const T=S["@graph"];for(const V of Object.keys(y).sort()){const R=y[V];j.isSubjectReference(R)||T.push(R)}}return O}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(Y,Se,he){"use strict";const W=Y("./documentLoaders/xhr"),j={};Se.exports=j,j.setupDocumentLoaders=function(P){"undefined"!=typeof XMLHttpRequest&&(P.documentLoaders.xhr=W,P.useDocumentLoader("xhr"))},j.setupGlobals=function(P){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:P.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(Y,Se,he){"use strict";const{createNodeMap:W}=Y("./nodeMap"),{isKeyword:j}=Y("./context"),P=Y("./graphTypes"),Q=Y("canonicalize"),z=Y("./types"),v=Y("./util"),{RDF_FIRST:x,RDF_REST:O,RDF_NIL:A,RDF_TYPE:b,RDF_JSON_LITERAL:y,RDF_LANGSTRING:S,XSD_BOOLEAN:T,XSD_DOUBLE:V,XSD_INTEGER:R,XSD_STRING:K}=Y("./constants"),{isAbsolute:ce}=Y("./url"),D={};function I($,Z,oe,se,te){const Ce=Object.keys(Z).sort();for(const me of Ce){const ne=Z[me],_e=Object.keys(ne).sort();for(let Ie of _e){const Ge=ne[Ie];if("@type"===Ie)Ie=b;else if(j(Ie))continue;for(const st of Ge){const Xe={termType:me.startsWith("_:")?"BlankNode":"NamedNode",value:me};if(!ce(me))continue;const tt={termType:Ie.startsWith("_:")?"BlankNode":"NamedNode",value:Ie};if(!ce(Ie)||"BlankNode"===tt.termType&&!te.produceGeneralizedRdf)continue;const Ye=E(st,se,$,oe,te.rdfDirection);Ye&&$.push({subject:Xe,predicate:tt,object:Ye,graph:oe})}}}}function E($,Z,oe,se,te){const Ce={};if(P.isValue($)){Ce.termType="Literal",Ce.value=void 0,Ce.datatype={termType:"NamedNode"};let me=$["@value"];const ne=$["@type"]||null;"@json"===ne?(Ce.value=Q(me),Ce.datatype.value=y):z.isBoolean(me)?(Ce.value=me.toString(),Ce.datatype.value=ne||T):z.isDouble(me)||ne===V?(z.isDouble(me)||(me=parseFloat(me)),Ce.value=me.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Ce.datatype.value=ne||V):z.isNumber(me)?(Ce.value=me.toFixed(0),Ce.datatype.value=ne||R):"i18n-datatype"===te&&"@direction"in $?(Ce.datatype.value="https://www.w3.org/ns/i18n#"+($["@language"]||"")+`_${$["@direction"]}`,Ce.value=me):"@language"in $?(Ce.value=me,Ce.datatype.value=ne||S,Ce.language=$["@language"]):(Ce.value=me,Ce.datatype.value=ne||K)}else if(P.isList($)){const me=function($,Z,oe,se,te){const Ce={termType:"NamedNode",value:x},me={termType:"NamedNode",value:O},ne={termType:"NamedNode",value:A},_e=$.pop(),Ie=_e?{termType:"BlankNode",value:Z.getId()}:ne;let Ge=Ie;for(const st of $){const Xe=E(st,Z,oe,se,te),tt={termType:"BlankNode",value:Z.getId()};oe.push({subject:Ge,predicate:Ce,object:Xe,graph:se}),oe.push({subject:Ge,predicate:me,object:tt,graph:se}),Ge=tt}if(_e){const st=E(_e,Z,oe,se,te);oe.push({subject:Ge,predicate:Ce,object:st,graph:se}),oe.push({subject:Ge,predicate:me,object:ne,graph:se})}return Ie}($["@list"],Z,oe,se,te);Ce.termType=me.termType,Ce.value=me.value}else{const me=z.isObject($)?$["@id"]:$;Ce.termType=me.startsWith("_:")?"BlankNode":"NamedNode",Ce.value=me}return"NamedNode"!==Ce.termType||ce(Ce.value)?Ce:null}Se.exports=D,D.toRDF=($,Z)=>{const oe=new v.IdentifierIssuer("_:b"),se={"@default":{}};W($,se,"@default",oe);const te=[],Ce=Object.keys(se).sort();for(const me of Ce){let ne;if("@default"===me)ne={termType:"DefaultGraph",value:""};else{if(!ce(me))continue;ne=me.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},ne.value=me}I(te,se[me],ne,oe,Z)}return te}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(Y,Se,he){"use strict";const W={};Se.exports=W,W.isArray=Array.isArray,W.isBoolean=j=>"boolean"==typeof j||"[object Boolean]"===Object.prototype.toString.call(j),W.isDouble=j=>W.isNumber(j)&&(-1!==String(j).indexOf(".")||Math.abs(j)>=1e21),W.isEmptyObject=j=>W.isObject(j)&&0===Object.keys(j).length,W.isNumber=j=>"number"==typeof j||"[object Number]"===Object.prototype.toString.call(j),W.isNumeric=j=>!isNaN(parseFloat(j))&&isFinite(j),W.isObject=j=>"[object Object]"===Object.prototype.toString.call(j),W.isString=j=>"string"==typeof j||"[object String]"===Object.prototype.toString.call(j),W.isUndefined=j=>void 0===j},{}],31:[function(Y,Se,he){"use strict";const W=Y("./types"),j={};Se.exports=j,j.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},j.parse=(Q,z)=>{const v={},x=j.parsers[z||"full"],O=x.regex.exec(Q);let A=x.keys.length;for(;A--;)v[x.keys[A]]=void 0===O[A]?null:O[A];return("https"===v.scheme&&"443"===v.port||"http"===v.scheme&&"80"===v.port)&&(v.href=v.href.replace(":"+v.port,""),v.authority=v.authority.replace(":"+v.port,""),v.port=null),v.normalizedPath=j.removeDotSegments(v.path),v},j.prependBase=(Q,z)=>{if(null===Q||j.isAbsolute(z))return z;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));const v=j.parse(z),x={protocol:Q.protocol||""};if(null!==v.authority)x.authority=v.authority,x.path=v.path,x.query=v.query;else if(x.authority=Q.authority,""===v.path)x.path=Q.path,x.query=null!==v.query?v.query:Q.query;else{if(0===v.path.indexOf("/"))x.path=v.path;else{let A=Q.path;A=A.substr(0,A.lastIndexOf("/")+1),(A.length>0||Q.authority)&&"/"!==A.substr(-1)&&(A+="/"),A+=v.path,x.path=A}x.query=v.query}""!==v.path&&(x.path=j.removeDotSegments(x.path));let O=x.protocol;return null!==x.authority&&(O+="//"+x.authority),O+=x.path,null!==x.query&&(O+="?"+x.query),null!==v.fragment&&(O+="#"+v.fragment),""===O&&(O="./"),O},j.removeBase=(Q,z)=>{if(null===Q)return z;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));let v="";if(""!==Q.href?v+=(Q.protocol||"")+"//"+(Q.authority||""):z.indexOf("//")&&(v+="//"),0!==z.indexOf(v))return z;const x=j.parse(z.substr(v.length)),O=Q.normalizedPath.split("/"),A=x.normalizedPath.split("/"),b=x.fragment||x.query?0:1;for(;O.length>0&&A.length>b&&O[0]===A[0];)O.shift(),A.shift();let y="";if(O.length>0){O.pop();for(let S=0;S<O.length;++S)y+="../"}return y+=A.join("/"),null!==x.query&&(y+="?"+x.query),null!==x.fragment&&(y+="#"+x.fragment),""===y&&(y="./"),y},j.removeDotSegments=Q=>{if(0===Q.length)return"";const z=Q.split("/"),v=[];for(;z.length>0;){const x=z.shift(),O=0===z.length;"."!==x?".."!==x?v.push(x):(v.pop(),O&&v.push("")):O&&v.push("")}return"/"===Q[0]&&v.length>0&&""!==v[0]&&v.unshift(""),1===v.length&&""===v[0]?"/":v.join("/")};const P=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;j.isAbsolute=Q=>W.isString(Q)&&P.test(Q),j.isRelative=Q=>W.isString(Q)},{"./types":30}],32:[function(Y,Se,he){"use strict";const W=Y("./graphTypes"),j=Y("./types"),P=Y("rdf-canonize").IdentifierIssuer,Q=Y("./JsonLdError"),z=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,v=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,x=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,O_headers={accept:"application/ld+json, application/json"},A={};function b(y,S){if(j.isArray(S))for(let T=0;T<S.length;++T)S[T]=b(y,S[T]);else if(W.isList(S))S["@list"]=b(y,S["@list"]);else if(j.isObject(S)){W.isBlankNode(S)&&(S["@id"]=y.getId(S["@id"]));const T=Object.keys(S).sort();for(let V=0;V<T.length;++V){const R=T[V];"@id"!==R&&(S[R]=b(y,S[R]))}}return S}Se.exports=A,A.IdentifierIssuer=P,A.clone=function(y){if(y&&"object"==typeof y){let S;if(j.isArray(y)){S=[];for(let T=0;T<y.length;++T)S[T]=A.clone(y[T])}else if(y instanceof Map){S=new Map;for(const[T,V]of y)S.set(T,A.clone(V))}else if(y instanceof Set){S=new Set;for(const T of y)S.add(A.clone(T))}else if(j.isObject(y)){S={};for(const T in y)S[T]=A.clone(y[T])}else S=y.toString();return S}return y},A.asArray=function(y){return Array.isArray(y)?y:[y]},A.buildHeaders=(y={})=>{if(Object.keys(y).some(T=>"accept"===T.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+O_headers.accept+'" is supported.');return Object.assign({Accept:O_headers.accept},y)},A.parseLinkHeader=y=>{const S={},T=y.match(z);for(let V=0;V<T.length;++V){let R=T[V].match(v);if(!R)continue;const K={target:R[1]},ce=R[2];for(;R=x.exec(ce);)K[R[1]]=void 0===R[2]?R[3]:R[2];const D=K.rel||"";Array.isArray(S[D])?S[D].push(K):S[D]=S.hasOwnProperty(D)?[S[D],K]:K}return S},A.validateTypeValue=(y,S)=>{if(!(j.isString(y)||j.isArray(y)&&y.every(T=>j.isString(T)))){if(S&&j.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&A.asArray(y["@default"]).every(T=>j.isString(T)))return}throw new Q('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},A.hasProperty=(y,S)=>{if(y.hasOwnProperty(S)){const T=y[S];return!j.isArray(T)||T.length>0}return!1},A.hasValue=(y,S,T)=>{if(A.hasProperty(y,S)){let V=y[S];const R=W.isList(V);if(j.isArray(V)||R){R&&(V=V["@list"]);for(let K=0;K<V.length;++K)if(A.compareValues(T,V[K]))return!0}else if(!j.isArray(T))return A.compareValues(T,V)}return!1},A.addValue=(y,S,T,V)=>{if("propertyIsArray"in(V=V||{})||(V.propertyIsArray=!1),"valueIsArray"in V||(V.valueIsArray=!1),"allowDuplicate"in V||(V.allowDuplicate=!0),"prependValue"in V||(V.prependValue=!1),V.valueIsArray)y[S]=T;else if(j.isArray(T)){0===T.length&&V.propertyIsArray&&!y.hasOwnProperty(S)&&(y[S]=[]),V.prependValue&&(T=T.concat(y[S]),y[S]=[]);for(let R=0;R<T.length;++R)A.addValue(y,S,T[R],V)}else if(y.hasOwnProperty(S)){const R=!V.allowDuplicate&&A.hasValue(y,S,T);!j.isArray(y[S])&&(!R||V.propertyIsArray)&&(y[S]=[y[S]]),R||(V.prependValue?y[S].unshift(T):y[S].push(T))}else y[S]=V.propertyIsArray?[T]:T},A.getValues=(y,S)=>[].concat(y[S]||[]),A.removeProperty=(y,S)=>{delete y[S]},A.removeValue=(y,S,T,V)=>{"propertyIsArray"in(V=V||{})||(V.propertyIsArray=!1);const R=A.getValues(y,S).filter(K=>!A.compareValues(K,T));0===R.length?A.removeProperty(y,S):y[S]=1!==R.length||V.propertyIsArray?R:R[0]},A.relabelBlankNodes=(y,S)=>b((S=S||{}).issuer||new P("_:b"),y),A.compareValues=(y,S)=>!!(y===S||W.isValue(y)&&W.isValue(S)&&y["@value"]===S["@value"]&&y["@type"]===S["@type"]&&y["@language"]===S["@language"]&&y["@index"]===S["@index"])||!!(j.isObject(y)&&"@id"in y&&j.isObject(S)&&"@id"in S)&&y["@id"]===S["@id"],A.compareShortestLeast=(y,S)=>y.length<S.length?-1:S.length<y.length?1:y===S?0:y<S?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(Y,Se,he){"use strict";const W=Y("yallist"),j=Symbol("max"),P=Symbol("length"),Q=Symbol("lengthCalculator"),z=Symbol("allowStale"),v=Symbol("maxAge"),x=Symbol("dispose"),O=Symbol("noDisposeOnSet"),A=Symbol("lruList"),b=Symbol("cache"),y=Symbol("updateAgeOnGet"),S=()=>1;const V=(X,E,$)=>{const Z=X[b].get(E);if(Z){const oe=Z.value;if(R(X,oe)){if(ce(X,Z),!X[z])return}else $&&(X[y]&&(Z.value.now=Date.now()),X[A].unshiftNode(Z));return oe.value}},R=(X,E)=>{if(!E||!E.maxAge&&!X[v])return!1;const $=Date.now()-E.now;return E.maxAge?$>E.maxAge:X[v]&&$>X[v]},K=X=>{if(X[P]>X[j])for(let E=X[A].tail;X[P]>X[j]&&null!==E;){const $=E.prev;ce(X,E),E=$}},ce=(X,E)=>{if(E){const $=E.value;X[x]&&X[x]($.key,$.value),X[P]-=$.length,X[b].delete($.key),X[A].removeNode(E)}};class D{constructor(E,$,Z,oe,se){this.key=E,this.value=$,this.length=Z,this.now=oe,this.maxAge=se||0}}const I=(X,E,$,Z)=>{let oe=$.value;R(X,oe)&&(ce(X,$),X[z]||(oe=void 0)),oe&&E.call(Z,oe.value,oe.key,X)};Se.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[j]=E.max||1/0;const Z=E.length||S;if(this[Q]="function"!=typeof Z?S:Z,this[z]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[v]=E.maxAge||0,this[x]=E.dispose,this[O]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[j]=E||1/0,K(this)}get max(){return this[j]}set allowStale(E){this[z]=!!E}get allowStale(){return this[z]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[v]=E,K(this)}get maxAge(){return this[v]}set lengthCalculator(E){"function"!=typeof E&&(E=S),E!==this[Q]&&(this[Q]=E,this[P]=0,this[A].forEach($=>{$.length=this[Q]($.value,$.key),this[P]+=$.length})),K(this)}get lengthCalculator(){return this[Q]}get length(){return this[P]}get itemCount(){return this[A].length}rforEach(E,$){$=$||this;for(let Z=this[A].tail;null!==Z;){const oe=Z.prev;I(this,E,Z,$),Z=oe}}forEach(E,$){$=$||this;for(let Z=this[A].head;null!==Z;){const oe=Z.next;I(this,E,Z,$),Z=oe}}keys(){return this[A].toArray().map(E=>E.key)}values(){return this[A].toArray().map(E=>E.value)}reset(){this[x]&&this[A]&&this[A].length&&this[A].forEach(E=>this[x](E.key,E.value)),this[b]=new Map,this[A]=new W,this[P]=0}dump(){return this[A].map(E=>!R(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[A]}set(E,$,Z){if((Z=Z||this[v])&&"number"!=typeof Z)throw new TypeError("maxAge must be a number");const oe=Z?Date.now():0,se=this[Q]($,E);if(this[b].has(E)){if(se>this[j])return ce(this,this[b].get(E)),!1;const me=this[b].get(E).value;return this[x]&&(this[O]||this[x](E,me.value)),me.now=oe,me.maxAge=Z,me.value=$,this[P]+=se-me.length,me.length=se,this.get(E),K(this),!0}const te=new D(E,$,se,oe,Z);return te.length>this[j]?(this[x]&&this[x](E,$),!1):(this[P]+=te.length,this[A].unshift(te),this[b].set(E,this[A].head),K(this),!0)}has(E){if(!this[b].has(E))return!1;const $=this[b].get(E).value;return!R(this,$)}get(E){return V(this,E,!0)}peek(E){return V(this,E,!1)}pop(){const E=this[A].tail;return E?(ce(this,E),E.value):null}del(E){ce(this,this[b].get(E))}load(E){this.reset();const $=Date.now();for(let Z=E.length-1;Z>=0;Z--){const oe=E[Z],se=oe.e||0;if(0===se)this.set(oe.k,oe.v);else{const te=se-$;te>0&&this.set(oe.k,oe.v,te)}}}prune(){this[b].forEach((E,$)=>V(this,$,!1))}}},{yallist:92}],34:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#",P="http://www.w3.org/2000/10/swap/";he.default={xsd:{decimal:`${j}decimal`,boolean:`${j}boolean`,double:`${j}double`,integer:`${j}integer`,string:`${j}string`},rdf:{type:`${W}type`,nil:`${W}nil`,first:`${W}first`,rest:`${W}rest`,langString:`${W}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${P}reify#forSome`,forAll:`${P}reify#forAll`},log:{implies:`${P}log#implies`}}},{}],35:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=he.Variable=he.Triple=he.Term=he.Quad=he.NamedNode=he.Literal=he.DefaultGraph=he.BlankNode=void 0,he.escapeQuotes=E,he.termFromId=function D(ne,_e){if(_e=_e||b,!ne)return _e.defaultGraph();switch(ne[0]){case"?":return _e.variable(ne.substr(1));case"_":return _e.blankNode(ne.substr(2));case'"':if(_e===b)return new V(ne);if('"'===ne[ne.length-1])return _e.literal(ne.substr(1,ne.length-2));const Ie=ne.lastIndexOf('"',ne.length-1);return _e.literal(ne.substr(1,Ie-1),"@"===ne[Ie+1]?ne.substr(Ie+2):_e.namedNode(ne.substr(Ie+3)));case"<":const Ge=A.exec(ne);return _e.quad(D($(Ge[1]),_e),D($(Ge[2]),_e),D($(Ge[3]),_e),Ge[4]&&D($(Ge[4]),_e));default:return _e.namedNode(ne)}},he.termToId=function I(ne){if("string"==typeof ne)return ne;if(ne instanceof S&&"Quad"!==ne.termType)return ne.id;if(!ne)return v.id;switch(ne.termType){case"NamedNode":return ne.value;case"BlankNode":return`_:${ne.value}`;case"Variable":return`?${ne.value}`;case"DefaultGraph":return"";case"Literal":return`"${ne.value}"${ne.language?`@${ne.language}`:ne.datatype&&ne.datatype.value!==z.string?`^^${ne.datatype.value}`:""}`;case"Quad":return`<<${E(I(ne.subject))} ${E(I(ne.predicate))} ${E(I(ne.object))}${(0,j.isDefaultGraph)(ne.graph)?"":` ${I(ne.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${ne.termType}`)}},he.unescapeQuotes=$;var ne,W=(ne=Y("./IRIs"))&&ne.__esModule?ne:{default:ne},j=Y("./N3Util");const{rdf:Q,xsd:z}=W.default;let v,x=0;const O=/^"(.*".*)(?="[^"]*$)/,A=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,b={namedNode:function(ne){return new T(ne)},blankNode:function(ne){return new R(ne||"n3-"+x++)},variable:function(ne){return new K(ne)},literal:function(ne,_e){if("string"==typeof _e)return new V(`"${ne}"@${_e.toLowerCase()}`);let Ie=_e?_e.value:"";return""===Ie&&("boolean"==typeof ne?Ie=z.boolean:"number"==typeof ne&&(Number.isFinite(ne)?Ie=Number.isInteger(ne)?z.integer:z.double:(Ie=z.double,Number.isNaN(ne)||(ne=ne>0?"INF":"-INF")))),new V(""===Ie||Ie===z.string?`"${ne}"`:`"${ne}"^^${Ie}`)},defaultGraph:function(){return v},quad:me,triple:me};he.default=b;class S{constructor(_e){this.id=_e}get value(){return this.id}equals(_e){return _e instanceof S?this.id===_e.id:!!_e&&this.termType===_e.termType&&this.value===_e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}he.Term=S;class T extends S{get termType(){return"NamedNode"}}he.NamedNode=T;class V extends S{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const _e=this.id;let Ie=_e.lastIndexOf('"')+1;return Ie<_e.length&&"@"===_e[Ie++]?_e.substr(Ie).toLowerCase():""}get datatype(){return new T(this.datatypeString)}get datatypeString(){const _e=this.id,Ie=_e.lastIndexOf('"')+1,Ge=Ie<_e.length?_e[Ie]:"";return"^"===Ge?_e.substr(Ie+2):"@"!==Ge?z.string:Q.langString}equals(_e){return _e instanceof V?this.id===_e.id:!!_e&&!!_e.datatype&&this.termType===_e.termType&&this.value===_e.value&&this.language===_e.language&&this.datatype.value===_e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}he.Literal=V;class R extends S{constructor(_e){super(`_:${_e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}he.BlankNode=R;class K extends S{constructor(_e){super(`?${_e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}he.Variable=K;class ce extends S{constructor(){return super(""),v||this}get termType(){return"DefaultGraph"}equals(_e){return this===_e||!!_e&&this.termType===_e.termType}}he.DefaultGraph=ce,v=new ce;class X extends S{constructor(_e,Ie,Ge,st){super(""),this._subject=_e,this._predicate=Ie,this._object=Ge,this._graph=st||v}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(_e){return!!_e&&this._subject.equals(_e.subject)&&this._predicate.equals(_e.predicate)&&this._object.equals(_e.object)&&this._graph.equals(_e.graph)}}function E(ne){return ne.replace(O,(_e,Ie)=>`"${Ie.replace(/"/g,'""')}`)}function $(ne){return ne.replace(O,(_e,Ie)=>`"${Ie.replace(/""/g,'"')}`)}function me(ne,_e,Ie,Ge){return new X(ne,_e,Ie,Ge)}he.Triple=he.Quad=X},{"./IRIs":34,"./N3Util":41}],36:[function(Y,Se,he){(function(W){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var j=Q(Y("./IRIs")),P=Q(Y("queue-microtask"));function Q(S){return S&&S.__esModule?S:{default:S}}const{xsd:z}=j.default,v=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,x={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},O=/[\x00-\x20<>\\"\{\}\|\^\`]/,A={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},b=/$0^/;he.default=class{constructor(T){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(T=T||{}).lineMode){this._n3Mode=!1;for(const V in this)!(V in A)&&this[V]instanceof RegExp&&(this[V]=b)}else this._n3Mode=!1!==T.n3;this._comments=!!T.comments,this._literalClosingPos=0}_tokenizeToEnd(T,V){let R=this._input,K=R.length;for(;;){let I,X;for(;I=this._newline.exec(R);)this._comments&&(X=this._comment.exec(I[0]))&&ce("comment",X[1],"",this._line,I[0].length),R=R.substr(I[0].length,R.length),K=R.length,this._line++;if(!I&&(I=this._whitespace.exec(R))&&(R=R.substr(I[0].length,R.length)),this._endOfFile.test(R))return V&&(this._comments&&(X=this._comment.exec(R))&&ce("comment",X[1],"",this._line,R.length),R=null,ce("eof","","",this._line,0)),this._input=R;const E=this._line,$=R[0];let Z="",oe="",se="",te=null,Ce=0,me=!1;switch($){case"^":if(R.length<3)break;if("^"!==R[1]){this._n3Mode&&(Ce=1,Z="^");break}if(this._previousMarker="^^",R=R.substr(2),"<"!==R[0]){me=!0;break}case"<":if(te=this._unescapedIri.exec(R))Z="IRI",oe=te[1];else if(te=this._iri.exec(R)){if(oe=this._unescape(te[1]),null===oe||O.test(oe))return D(this);Z="IRI"}else R.length>1&&"<"===R[1]?(Z="<<",Ce=2):this._n3Mode&&R.length>1&&"="===R[1]&&(Z="inverse",Ce=2,oe=">");break;case">":R.length>1&&">"===R[1]&&(Z=">>",Ce=2);break;case"_":((te=this._blank.exec(R))||V&&(te=this._blank.exec(`${R} `)))&&(Z="blank",se="_",oe=te[1]);break;case'"':if(te=this._simpleQuotedString.exec(R))oe=te[1];else if(({value:oe,matchLength:Ce}=this._parseLiteral(R)),null===oe)return D(this);(null!==te||0!==Ce)&&(Z="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(te=this._simpleApostropheString.exec(R))oe=te[1];else if(({value:oe,matchLength:Ce}=this._parseLiteral(R)),null===oe)return D(this);(null!==te||0!==Ce)&&(Z="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(te=this._variable.exec(R))&&(Z="var",oe=te[0]);break;case"@":"literal"===this._previousMarker&&(te=this._langcode.exec(R))?(Z="langcode",oe=te[1]):(te=this._keyword.exec(R))&&(Z=te[0]);break;case".":if(1===R.length?V:R[1]<"0"||R[1]>"9"){Z=".",Ce=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(te=this._number.exec(R)||V&&(te=this._number.exec(`${R} `)))&&(Z="literal",oe=te[0],se="string"==typeof te[1]?z.double:"string"==typeof te[2]?z.decimal:z.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(te=this._sparqlKeyword.exec(R))?Z=te[0].toUpperCase():me=!0;break;case"f":case"t":(te=this._boolean.exec(R))?(Z="literal",oe=te[0],se=z.boolean):me=!0;break;case"a":(te=this._shortPredicates.exec(R))?(Z="abbreviation",oe="a"):me=!0;break;case"=":this._n3Mode&&R.length>1&&(Z="abbreviation",">"!==R[1]?(Ce=1,oe="="):(Ce=2,oe=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(Ce=1,Z=$);break;default:me=!0}if(me&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(te=this._prefix.exec(R))?((te=this._prefixed.exec(R))||V&&(te=this._prefixed.exec(`${R} `)))&&(Z="prefixed",se=te[1]||"",oe=this._unescape(te[2])):(Z="prefix",oe=te[1]||"")),"^^"===this._previousMarker)switch(Z){case"prefixed":Z="type";break;case"IRI":Z="typeIRI";break;default:Z=""}if(!Z)return V||!/^'''|^"""/.test(R)&&/\n|\r/.test(R)?D(this):this._input=R;const ne=Ce||te[0].length,_e=ce(Z,oe,se,E,ne);this.previousToken=_e,this._previousMarker=Z,R=R.substr(ne,R.length)}function ce(I,X,E,$,Z){const oe=R?K-R.length:K,te={type:I,value:X,prefix:E,line:$,start:oe,end:oe+Z};return T(null,te),te}function D(I){T(I._syntaxError(/^\S*/.exec(R)[0]))}}_unescape(T){let V=!1;const R=T.replace(v,(K,ce,D,I)=>{if("string"==typeof ce)return String.fromCharCode(Number.parseInt(ce,16));if("string"==typeof D){let X=Number.parseInt(D,16);return X<=65535?String.fromCharCode(Number.parseInt(D,16)):String.fromCharCode(55296+((X-=65536)>>10),56320+(1023&X))}return I in x?x[I]:(V=!0,"")});return V?null:R}_parseLiteral(T){if(T.length>=3){const V=T.match(/^(?:"""|"|'''|'|)/)[0],R=V.length;let K=Math.max(this._literalClosingPos,R);for(;(K=T.indexOf(V,K))>0;){let ce=0;for(;"\\"===T[K-ce-1];)ce++;if(ce%2==0){const D=T.substring(R,K),I=D.split(/\r\n|\r|\n/).length-1,X=K+R;if(1===R&&0!==I||3===R&&this._lineMode)break;return this._line+=I,{value:this._unescape(D),matchLength:X}}K++}this._literalClosingPos=T.length-R+1}return{value:"",matchLength:0}}_syntaxError(T){this._input=null;const V=new Error(`Unexpected "${T}" on line ${this._line}.`);return V.context={token:void 0,line:this._line,previousToken:this.previousToken},V}_readStartingBom(T){return T.startsWith("\ufeff")?T.substr(1):T}tokenize(T,V){if(this._line=1,"string"==typeof T){if(this._input=this._readStartingBom(T),"function"!=typeof V){const R=[];let K;if(this._tokenizeToEnd((ce,D)=>ce?K=ce:R.push(D),!0),K)throw K;return R}(0,P.default)(()=>this._tokenizeToEnd(V,!0))}else this._pendingBuffer=null,"function"==typeof T.setEncoding&&T.setEncoding("utf8"),T.on("data",R=>{null!==this._input&&0!==R.length&&(this._pendingBuffer&&(R=W.concat([this._pendingBuffer,R]),this._pendingBuffer=null),128&R[R.length-1]?this._pendingBuffer=R:(void 0===this._input?this._input=this._readStartingBom("string"==typeof R?R:R.toString()):this._input+=R,this._tokenizeToEnd(V,!1)))}),T.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(V,!0)}),T.on("error",V)}}}).call(this)}).call(this,Y("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var W=Q(Y("./N3Lexer")),j=Q(Y("./N3DataFactory")),P=Q(Y("./IRIs"));function Q(A){return A&&A.__esModule?A:{default:A}}let z=0;class v{constructor(b){this._contextStack=[],this._graph=null,this._setBase((b=b||{}).baseIRI),b.factory&&O(this,b.factory);const y="string"==typeof b.format?b.format.match(/\w*$/)[0].toLowerCase():"",S=/turtle/.test(y),T=/trig/.test(y),V=/triple/.test(y),R=/quad/.test(y),K=this._n3Mode=/n3/.test(y),ce=V||R;(this._supportsNamedGraphs=!(S||K))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(S||T||V||K),this._supportsRDFStar=""===y||/star|\*$/.test(y),ce&&(this._resolveRelativeIRI=D=>null),this._blankNodePrefix="string"!=typeof b.blankNodePrefix?"":b.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=b.lexer||new W.default({lineMode:ce,n3:K}),this._explicitQuantifiers=!!b.explicitQuantifiers}static _resetBlankNodePrefix(){z=0}_setBase(b){if(b){const y=b.indexOf("#");y>=0&&(b=b.substr(0,y)),this._base=b,this._basePath=b.indexOf("/")<0?b:b.replace(/[^\/?]*(?:\?.*)?$/,""),b=b.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=b[0],this._baseScheme=b[1]}else this._base="",this._basePath=""}_saveContext(b,y,S,T,V){const R=this._n3Mode;this._contextStack.push({subject:S,predicate:T,object:V,graph:y,type:b,inverse:!!R&&this._inversePredicate,blankPrefix:R?this._prefixes._:"",quantified:R?this._quantified:null}),R&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const b=this._contextStack.pop(),y=this._n3Mode;this._subject=b.subject,this._predicate=b.predicate,this._object=b.object,this._graph=b.graph,y&&(this._inversePredicate=b.inverse,this._prefixes._=b.blankPrefix,this._quantified=b.quantified)}_readInTopContext(b){switch(b.type){case"eof":return null!==this._graph?this._error("Unclosed graph",b):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(b)}}_readEntity(b,y){let S;switch(b.type){case"IRI":case"typeIRI":const T=this._resolveIRI(b.value);if(null===T)return this._error("Invalid IRI",b);S=this._namedNode(T);break;case"type":case"prefixed":const V=this._prefixes[b.prefix];if(void 0===V)return this._error(`Undefined prefix "${b.prefix}:"`,b);S=this._namedNode(V+b.value);break;case"blank":S=this._blankNode(this._prefixes[b.prefix]+b.value);break;case"var":S=this._variable(b.value.substr(1));break;default:return this._error(`Expected entity but got ${b.type}`,b)}return!y&&this._n3Mode&&S.id in this._quantified&&(S=this._quantified[S.id]),S}_readSubject(b){switch(this._predicate=null,b.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",b);case"}":return this._readPunctuation(b);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',b);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',b);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",b);if(0===b.prefix.length)return this._literalValue=b.value,this._completeSubjectLiteral;this._subject=this._literal(b.value,this._namedNode(b.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._subject=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(b){const y=b.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[b.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,b):(this._subject=null,"]"===y?this._readBlankNodeTail(b):this._readPunctuation(b));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",b);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",b);default:if(void 0===(this._predicate=this._readEntity(b)))return}return this._readObject}_readObject(b){switch(b.type){case"literal":if(0===b.prefix.length)return this._literalValue=b.value,this._readDataTypeOrLang;this._object=this._literal(b.value,this._namedNode(b.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._object=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(b){return"{"===b.type?this._readGraph(b):this._readPredicate(b)}_readGraph(b){return"{"!==b.type?this._error(`Expected graph but got ${b.type}`,b):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(b){return"]"===b.type?(this._subject=null,this._readBlankNodeTail(b)):(this._predicate=null,this._readPredicate(b))}_readBlankNodeTail(b){if("]"!==b.type)return this._readBlankNodePunctuation(b);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(b){switch(b.type){case".":case"}":return this._subject=null,this._readPunctuation(b);default:return this._readPredicate(b)}}_readListItem(b){let y=null,S=null,T=this._readListItem;const V=this._subject,R=this._contextStack,K=R[R.length-1];switch(b.type){case"[":this._saveContext("blank",this._graph,S=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),T=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,S=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==R.length&&"list"===R[R.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(T=this._readPredicate,this._subject===this.RDF_NIL)return T}else if(T=this._getContextEndReader(),this._object===this.RDF_NIL)return T;S=this.RDF_NIL;break;case"literal":0===b.prefix.length?(this._literalValue=b.value,T=this._readListItemDataTypeOrLang):(y=this._literal(b.value,this._namedNode(b.prefix)),T=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);default:if(void 0===(y=this._readEntity(b)))return}if(null===S&&(this._subject=S=this._blankNode()),null===V?null===K.predicate?K.subject=S:K.object=S:this._emit(V,this.RDF_REST,S,this._graph),null!==y){if(this._n3Mode&&("IRI"===b.type||"prefixed"===b.type))return this._saveContext("item",this._graph,S,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(S,this.RDF_FIRST,y,this._graph)}return T}_readDataTypeOrLang(b){return this._completeObjectLiteral(b,!1)}_readListItemDataTypeOrLang(b){return this._completeObjectLiteral(b,!0)}_completeLiteral(b){let y=this._literal(this._literalValue);switch(b.type){case"type":case"typeIRI":const S=this._readEntity(b);if(void 0===S)return;y=this._literal(this._literalValue,S),b=null;break;case"langcode":y=this._literal(this._literalValue,b.value),b=null}return{token:b,literal:y}}_completeSubjectLiteral(b){return this._subject=this._completeLiteral(b).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(b,y){const S=this._completeLiteral(b);if(S)return this._object=S.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===S.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(S.token))}_readFormulaTail(b){return"}"!==b.type?this._readPunctuation(b):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(b){let y,S=this._graph;const T=this._subject,V=this._inversePredicate;switch(b.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",b);if(this._n3Mode)return this._readFormulaTail(b);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,V&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(S=this._readEntity(b))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}if(null!==T){const R=this._predicate,K=this._object;V?this._emit(K,R,T,S):this._emit(T,R,K,S)}return y}_readBlankNodePunctuation(b){let y;switch(b.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(b){return"."!==b.type?this._error("Expected dot to follow quad",b):this._readInTopContext}_readPrefix(b){return"prefix"!==b.type?this._error("Expected prefix to follow @prefix",b):(this._prefix=b.value,this._readPrefixIRI)}_readPrefixIRI(b){if("IRI"!==b.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,b);const y=this._readEntity(b);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(b){const y="IRI"===b.type&&this._resolveIRI(b.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",b)}_readNamedGraphLabel(b){switch(b.type){case"IRI":case"blank":case"prefixed":return this._readSubject(b),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",b)}}_readNamedGraphBlankLabel(b){return"]"!==b.type?this._error("Invalid graph label",b):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(b){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(b)):"."!==b.type?this._error("Expected declaration to end with a dot",b):this._readInTopContext}_readQuantifierList(b){let y;switch(b.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(b,!0)))break;default:return this._error(`Unexpected ${b.type}`,b)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(b){return","===b.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(b))}_getPathReader(b){return this._afterPath=b,this._readPath}_readPath(b){switch(b.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,S=y.length&&y[y.length-1];if(S&&"item"===S.type){const T=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,T,this._graph)}return this._afterPath(b)}}_readForwardPath(b){let y,S;const T=this._blankNode();if(void 0!==(S=this._readEntity(b)))return null===this._predicate?(y=this._subject,this._subject=T):(y=this._object,this._object=T),this._emit(y,S,T,this._graph),this._readPath}_readBackwardPath(b){const y=this._blankNode();let S,T;if(void 0!==(S=this._readEntity(b)))return null===this._predicate?(T=this._subject,this._subject=y):(T=this._object,this._object=y),this._emit(y,S,T,this._graph),this._readPath}_readRDFStarTailOrGraph(b){return">>"!==b.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(b))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,b):this._readRDFStarTail(b)}_readRDFStarTail(b){if(">>"!==b.type)return this._error(`Expected >> but got ${b.type}`,b);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const b=this._contextStack;if(!b.length)return this._readPunctuation;switch(b[b.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(b,y,S,T){this._callback(null,this._quad(b,y,S,T||this.DEFAULTGRAPH))}_error(b,y){const S=new Error(`${b} on line ${y.line}.`);S.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(S),this._callback=x}_resolveIRI(b){return/^[a-z][a-z0-9+.-]*:/i.test(b)?b:this._resolveRelativeIRI(b)}_resolveRelativeIRI(b){if(!b.length)return this._base;switch(b[0]){case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return/^[^/:]*:/.test(b)?null:this._removeDotSegments(this._basePath+b)}}_removeDotSegments(b){if(!/(^|\/)\.\.?($|[/#?])/.test(b))return b;const y=b.length;let S="",T=-1,V=-1,R=0,K="/";for(;T<y;){switch(K){case":":if(V<0&&"/"===b[++T]&&"/"===b[++T])for(;(V=T+1)<y&&"/"!==b[V];)T=V;break;case"?":case"#":T=y;break;case"/":if("."===b[T+1])switch(K=b[1+ ++T],K){case"/":S+=b.substring(R,T-1),R=T+1;break;case void 0:case"?":case"#":return S+b.substring(R,T)+b.substr(T+1);case".":if(K=b[1+ ++T],void 0===K||"/"===K||"?"===K||"#"===K){if(S+=b.substring(R,T-2),(R=S.lastIndexOf("/"))>=V&&(S=S.substr(0,R)),"/"!==K)return`${S}/${b.substr(T+1)}`;R=T+1}}}K=b[++T]}return S+b.substring(R)}parse(b,y,S){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${z++}_`,this._prefixCallback=S||x,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const T=[];let V;if(this._callback=(R,K)=>{R?V=R:K&&T.push(K)},this._lexer.tokenize(b).every(R=>this._readCallback=this._readCallback(R)),V)throw V;return T}this._callback=y,this._lexer.tokenize(b,(T,V)=>{null!==T?(this._callback(T),this._callback=x):this._readCallback&&(this._readCallback=this._readCallback(V))})}}function x(){}function O(A,b){const y=b.namedNode;A._namedNode=y,A._blankNode=b.blankNode,A._literal=b.literal,A._variable=b.variable,A._quad=b.quad,A.DEFAULTGRAPH=b.defaultGraph(),A.RDF_FIRST=y(P.default.rdf.first),A.RDF_REST=y(P.default.rdf.rest),A.RDF_NIL=y(P.default.rdf.nil),A.N3_FORALL=y(P.default.r.forAll),A.N3_FORSOME=y(P.default.r.forSome),A.ABBREVIATIONS={a:y(P.default.rdf.type),"=":y(P.default.owl.sameAs),">":y(P.default.log.implies)},A.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}he.default=v,O(v.prototype,j.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var b,W=function(b,y){if(!y&&b&&b.__esModule)return b;if(null===b||"object"!=typeof b&&"function"!=typeof b)return{default:b};var S=z(y);if(S&&S.has(b))return S.get(b);var T={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in b)if("default"!==R&&Object.prototype.hasOwnProperty.call(b,R)){var K=V?Object.getOwnPropertyDescriptor(b,R):null;K&&(K.get||K.set)?Object.defineProperty(T,R,K):T[R]=b[R]}return T.default=b,S&&S.set(b,T),T}(Y("./N3DataFactory")),j=Y("readable-stream"),P=(b=Y("./IRIs"))&&b.__esModule?b:{default:b};function z(b){if("function"!=typeof WeakMap)return null;var y=new WeakMap,S=new WeakMap;return(z=function(T){return T?S:y})(b)}class x{constructor(y,S){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!S&&y&&!y[0]&&(S=y,y=null),this._factory=(S=S||{}).factory||W.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const S=this._graphs;let T,V;for(const R in S)for(const K in T=S[R].subjects)for(const ce in V=T[K])y+=Object.keys(V[ce]).length;return this._size=y}_addToIndex(y,S,T,V){const R=y[S]||(y[S]={}),K=R[T]||(R[T]={}),ce=V in K;return ce||(K[V]=null),!ce}_removeFromIndex(y,S,T,V){const R=y[S],K=R[T];delete K[V];for(const ce in K)return;delete R[T];for(const ce in R)return;delete y[S]}*_findInIndex(y,S,T,V,R,K,ce,D){let I,X,E;const Z=!S+!T+!V>1?Object.keys(this._ids):this._entities,oe=(0,W.termFromId)(D,this._factory);S&&((I=y,y={})[S]=I[S]);for(const se in y){const te=Z[se];if(X=y[se]){T&&((I=X,X={})[T]=I[T]);for(const Ce in X){const me=Z[Ce];if(E=X[Ce]){const ne=V?V in E?[V]:[]:Object.keys(E);for(let _e=0;_e<ne.length;_e++){const Ie={subject:null,predicate:null,object:null};Ie[R]=(0,W.termFromId)(te,this._factory),Ie[K]=(0,W.termFromId)(me,this._factory),Ie[ce]=(0,W.termFromId)(Z[ne[_e]],this._factory),yield this._factory.quad(Ie.subject,Ie.predicate,Ie.object,oe)}}}}}}_loop(y,S){for(const T in y)S(T)}_loopByKey0(y,S,T){let V,R;if(V=y[S])for(R in V)T(R)}_loopByKey1(y,S,T){let V,R;for(V in y)R=y[V],R[S]&&T(V)}_loopBy2Keys(y,S,T,V){let R,K,ce;if((R=y[S])&&(K=R[T]))for(ce in K)V(ce)}_countInIndex(y,S,T,V){let K,ce,D,R=0;S&&((K=y,y={})[S]=K[S]);for(const I in y)if(ce=y[I]){T&&((K=ce,ce={})[T]=K[T]);for(const X in ce)(D=ce[X])&&(V?V in D&&R++:R+=Object.keys(D).length)}return R}_getGraphs(y){if(!O(y))return this._graphs;const S={};return S[y]=this._graphs[y],S}_uniqueEntities(y){const S=Object.create(null);return T=>{T in S||(S[T]=!0,y((0,W.termFromId)(this._entities[T],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,S,T,V){S||(V=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,W.termToId)(y),S=(0,W.termToId)(S),T=(0,W.termToId)(T),V=(0,W.termToId)(V);let R=this._graphs[V];R||(R=this._graphs[V]={subjects:{},predicates:{},objects:{}},Object.freeze(R));const K=this._ids,ce=this._entities;y=K[y]||(K[ce[++this._id]=y]=this._id),S=K[S]||(K[ce[++this._id]=S]=this._id),T=K[T]||(K[ce[++this._id]=T]=this._id);const D=this._addToIndex(R.subjects,y,S,T);return this._addToIndex(R.predicates,S,T,y),this._addToIndex(R.objects,T,y,S),this._size=null,D}addQuads(y){for(let S=0;S<y.length;S++)this.addQuad(y[S])}delete(y){return this.removeQuad(y),this}has(y,S,T,V){return y&&y.subject&&({subject:y,predicate:S,object:T,graph:V}=y),!this.readQuads(y,S,T,V).next().done}import(y){return y.on("data",S=>{this.addQuad(S)}),y}removeQuad(y,S,T,V){S||(V=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,W.termToId)(y),S=(0,W.termToId)(S),T=(0,W.termToId)(T),V=(0,W.termToId)(V);const R=this._ids,K=this._graphs;let ce,D,I;if(!((y=R[y])&&(S=R[S])&&(T=R[T])&&(ce=K[V])&&(D=ce.subjects[y])&&(I=D[S])&&T in I))return!1;for(y in this._removeFromIndex(ce.subjects,y,S,T),this._removeFromIndex(ce.predicates,S,T,y),this._removeFromIndex(ce.objects,T,y,S),null!==this._size&&this._size--,ce.subjects)return!0;return delete K[V],!0}removeQuads(y){for(let S=0;S<y.length;S++)this.removeQuad(y[S])}remove(y){return y.on("data",S=>{this.removeQuad(S)}),y}removeMatches(y,S,T,V){const R=new j.Readable({objectMode:!0});return R._read=()=>{for(const K of this.readQuads(y,S,T,V))R.push(K);R.push(null)},this.remove(R)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,S,T,V){return[...this.readQuads(y,S,T,V)]}*readQuads(y,S,T,V){y=y&&(0,W.termToId)(y),S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._getGraphs(V),K=this._ids;let ce,D,I,X;if(!(O(y)&&!(D=K[y])||O(S)&&!(I=K[S])||O(T)&&!(X=K[T])))for(const E in R)(ce=R[E])&&(D?X?yield*this._findInIndex(ce.objects,X,D,I,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ce.subjects,D,I,null,"subject","predicate","object",E,null,!0):I?yield*this._findInIndex(ce.predicates,I,X,null,"predicate","object","subject",E,null,!0):X?yield*this._findInIndex(ce.objects,X,null,null,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ce.subjects,null,null,null,"subject","predicate","object",E,null,!0))}match(y,S,T,V){return new A(this,y,S,T,V)}countQuads(y,S,T,V){y=y&&(0,W.termToId)(y),S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._getGraphs(V),K=this._ids;let D,I,X,E,ce=0;if(O(y)&&!(I=K[y])||O(S)&&!(X=K[S])||O(T)&&!(E=K[T]))return 0;for(const $ in R)(D=R[$])&&(ce+=y?T?this._countInIndex(D.objects,E,I,X):this._countInIndex(D.subjects,I,X,E):S?this._countInIndex(D.predicates,X,E,I):this._countInIndex(D.objects,E,I,X));return ce}forEach(y,S,T,V,R){this.some(K=>(y(K),!1),S,T,V,R)}every(y,S,T,V,R){let K=!1;const ce=!this.some(D=>(K=!0,!y(D)),S,T,V,R);return K&&ce}some(y,S,T,V,R){for(const K of this.readQuads(S,T,V,R))if(y(K))return!0;return!1}getSubjects(y,S,T){const V=[];return this.forSubjects(R=>{V.push(R)},y,S,T),V}forSubjects(y,S,T,V){S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._ids,K=this._getGraphs(V);let ce,D,I;if(y=this._uniqueEntities(y),!(O(S)&&!(D=R[S])||O(T)&&!(I=R[T])))for(V in K)(ce=K[V])&&(D?I?this._loopBy2Keys(ce.predicates,D,I,y):this._loopByKey1(ce.subjects,D,y):I?this._loopByKey0(ce.objects,I,y):this._loop(ce.subjects,y))}getPredicates(y,S,T){const V=[];return this.forPredicates(R=>{V.push(R)},y,S,T),V}forPredicates(y,S,T,V){S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._ids,K=this._getGraphs(V);let ce,D,I;if(y=this._uniqueEntities(y),!(O(S)&&!(D=R[S])||O(T)&&!(I=R[T])))for(V in K)(ce=K[V])&&(D?I?this._loopBy2Keys(ce.objects,I,D,y):this._loopByKey0(ce.subjects,D,y):I?this._loopByKey1(ce.predicates,I,y):this._loop(ce.predicates,y))}getObjects(y,S,T){const V=[];return this.forObjects(R=>{V.push(R)},y,S,T),V}forObjects(y,S,T,V){S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._ids,K=this._getGraphs(V);let ce,D,I;if(y=this._uniqueEntities(y),!(O(S)&&!(D=R[S])||O(T)&&!(I=R[T])))for(V in K)(ce=K[V])&&(D?I?this._loopBy2Keys(ce.subjects,D,I,y):this._loopByKey1(ce.objects,D,y):I?this._loopByKey0(ce.predicates,I,y):this._loop(ce.objects,y))}getGraphs(y,S,T){const V=[];return this.forGraphs(R=>{V.push(R)},y,S,T),V}forGraphs(y,S,T,V){for(const R in this._graphs)this.some(K=>(y(K.graph),!0),S,T,V,R)}createBlankNode(y){let S,T;if(y)for(S=y=`_:${y}`,T=1;this._ids[S];)S=y+T++;else do{S="_:b"+this._blankNodeIndex++}while(this._ids[S]);return this._ids[S]=++this._id,this._entities[this._id]=S,this._factory.blankNode(S.substr(2))}extractLists({remove:y=!1,ignoreErrors:S=!1}={}){const T={},V=S?()=>!0:(ce,D)=>{throw new Error(`${ce.value} ${D}`)},R=this.getQuads(null,P.default.rdf.rest,P.default.rdf.nil,null),K=y?[...R]:[];return R.forEach(ce=>{const D=[];let X,E,I=!1;const $=ce.graph;let Z=ce.subject;for(;Z&&!I;){const oe=this.getQuads(null,null,Z,null),se=this.getQuads(Z,null,null,null);let te,Ce=null,me=null,ne=null;for(let _e=0;_e<se.length&&!I;_e++)te=se[_e],te.graph.equals($)?X?I=V(Z,"has non-list arcs out"):te.predicate.value===P.default.rdf.first?Ce?I=V(Z,"has multiple rdf:first arcs"):K.push(Ce=te):te.predicate.value===P.default.rdf.rest?me?I=V(Z,"has multiple rdf:rest arcs"):K.push(me=te):oe.length?I=V(Z,"can't be subject and object"):(X=te,E="subject"):I=V(Z,"not confined to single graph");for(let _e=0;_e<oe.length&&!I;++_e)te=oe[_e],X?I=V(Z,"can't have coreferences"):te.predicate.value===P.default.rdf.rest?ne?I=V(Z,"has incoming rdf:rest arcs"):ne=te:(X=te,E="object");Ce?D.unshift(Ce.object):I=V(Z,"has no list head"),Z=ne&&ne.subject}I?y=!1:X&&(T[X[E].value]=D)}),y&&this.removeQuads(K),T}*[Symbol.iterator](){yield*this.readQuads()}}function O(b){return"string"==typeof b||b instanceof String}he.default=x;class A extends j.Readable{constructor(y,S,T,V,R){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:S,predicate:T,object:V,graph:R})}get filtered(){if(!this._filtered){const{n3Store:y,graph:S,object:T,predicate:V,subject:R}=this,K=y.getQuads(R,V,T,S);this._filtered=new x(K,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,S,T,V){return new A(this.filtered,y,S,T,V)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var z,W=(z=Y("./N3Parser"))&&z.__esModule?z:{default:z},j=Y("readable-stream");he.default=class extends j.Transform{constructor(v){let O,A;super({decodeStrings:!0}),this._readableState.objectMode=!0,new W.default(v).parse({on:(b,y)=>{switch(b){case"data":O=y;break;case"end":A=y}}},(b,y)=>{b&&this.emit("error",b)||y&&this.push(y)},(b,y)=>{this.emit("prefix",b,y)}),this._transform=(b,y,S)=>{O(b),S()},this._flush=b=>{A(),b()}}import(v){return v.on("data",x=>{this.write(x)}),v.on("end",()=>{this.end()}),v.on("error",x=>{this.emit("error",x)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var z,W=Y("readable-stream"),j=(z=Y("./N3Writer"))&&z.__esModule?z:{default:z};he.default=class extends W.Transform{constructor(v){super({encoding:"utf8",writableObjectMode:!0});const x=this._writer=new j.default({write:(O,A,b)=>{this.push(O),b&&b()},end:O=>{this.push(null),O&&O()}},v);this._transform=(O,A,b)=>{x.addQuad(O,b)},this._flush=O=>{x.end(O)}}import(v){return v.on("data",x=>{this.write(x)}),v.on("end",()=>{this.end()}),v.on("error",x=>{this.emit("error",x)}),v.on("prefix",(x,O)=>{this._writer.addPrefix(x,O)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.inDefaultGraph=function(y){return x(y.graph)},he.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},he.isDefaultGraph=x,he.isLiteral=function(y){return!!y&&"Literal"===y.termType},he.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},he.isVariable=function(y){return!!y&&"Variable"===y.termType},he.prefix=function(y,S){return b({"":y.value||y},S)("")},he.prefixes=b;var y,W=(y=Y("./N3DataFactory"))&&y.__esModule?y:{default:y};function x(y){return!!y&&"DefaultGraph"===y.termType}function b(y,S){const T=Object.create(null);for(const R in y)V(R,y[R]);function V(R,K){if("string"==typeof K){const ce=Object.create(null);T[R]=D=>ce[D]||(ce[D]=S.namedNode(K+D))}else if(!(R in T))throw new Error(`Unknown prefix: ${R}`);return T[R]}return S=S||W.default,V}},{"./N3DataFactory":35}],42:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var ce,W=(ce=Y("./IRIs"))&&ce.__esModule?ce:{default:ce},j=function(ce,D){if(!D&&ce&&ce.__esModule)return ce;if(null===ce||"object"!=typeof ce&&"function"!=typeof ce)return{default:ce};var I=Q(D);if(I&&I.has(ce))return I.get(ce);var X={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in ce)if("default"!==$&&Object.prototype.hasOwnProperty.call(ce,$)){var Z=E?Object.getOwnPropertyDescriptor(ce,$):null;Z&&(Z.get||Z.set)?Object.defineProperty(X,$,Z):X[$]=ce[$]}return X.default=ce,I&&I.set(ce,X),X}(Y("./N3DataFactory")),P=Y("./N3Util");function Q(ce){if("function"!=typeof WeakMap)return null;var D=new WeakMap,I=new WeakMap;return(Q=function(X){return X?I:D})(ce)}const x=j.default.defaultGraph(),{rdf:O,xsd:A}=W.default,b=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,S={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class T extends j.Term{equals(){return!1}}function R(ce){let D=S[ce];return void 0===D&&(1===ce.length?(D=ce.charCodeAt(0).toString(16),D="\\u0000".substr(0,6-D.length)+D):(D=(1024*(ce.charCodeAt(0)-55296)+ce.charCodeAt(1)+9216).toString(16),D="\\U00000000".substr(0,10-D.length)+D)),D}function K(ce){return ce.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}he.default=class{constructor(D,I){if(this._prefixRegex=/$0^/,D&&"function"!=typeof D.write&&(I=D,D=null),this._lists=(I=I||{}).lists,D)this._outputStream=D,this._endStream=void 0===I.end||!!I.end;else{let X="";this._outputStream={write(E,$,Z){X+=E,Z&&Z()},end:E=>{E&&E(null,X)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(I.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=x,this._prefixIRIs=Object.create(null),I.prefixes&&this.addPrefixes(I.prefixes),I.baseIRI&&(this._baseMatcher=new RegExp(`^${K(I.baseIRI)}${I.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=I.baseIRI.length))}get _inDefaultGraph(){return x.equals(this._graph)}_write(D,I){this._outputStream.write(D,"utf8",I)}_writeQuad(D,I,X,E,$){try{E.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(x.equals(E)?"":`${this._encodeIriOrBlank(E)} {\n`)),this._graph=E,this._subject=null),D.equals(this._subject)?I.equals(this._predicate)?this._write(`, ${this._encodeObject(X)}`,$):this._write(`;\n    ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,$):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=D)} ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,$)}catch(Z){$&&$(Z)}}_writeQuadLine(D,I,X,E,$){delete this._prefixMatch,this._write(this.quadToString(D,I,X,E),$)}quadToString(D,I,X,E){return`${this._encodeSubject(D)} ${this._encodeIriOrBlank(I)} ${this._encodeObject(X)}${E&&E.value?` ${this._encodeIriOrBlank(E)} .\n`:" .\n"}`}quadsToString(D){return D.map(I=>this.quadToString(I.subject,I.predicate,I.object,I.graph)).join("")}_encodeSubject(D){return"Quad"===D.termType?this._encodeQuad(D):this._encodeIriOrBlank(D)}_encodeIriOrBlank(D){if("NamedNode"!==D.termType)return this._lists&&D.value in this._lists&&(D=this.list(this._lists[D.value])),"id"in D?D.id:`_:${D.value}`;let I=D.value;this._baseMatcher&&this._baseMatcher.test(I)&&(I=I.substr(this._baseLength)),b.test(I)&&(I=I.replace(y,R));const X=this._prefixRegex.exec(I);return X?X[1]?this._prefixIRIs[X[1]]+X[2]:I:`<${I}>`}_encodeLiteral(D){let I=D.value;if(b.test(I)&&(I=I.replace(y,R)),D.language)return`"${I}"@${D.language}`;if(this._lineMode){if(D.datatype.value===A.string)return`"${I}"`}else switch(D.datatype.value){case A.string:return`"${I}"`;case A.boolean:if("true"===I||"false"===I)return I;break;case A.integer:if(/^[+-]?\d+$/.test(I))return I;break;case A.decimal:if(/^[+-]?\d*\.\d+$/.test(I))return I;break;case A.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(I))return I}return`"${I}"^^${this._encodeIriOrBlank(D.datatype)}`}_encodePredicate(D){return D.value===O.type?"a":this._encodeIriOrBlank(D)}_encodeObject(D){switch(D.termType){case"Quad":return this._encodeQuad(D);case"Literal":return this._encodeLiteral(D);default:return this._encodeIriOrBlank(D)}}_encodeQuad({subject:D,predicate:I,object:X,graph:E}){return`<<${this._encodeSubject(D)} ${this._encodePredicate(I)} ${this._encodeObject(X)}${(0,P.isDefaultGraph)(E)?"":` ${this._encodeIriOrBlank(E)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(D,I,X,E,$){void 0===X?this._writeQuad(D.subject,D.predicate,D.object,D.graph,I):"function"==typeof E?this._writeQuad(D,I,X,x,E):this._writeQuad(D,I,X,E||x,$)}addQuads(D){for(let I=0;I<D.length;I++)this.addQuad(D[I])}addPrefix(D,I,X){const E={};E[D]=I,this.addPrefixes(E,X)}addPrefixes(D,I){if(!this._prefixIRIs)return I&&I();let X=!1;for(let E in D){let $=D[E];"string"!=typeof $&&($=$.value),X=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[$]=E+=":",this._write(`@prefix ${E} <${$}>.\n`)}if(X){let E="",$="";for(const Z in this._prefixIRIs)E+=E?`|${Z}`:Z,$+=($?"|":"")+this._prefixIRIs[Z];E=K(E),this._prefixRegex=new RegExp(`^(?:${$})[^/]*$|^(${E})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(X?"\n":"",I)}blank(D,I){let E,$,X=D;switch(void 0===D?X=[]:D.termType?X=[{predicate:D,object:I}]:"length"in D||(X=[D]),$=X.length){case 0:return new T("[]");case 1:if(E=X[0],!(E.object instanceof T))return new T(`[ ${this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)} ]`);default:let Z="[";for(let oe=0;oe<$;oe++)E=X[oe],E.predicate.equals(D)?Z+=`, ${this._encodeObject(E.object)}`:(Z+=`${(oe?";\n  ":"\n  ")+this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)}`,D=E.predicate);return new T(`${Z}\n]`)}}list(D){const I=D&&D.length||0,X=new Array(I);for(let E=0;E<I;E++)X[E]=this._encodeObject(D[E]);return new T(`(${X.join(" ")})`)}end(D){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let I=D&&((X,E)=>{I=null,D(X,E)});if(this._endStream)try{return this._outputStream.end(I)}catch(X){}I&&I()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),Object.defineProperty(he,"BlankNode",{enumerable:!0,get:function(){return O.BlankNode}}),Object.defineProperty(he,"DataFactory",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(he,"DefaultGraph",{enumerable:!0,get:function(){return O.DefaultGraph}}),Object.defineProperty(he,"Lexer",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(he,"Literal",{enumerable:!0,get:function(){return O.Literal}}),Object.defineProperty(he,"NamedNode",{enumerable:!0,get:function(){return O.NamedNode}}),Object.defineProperty(he,"Parser",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(he,"Quad",{enumerable:!0,get:function(){return O.Quad}}),Object.defineProperty(he,"Store",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(he,"StreamParser",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(he,"StreamWriter",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(he,"Term",{enumerable:!0,get:function(){return O.Term}}),Object.defineProperty(he,"Triple",{enumerable:!0,get:function(){return O.Triple}}),he.Util=void 0,Object.defineProperty(he,"Variable",{enumerable:!0,get:function(){return O.Variable}}),Object.defineProperty(he,"Writer",{enumerable:!0,get:function(){return P.default}}),he.default=void 0,Object.defineProperty(he,"termFromId",{enumerable:!0,get:function(){return O.termFromId}}),Object.defineProperty(he,"termToId",{enumerable:!0,get:function(){return O.termToId}});var W=y(Y("./N3Lexer")),j=y(Y("./N3Parser")),P=y(Y("./N3Writer")),Q=y(Y("./N3Store")),z=y(Y("./N3StreamParser")),v=y(Y("./N3StreamWriter")),x=b(Y("./N3Util"));he.Util=x;var O=b(Y("./N3DataFactory"));function A(T){if("function"!=typeof WeakMap)return null;var V=new WeakMap,R=new WeakMap;return(A=function(K){return K?R:V})(T)}function b(T,V){if(!V&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var R=A(V);if(R&&R.has(T))return R.get(T);var K={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in T)if("default"!==D&&Object.prototype.hasOwnProperty.call(T,D)){var I=ce?Object.getOwnPropertyDescriptor(T,D):null;I&&(I.get||I.set)?Object.defineProperty(K,D,I):K[D]=T[D]}return K.default=T,R&&R.set(T,K),K}function y(T){return T&&T.__esModule?T:{default:T}}he.default={Lexer:W.default,Parser:j.default,Writer:P.default,Store:Q.default,StreamParser:z.default,StreamWriter:v.default,Util:x,DataFactory:O.default,Term:O.Term,NamedNode:O.NamedNode,Literal:O.Literal,BlankNode:O.BlankNode,Variable:O.Variable,DefaultGraph:O.DefaultGraph,Quad:O.Quad,Triple:O.Triple,termFromId:O.termFromId,termToId:O.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(Y,Se,he){var j,P,W=Se.exports={};function Q(){throw new Error("setTimeout has not been defined")}function z(){throw new Error("clearTimeout has not been defined")}function v(K){if(j===setTimeout)return setTimeout(K,0);if((j===Q||!j)&&setTimeout)return j=setTimeout,setTimeout(K,0);try{return j(K,0)}catch(ce){try{return j.call(null,K,0)}catch(D){return j.call(this,K,0)}}}!function(){try{j="function"==typeof setTimeout?setTimeout:Q}catch(K){j=Q}try{P="function"==typeof clearTimeout?clearTimeout:z}catch(K){P=z}}();var b,O=[],A=!1,y=-1;function S(){!A||!b||(A=!1,b.length?O=b.concat(O):y=-1,O.length&&T())}function T(){if(!A){var K=v(S);A=!0;for(var ce=O.length;ce;){for(b=O,O=[];++y<ce;)b&&b[y].run();y=-1,ce=O.length}b=null,A=!1,function(K){if(P===clearTimeout)return clearTimeout(K);if((P===z||!P)&&clearTimeout)return P=clearTimeout,clearTimeout(K);try{P(K)}catch(ce){try{return P.call(null,K)}catch(D){return P.call(this,K)}}}(K)}}function V(K,ce){this.fun=K,this.array=ce}function R(){}W.nextTick=function(K){var ce=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)ce[D-1]=arguments[D];O.push(new V(K,ce)),1===O.length&&!A&&v(T)},V.prototype.run=function(){this.fun.apply(null,this.array)},W.title="browser",W.browser=!0,W.env={},W.argv=[],W.version="",W.versions={},W.on=R,W.addListener=R,W.once=R,W.off=R,W.removeListener=R,W.removeAllListeners=R,W.emit=R,W.prependListener=R,W.prependOnceListener=R,W.listeners=function(K){return[]},W.binding=function(K){throw new Error("process.binding is not supported")},W.cwd=function(){return"/"},W.chdir=function(K){throw new Error("process.chdir is not supported")},W.umask=function(){return 0}},{}],45:[function(Y,Se,he){(function(W){(function(){let j;Se.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:W):P=>(j||(j=Promise.resolve())).then(P).catch(Q=>setTimeout(()=>{throw Q},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(Y,Se,he){Se.exports=Y("./lib")},{"./lib":55}],47:[function(Y,Se,he){"use strict";Se.exports=class Qq{constructor(j,P=new Map,Q=0){this.prefix=j,this._existing=P,this.counter=Q}clone(){const{prefix:j,_existing:P,counter:Q}=this;return new Qq(j,new Map(P),Q)}getId(j){const P=j&&this._existing.get(j);if(P)return P;const Q=this.prefix+this.counter;return this.counter++,j&&this._existing.set(j,Q),Q}hasId(j){return this._existing.has(j)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(Y,Se,he){"use strict";Y("setimmediate");const W=self.crypto||self.msCrypto;Se.exports=class{constructor(P){if(!W||!W.subtle)throw new Error("crypto.subtle not found.");if("sha256"===P)this.algorithm={name:"SHA-256"};else{if("sha1"!==P)throw new Error(`Unsupport algorithm "${P}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(P){this._content+=P}digest(){var P=this;return yt(function*(){const Q=(new TextEncoder).encode(P._content),z=new Uint8Array(yield W.subtle.digest(P.algorithm,Q));let v="";for(let x=0;x<z.length;++x)v+=z[x].toString(16).padStart(2,"0");return v})()}}},{setimmediate:86}],49:[function(Y,Se,he){"use strict";const P="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",Q="http://www.w3.org/2001/XMLSchema#string",z="NamedNode",v="BlankNode",x="Literal",O="DefaultGraph",A={};function b(R,K){return R.subject.termType===K.subject.termType&&R.object.termType===K.object.termType&&R.subject.value===K.subject.value&&R.predicate.value===K.predicate.value&&R.object.value===K.object.value&&(R.object.termType!==x||R.object.datatype.termType===K.object.datatype.termType&&R.object.language===K.object.language&&R.object.datatype.value===K.object.datatype.value)}A.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,A.empty=new RegExp("^[ \\t]*$"),A.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Se.exports=class d2{static parse(K){const ce=[],D={},I=K.split(A.eoln);let X=0;for(const E of I){if(X++,A.empty.test(E))continue;const $=E.match(A.quad);if(null===$)throw new Error("N-Quads parse error on line "+X+".");const Z={subject:null,predicate:null,object:null,graph:null};if(Z.subject=void 0!==$[1]?{termType:z,value:$[1]}:{termType:v,value:$[2]},Z.predicate={termType:z,value:$[3]},void 0!==$[4]?Z.object={termType:z,value:$[4]}:void 0!==$[5]?Z.object={termType:v,value:$[5]}:(Z.object={termType:x,value:void 0,datatype:{termType:z}},void 0!==$[7]?Z.object.datatype.value=$[7]:void 0!==$[8]?(Z.object.datatype.value=P,Z.object.language=$[8]):Z.object.datatype.value=Q,Z.object.value=$[6].replace(T,function(K,ce,D,I){if(ce)switch(ce){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(D)return String.fromCharCode(parseInt(D,16));if(I)throw new Error("Unsupported U escape")})),Z.graph=void 0!==$[9]?{termType:z,value:$[9]}:void 0!==$[10]?{termType:v,value:$[10]}:{termType:O,value:""},Z.graph.value in D){let oe=!0;const se=D[Z.graph.value];for(const te of se)if(b(te,Z)){oe=!1;break}oe&&(se.push(Z),ce.push(Z))}else D[Z.graph.value]=[Z],ce.push(Z)}return ce}static serialize(K){Array.isArray(K)||(K=d2.legacyDatasetToQuads(K));const ce=[];for(const D of K)ce.push(d2.serializeQuad(D));return ce.sort().join("")}static serializeQuad(K){const ce=K.subject,I=K.object,X=K.graph;let E="";return E+=ce.termType===z?`<${ce.value}>`:`${ce.value}`,E+=` <${K.predicate.value}> `,I.termType===z?E+=`<${I.value}>`:I.termType===v?E+=I.value:(E+=`"${R=I.value,R.replace(y,function(K){switch(K){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,I.datatype.value===P?I.language&&(E+=`@${I.language}`):I.datatype.value!==Q&&(E+=`^^<${I.datatype.value}>`)),X.termType===z?E+=` <${X.value}>`:X.termType===v&&(E+=` ${X.value}`),E+=" .\n",E;var R}static legacyDatasetToQuads(K){const ce=[],D={"blank node":v,IRI:z,literal:x};for(const I in K)K[I].forEach(E=>{const $={};for(const Z in E){const oe=E[Z],se={termType:D[oe.type],value:oe.value};se.termType===x&&(se.datatype={termType:z},"datatype"in oe&&(se.datatype.value=oe.datatype),"language"in oe?("datatype"in oe||(se.datatype.value=P),se.language=oe.language):"datatype"in oe||(se.datatype.value=Q)),$[Z]=se}$.graph="@default"===I?{termType:O,value:""}:{termType:I.startsWith("_:")?v:z,value:I},ce.push($)});return ce}};const y=/["\\\n\r]/g;const T=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(Y,Se,he){"use strict";Se.exports=class{constructor(j){this.current=j.sort(),this.done=!1,this.dir=new Map;for(let P=0;P<j.length;++P)this.dir.set(j[P],!0)}hasNext(){return!this.done}next(){const{current:j,dir:P}=this,Q=j.slice();let z=null,v=0;const x=j.length;for(let O=0;O<x;++O){const A=j[O],b=P.get(A);(null===z||A>z)&&(b&&O>0&&A>j[O-1]||!b&&O<x-1&&A>j[O+1])&&(z=A,v=O)}if(null===z)this.done=!0;else{const O=P.get(z)?v-1:v+1;j[v]=j[O],j[O]=z;for(const A of j)A>z&&P.set(A,!P.get(A))}return Q}}},{}],51:[function(Y,Se,he){(function(W){(function(){"use strict";const j=Y("./IdentifierIssuer"),P=Y("./MessageDigest"),Q=Y("./Permuter"),z=Y("./NQuads");function v(x,O){return x.hash<O.hash?-1:x.hash>O.hash?1:0}Se.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new j("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(O){var A=this;return yt(function*(){A.quads=O;for(const K of O)A._addBlankNodeQuadInfo({quad:K,component:K.subject}),A._addBlankNodeQuadInfo({quad:K,component:K.object}),A._addBlankNodeQuadInfo({quad:K,component:K.graph});const b=new Map,y=[...A.blankNodeInfo.keys()];let S=0;for(const K of y)++S%100==0&&(yield A._yield()),yield A._hashAndTrackBlankNode({id:K,hashToBlankNodes:b});const T=[...b.keys()].sort(),V=[];for(const K of T){const ce=b.get(K);ce.length>1?V.push(ce):A.canonicalIssuer.getId(ce[0])}for(const K of V){const ce=[];for(const D of K){if(A.canonicalIssuer.hasId(D))continue;const I=new j("_:b");I.getId(D);const X=yield A.hashNDegreeQuads(D,I);ce.push(X)}ce.sort(v);for(const D of ce){const I=D.issuer.getOldIds();for(const X of I)A.canonicalIssuer.getId(X)}}const R=[];for(const K of A.quads){const ce=ot({},K);ce.subject=A._useCanonicalId({component:ce.subject}),ce.object=A._useCanonicalId({component:ce.object}),ce.graph=A._useCanonicalId({component:ce.graph}),R.push(z.serializeQuad(ce))}return R.sort(),R.join("")})()}hashFirstDegreeQuads(O){var A=this;return yt(function*(){const b=[],y=A.blankNodeInfo.get(O),S=y.quads;for(const V of S){const R={subject:null,predicate:V.predicate,object:null,graph:null};R.subject=A.modifyFirstDegreeComponent(O,V.subject,"subject"),R.object=A.modifyFirstDegreeComponent(O,V.object,"object"),R.graph=A.modifyFirstDegreeComponent(O,V.graph,"graph"),b.push(z.serializeQuad(R))}b.sort();const T=new P(A.hashAlgorithm);for(const V of b)T.update(V);return y.hash=yield T.digest(),y.hash})()}hashRelatedBlankNode(O,A,b,y){var S=this;return yt(function*(){let T;T=S.canonicalIssuer.hasId(O)?S.canonicalIssuer.getId(O):b.hasId(O)?b.getId(O):S.blankNodeInfo.get(O).hash;const V=new P(S.hashAlgorithm);return V.update(y),"g"!==y&&V.update(S.getRelatedPredicate(A)),V.update(T),V.digest()})()}hashNDegreeQuads(O,A){var b=this;return yt(function*(){const y=new P(b.hashAlgorithm),S=yield b.createHashToRelated(O,A),T=[...S.keys()].sort();for(const V of T){y.update(V);let K,R="";const ce=new Q(S.get(V));let D=0;for(;ce.hasNext();){const I=ce.next();++D%3==0&&(yield b._yield());let X=A.clone(),E="";const $=[];let Z=!1;for(const oe of I)if(b.canonicalIssuer.hasId(oe)?E+=b.canonicalIssuer.getId(oe):(X.hasId(oe)||$.push(oe),E+=X.getId(oe)),0!==R.length&&E>R){Z=!0;break}if(!Z){for(const oe of $){const se=yield b.hashNDegreeQuads(oe,X);if(E+=X.getId(oe),E+=`<${se.hash}>`,X=se.issuer,0!==R.length&&E>R){Z=!0;break}}Z||(0===R.length||E<R)&&(R=E,K=X)}}y.update(R),A=K}return{hash:yield y.digest(),issuer:A}})()}modifyFirstDegreeComponent(O,A){return"BlankNode"!==A.termType?A:{termType:"BlankNode",value:A.value===O?"_:a":"_:z"}}getRelatedPredicate(O){return`<${O.predicate.value}>`}createHashToRelated(O,A){var b=this;return yt(function*(){const y=new Map,S=b.blankNodeInfo.get(O).quads;let T=0;for(const V of S)++T%100==0&&(yield b._yield()),yield Promise.all([b._addRelatedBlankNodeHash({quad:V,component:V.subject,position:"s",id:O,issuer:A,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:V,component:V.object,position:"o",id:O,issuer:A,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:V,component:V.graph,position:"g",id:O,issuer:A,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:O,hashToBlankNodes:A}){var b=this;return yt(function*(){const y=yield b.hashFirstDegreeQuads(O),S=A.get(y);S?S.push(O):A.set(y,[O])})()}_addBlankNodeQuadInfo({quad:O,component:A}){if("BlankNode"!==A.termType)return;const b=A.value,y=this.blankNodeInfo.get(b);y?y.quads.add(O):this.blankNodeInfo.set(b,{quads:new Set([O]),hash:null})}_addRelatedBlankNodeHash({quad:O,component:A,position:b,id:y,issuer:S,hashToRelated:T}){var V=this;return yt(function*(){if("BlankNode"!==A.termType||A.value===y)return;const R=A.value,K=yield V.hashRelatedBlankNode(R,O,S,b),ce=T.get(K);ce?ce.push(R):T.set(K,[R])})()}_useCanonicalId({component:O}){return"BlankNode"!==O.termType||O.value.startsWith(this.canonicalIssuer.prefix)?O:{termType:"BlankNode",value:this.canonicalIssuer.getId(O.value)}}_yield(){return yt(function*(){return new Promise(O=>W(O))})()}}}).call(this)}).call(this,Y("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(Y,Se,he){"use strict";const W=Y("./IdentifierIssuer"),j=Y("./MessageDigest"),P=Y("./Permuter"),Q=Y("./NQuads");function z(v,x){return v.hash<x.hash?-1:v.hash>x.hash?1:0}Se.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new W("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(x){this.quads=x;for(const T of x)this._addBlankNodeQuadInfo({quad:T,component:T.subject}),this._addBlankNodeQuadInfo({quad:T,component:T.object}),this._addBlankNodeQuadInfo({quad:T,component:T.graph});const O=new Map,A=[...this.blankNodeInfo.keys()];for(const T of A)this._hashAndTrackBlankNode({id:T,hashToBlankNodes:O});const b=[...O.keys()].sort(),y=[];for(const T of b){const V=O.get(T);V.length>1?y.push(V):this.canonicalIssuer.getId(V[0])}for(const T of y){const V=[];for(const R of T){if(this.canonicalIssuer.hasId(R))continue;const K=new W("_:b");K.getId(R);const ce=this.hashNDegreeQuads(R,K);V.push(ce)}V.sort(z);for(const R of V){const K=R.issuer.getOldIds();for(const ce of K)this.canonicalIssuer.getId(ce)}}const S=[];for(const T of this.quads){const V=ot({},T);V.subject=this._useCanonicalId({component:V.subject}),V.object=this._useCanonicalId({component:V.object}),V.graph=this._useCanonicalId({component:V.graph}),S.push(Q.serializeQuad(V))}return S.sort(),S.join("")}hashFirstDegreeQuads(x){const O=[],A=this.blankNodeInfo.get(x),b=A.quads;for(const S of b){const T={subject:null,predicate:S.predicate,object:null,graph:null};T.subject=this.modifyFirstDegreeComponent(x,S.subject,"subject"),T.object=this.modifyFirstDegreeComponent(x,S.object,"object"),T.graph=this.modifyFirstDegreeComponent(x,S.graph,"graph"),O.push(Q.serializeQuad(T))}O.sort();const y=new j(this.hashAlgorithm);for(const S of O)y.update(S);return A.hash=y.digest(),A.hash}hashRelatedBlankNode(x,O,A,b){let y;y=this.canonicalIssuer.hasId(x)?this.canonicalIssuer.getId(x):A.hasId(x)?A.getId(x):this.blankNodeInfo.get(x).hash;const S=new j(this.hashAlgorithm);return S.update(b),"g"!==b&&S.update(this.getRelatedPredicate(O)),S.update(y),S.digest()}hashNDegreeQuads(x,O){const A=new j(this.hashAlgorithm),b=this.createHashToRelated(x,O),y=[...b.keys()].sort();for(const S of y){A.update(S);let V,T="";const R=new P(b.get(S));for(;R.hasNext();){const K=R.next();let ce=O.clone(),D="";const I=[];let X=!1;for(const E of K)if(this.canonicalIssuer.hasId(E)?D+=this.canonicalIssuer.getId(E):(ce.hasId(E)||I.push(E),D+=ce.getId(E)),0!==T.length&&D>T){X=!0;break}if(!X){for(const E of I){const $=this.hashNDegreeQuads(E,ce);if(D+=ce.getId(E),D+=`<${$.hash}>`,ce=$.issuer,0!==T.length&&D>T){X=!0;break}}X||(0===T.length||D<T)&&(T=D,V=ce)}}A.update(T),O=V}return{hash:A.digest(),issuer:O}}modifyFirstDegreeComponent(x,O){return"BlankNode"!==O.termType?O:{termType:"BlankNode",value:O.value===x?"_:a":"_:z"}}getRelatedPredicate(x){return`<${x.predicate.value}>`}createHashToRelated(x,O){const A=new Map,b=this.blankNodeInfo.get(x).quads;for(const y of b)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:x,issuer:O,hashToRelated:A}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:x,issuer:O,hashToRelated:A}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:x,issuer:O,hashToRelated:A});return A}_hashAndTrackBlankNode({id:x,hashToBlankNodes:O}){const A=this.hashFirstDegreeQuads(x),b=O.get(A);b?b.push(x):O.set(A,[x])}_addBlankNodeQuadInfo({quad:x,component:O}){if("BlankNode"!==O.termType)return;const A=O.value,b=this.blankNodeInfo.get(A);b?b.quads.add(x):this.blankNodeInfo.set(A,{quads:new Set([x]),hash:null})}_addRelatedBlankNodeHash({quad:x,component:O,position:A,id:b,issuer:y,hashToRelated:S}){if("BlankNode"!==O.termType||O.value===b)return;const T=O.value,V=this.hashRelatedBlankNode(T,x,y,A),R=S.get(V);R?R.push(T):S.set(V,[T])}_useCanonicalId({component:x}){return"BlankNode"!==x.termType||x.value.startsWith(this.canonicalIssuer.prefix)?x:{termType:"BlankNode",value:this.canonicalIssuer.getId(x.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015");Se.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(P,Q,z){return"BlankNode"!==Q.termType?Q:"graph"===z?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===P?"_:a":"_:z"}}getRelatedPredicate(P){return P.predicate.value}createHashToRelated(P,Q){var z=this;return yt(function*(){const v=new Map,x=z.blankNodeInfo.get(P).quads;let O=0;for(const A of x){let b,y;if("BlankNode"===A.subject.termType&&A.subject.value!==P)y=A.subject.value,b="p";else{if("BlankNode"!==A.object.termType||A.object.value===P)continue;y=A.object.value,b="r"}++O%100==0&&(yield z._yield());const S=yield z.hashRelatedBlankNode(y,A,Q,b),T=v.get(S);T?T.push(y):v.set(S,[y])}return v})()}}},{"./URDNA2015":51}],54:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015Sync");Se.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(P,Q,z){return"BlankNode"!==Q.termType?Q:"graph"===z?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===P?"_:a":"_:z"}}getRelatedPredicate(P){return P.predicate.value}createHashToRelated(P,Q){const z=new Map,v=this.blankNodeInfo.get(P).quads;for(const x of v){let O,A;if("BlankNode"===x.subject.termType&&x.subject.value!==P)A=x.subject.value,O="p";else{if("BlankNode"!==x.object.termType||x.object.value===P)continue;A=x.object.value,O="r"}const b=this.hashRelatedBlankNode(A,x,Q,O),y=z.get(b);y?y.push(A):z.set(b,[A])}return z}}},{"./URDNA2015Sync":52}],55:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015"),j=Y("./URGNA2012"),P=Y("./URDNA2015Sync"),Q=Y("./URGNA2012Sync");let z;try{z=Y("rdf-canonize-native")}catch(x){}const v={};Se.exports=v,v.NQuads=Y("./NQuads"),v.IdentifierIssuer=Y("./IdentifierIssuer"),v._rdfCanonizeNative=function(x){return x&&(z=x),z},v.canonize=function(){var x=yt(function*(O,A){if(Array.isArray(O)||(O=v.NQuads.legacyDatasetToQuads(O)),A.useNative){if(!z)throw new Error("rdf-canonize-native not available");return new Promise((b,y)=>z.canonize(O,A,(S,T)=>S?y(S):b(T)))}if("URDNA2015"===A.algorithm)return new W(A).main(O);if("URGNA2012"===A.algorithm)return new j(A).main(O);throw"algorithm"in A?new Error("Invalid RDF Dataset Canonicalization algorithm: "+A.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(O,A){return x.apply(this,arguments)}}(),v._canonizeSync=function(x,O){if(Array.isArray(x)||(x=v.NQuads.legacyDatasetToQuads(x)),O.useNative){if(z)return z.canonizeSync(x,O);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===O.algorithm)return new P(O).main(x);if("URGNA2012"===O.algorithm)return new Q(O).main(x);throw"algorithm"in O?new Error("Invalid RDF Dataset Canonicalization algorithm: "+O.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(Y,Se,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(P,Q,z,v){void 0===v&&(v=z),Object.defineProperty(P,v,{enumerable:!0,get:function(){return Q[z]}})}:function(P,Q,z,v){void 0===v&&(v=z),P[v]=Q[z]}),j=this&&this.__exportStar||function(P,Q){for(var z in P)"default"!==z&&!Object.prototype.hasOwnProperty.call(Q,z)&&W(Q,P,z)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/BlankNode"),he),j(Y("./lib/DataFactory"),he),j(Y("./lib/DefaultGraph"),he),j(Y("./lib/Literal"),he),j(Y("./lib/NamedNode"),he),j(Y("./lib/Quad"),he),j(Y("./lib/Variable"),he)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.BlankNode=void 0;he.BlankNode=class{constructor(P){this.termType="BlankNode",this.value=P}equals(P){return!!P&&"BlankNode"===P.termType&&P.value===this.value}}},{}],58:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DataFactory=void 0;const W=Y("./BlankNode"),j=Y("./DefaultGraph"),P=Y("./Literal"),Q=Y("./NamedNode"),z=Y("./Quad"),v=Y("./Variable");let x=0;he.DataFactory=class{constructor(b){this.blankNodeCounter=0,this.blankNodePrefix=(b=b||{}).blankNodePrefix||`df_${x++}_`}namedNode(b){return new Q.NamedNode(b)}blankNode(b){return new W.BlankNode(b||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(b,y){return new P.Literal(b,y)}variable(b){return new v.Variable(b)}defaultGraph(){return j.DefaultGraph.INSTANCE}quad(b,y,S,T){return new z.Quad(b,y,S,T||this.defaultGraph())}fromTerm(b){switch(b.termType){case"NamedNode":return this.namedNode(b.value);case"BlankNode":return this.blankNode(b.value);case"Literal":return b.language?this.literal(b.value,b.language):b.datatype.equals(P.Literal.XSD_STRING)?this.literal(b.value):this.literal(b.value,this.fromTerm(b.datatype));case"Variable":return this.variable(b.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(b.subject),this.fromTerm(b.predicate),this.fromTerm(b.object),this.fromTerm(b.graph))}}fromQuad(b){return this.fromTerm(b)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultGraph=void 0;class W{constructor(){this.termType="DefaultGraph",this.value=""}equals(P){return!!P&&"DefaultGraph"===P.termType}}he.DefaultGraph=W,W.INSTANCE=new W},{}],60:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Literal=void 0;const W=Y("./NamedNode");class j{constructor(Q,z){this.termType="Literal",this.value=Q,"string"==typeof z?(this.language=z,this.datatype=j.RDF_LANGUAGE_STRING):z?(this.language="",this.datatype=z):(this.language="",this.datatype=j.XSD_STRING)}equals(Q){return!!Q&&"Literal"===Q.termType&&Q.value===this.value&&Q.language===this.language&&Q.datatype.equals(this.datatype)}}he.Literal=j,j.RDF_LANGUAGE_STRING=new W.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),j.XSD_STRING=new W.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.NamedNode=void 0;he.NamedNode=class{constructor(P){this.termType="NamedNode",this.value=P}equals(P){return!!P&&"NamedNode"===P.termType&&P.value===this.value}}},{}],62:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Quad=void 0;he.Quad=class{constructor(P,Q,z,v){this.termType="Quad",this.value="",this.subject=P,this.predicate=Q,this.object=z,this.graph=v}equals(P){return!!P&&("Quad"===P.termType||!P.termType)&&this.subject.equals(P.subject)&&this.predicate.equals(P.predicate)&&this.object.equals(P.object)&&this.graph.equals(P.graph)}}},{}],63:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Variable=void 0;he.Variable=class{constructor(P){this.termType="Variable",this.value=P}equals(P){return!!P&&"Variable"===P.termType&&P.value===this.value}}},{}],64:[function(Y,Se,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(P,Q,z,v){void 0===v&&(v=z),Object.defineProperty(P,v,{enumerable:!0,get:function(){return Q[z]}})}:function(P,Q,z,v){void 0===v&&(v=z),P[v]=Q[z]}),j=this&&this.__exportStar||function(P,Q){for(var z in P)"default"!==z&&!Object.prototype.hasOwnProperty.call(Q,z)&&W(Q,P,z)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/RdfXmlParser"),he)},{"./lib/RdfXmlParser":66}],65:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseError=void 0;class W extends Error{constructor(P,Q){const z=P.saxStream._parser;super(P.trackPosition?`Line ${z.line+1} column ${z.column+1}: ${Q}`:Q)}}he.ParseError=W},{}],66:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseType=he.RdfXmlParser=void 0;const W=Y("relative-to-absolute-iri"),j=Y("sax"),P=Y("stream"),Q=Y("./ParseError"),z=Y("rdf-data-factory");class v extends P.Transform{constructor(A){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},A&&(Object.assign(this,A),this.options=A),this.dataFactory||(this.dataFactory=new z.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=j.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(A,b){const y={};let S=!1;for(const V in A.attributes)V.startsWith("xmlns")&&(5===V.length?(S=!0,y[""]=A.attributes[V]):":"===V.charAt(5)&&(S=!0,y[V.substr(6)]=A.attributes[V]));const T=b&&b.ns?b.ns:[v.DEFAULT_NS];return S?T.concat([y]):T}static expandPrefixedTerm(A,b,y){const S=A.indexOf(":");let T,V;S>=0?(T=A.substr(0,S),V=A.substr(S+1)):(T="",V=A);let R=null,K=null;for(let ce=b.length-1;ce>=0;ce--){const D=b[ce][T];if(D){R=D;break}K||(K=b[ce][""])}if(!R){if(T&&"xmlns"!==T)throw new Q.ParseError(y,`The prefix '${T}' in term '${A}' was not bound.`);R=K||""}return{prefix:T,local:V,uri:R}}static isValidIri(A){return v.IRI_REGEX.test(A)}import(A){const b=new P.PassThrough({readableObjectMode:!0});A.on("error",S=>y.emit("error",S)),A.on("data",S=>b.push(S)),A.on("end",()=>b.push(null));const y=b.pipe(new v(this.options));return y}_transform(A,b,y){try{this.saxStream.write(A,b)}catch(S){return y(S)}y()}newParseError(A){return new Q.ParseError(this,A)}valueToUri(A,b){return this.uriToNamedNode(W.resolve(A,b.baseIRI))}uriToNamedNode(A){if(!v.isValidIri(A))throw this.newParseError(`Invalid URI: ${A}`);return this.dataFactory.namedNode(A)}validateNcname(A){if(!v.NCNAME_MATCHER.test(A))throw this.newParseError(`Not a valid NCName: ${A}`)}attachSaxListeners(){this.saxStream.on("error",A=>this.emit("error",A)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(A){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=x.RESOURCE;if(b&&(b.hadChildren=!0,y=b.childrenParseType),b&&b.childrenStringTags){const T=A.name;let V="";for(const D in A.attributes)V+=` ${D}="${A.attributes[D]}"`;b.childrenStringTags.push(`<${T}${V}>`);const ce={childrenStringTags:b.childrenStringTags};return ce.childrenStringEmitClosingTag=`</${T}>`,void this.activeTagStack.push(ce)}const S={};b?(S.language=b.language,S.baseIRI=b.baseIRI):S.baseIRI=this.baseIRI,this.activeTagStack.push(S),S.ns=v.parseNamespace(A,b),y===x.RESOURCE?this.onTagResource(A,S,b,!b):this.onTagProperty(A,S,b)}onTagResource(A,b,y,S){const T=v.expandPrefixedTerm(A.name,b.ns,this);b.childrenParseType=x.PROPERTY;let V=!0;if(T.uri===v.RDF){if(!S&&v.FORBIDDEN_NODE_ELEMENTS.indexOf(T.local)>=0)throw this.newParseError(`Illegal node element name: ${T.local}`);switch(T.local){case"RDF":b.childrenParseType=x.RESOURCE;case"Description":V=!1}}const R=[],K=[];let ce=null,D=!1,I=!1,X=null;for(const E in A.attributes){const $=A.attributes[E],Z=v.expandPrefixedTerm(E,b.ns,this);if(y&&Z.uri===v.RDF)switch(Z.local){case"about":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ce} where found.`);ce=$;continue;case"ID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ce} where found.`);this.validateNcname($),ce="#"+$,D=!0;continue;case"nodeID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ce} where found.`);this.validateNcname($),ce=$,I=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":X=$;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Z.uri===v.XML){if("lang"===Z.local){b.language=""===$?null:$.toLowerCase();continue}if("base"===Z.local){b.baseIRI=W.resolve($,b.baseIRI);continue}}"xml"!==Z.prefix&&Z.uri&&(R.push(this.uriToNamedNode(Z.uri+Z.local)),K.push($))}if(null!==ce&&(b.subject=I?this.dataFactory.blankNode(ce):this.valueToUri(ce,b),D&&this.claimNodeId(b.subject)),b.subject||(b.subject=this.dataFactory.blankNode()),V){const E=this.uriToNamedNode(T.uri+T.local);this.emitTriple(b.subject,this.dataFactory.namedNode(v.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(v.RDF+"first"),b.subject,b.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(v.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,b.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(b.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<R.length;E++){const $=this.dataFactory.literal(K[E],b.datatype||b.language);this.emitTriple(b.subject,R[E],$,y.reifiedStatementId)}X&&this.emitTriple(b.subject,this.dataFactory.namedNode(v.RDF+"type"),this.uriToNamedNode(X),null)}}onTagProperty(A,b,y){const S=v.expandPrefixedTerm(A.name,b.ns,this);if(b.childrenParseType=x.RESOURCE,b.subject=y.subject,S.uri===v.RDF&&"li"===S.local?(y.listItemCounter||(y.listItemCounter=1),b.predicate=this.uriToNamedNode(S.uri+"_"+y.listItemCounter++)):b.predicate=this.uriToNamedNode(S.uri+S.local),S.uri===v.RDF&&v.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(S.local)>=0)throw this.newParseError(`Illegal property element name: ${S.local}`);b.predicateSubPredicates=[],b.predicateSubObjects=[];let T=!1,V=!1,R=null,K=!0;const ce=[],D=[];for(const I in A.attributes){const X=A.attributes[I],E=v.expandPrefixedTerm(I,b.ns,this);if(E.uri===v.RDF)switch(E.local){case"resource":if(R)throw this.newParseError(`Found both rdf:resource (${X}) and rdf:nodeID (${R}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${X})`);b.hadChildren=!0,R=X,K=!1;continue;case"datatype":if(V)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${X})`);b.datatype=this.valueToUri(X,b);continue;case"nodeID":if(V)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${X}).`);if(b.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${X})`);this.validateNcname(X),b.hadChildren=!0,R=X,K=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(V)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(b.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${b.datatype.value})`);if(R)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${R})`);if("Resource"===X){T=!0,b.childrenParseType=x.PROPERTY;const $=this.dataFactory.blankNode();this.emitTriple(b.subject,b.predicate,$,b.reifiedStatementId),b.subject=$,b.predicate=null}else"Collection"===X?(T=!0,b.hadChildren=!0,b.childrenCollectionSubject=b.subject,b.childrenCollectionPredicate=b.predicate,K=!1):"Literal"===X&&(T=!0,b.childrenTagsToString=!0,b.childrenStringTags=[]);continue;case"ID":this.validateNcname(X),b.reifiedStatementId=this.valueToUri("#"+X,b),this.claimNodeId(b.reifiedStatementId);continue}else if(E.uri===v.XML&&"lang"===E.local){b.language=""===X?null:X.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(T||b.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${X}`);b.hadChildren=!0,V=!0,ce.push(this.uriToNamedNode(E.uri+E.local)),D.push(this.dataFactory.literal(X,b.datatype||b.language))}}if(null!==R){const I=b.subject;b.subject=K?this.dataFactory.blankNode(R):this.valueToUri(R,b),this.emitTriple(I,b.predicate,b.subject,b.reifiedStatementId);for(let X=0;X<ce.length;X++)this.emitTriple(b.subject,ce[X],D[X],null);b.predicateEmitted=!0}else K&&(b.predicateSubPredicates=ce,b.predicateSubObjects=D,b.predicateEmitted=!1)}emitTriple(A,b,y,S){this.push(this.dataFactory.quad(A,b,y,this.defaultGraph)),S&&(this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"type"),this.dataFactory.namedNode(v.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"subject"),A,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"predicate"),b,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"object"),y,this.defaultGraph)))}claimNodeId(A){if(!this.allowDuplicateRdfIds){if(this.nodeIds[A.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${A.value}'.`);this.nodeIds[A.value]=!0}}onText(A){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;b&&(b.childrenStringTags?b.childrenStringTags.push(A):b.predicate&&(b.text=A))}onCloseTag(){const A=this.activeTagStack.pop();if(A.childrenStringEmitClosingTag&&A.childrenStringTags.push(A.childrenStringEmitClosingTag),A.childrenTagsToString&&(A.datatype=this.dataFactory.namedNode(v.RDF+"XMLLiteral"),A.text=A.childrenStringTags.join(""),A.hadChildren=!1),A.childrenCollectionSubject)this.emitTriple(A.childrenCollectionSubject,A.childrenCollectionPredicate,this.dataFactory.namedNode(v.RDF+"nil"),A.reifiedStatementId);else if(A.predicate)if(A.hadChildren||A.childrenParseType===x.PROPERTY){if(!A.predicateEmitted){const b=this.dataFactory.blankNode();this.emitTriple(A.subject,A.predicate,b,A.reifiedStatementId);for(let y=0;y<A.predicateSubPredicates.length;y++)this.emitTriple(b,A.predicateSubPredicates[y],A.predicateSubObjects[y],null)}}else this.emitTriple(A.subject,A.predicate,this.dataFactory.literal(A.text||"",A.datatype||A.language),A.reifiedStatementId)}onDoctype(A){A.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(b,y,S)=>(this.saxStream._parser.ENTITIES[y]=S,""))}}var x,O;he.RdfXmlParser=v,v.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,v.MIME_TYPE="application/rdf+xml",v.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",v.XML="http://www.w3.org/XML/1998/namespace",v.XMLNS="http://www.w3.org/2000/xmlns/",v.DEFAULT_NS={xml:v.XML},v.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],v.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],v.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(O=x=he.ParseType||(he.ParseType={}))[O.RESOURCE=0]="RESOURCE",O[O.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(Y,Se,he){"use strict";var j={};function P(O,A,b){b||(b=Error);var S=function(T){function V(R,K,ce){return T.call(this,function(T,V,R){return"string"==typeof A?A:A(T,V,R)}(R,K,ce))||this}return function(O,A){O.prototype=Object.create(A.prototype),O.prototype.constructor=O,O.__proto__=A}(V,T),V}(b);S.prototype.name=b.name,S.prototype.code=O,j[O]=S}function Q(O,A){if(Array.isArray(O)){var b=O.length;return O=O.map(function(y){return String(y)}),b>2?"one of ".concat(A," ").concat(O.slice(0,b-1).join(", "),", or ")+O[b-1]:2===b?"one of ".concat(A," ").concat(O[0]," or ").concat(O[1]):"of ".concat(A," ").concat(O[0])}return"of ".concat(A," ").concat(String(O))}P("ERR_INVALID_OPT_VALUE",function(O,A){return'The value "'+A+'" is invalid for option "'+O+'"'},TypeError),P("ERR_INVALID_ARG_TYPE",function(O,A,b){var y,S;if("string"==typeof A&&function(O,A,b){return O.substr(!b||b<0?0:+b,A.length)===A}(A,"not ")?(y="must not be",A=A.replace(/^not /,"")):y="must be",function(O,A,b){return(void 0===b||b>O.length)&&(b=O.length),O.substring(b-A.length,b)===A}(O," argument"))S="The ".concat(O," ").concat(y," ").concat(Q(A,"type"));else{var T=function(O,A,b){return"number"!=typeof b&&(b=0),!(b+A.length>O.length)&&-1!==O.indexOf(A,b)}(O,".")?"property":"argument";S='The "'.concat(O,'" ').concat(T," ").concat(y," ").concat(Q(A,"type"))}return S+". Received type ".concat(typeof b)},TypeError),P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),P("ERR_METHOD_NOT_IMPLEMENTED",function(O){return"The "+O+" method is not implemented"}),P("ERR_STREAM_PREMATURE_CLOSE","Premature close"),P("ERR_STREAM_DESTROYED",function(O){return"Cannot call "+O+" after a stream was destroyed"}),P("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),P("ERR_STREAM_WRITE_AFTER_END","write after end"),P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),P("ERR_UNKNOWN_ENCODING",function(O){return"Unknown encoding: "+O},TypeError),P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Se.exports.codes=j},{}],68:[function(Y,Se,he){(function(W){(function(){"use strict";var j=Object.keys||function(y){var S=[];for(var T in y)S.push(T);return S};Se.exports=O;var P=Y("./_stream_readable"),Q=Y("./_stream_writable");Y("inherits")(O,P);for(var z=j(Q.prototype),v=0;v<z.length;v++){var x=z[v];O.prototype[x]||(O.prototype[x]=Q.prototype[x])}function O(y){if(!(this instanceof O))return new O(y);P.call(this,y),Q.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",A)))}function A(){this._writableState.ended||W.nextTick(b,this)}function b(y){y.end()}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,Y("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(Y,Se,he){"use strict";Se.exports=j;var W=Y("./_stream_transform");function j(P){if(!(this instanceof j))return new j(P);W.call(this,P)}Y("inherits")(j,W),j.prototype._transform=function(P,Q,z){z(null,P)}},{"./_stream_transform":71,inherits:10}],70:[function(Y,Se,he){(function(W,j){(function(){"use strict";var P;Se.exports=ne,ne.ReadableState=me,Y("events");var z=function(L,N){return L.listeners(N).length},v=Y("./internal/streams/stream"),x=Y("buffer").Buffer,O=j.Uint8Array||function(){};var S,y=Y("util");S=y&&y.debuglog?y.debuglog("stream"):function(){};var $,Z,oe,T=Y("./internal/streams/buffer_list"),V=Y("./internal/streams/destroy"),K=Y("./internal/streams/state").getHighWaterMark,ce=Y("../errors").codes,D=ce.ERR_INVALID_ARG_TYPE,I=ce.ERR_STREAM_PUSH_AFTER_EOF,X=ce.ERR_METHOD_NOT_IMPLEMENTED,E=ce.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Y("inherits")(ne,v);var se=V.errorOrDestroy,te=["error","close","destroy","pause","resume"];function me(ve,L,N){P=P||Y("./_stream_duplex"),"boolean"!=typeof N&&(N=L instanceof P),this.objectMode=!!(ve=ve||{}).objectMode,N&&(this.objectMode=this.objectMode||!!ve.readableObjectMode),this.highWaterMark=K(this,ve,"readableHighWaterMark",N),this.buffer=new T,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==ve.emitClose,this.autoDestroy=!!ve.autoDestroy,this.destroyed=!1,this.defaultEncoding=ve.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ve.encoding&&($||($=Y("string_decoder/").StringDecoder),this.decoder=new $(ve.encoding),this.encoding=ve.encoding)}function ne(ve){if(P=P||Y("./_stream_duplex"),!(this instanceof ne))return new ne(ve);this._readableState=new me(ve,this,this instanceof P),this.readable=!0,ve&&("function"==typeof ve.read&&(this._read=ve.read),"function"==typeof ve.destroy&&(this._destroy=ve.destroy)),v.call(this)}function _e(ve,L,N,B,Re){S("readableAddChunk",L);var St,Qe=ve._readableState;if(null===L)Qe.reading=!1,function(ve,L){if(S("onEofChunk"),!L.ended){if(L.decoder){var N=L.decoder.end();N&&N.length&&(L.buffer.push(N),L.length+=L.objectMode?1:N.length)}L.ended=!0,L.sync?Ue(ve):(L.needReadable=!1,L.emittedReadable||(L.emittedReadable=!0,ke(ve)))}}(ve,Qe);else if(Re||(St=function(ve,L){var N;return!function(ve){return x.isBuffer(ve)||ve instanceof O}(L)&&"string"!=typeof L&&void 0!==L&&!ve.objectMode&&(N=new D("chunk",["string","Buffer","Uint8Array"],L)),N}(Qe,L)),St)se(ve,St);else if(Qe.objectMode||L&&L.length>0)if("string"!=typeof L&&!Qe.objectMode&&Object.getPrototypeOf(L)!==x.prototype&&(L=function(ve){return x.from(ve)}(L)),B)Qe.endEmitted?se(ve,new E):Ie(ve,Qe,L,!0);else if(Qe.ended)se(ve,new I);else{if(Qe.destroyed)return!1;Qe.reading=!1,Qe.decoder&&!N?(L=Qe.decoder.write(L),Qe.objectMode||0!==L.length?Ie(ve,Qe,L,!1):Ke(ve,Qe)):Ie(ve,Qe,L,!1)}else B||(Qe.reading=!1,Ke(ve,Qe));return!Qe.ended&&(Qe.length<Qe.highWaterMark||0===Qe.length)}function Ie(ve,L,N,B){L.flowing&&0===L.length&&!L.sync?(L.awaitDrain=0,ve.emit("data",N)):(L.length+=L.objectMode?1:N.length,B?L.buffer.unshift(N):L.buffer.push(N),L.needReadable&&Ue(ve)),Ke(ve,L)}Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(L){!this._readableState||(this._readableState.destroyed=L)}}),ne.prototype.destroy=V.destroy,ne.prototype._undestroy=V.undestroy,ne.prototype._destroy=function(ve,L){L(ve)},ne.prototype.push=function(ve,L){var B,N=this._readableState;return N.objectMode?B=!0:"string"==typeof ve&&((L=L||N.defaultEncoding)!==N.encoding&&(ve=x.from(ve,L),L=""),B=!0),_e(this,ve,L,!1,B)},ne.prototype.unshift=function(ve){return _e(this,ve,null,!0,!1)},ne.prototype.isPaused=function(){return!1===this._readableState.flowing},ne.prototype.setEncoding=function(ve){$||($=Y("string_decoder/").StringDecoder);var L=new $(ve);this._readableState.decoder=L,this._readableState.encoding=this._readableState.decoder.encoding;for(var N=this._readableState.buffer.head,B="";null!==N;)B+=L.write(N.data),N=N.next;return this._readableState.buffer.clear(),""!==B&&this._readableState.buffer.push(B),this._readableState.length=B.length,this};var st=1073741824;function tt(ve,L){return ve<=0||0===L.length&&L.ended?0:L.objectMode?1:ve!=ve?L.flowing&&L.length?L.buffer.head.data.length:L.length:(ve>L.highWaterMark&&(L.highWaterMark=function(ve){return ve>=st?ve=st:(ve--,ve|=ve>>>1,ve|=ve>>>2,ve|=ve>>>4,ve|=ve>>>8,ve|=ve>>>16,ve++),ve}(ve)),ve<=L.length?ve:L.ended?L.length:(L.needReadable=!0,0))}function Ue(ve){var L=ve._readableState;S("emitReadable",L.needReadable,L.emittedReadable),L.needReadable=!1,L.emittedReadable||(S("emitReadable",L.flowing),L.emittedReadable=!0,W.nextTick(ke,ve))}function ke(ve){var L=ve._readableState;S("emitReadable_",L.destroyed,L.length,L.ended),!L.destroyed&&(L.length||L.ended)&&(ve.emit("readable"),L.emittedReadable=!1),L.needReadable=!L.flowing&&!L.ended&&L.length<=L.highWaterMark,pe(ve)}function Ke(ve,L){L.readingMore||(L.readingMore=!0,W.nextTick(Me,ve,L))}function Me(ve,L){for(;!L.reading&&!L.ended&&(L.length<L.highWaterMark||L.flowing&&0===L.length);){var N=L.length;if(S("maybeReadMore read 0"),ve.read(0),N===L.length)break}L.readingMore=!1}function $e(ve){var L=ve._readableState;L.readableListening=ve.listenerCount("readable")>0,L.resumeScheduled&&!L.paused?L.flowing=!0:ve.listenerCount("data")>0&&ve.resume()}function Ne(ve){S("readable nexttick read 0"),ve.read(0)}function G(ve,L){S("resume",L.reading),L.reading||ve.read(0),L.resumeScheduled=!1,ve.emit("resume"),pe(ve),L.flowing&&!L.reading&&ve.read(0)}function pe(ve){var L=ve._readableState;for(S("flow",L.flowing);L.flowing&&null!==ve.read(););}function ue(ve,L){return 0===L.length?null:(L.objectMode?N=L.buffer.shift():!ve||ve>=L.length?(N=L.decoder?L.buffer.join(""):1===L.buffer.length?L.buffer.first():L.buffer.concat(L.length),L.buffer.clear()):N=L.buffer.consume(ve,L.decoder),N);var N}function je(ve){var L=ve._readableState;S("endReadable",L.endEmitted),L.endEmitted||(L.ended=!0,W.nextTick(_t,L,ve))}function _t(ve,L){if(S("endReadableNT",ve.endEmitted,ve.length),!ve.endEmitted&&0===ve.length&&(ve.endEmitted=!0,L.readable=!1,L.emit("end"),ve.autoDestroy)){var N=L._writableState;(!N||N.autoDestroy&&N.finished)&&L.destroy()}}function pt(ve,L){for(var N=0,B=ve.length;N<B;N++)if(ve[N]===L)return N;return-1}ne.prototype.read=function(ve){S("read",ve),ve=parseInt(ve,10);var L=this._readableState,N=ve;if(0!==ve&&(L.emittedReadable=!1),0===ve&&L.needReadable&&((0!==L.highWaterMark?L.length>=L.highWaterMark:L.length>0)||L.ended))return S("read: emitReadable",L.length,L.ended),0===L.length&&L.ended?je(this):Ue(this),null;if(0===(ve=tt(ve,L))&&L.ended)return 0===L.length&&je(this),null;var Re,B=L.needReadable;return S("need readable",B),(0===L.length||L.length-ve<L.highWaterMark)&&S("length less than watermark",B=!0),L.ended||L.reading?S("reading or ended",B=!1):B&&(S("do read"),L.reading=!0,L.sync=!0,0===L.length&&(L.needReadable=!0),this._read(L.highWaterMark),L.sync=!1,L.reading||(ve=tt(N,L))),null===(Re=ve>0?ue(ve,L):null)?(L.needReadable=L.length<=L.highWaterMark,ve=0):(L.length-=ve,L.awaitDrain=0),0===L.length&&(L.ended||(L.needReadable=!0),N!==ve&&L.ended&&je(this)),null!==Re&&this.emit("data",Re),Re},ne.prototype._read=function(ve){se(this,new X("_read()"))},ne.prototype.pipe=function(ve,L){var N=this,B=this._readableState;switch(B.pipesCount){case 0:B.pipes=ve;break;case 1:B.pipes=[B.pipes,ve];break;default:B.pipes.push(ve)}B.pipesCount+=1,S("pipe count=%d opts=%j",B.pipesCount,L);var Qe=L&&!1===L.end||ve===W.stdout||ve===W.stderr?gs:Nt;function St(Bs,Xr){S("onunpipe"),Bs===N&&Xr&&!1===Xr.hasUnpiped&&(Xr.hasUnpiped=!0,S("cleanup"),ve.removeListener("close",Kr),ve.removeListener("finish",Ls),ve.removeListener("drain",On),ve.removeListener("error",wi),ve.removeListener("unpipe",St),N.removeListener("end",Nt),N.removeListener("end",gs),N.removeListener("data",Ti),kn=!0,B.awaitDrain&&(!ve._writableState||ve._writableState.needDrain)&&On())}function Nt(){S("onend"),ve.end()}B.endEmitted?W.nextTick(Qe):N.once("end",Qe),ve.on("unpipe",St);var On=function(ve){return function(){var N=ve._readableState;S("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,0===N.awaitDrain&&z(ve,"data")&&(N.flowing=!0,pe(ve))}}(N);ve.on("drain",On);var kn=!1;function Ti(Bs){S("ondata");var Xr=ve.write(Bs);S("dest.write",Xr),!1===Xr&&((1===B.pipesCount&&B.pipes===ve||B.pipesCount>1&&-1!==pt(B.pipes,ve))&&!kn&&(S("false write response, pause",B.awaitDrain),B.awaitDrain++),N.pause())}function wi(Bs){S("onerror",Bs),gs(),ve.removeListener("error",wi),0===z(ve,"error")&&se(ve,Bs)}function Kr(){ve.removeListener("finish",Ls),gs()}function Ls(){S("onfinish"),ve.removeListener("close",Kr),gs()}function gs(){S("unpipe"),N.unpipe(ve)}return N.on("data",Ti),function(ve,L,N){if("function"==typeof ve.prependListener)return ve.prependListener(L,N);ve._events&&ve._events[L]?Array.isArray(ve._events[L])?ve._events[L].unshift(N):ve._events[L]=[N,ve._events[L]]:ve.on(L,N)}(ve,"error",wi),ve.once("close",Kr),ve.once("finish",Ls),ve.emit("pipe",N),B.flowing||(S("pipe resume"),N.resume()),ve},ne.prototype.unpipe=function(ve){var L=this._readableState,N={hasUnpiped:!1};if(0===L.pipesCount)return this;if(1===L.pipesCount)return ve&&ve!==L.pipes||(ve||(ve=L.pipes),L.pipes=null,L.pipesCount=0,L.flowing=!1,ve&&ve.emit("unpipe",this,N)),this;if(!ve){var B=L.pipes,Re=L.pipesCount;L.pipes=null,L.pipesCount=0,L.flowing=!1;for(var Qe=0;Qe<Re;Qe++)B[Qe].emit("unpipe",this,{hasUnpiped:!1});return this}var St=pt(L.pipes,ve);return-1===St||(L.pipes.splice(St,1),L.pipesCount-=1,1===L.pipesCount&&(L.pipes=L.pipes[0]),ve.emit("unpipe",this,N)),this},ne.prototype.addListener=ne.prototype.on=function(ve,L){var N=v.prototype.on.call(this,ve,L),B=this._readableState;return"data"===ve?(B.readableListening=this.listenerCount("readable")>0,!1!==B.flowing&&this.resume()):"readable"===ve&&!B.endEmitted&&!B.readableListening&&(B.readableListening=B.needReadable=!0,B.flowing=!1,B.emittedReadable=!1,S("on readable",B.length,B.reading),B.length?Ue(this):B.reading||W.nextTick(Ne,this)),N},ne.prototype.removeListener=function(ve,L){var N=v.prototype.removeListener.call(this,ve,L);return"readable"===ve&&W.nextTick($e,this),N},ne.prototype.removeAllListeners=function(ve){var L=v.prototype.removeAllListeners.apply(this,arguments);return("readable"===ve||void 0===ve)&&W.nextTick($e,this),L},ne.prototype.resume=function(){var ve=this._readableState;return ve.flowing||(S("resume"),ve.flowing=!ve.readableListening,function(ve,L){L.resumeScheduled||(L.resumeScheduled=!0,W.nextTick(G,ve,L))}(this,ve)),ve.paused=!1,this},ne.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},ne.prototype.wrap=function(ve){var L=this,N=this._readableState,B=!1;for(var Re in ve.on("end",function(){if(S("wrapped end"),N.decoder&&!N.ended){var St=N.decoder.end();St&&St.length&&L.push(St)}L.push(null)}),ve.on("data",function(St){S("wrapped data"),N.decoder&&(St=N.decoder.write(St)),N.objectMode&&null==St||!(N.objectMode||St&&St.length)||L.push(St)||(B=!0,ve.pause())}),ve)void 0===this[Re]&&"function"==typeof ve[Re]&&(this[Re]=function(Nt){return function(){return ve[Nt].apply(ve,arguments)}}(Re));for(var Qe=0;Qe<te.length;Qe++)ve.on(te[Qe],this.emit.bind(this,te[Qe]));return this._read=function(St){S("wrapped _read",St),B&&(B=!1,ve.resume())},this},"function"==typeof Symbol&&(ne.prototype[Symbol.asyncIterator]=function(){return void 0===Z&&(Z=Y("./internal/streams/async_iterator")),Z(this)}),Object.defineProperty(ne.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ne.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ne.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(L){this._readableState&&(this._readableState.flowing=L)}}),ne._fromList=ue,Object.defineProperty(ne.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(ne.from=function(ve,L){return void 0===oe&&(oe=Y("./internal/streams/from")),oe(ne,ve,L)})}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(Y,Se,he){"use strict";Se.exports=O;var W=Y("../errors").codes,j=W.ERR_METHOD_NOT_IMPLEMENTED,P=W.ERR_MULTIPLE_CALLBACK,Q=W.ERR_TRANSFORM_ALREADY_TRANSFORMING,z=W.ERR_TRANSFORM_WITH_LENGTH_0,v=Y("./_stream_duplex");function x(y,S){var T=this._transformState;T.transforming=!1;var V=T.writecb;if(null===V)return this.emit("error",new P);T.writechunk=null,T.writecb=null,null!=S&&this.push(S),V(y);var R=this._readableState;R.reading=!1,(R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}function O(y){if(!(this instanceof O))return new O(y);v.call(this,y),this._transformState={afterTransform:x.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",A)}function A(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?b(this,null,null):this._flush(function(S,T){b(y,S,T)})}function b(y,S,T){if(S)return y.emit("error",S);if(null!=T&&y.push(T),y._writableState.length)throw new z;if(y._transformState.transforming)throw new Q;return y.push(null)}Y("inherits")(O,v),O.prototype.push=function(y,S){return this._transformState.needTransform=!1,v.prototype.push.call(this,y,S)},O.prototype._transform=function(y,S,T){T(new j("_transform()"))},O.prototype._write=function(y,S,T){var V=this._transformState;if(V.writecb=T,V.writechunk=y,V.writeencoding=S,!V.transforming){var R=this._readableState;(V.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}},O.prototype._read=function(y){var S=this._transformState;null===S.writechunk||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},O.prototype._destroy=function(y,S){v.prototype._destroy.call(this,y,function(T){S(T)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(Y,Se,he){(function(W,j){(function(){"use strict";function Q(pe){var ue=this;this.next=null,this.entry=null,this.finish=function(){!function(pe,ue,je){var _t=pe.entry;for(pe.entry=null;_t;){var pt=_t.callback;ue.pendingcb--,pt(je),_t=_t.next}ue.corkedRequestsFree.next=pe}(ue,pe)}}var z;Se.exports=me,me.WritableState=te;var v={deprecate:Y("util-deprecate")},x=Y("./internal/streams/stream"),O=Y("buffer").Buffer,A=j.Uint8Array||function(){};var Ce,S=Y("./internal/streams/destroy"),V=Y("./internal/streams/state").getHighWaterMark,R=Y("../errors").codes,K=R.ERR_INVALID_ARG_TYPE,ce=R.ERR_METHOD_NOT_IMPLEMENTED,D=R.ERR_MULTIPLE_CALLBACK,I=R.ERR_STREAM_CANNOT_PIPE,X=R.ERR_STREAM_DESTROYED,E=R.ERR_STREAM_NULL_VALUES,$=R.ERR_STREAM_WRITE_AFTER_END,Z=R.ERR_UNKNOWN_ENCODING,oe=S.errorOrDestroy;function se(){}function te(pe,ue,je){z=z||Y("./_stream_duplex"),"boolean"!=typeof je&&(je=ue instanceof z),this.objectMode=!!(pe=pe||{}).objectMode,je&&(this.objectMode=this.objectMode||!!pe.writableObjectMode),this.highWaterMark=V(this,pe,"writableHighWaterMark",je),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===pe.decodeStrings),this.defaultEncoding=pe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){!function(pe,ue){var je=pe._writableState,_t=je.sync,pt=je.writecb;if("function"!=typeof pt)throw new D;if(function(pe){pe.writing=!1,pe.writecb=null,pe.length-=pe.writelen,pe.writelen=0}(je),ue)!function(pe,ue,je,_t,pt){--ue.pendingcb,je?(W.nextTick(pt,_t),W.nextTick(Ne,pe,ue),pe._writableState.errorEmitted=!0,oe(pe,_t)):(pt(_t),pe._writableState.errorEmitted=!0,oe(pe,_t),Ne(pe,ue))}(pe,je,_t,ue,pt);else{var ve=Me(je)||pe.destroyed;!ve&&!je.corked&&!je.bufferProcessing&&je.bufferedRequest&&Ke(pe,je),_t?W.nextTick(Ue,pe,je,ve,pt):Ue(pe,je,ve,pt)}}(ue,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==pe.emitClose,this.autoDestroy=!!pe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Q(this)}function me(pe){var ue=this instanceof(z=z||Y("./_stream_duplex"));if(!ue&&!Ce.call(me,this))return new me(pe);this._writableState=new te(pe,this,ue),this.writable=!0,pe&&("function"==typeof pe.write&&(this._write=pe.write),"function"==typeof pe.writev&&(this._writev=pe.writev),"function"==typeof pe.destroy&&(this._destroy=pe.destroy),"function"==typeof pe.final&&(this._final=pe.final)),x.call(this)}function Ge(pe,ue,je,_t,pt,ve){if(!je){var L=function(pe,ue,je){return!pe.objectMode&&!1!==pe.decodeStrings&&"string"==typeof ue&&(ue=O.from(ue,je)),ue}(ue,_t,pt);_t!==L&&(je=!0,pt="buffer",_t=L)}var N=ue.objectMode?1:_t.length;ue.length+=N;var B=ue.length<ue.highWaterMark;if(B||(ue.needDrain=!0),ue.writing||ue.corked){var Re=ue.lastBufferedRequest;ue.lastBufferedRequest={chunk:_t,encoding:pt,isBuf:je,callback:ve,next:null},Re?Re.next=ue.lastBufferedRequest:ue.bufferedRequest=ue.lastBufferedRequest,ue.bufferedRequestCount+=1}else st(pe,ue,!1,N,_t,pt,ve);return B}function st(pe,ue,je,_t,pt,ve,L){ue.writelen=_t,ue.writecb=L,ue.writing=!0,ue.sync=!0,ue.destroyed?ue.onwrite(new X("write")):je?pe._writev(pt,ue.onwrite):pe._write(pt,ve,ue.onwrite),ue.sync=!1}function Ue(pe,ue,je,_t){je||function(pe,ue){0===ue.length&&ue.needDrain&&(ue.needDrain=!1,pe.emit("drain"))}(pe,ue),ue.pendingcb--,_t(),Ne(pe,ue)}function Ke(pe,ue){ue.bufferProcessing=!0;var je=ue.bufferedRequest;if(pe._writev&&je&&je.next){var pt=new Array(ue.bufferedRequestCount),ve=ue.corkedRequestsFree;ve.entry=je;for(var L=0,N=!0;je;)pt[L]=je,je.isBuf||(N=!1),je=je.next,L+=1;pt.allBuffers=N,st(pe,ue,!0,ue.length,pt,"",ve.finish),ue.pendingcb++,ue.lastBufferedRequest=null,ve.next?(ue.corkedRequestsFree=ve.next,ve.next=null):ue.corkedRequestsFree=new Q(ue),ue.bufferedRequestCount=0}else{for(;je;){var B=je.chunk;if(st(pe,ue,!1,ue.objectMode?1:B.length,B,je.encoding,je.callback),je=je.next,ue.bufferedRequestCount--,ue.writing)break}null===je&&(ue.lastBufferedRequest=null)}ue.bufferedRequest=je,ue.bufferProcessing=!1}function Me(pe){return pe.ending&&0===pe.length&&null===pe.bufferedRequest&&!pe.finished&&!pe.writing}function Ve(pe,ue){pe._final(function(je){ue.pendingcb--,je&&oe(pe,je),ue.prefinished=!0,pe.emit("prefinish"),Ne(pe,ue)})}function Ne(pe,ue){var je=Me(ue);if(je&&(function(pe,ue){!ue.prefinished&&!ue.finalCalled&&("function"!=typeof pe._final||ue.destroyed?(ue.prefinished=!0,pe.emit("prefinish")):(ue.pendingcb++,ue.finalCalled=!0,W.nextTick(Ve,pe,ue)))}(pe,ue),0===ue.pendingcb&&(ue.finished=!0,pe.emit("finish"),ue.autoDestroy))){var _t=pe._readableState;(!_t||_t.autoDestroy&&_t.endEmitted)&&pe.destroy()}return je}Y("inherits")(me,x),te.prototype.getBuffer=function(){for(var ue=this.bufferedRequest,je=[];ue;)je.push(ue),ue=ue.next;return je},function(){try{Object.defineProperty(te.prototype,"buffer",{get:v.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(pe){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Ce=Function.prototype[Symbol.hasInstance],Object.defineProperty(me,Symbol.hasInstance,{value:function(ue){return!!Ce.call(this,ue)||this===me&&ue&&ue._writableState instanceof te}})):Ce=function(ue){return ue instanceof this},me.prototype.pipe=function(){oe(this,new I)},me.prototype.write=function(pe,ue,je){var _t=this._writableState,pt=!1,ve=!_t.objectMode&&function(pe){return O.isBuffer(pe)||pe instanceof A}(pe);return ve&&!O.isBuffer(pe)&&(pe=function(pe){return O.from(pe)}(pe)),"function"==typeof ue&&(je=ue,ue=null),ve?ue="buffer":ue||(ue=_t.defaultEncoding),"function"!=typeof je&&(je=se),_t.ending?function(pe,ue){var je=new $;oe(pe,je),W.nextTick(ue,je)}(this,je):(ve||function(pe,ue,je,_t){var pt;return null===je?pt=new E:"string"!=typeof je&&!ue.objectMode&&(pt=new K("chunk",["string","Buffer"],je)),!pt||(oe(pe,pt),W.nextTick(_t,pt),!1)}(this,_t,pe,je))&&(_t.pendingcb++,pt=Ge(this,_t,ve,pe,ue,je)),pt},me.prototype.cork=function(){this._writableState.corked++},me.prototype.uncork=function(){var pe=this._writableState;pe.corked&&(pe.corked--,!pe.writing&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&Ke(this,pe))},me.prototype.setDefaultEncoding=function(ue){if("string"==typeof ue&&(ue=ue.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ue+"").toLowerCase())>-1))throw new Z(ue);return this._writableState.defaultEncoding=ue,this},Object.defineProperty(me.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(me.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),me.prototype._write=function(pe,ue,je){je(new ce("_write()"))},me.prototype._writev=null,me.prototype.end=function(pe,ue,je){var _t=this._writableState;return"function"==typeof pe?(je=pe,pe=null,ue=null):"function"==typeof ue&&(je=ue,ue=null),null!=pe&&this.write(pe,ue),_t.corked&&(_t.corked=1,this.uncork()),_t.ending||function(pe,ue,je){ue.ending=!0,Ne(pe,ue),je&&(ue.finished?W.nextTick(je):pe.once("finish",je)),ue.ended=!0,pe.writable=!1}(this,_t,je),this},Object.defineProperty(me.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(me.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(ue){!this._writableState||(this._writableState.destroyed=ue)}}),me.prototype.destroy=S.destroy,me.prototype._undestroy=S.undestroy,me.prototype._destroy=function(pe,ue){ue(pe)}}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(Y,Se,he){(function(W){(function(){"use strict";var j;function P(I,X,E){return X in I?Object.defineProperty(I,X,{value:E,enumerable:!0,configurable:!0,writable:!0}):I[X]=E,I}var Q=Y("./end-of-stream"),z=Symbol("lastResolve"),v=Symbol("lastReject"),x=Symbol("error"),O=Symbol("ended"),A=Symbol("lastPromise"),b=Symbol("handlePromise"),y=Symbol("stream");function S(I,X){return{value:I,done:X}}function T(I){var X=I[z];if(null!==X){var E=I[y].read();null!==E&&(I[A]=null,I[z]=null,I[v]=null,X(S(E,!1)))}}function V(I){W.nextTick(T,I)}var K=Object.getPrototypeOf(function(){}),ce=Object.setPrototypeOf((P(j={get stream(){return this[y]},next:function(){var X=this,E=this[x];if(null!==E)return Promise.reject(E);if(this[O])return Promise.resolve(S(void 0,!0));if(this[y].destroyed)return new Promise(function(se,te){W.nextTick(function(){X[x]?te(X[x]):se(S(void 0,!0))})});var Z,$=this[A];if($)Z=new Promise(function(I,X){return function(E,$){I.then(function(){X[O]?E(S(void 0,!0)):X[b](E,$)},$)}}($,this));else{var oe=this[y].read();if(null!==oe)return Promise.resolve(S(oe,!1));Z=new Promise(this[b])}return this[A]=Z,Z}},Symbol.asyncIterator,function(){return this}),P(j,"return",function(){var X=this;return new Promise(function(E,$){X[y].destroy(null,function(Z){Z?$(Z):E(S(void 0,!0))})})}),j),K);Se.exports=function(X){var E,$=Object.create(ce,(P(E={},y,{value:X,writable:!0}),P(E,z,{value:null,writable:!0}),P(E,v,{value:null,writable:!0}),P(E,x,{value:null,writable:!0}),P(E,O,{value:X._readableState.endEmitted,writable:!0}),P(E,b,{value:function(oe,se){var te=$[y].read();te?($[A]=null,$[z]=null,$[v]=null,oe(S(te,!1))):($[z]=oe,$[v]=se)},writable:!0}),E));return $[A]=null,Q(X,function(Z){if(Z&&"ERR_STREAM_PREMATURE_CLOSE"!==Z.code){var oe=$[v];return null!==oe&&($[A]=null,$[z]=null,$[v]=null,oe(Z)),void($[x]=Z)}var se=$[z];null!==se&&($[A]=null,$[z]=null,$[v]=null,se(S(void 0,!0))),$[O]=!0}),X.on("readable",V.bind(null,$)),$}}).call(this)}).call(this,Y("_process"))},{"./end-of-stream":76,_process:44}],74:[function(Y,Se,he){"use strict";function W(T,V){var R=Object.keys(T);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(T);V&&(K=K.filter(function(ce){return Object.getOwnPropertyDescriptor(T,ce).enumerable})),R.push.apply(R,K)}return R}function P(T,V,R){return V in T?Object.defineProperty(T,V,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[V]=R,T}function z(T,V){for(var R=0;R<V.length;R++){var K=V[R];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(T,K.key,K)}}var O=Y("buffer").Buffer,b=Y("util").inspect,y=b&&b.custom||"inspect";function S(T,V,R){O.prototype.copy.call(T,V,R)}Se.exports=function(){function T(){(function(T,V){if(!(T instanceof V))throw new TypeError("Cannot call a class as a function")})(this,T),this.head=null,this.tail=null,this.length=0}return function(T,V,R){V&&z(T.prototype,V),R&&z(T,R)}(T,[{key:"push",value:function(R){var K={data:R,next:null};this.length>0?this.tail.next=K:this.head=K,this.tail=K,++this.length}},{key:"unshift",value:function(R){var K={data:R,next:this.head};0===this.length&&(this.tail=K),this.head=K,++this.length}},{key:"shift",value:function(){if(0!==this.length){var R=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,R}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(R){if(0===this.length)return"";for(var K=this.head,ce=""+K.data;K=K.next;)ce+=R+K.data;return ce}},{key:"concat",value:function(R){if(0===this.length)return O.alloc(0);for(var K=O.allocUnsafe(R>>>0),ce=this.head,D=0;ce;)S(ce.data,K,D),D+=ce.data.length,ce=ce.next;return K}},{key:"consume",value:function(R,K){var ce;return R<this.head.data.length?(ce=this.head.data.slice(0,R),this.head.data=this.head.data.slice(R)):ce=R===this.head.data.length?this.shift():K?this._getString(R):this._getBuffer(R),ce}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(R){var K=this.head,ce=1,D=K.data;for(R-=D.length;K=K.next;){var I=K.data,X=R>I.length?I.length:R;if(D+=X===I.length?I:I.slice(0,R),0==(R-=X)){X===I.length?(++ce,this.head=K.next?K.next:this.tail=null):(this.head=K,K.data=I.slice(X));break}++ce}return this.length-=ce,D}},{key:"_getBuffer",value:function(R){var K=O.allocUnsafe(R),ce=this.head,D=1;for(ce.data.copy(K),R-=ce.data.length;ce=ce.next;){var I=ce.data,X=R>I.length?I.length:R;if(I.copy(K,K.length-R,0,X),0==(R-=X)){X===I.length?(++D,this.head=ce.next?ce.next:this.tail=null):(this.head=ce,ce.data=I.slice(X));break}++D}return this.length-=D,K}},{key:y,value:function(R,K){return b(this,function(T){for(var V=1;V<arguments.length;V++){var R=null!=arguments[V]?arguments[V]:{};V%2?W(Object(R),!0).forEach(function(K){P(T,K,R[K])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(R)):W(Object(R)).forEach(function(K){Object.defineProperty(T,K,Object.getOwnPropertyDescriptor(R,K))})}return T}({},K,{depth:0,customInspect:!1}))}}]),T}()},{buffer:6,util:3}],75:[function(Y,Se,he){(function(W){(function(){"use strict";function P(O,A){v(O,A),Q(O)}function Q(O){O._writableState&&!O._writableState.emitClose||O._readableState&&!O._readableState.emitClose||O.emit("close")}function v(O,A){O.emit("error",A)}Se.exports={destroy:function(O,A){var b=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(A?A(O):O&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,W.nextTick(v,this,O)):W.nextTick(v,this,O)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(O||null,function(T){!A&&T?b._writableState?b._writableState.errorEmitted?W.nextTick(Q,b):(b._writableState.errorEmitted=!0,W.nextTick(P,b,T)):W.nextTick(P,b,T):A?(W.nextTick(Q,b),A(T)):W.nextTick(Q,b)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(O,A){var b=O._readableState,y=O._writableState;b&&b.autoDestroy||y&&y.autoDestroy?O.destroy(A):O.emit("error",A)}}}).call(this)}).call(this,Y("_process"))},{_process:44}],76:[function(Y,Se,he){"use strict";var W=Y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function P(){}Se.exports=function z(v,x,O){if("function"==typeof x)return z(v,null,x);x||(x={}),O=function(v){var x=!1;return function(){if(!x){x=!0;for(var O=arguments.length,A=new Array(O),b=0;b<O;b++)A[b]=arguments[b];v.apply(this,A)}}}(O||P);var A=x.readable||!1!==x.readable&&v.readable,b=x.writable||!1!==x.writable&&v.writable,y=function(){v.writable||T()},S=v._writableState&&v._writableState.finished,T=function(){b=!1,S=!0,A||O.call(v)},V=v._readableState&&v._readableState.endEmitted,R=function(){A=!1,V=!0,b||O.call(v)},K=function(X){O.call(v,X)},ce=function(){var X;return A&&!V?((!v._readableState||!v._readableState.ended)&&(X=new W),O.call(v,X)):b&&!S?((!v._writableState||!v._writableState.ended)&&(X=new W),O.call(v,X)):void 0},D=function(){v.req.on("finish",T)};return function(v){return v.setHeader&&"function"==typeof v.abort}(v)?(v.on("complete",T),v.on("abort",ce),v.req?D():v.on("request",D)):b&&!v._writableState&&(v.on("end",y),v.on("close",y)),v.on("end",R),v.on("finish",T),!1!==x.error&&v.on("error",K),v.on("close",ce),function(){v.removeListener("complete",T),v.removeListener("abort",ce),v.removeListener("request",D),v.req&&v.req.removeListener("finish",T),v.removeListener("end",y),v.removeListener("close",y),v.removeListener("finish",T),v.removeListener("end",R),v.removeListener("error",K),v.removeListener("close",ce)}}},{"../../../errors":67}],77:[function(Y,Se,he){Se.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(Y,Se,he){"use strict";var W;var P=Y("../../../errors").codes,Q=P.ERR_MISSING_ARGS,z=P.ERR_STREAM_DESTROYED;function v(T){if(T)throw T}function O(T,V,R,K){K=function(T){var V=!1;return function(){V||(V=!0,T.apply(void 0,arguments))}}(K);var ce=!1;T.on("close",function(){ce=!0}),void 0===W&&(W=Y("./end-of-stream")),W(T,{readable:V,writable:R},function(I){if(I)return K(I);ce=!0,K()});var D=!1;return function(I){if(!ce&&!D){if(D=!0,function(T){return T.setHeader&&"function"==typeof T.abort}(T))return T.abort();if("function"==typeof T.destroy)return T.destroy();K(I||new z("pipe"))}}}function A(T){T()}function b(T,V){return T.pipe(V)}function y(T){return T.length&&"function"==typeof T[T.length-1]?T.pop():v}Se.exports=function(){for(var T=arguments.length,V=new Array(T),R=0;R<T;R++)V[R]=arguments[R];var K=y(V);if(Array.isArray(V[0])&&(V=V[0]),V.length<2)throw new Q("streams");var ce,D=V.map(function(I,X){var E=X<V.length-1;return O(I,E,X>0,function(Z){ce||(ce=Z),Z&&D.forEach(A),!E&&(D.forEach(A),K(ce))})});return V.reduce(b)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(Y,Se,he){"use strict";var W=Y("../../../errors").codes.ERR_INVALID_OPT_VALUE;Se.exports={getHighWaterMark:function(Q,z,v,x){var O=function(Q,z,v){return null!=Q.highWaterMark?Q.highWaterMark:z?Q[v]:null}(z,x,v);if(null!=O){if(!isFinite(O)||Math.floor(O)!==O||O<0)throw new W(x?v:"highWaterMark",O);return Math.floor(O)}return Q.objectMode?16:16384}}},{"../../../errors":67}],80:[function(Y,Se,he){Se.exports=Y("events").EventEmitter},{events:8}],81:[function(Y,Se,he){(he=Se.exports=Y("./lib/_stream_readable.js")).Stream=he,he.Readable=he,he.Writable=Y("./lib/_stream_writable.js"),he.Duplex=Y("./lib/_stream_duplex.js"),he.Transform=Y("./lib/_stream_transform.js"),he.PassThrough=Y("./lib/_stream_passthrough.js"),he.finished=Y("./lib/internal/streams/end-of-stream.js"),he.pipeline=Y("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),function(j){for(var P in j)he.hasOwnProperty(P)||(he[P]=j[P])}(Y("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(Y,Se,he){"use strict";function j(z){const v=[];let x=0;for(;x<z.length;)switch(z[x]){case"/":if("."===z[x+1])if("."===z[x+2]){if(!Q(z[x+3])){v.push([]),x++;break}v.pop(),z[x+3]||v.push([]),x+=3}else{if(!Q(z[x+2])){v.push([]),x++;break}z[x+2]||v.push([]),x+=2}else v.push([]),x++;break;case"#":case"?":v.length||v.push([]),v[v.length-1].push(z.substr(x)),x=z.length;break;default:v.length||v.push([]),v[v.length-1].push(z[x]),x++}return"/"+v.map(O=>O.join("")).join("/")}function P(z,v){let x=v+1;v>=0?"/"===z[v+1]&&"/"===z[v+2]&&(x=v+3):"/"===z[0]&&"/"===z[1]&&(x=2);const O=z.indexOf("/",x);return O<0?z:z.substr(0,O)+j(z.substr(O))}function Q(z){return!z||"#"===z||"?"===z||"/"===z}Object.defineProperty(he,"__esModule",{value:!0}),he.resolve=function(z,v){const x=(v=v||"").indexOf("#");if(x>0&&(v=v.substr(0,x)),!z.length){if(v.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${v}' for value '${z}'`);return v}if(z.startsWith("?")){const V=v.indexOf("?");return V>0&&(v=v.substr(0,V)),v+z}if(z.startsWith("#"))return v+z;if(!v.length){const V=z.indexOf(":");if(V<0)throw new Error(`Found invalid relative IRI '${z}' for a missing baseIRI`);return P(z,V)}const O=z.indexOf(":");if(O>=0)return P(z,O);const A=v.indexOf(":");if(A<0)throw new Error(`Found invalid baseIRI '${v}' for value '${z}'`);const b=v.substr(0,A+1);if(0===z.indexOf("//"))return b+P(z,O);let y;if(v.indexOf("//",A)===A+1){if(y=v.indexOf("/",A+3),y<0)return v.length>A+3?v+"/"+P(z,O):b+P(z,O)}else if(y=v.indexOf("/",A+1),y<0)return b+P(z,O);if(0===z.indexOf("/"))return v.substr(0,y)+j(z);let S=v.substr(y);const T=S.lastIndexOf("/");return T>=0&&T<S.length-1&&(S=S.substr(0,T+1),"."===z[0]&&"."!==z[1]&&"/"!==z[1]&&z[2]&&(z=z.substr(1))),z=j(z=S+z),v.substr(0,y)+z},he.removeDotSegments=j,he.removeDotSegmentsOfPath=P},{}],84:[function(Y,Se,he){var W=Y("buffer"),j=W.Buffer;function P(z,v){for(var x in z)v[x]=z[x]}function Q(z,v,x){return j(z,v,x)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Se.exports=W:(P(W,he),he.Buffer=Q),Q.prototype=Object.create(j.prototype),P(j,Q),Q.from=function(z,v,x){if("number"==typeof z)throw new TypeError("Argument must not be a number");return j(z,v,x)},Q.alloc=function(z,v,x){if("number"!=typeof z)throw new TypeError("Argument must be a number");var O=j(z);return void 0!==v?"string"==typeof x?O.fill(v,x):O.fill(v):O.fill(0),O},Q.allocUnsafe=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return j(z)},Q.allocUnsafeSlow=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return W.SlowBuffer(z)}},{buffer:6}],85:[function(Y,Se,he){(function(W){(function(){!function(j){j.parser=function(q,G){return new Q(q,G)},j.SAXParser=Q,j.SAXStream=y,j.createStream=function(q,G){return new y(q,G)},j.MAX_BUFFER_LENGTH=65536;var O,P=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function Q(q,G){if(!(this instanceof Q))return new Q(q,G);var pe=this;(function(q){for(var G=0,pe=P.length;G<pe;G++)q[P[G]]=""})(pe),pe.q=pe.c="",pe.bufferCheckPosition=j.MAX_BUFFER_LENGTH,pe.opt=G||{},pe.opt.lowercase=pe.opt.lowercase||pe.opt.lowercasetags,pe.looseCase=pe.opt.lowercase?"toLowerCase":"toUpperCase",pe.tags=[],pe.closed=pe.closedRoot=pe.sawRoot=!1,pe.tag=pe.error=null,pe.strict=!!q,pe.noscript=!(!q&&!pe.opt.noscript),pe.state=te.BEGIN,pe.strictEntities=pe.opt.strictEntities,pe.ENTITIES=Object.create(pe.strictEntities?j.XML_ENTITIES:j.ENTITIES),pe.attribList=[],pe.opt.xmlns&&(pe.ns=Object.create(K)),pe.trackPosition=!1!==pe.opt.position,pe.trackPosition&&(pe.position=pe.line=pe.column=0),me(pe,"onready")}j.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(q){function G(){}return G.prototype=q,new G}),Object.keys||(Object.keys=function(q){var G=[];for(var pe in q)q.hasOwnProperty(pe)&&G.push(pe);return G}),Q.prototype={end:function(){st(this)},write:function(q){var G=this;if(this.error)throw this.error;if(G.closed)return Ge(G,"Cannot write after close. Assign an onready handler.");if(null===q)return st(G);"object"==typeof q&&(q=q.toString());for(var pe=0,ue="";ue=$e(q,pe++),G.c=ue,ue;)switch(G.trackPosition&&(G.position++,"\n"===ue?(G.line++,G.column=0):G.column++),G.state){case te.BEGIN:if(G.state=te.BEGIN_WHITESPACE,"\ufeff"===ue)continue;Ve(G,ue);continue;case te.BEGIN_WHITESPACE:Ve(G,ue);continue;case te.TEXT:if(G.sawRoot&&!G.closedRoot){for(var je=pe-1;ue&&"<"!==ue&&"&"!==ue;)(ue=$e(q,pe++))&&G.trackPosition&&(G.position++,"\n"===ue?(G.line++,G.column=0):G.column++);G.textNode+=q.substring(je,pe-1)}"<"!==ue||G.sawRoot&&G.closedRoot&&!G.strict?(!E(ue)&&(!G.sawRoot||G.closedRoot)&&Xe(G,"Text data outside of root node."),"&"===ue?G.state=te.TEXT_ENTITY:G.textNode+=ue):(G.state=te.OPEN_WAKA,G.startTagPosition=G.position);continue;case te.SCRIPT:"<"===ue?G.state=te.SCRIPT_ENDING:G.script+=ue;continue;case te.SCRIPT_ENDING:"/"===ue?G.state=te.CLOSE_TAG:(G.script+="<"+ue,G.state=te.SCRIPT);continue;case te.OPEN_WAKA:"!"===ue?(G.state=te.SGML_DECL,G.sgmlDecl=""):E(ue)||(oe(ce,ue)?(G.state=te.OPEN_TAG,G.tagName=ue):"/"===ue?(G.state=te.CLOSE_TAG,G.tagName=""):"?"===ue?(G.state=te.PROC_INST,G.procInstName=G.procInstBody=""):(Xe(G,"Unencoded <"),G.startTagPosition+1<G.position&&(ue=new Array(G.position-G.startTagPosition).join(" ")+ue),G.textNode+="<"+ue,G.state=te.TEXT));continue;case te.SGML_DECL:"[CDATA["===(G.sgmlDecl+ue).toUpperCase()?(ne(G,"onopencdata"),G.state=te.CDATA,G.sgmlDecl="",G.cdata=""):G.sgmlDecl+ue==="--"?(G.state=te.COMMENT,G.comment="",G.sgmlDecl=""):"DOCTYPE"===(G.sgmlDecl+ue).toUpperCase()?(G.state=te.DOCTYPE,(G.doctype||G.sawRoot)&&Xe(G,"Inappropriately located doctype declaration"),G.doctype="",G.sgmlDecl=""):">"===ue?(ne(G,"onsgmldeclaration",G.sgmlDecl),G.sgmlDecl="",G.state=te.TEXT):($(ue)&&(G.state=te.SGML_DECL_QUOTED),G.sgmlDecl+=ue);continue;case te.SGML_DECL_QUOTED:ue===G.q&&(G.state=te.SGML_DECL,G.q=""),G.sgmlDecl+=ue;continue;case te.DOCTYPE:">"===ue?(G.state=te.TEXT,ne(G,"ondoctype",G.doctype),G.doctype=!0):(G.doctype+=ue,"["===ue?G.state=te.DOCTYPE_DTD:$(ue)&&(G.state=te.DOCTYPE_QUOTED,G.q=ue));continue;case te.DOCTYPE_QUOTED:G.doctype+=ue,ue===G.q&&(G.q="",G.state=te.DOCTYPE);continue;case te.DOCTYPE_DTD:G.doctype+=ue,"]"===ue?G.state=te.DOCTYPE:$(ue)&&(G.state=te.DOCTYPE_DTD_QUOTED,G.q=ue);continue;case te.DOCTYPE_DTD_QUOTED:G.doctype+=ue,ue===G.q&&(G.state=te.DOCTYPE_DTD,G.q="");continue;case te.COMMENT:"-"===ue?G.state=te.COMMENT_ENDING:G.comment+=ue;continue;case te.COMMENT_ENDING:"-"===ue?(G.state=te.COMMENT_ENDED,G.comment=Ie(G.opt,G.comment),G.comment&&ne(G,"oncomment",G.comment),G.comment=""):(G.comment+="-"+ue,G.state=te.COMMENT);continue;case te.COMMENT_ENDED:">"!==ue?(Xe(G,"Malformed comment"),G.comment+="--"+ue,G.state=te.COMMENT):G.state=te.TEXT;continue;case te.CDATA:"]"===ue?G.state=te.CDATA_ENDING:G.cdata+=ue;continue;case te.CDATA_ENDING:"]"===ue?G.state=te.CDATA_ENDING_2:(G.cdata+="]"+ue,G.state=te.CDATA);continue;case te.CDATA_ENDING_2:">"===ue?(G.cdata&&ne(G,"oncdata",G.cdata),ne(G,"onclosecdata"),G.cdata="",G.state=te.TEXT):"]"===ue?G.cdata+="]":(G.cdata+="]]"+ue,G.state=te.CDATA);continue;case te.PROC_INST:"?"===ue?G.state=te.PROC_INST_ENDING:E(ue)?G.state=te.PROC_INST_BODY:G.procInstName+=ue;continue;case te.PROC_INST_BODY:if(!G.procInstBody&&E(ue))continue;"?"===ue?G.state=te.PROC_INST_ENDING:G.procInstBody+=ue;continue;case te.PROC_INST_ENDING:">"===ue?(ne(G,"onprocessinginstruction",{name:G.procInstName,body:G.procInstBody}),G.procInstName=G.procInstBody="",G.state=te.TEXT):(G.procInstBody+="?"+ue,G.state=te.PROC_INST_BODY);continue;case te.OPEN_TAG:oe(D,ue)?G.tagName+=ue:(tt(G),">"===ue?ke(G):"/"===ue?G.state=te.OPEN_TAG_SLASH:(E(ue)||Xe(G,"Invalid character in tag name"),G.state=te.ATTRIB));continue;case te.OPEN_TAG_SLASH:">"===ue?(ke(G,!0),Ke(G)):(Xe(G,"Forward-slash in opening tag not followed by >"),G.state=te.ATTRIB);continue;case te.ATTRIB:if(E(ue))continue;">"===ue?ke(G):"/"===ue?G.state=te.OPEN_TAG_SLASH:oe(ce,ue)?(G.attribName=ue,G.attribValue="",G.state=te.ATTRIB_NAME):Xe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME:"="===ue?G.state=te.ATTRIB_VALUE:">"===ue?(Xe(G,"Attribute without value"),G.attribValue=G.attribName,Ue(G),ke(G)):E(ue)?G.state=te.ATTRIB_NAME_SAW_WHITE:oe(D,ue)?G.attribName+=ue:Xe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME_SAW_WHITE:if("="===ue)G.state=te.ATTRIB_VALUE;else{if(E(ue))continue;Xe(G,"Attribute without value"),G.tag.attributes[G.attribName]="",G.attribValue="",ne(G,"onattribute",{name:G.attribName,value:""}),G.attribName="",">"===ue?ke(G):oe(ce,ue)?(G.attribName=ue,G.state=te.ATTRIB_NAME):(Xe(G,"Invalid attribute name"),G.state=te.ATTRIB)}continue;case te.ATTRIB_VALUE:if(E(ue))continue;$(ue)?(G.q=ue,G.state=te.ATTRIB_VALUE_QUOTED):(Xe(G,"Unquoted attribute value"),G.state=te.ATTRIB_VALUE_UNQUOTED,G.attribValue=ue);continue;case te.ATTRIB_VALUE_QUOTED:if(ue!==G.q){"&"===ue?G.state=te.ATTRIB_VALUE_ENTITY_Q:G.attribValue+=ue;continue}Ue(G),G.q="",G.state=te.ATTRIB_VALUE_CLOSED;continue;case te.ATTRIB_VALUE_CLOSED:E(ue)?G.state=te.ATTRIB:">"===ue?ke(G):"/"===ue?G.state=te.OPEN_TAG_SLASH:oe(ce,ue)?(Xe(G,"No whitespace between attributes"),G.attribName=ue,G.attribValue="",G.state=te.ATTRIB_NAME):Xe(G,"Invalid attribute name");continue;case te.ATTRIB_VALUE_UNQUOTED:if(!Z(ue)){"&"===ue?G.state=te.ATTRIB_VALUE_ENTITY_U:G.attribValue+=ue;continue}Ue(G),">"===ue?ke(G):G.state=te.ATTRIB;continue;case te.CLOSE_TAG:if(G.tagName)">"===ue?Ke(G):oe(D,ue)?G.tagName+=ue:G.script?(G.script+="</"+G.tagName,G.tagName="",G.state=te.SCRIPT):(E(ue)||Xe(G,"Invalid tagname in closing tag"),G.state=te.CLOSE_TAG_SAW_WHITE);else{if(E(ue))continue;se(ce,ue)?G.script?(G.script+="</"+ue,G.state=te.SCRIPT):Xe(G,"Invalid tagname in closing tag."):G.tagName=ue}continue;case te.CLOSE_TAG_SAW_WHITE:if(E(ue))continue;">"===ue?Ke(G):Xe(G,"Invalid characters in closing tag");continue;case te.TEXT_ENTITY:case te.ATTRIB_VALUE_ENTITY_Q:case te.ATTRIB_VALUE_ENTITY_U:var pt,ve;switch(G.state){case te.TEXT_ENTITY:pt=te.TEXT,ve="textNode";break;case te.ATTRIB_VALUE_ENTITY_Q:pt=te.ATTRIB_VALUE_QUOTED,ve="attribValue";break;case te.ATTRIB_VALUE_ENTITY_U:pt=te.ATTRIB_VALUE_UNQUOTED,ve="attribValue"}";"===ue?(G[ve]+=Me(G),G.entity="",G.state=pt):oe(G.entity.length?X:I,ue)?G.entity+=ue:(Xe(G,"Invalid character in entity name"),G[ve]+="&"+G.entity+ue,G.entity="",G.state=pt);continue;default:throw new Error(G,"Unknown state: "+G.state)}return G.position>=G.bufferCheckPosition&&function(q){for(var G=Math.max(j.MAX_BUFFER_LENGTH,10),pe=0,ue=0,je=P.length;ue<je;ue++){var _t=q[P[ue]].length;if(_t>G)switch(P[ue]){case"textNode":_e(q);break;case"cdata":ne(q,"oncdata",q.cdata),q.cdata="";break;case"script":ne(q,"onscript",q.script),q.script="";break;default:Ge(q,"Max buffer length exceeded: "+P[ue])}pe=Math.max(pe,_t)}q.bufferCheckPosition=j.MAX_BUFFER_LENGTH-pe+q.position}(G),G},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(q){_e(q),""!==q.cdata&&(ne(q,"oncdata",q.cdata),q.cdata=""),""!==q.script&&(ne(q,"onscript",q.script),q.script="")}(this)}};try{O=Y("stream").Stream}catch(q){O=function(){}}var A=j.EVENTS.filter(function(q){return"error"!==q&&"end"!==q});function y(q,G){if(!(this instanceof y))return new y(q,G);O.apply(this),this._parser=new Q(q,G),this.writable=!0,this.readable=!0;var pe=this;this._parser.onend=function(){pe.emit("end")},this._parser.onerror=function(ue){pe.emit("error",ue),pe._parser.error=null},this._decoder=null,A.forEach(function(ue){Object.defineProperty(pe,"on"+ue,{get:function(){return pe._parser["on"+ue]},set:function(je){if(!je)return pe.removeAllListeners(ue),pe._parser["on"+ue]=je,je;pe.on(ue,je)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(O.prototype,{constructor:{value:y}})).write=function(q){if("function"==typeof W&&"function"==typeof W.isBuffer&&W.isBuffer(q)){if(!this._decoder){var G=Y("string_decoder").StringDecoder;this._decoder=new G("utf8")}q=this._decoder.write(q)}return this._parser.write(q.toString()),this.emit("data",q),!0},y.prototype.end=function(q){return q&&q.length&&this.write(q),this._parser.end(),!0},y.prototype.on=function(q,G){var pe=this;return!pe._parser["on"+q]&&-1!==A.indexOf(q)&&(pe._parser["on"+q]=function(){var ue=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);ue.splice(0,0,q),pe.emit.apply(pe,ue)}),O.prototype.on.call(pe,q,G)};var V="http://www.w3.org/XML/1998/namespace",R="http://www.w3.org/2000/xmlns/",K={xml:V,xmlns:R},ce=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,I=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(q){return" "===q||"\n"===q||"\r"===q||"\t"===q}function $(q){return'"'===q||"'"===q}function Z(q){return">"===q||E(q)}function oe(q,G){return q.test(G)}function se(q,G){return!oe(q,G)}var q,G,pe,te=0;for(var Ce in j.STATE={BEGIN:te++,BEGIN_WHITESPACE:te++,TEXT:te++,TEXT_ENTITY:te++,OPEN_WAKA:te++,SGML_DECL:te++,SGML_DECL_QUOTED:te++,DOCTYPE:te++,DOCTYPE_QUOTED:te++,DOCTYPE_DTD:te++,DOCTYPE_DTD_QUOTED:te++,COMMENT_STARTING:te++,COMMENT:te++,COMMENT_ENDING:te++,COMMENT_ENDED:te++,CDATA:te++,CDATA_ENDING:te++,CDATA_ENDING_2:te++,PROC_INST:te++,PROC_INST_BODY:te++,PROC_INST_ENDING:te++,OPEN_TAG:te++,OPEN_TAG_SLASH:te++,ATTRIB:te++,ATTRIB_NAME:te++,ATTRIB_NAME_SAW_WHITE:te++,ATTRIB_VALUE:te++,ATTRIB_VALUE_QUOTED:te++,ATTRIB_VALUE_CLOSED:te++,ATTRIB_VALUE_UNQUOTED:te++,ATTRIB_VALUE_ENTITY_Q:te++,ATTRIB_VALUE_ENTITY_U:te++,CLOSE_TAG:te++,CLOSE_TAG_SAW_WHITE:te++,SCRIPT:te++,SCRIPT_ENDING:te++},j.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},j.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(j.ENTITIES).forEach(function(q){var G=j.ENTITIES[q],pe="number"==typeof G?String.fromCharCode(G):G;j.ENTITIES[q]=pe}),j.STATE)j.STATE[j.STATE[Ce]]=Ce;function me(q,G,pe){q[G]&&q[G](pe)}function ne(q,G,pe){q.textNode&&_e(q),me(q,G,pe)}function _e(q){q.textNode=Ie(q.opt,q.textNode),q.textNode&&me(q,"ontext",q.textNode),q.textNode=""}function Ie(q,G){return q.trim&&(G=G.trim()),q.normalize&&(G=G.replace(/\s+/g," ")),G}function Ge(q,G){return _e(q),q.trackPosition&&(G+="\nLine: "+q.line+"\nColumn: "+q.column+"\nChar: "+q.c),G=new Error(G),q.error=G,me(q,"onerror",G),q}function st(q){return q.sawRoot&&!q.closedRoot&&Xe(q,"Unclosed root tag"),q.state!==te.BEGIN&&q.state!==te.BEGIN_WHITESPACE&&q.state!==te.TEXT&&Ge(q,"Unexpected end"),_e(q),q.c="",q.closed=!0,me(q,"onend"),Q.call(q,q.strict,q.opt),q}function Xe(q,G){if("object"!=typeof q||!(q instanceof Q))throw new Error("bad call to strictFail");q.strict&&Ge(q,G)}function tt(q){q.strict||(q.tagName=q.tagName[q.looseCase]());var G=q.tags[q.tags.length-1]||q,pe=q.tag={name:q.tagName,attributes:{}};q.opt.xmlns&&(pe.ns=G.ns),q.attribList.length=0,ne(q,"onopentagstart",pe)}function Ye(q,G){var ue=q.indexOf(":")<0?["",q]:q.split(":"),je=ue[0],_t=ue[1];return G&&"xmlns"===q&&(je="xmlns",_t=""),{prefix:je,local:_t}}function Ue(q){if(q.strict||(q.attribName=q.attribName[q.looseCase]()),-1!==q.attribList.indexOf(q.attribName)||q.tag.attributes.hasOwnProperty(q.attribName))q.attribName=q.attribValue="";else{if(q.opt.xmlns){var G=Ye(q.attribName,!0),ue=G.local;if("xmlns"===G.prefix)if("xml"===ue&&q.attribValue!==V)Xe(q,"xml: prefix must be bound to "+V+"\nActual: "+q.attribValue);else if("xmlns"===ue&&q.attribValue!==R)Xe(q,"xmlns: prefix must be bound to "+R+"\nActual: "+q.attribValue);else{var je=q.tag,_t=q.tags[q.tags.length-1]||q;je.ns===_t.ns&&(je.ns=Object.create(_t.ns)),je.ns[ue]=q.attribValue}q.attribList.push([q.attribName,q.attribValue])}else q.tag.attributes[q.attribName]=q.attribValue,ne(q,"onattribute",{name:q.attribName,value:q.attribValue});q.attribName=q.attribValue=""}}function ke(q,G){if(q.opt.xmlns){var pe=q.tag,ue=Ye(q.tagName);pe.prefix=ue.prefix,pe.local=ue.local,pe.uri=pe.ns[ue.prefix]||"",pe.prefix&&!pe.uri&&(Xe(q,"Unbound namespace prefix: "+JSON.stringify(q.tagName)),pe.uri=ue.prefix),pe.ns&&(q.tags[q.tags.length-1]||q).ns!==pe.ns&&Object.keys(pe.ns).forEach(function(On){ne(q,"onopennamespace",{prefix:On,uri:pe.ns[On]})});for(var _t=0,pt=q.attribList.length;_t<pt;_t++){var ve=q.attribList[_t],L=ve[0],N=ve[1],B=Ye(L,!0),Re=B.prefix,St=""===Re?"":pe.ns[Re]||"",Nt={name:L,value:N,prefix:Re,local:B.local,uri:St};Re&&"xmlns"!==Re&&!St&&(Xe(q,"Unbound namespace prefix: "+JSON.stringify(Re)),Nt.uri=Re),q.tag.attributes[L]=Nt,ne(q,"onattribute",Nt)}q.attribList.length=0}q.tag.isSelfClosing=!!G,q.sawRoot=!0,q.tags.push(q.tag),ne(q,"onopentag",q.tag),G||(q.state=q.noscript||"script"!==q.tagName.toLowerCase()?te.TEXT:te.SCRIPT,q.tag=null,q.tagName=""),q.attribName=q.attribValue="",q.attribList.length=0}function Ke(q){if(!q.tagName)return Xe(q,"Weird empty close tag."),q.textNode+="</>",void(q.state=te.TEXT);if(q.script){if("script"!==q.tagName)return q.script+="</"+q.tagName+">",q.tagName="",void(q.state=te.SCRIPT);ne(q,"onscript",q.script),q.script=""}var G=q.tags.length,pe=q.tagName;q.strict||(pe=pe[q.looseCase]());for(var ue=pe;G--&&q.tags[G].name!==ue;)Xe(q,"Unexpected close tag");if(G<0)return Xe(q,"Unmatched closing tag: "+q.tagName),q.textNode+="</"+q.tagName+">",void(q.state=te.TEXT);q.tagName=pe;for(var _t=q.tags.length;_t-- >G;){var pt=q.tag=q.tags.pop();q.tagName=q.tag.name,ne(q,"onclosetag",q.tagName);var ve={};for(var L in pt.ns)ve[L]=pt.ns[L];q.opt.xmlns&&pt.ns!==(q.tags[q.tags.length-1]||q).ns&&Object.keys(pt.ns).forEach(function(B){ne(q,"onclosenamespace",{prefix:B,uri:pt.ns[B]})})}0===G&&(q.closedRoot=!0),q.tagName=q.attribValue=q.attribName="",q.attribList.length=0,q.state=te.TEXT}function Me(q){var ue,G=q.entity,pe=G.toLowerCase(),je="";return q.ENTITIES[G]?q.ENTITIES[G]:q.ENTITIES[pe]?q.ENTITIES[pe]:("#"===(G=pe).charAt(0)&&("x"===G.charAt(1)?(G=G.slice(2),je=(ue=parseInt(G,16)).toString(16)):(G=G.slice(1),je=(ue=parseInt(G,10)).toString(10))),G=G.replace(/^0+/,""),isNaN(ue)||je.toLowerCase()!==G?(Xe(q,"Invalid character entity"),"&"+q.entity+";"):String.fromCodePoint(ue))}function Ve(q,G){"<"===G?(q.state=te.OPEN_WAKA,q.startTagPosition=q.position):E(G)||(Xe(q,"Non-whitespace before first tag."),q.textNode=G,q.state=te.TEXT)}function $e(q,G){var pe="";return G<q.length&&(pe=q.charAt(G)),pe}te=j.STATE,String.fromCodePoint||(q=String.fromCharCode,G=Math.floor,pe=function(){var ue=16384,je=[],ve=-1,L=arguments.length;if(!L)return"";for(var N="";++ve<L;){var B=Number(arguments[ve]);if(!isFinite(B)||B<0||B>1114111||G(B)!==B)throw RangeError("Invalid code point: "+B);B<=65535?je.push(B):je.push(55296+((B-=65536)>>10),B%1024+56320),(ve+1===L||je.length>ue)&&(N+=q.apply(null,je),je.length=0)}return N},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:pe,configurable:!0,writable:!0}):String.fromCodePoint=pe)}(void 0===he?this.sax={}:he)}).call(this)}).call(this,Y("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(Y,Se,he){(function(W,j){(function(){!function(P,Q){"use strict";if(!P.setImmediate){var A,z=1,v={},x=!1,O=P.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(P);X=X&&X.setTimeout?X:P,"[object process]"==={}.toString.call(P.process)?A=function(E){W.nextTick(function(){T(E)})}:function(){if(P.postMessage&&!P.importScripts){var E=!0,$=P.onmessage;return P.onmessage=function(){E=!1},P.postMessage("","*"),P.onmessage=$,E}}()?(E="setImmediate$"+Math.random()+"$",$=function(Z){Z.source===P&&"string"==typeof Z.data&&0===Z.data.indexOf(E)&&T(+Z.data.slice(E.length))},P.addEventListener?P.addEventListener("message",$,!1):P.attachEvent("onmessage",$),A=function(Z){P.postMessage(E+Z,"*")}):P.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function($){T($.data)},A=function($){E.port2.postMessage($)}}():O&&"onreadystatechange"in O.createElement("script")?function(){var E=O.documentElement;A=function($){var Z=O.createElement("script");Z.onreadystatechange=function(){T($),Z.onreadystatechange=null,E.removeChild(Z),Z=null},E.appendChild(Z)}}():A=function(E){setTimeout(T,0,E)},X.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var $=new Array(arguments.length-1),Z=0;Z<$.length;Z++)$[Z]=arguments[Z+1];return v[z]={callback:E,args:$},A(z),z++},X.clearImmediate=y}var E,$;function y(E){delete v[E]}function T(E){if(x)setTimeout(T,0,E);else{var $=v[E];if($){x=!0;try{!function(E){var $=E.callback,Z=E.args;switch(Z.length){case 0:$();break;case 1:$(Z[0]);break;case 2:$(Z[0],Z[1]);break;case 3:$(Z[0],Z[1],Z[2]);break;default:$.apply(void 0,Z)}}($)}finally{y(E),x=!1}}}}}("undefined"==typeof self?void 0===j?this:j:self)}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(Y,Se,he){Se.exports=P;var W=Y("events").EventEmitter;function P(){W.call(this)}Y("inherits")(P,W),P.Readable=Y("readable-stream/lib/_stream_readable.js"),P.Writable=Y("readable-stream/lib/_stream_writable.js"),P.Duplex=Y("readable-stream/lib/_stream_duplex.js"),P.Transform=Y("readable-stream/lib/_stream_transform.js"),P.PassThrough=Y("readable-stream/lib/_stream_passthrough.js"),P.finished=Y("readable-stream/lib/internal/streams/end-of-stream.js"),P.pipeline=Y("readable-stream/lib/internal/streams/pipeline.js"),P.Stream=P,P.prototype.pipe=function(Q,z){var v=this;function x(V){Q.writable&&!1===Q.write(V)&&v.pause&&v.pause()}function O(){v.readable&&v.resume&&v.resume()}v.on("data",x),Q.on("drain",O),!Q._isStdio&&(!z||!1!==z.end)&&(v.on("end",b),v.on("close",y));var A=!1;function b(){A||(A=!0,Q.end())}function y(){A||(A=!0,"function"==typeof Q.destroy&&Q.destroy())}function S(V){if(T(),0===W.listenerCount(this,"error"))throw V}function T(){v.removeListener("data",x),Q.removeListener("drain",O),v.removeListener("end",b),v.removeListener("close",y),v.removeListener("error",S),Q.removeListener("error",S),v.removeListener("end",T),v.removeListener("close",T),Q.removeListener("close",T)}return v.on("error",S),Q.on("error",S),v.on("end",T),v.on("close",T),Q.on("close",T),Q.emit("pipe",v),Q}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(Y,Se,he){arguments[4][5][0].apply(he,arguments)},{dup:5,"safe-buffer":84}],89:[function(Y,Se,he){(function(W,j){(function(){var P=Y("process/browser.js").nextTick,Q=Function.prototype.apply,z=Array.prototype.slice,v={},x=0;function O(A,b){this._id=A,this._clearFn=b}he.setTimeout=function(){return new O(Q.call(setTimeout,window,arguments),clearTimeout)},he.setInterval=function(){return new O(Q.call(setInterval,window,arguments),clearInterval)},he.clearTimeout=he.clearInterval=function(A){A.close()},O.prototype.unref=O.prototype.ref=function(){},O.prototype.close=function(){this._clearFn.call(window,this._id)},he.enroll=function(A,b){clearTimeout(A._idleTimeoutId),A._idleTimeout=b},he.unenroll=function(A){clearTimeout(A._idleTimeoutId),A._idleTimeout=-1},he._unrefActive=he.active=function(A){clearTimeout(A._idleTimeoutId);var b=A._idleTimeout;b>=0&&(A._idleTimeoutId=setTimeout(function(){A._onTimeout&&A._onTimeout()},b))},he.setImmediate="function"==typeof W?W:function(A){var b=x++,y=!(arguments.length<2)&&z.call(arguments,1);return v[b]=!0,P(function(){v[b]&&(y?A.apply(null,y):A.call(null),he.clearImmediate(b))}),b},he.clearImmediate="function"==typeof j?j:function(A){delete v[A]}}).call(this)}).call(this,Y("timers").setImmediate,Y("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(Y,Se,he){(function(W){(function(){function P(Q){try{if(!W.localStorage)return!1}catch(v){return!1}var z=W.localStorage[Q];return null!=z&&"true"===String(z).toLowerCase()}Se.exports=function(Q,z){if(P("noDeprecation"))return Q;var v=!1;return function(){if(!v){if(P("throwDeprecation"))throw new Error(z);P("traceDeprecation")?console.trace(z):console.warn(z),v=!0}return Q.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(Y,Se,he){"use strict";Se.exports=function(W){W.prototype[Symbol.iterator]=function*(){for(let j=this.head;j;j=j.next)yield j.value}}},{}],92:[function(Y,Se,he){"use strict";function W(v){var x=this;if(x instanceof W||(x=new W),x.tail=null,x.head=null,x.length=0,v&&"function"==typeof v.forEach)v.forEach(function(b){x.push(b)});else if(arguments.length>0)for(var O=0,A=arguments.length;O<A;O++)x.push(arguments[O]);return x}function j(v,x,O){var A=x===v.head?new z(O,null,x,v):new z(O,x,x.next,v);return null===A.next&&(v.tail=A),null===A.prev&&(v.head=A),v.length++,A}function P(v,x){v.tail=new z(x,v.tail,null,v),v.head||(v.head=v.tail),v.length++}function Q(v,x){v.head=new z(x,null,v.head,v),v.tail||(v.tail=v.head),v.length++}function z(v,x,O,A){if(!(this instanceof z))return new z(v,x,O,A);this.list=A,this.value=v,x?(x.next=this,this.prev=x):this.prev=null,O?(O.prev=this,this.next=O):this.next=null}Se.exports=W,W.Node=z,W.create=W,W.prototype.removeNode=function(v){if(v.list!==this)throw new Error("removing node which does not belong to this list");var x=v.next,O=v.prev;return x&&(x.prev=O),O&&(O.next=x),v===this.head&&(this.head=x),v===this.tail&&(this.tail=O),v.list.length--,v.next=null,v.prev=null,v.list=null,x},W.prototype.unshiftNode=function(v){if(v!==this.head){v.list&&v.list.removeNode(v);var x=this.head;v.list=this,v.next=x,x&&(x.prev=v),this.head=v,this.tail||(this.tail=v),this.length++}},W.prototype.pushNode=function(v){if(v!==this.tail){v.list&&v.list.removeNode(v);var x=this.tail;v.list=this,v.prev=x,x&&(x.next=v),this.tail=v,this.head||(this.head=v),this.length++}},W.prototype.push=function(){for(var v=0,x=arguments.length;v<x;v++)P(this,arguments[v]);return this.length},W.prototype.unshift=function(){for(var v=0,x=arguments.length;v<x;v++)Q(this,arguments[v]);return this.length},W.prototype.pop=function(){if(this.tail){var v=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,v}},W.prototype.shift=function(){if(this.head){var v=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,v}},W.prototype.forEach=function(v,x){x=x||this;for(var O=this.head,A=0;null!==O;A++)v.call(x,O.value,A,this),O=O.next},W.prototype.forEachReverse=function(v,x){x=x||this;for(var O=this.tail,A=this.length-1;null!==O;A--)v.call(x,O.value,A,this),O=O.prev},W.prototype.get=function(v){for(var x=0,O=this.head;null!==O&&x<v;x++)O=O.next;if(x===v&&null!==O)return O.value},W.prototype.getReverse=function(v){for(var x=0,O=this.tail;null!==O&&x<v;x++)O=O.prev;if(x===v&&null!==O)return O.value},W.prototype.map=function(v,x){x=x||this;for(var O=new W,A=this.head;null!==A;)O.push(v.call(x,A.value,this)),A=A.next;return O},W.prototype.mapReverse=function(v,x){x=x||this;for(var O=new W,A=this.tail;null!==A;)O.push(v.call(x,A.value,this)),A=A.prev;return O},W.prototype.reduce=function(v,x){var O,A=this.head;if(arguments.length>1)O=x;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");A=this.head.next,O=this.head.value}for(var b=0;null!==A;b++)O=v(O,A.value,b),A=A.next;return O},W.prototype.reduceReverse=function(v,x){var O,A=this.tail;if(arguments.length>1)O=x;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");A=this.tail.prev,O=this.tail.value}for(var b=this.length-1;null!==A;b--)O=v(O,A.value,b),A=A.prev;return O},W.prototype.toArray=function(){for(var v=new Array(this.length),x=0,O=this.head;null!==O;x++)v[x]=O.value,O=O.next;return v},W.prototype.toArrayReverse=function(){for(var v=new Array(this.length),x=0,O=this.tail;null!==O;x++)v[x]=O.value,O=O.prev;return v},W.prototype.slice=function(v,x){(x=x||this.length)<0&&(x+=this.length),(v=v||0)<0&&(v+=this.length);var O=new W;if(x<v||x<0)return O;v<0&&(v=0),x>this.length&&(x=this.length);for(var A=0,b=this.head;null!==b&&A<v;A++)b=b.next;for(;null!==b&&A<x;A++,b=b.next)O.push(b.value);return O},W.prototype.sliceReverse=function(v,x){(x=x||this.length)<0&&(x+=this.length),(v=v||0)<0&&(v+=this.length);var O=new W;if(x<v||x<0)return O;v<0&&(v=0),x>this.length&&(x=this.length);for(var A=this.length,b=this.tail;null!==b&&A>x;A--)b=b.prev;for(;null!==b&&A>v;A--,b=b.prev)O.push(b.value);return O},W.prototype.splice=function(v,x,...O){v>this.length&&(v=this.length-1),v<0&&(v=this.length+v);for(var A=0,b=this.head;null!==b&&A<v;A++)b=b.next;var y=[];for(A=0;b&&A<x;A++)y.push(b.value),b=this.removeNode(b);for(null===b&&(b=this.tail),b!==this.head&&b!==this.tail&&(b=b.prev),A=0;A<O.length;A++)b=j(this,b,O[A]);return y},W.prototype.reverse=function(){for(var v=this.head,x=this.tail,O=v;null!==O;O=O.prev){var A=O.prev;O.prev=O.next,O.next=A}return this.head=x,this.tail=v,this};try{Y("./iterator.js")(W)}catch(v){}},{"./iterator.js":91}]},{},[1])(1)},2:Ut=>{"use strict";Ut.exports=Je,Ut.exports.default=Je;var it=1e20;function Je(Y,Se,he,W,j,P){this.fontSize=Y||24,this.buffer=void 0===Se?3:Se,this.cutoff=W||.25,this.fontFamily=j||"sans-serif",this.fontWeight=P||"normal",this.radius=he||8;var Q=this.size=this.fontSize+2*this.buffer,z=Q+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Tt(Y,Se,he,W,j,P){for(var Q=0;Q<Se;Q++)dt(Y,Q,Se,he,W,j,P);for(var z=0;z<he;z++)dt(Y,z*Se,1,Se,W,j,P)}function dt(Y,Se,he,W,j,P,Q){var z,v,x,O;for(P[0]=0,Q[0]=-it,Q[1]=it,z=0;z<W;z++)j[z]=Y[Se+z*he];for(z=1,v=0,x=0;z<W;z++){do{x=(j[z]-j[O=P[v]]+z*z-O*O)/(z-O)/2}while(x<=Q[v]&&--v>-1);P[++v]=z,Q[v]=x,Q[v+1]=it}for(z=0,v=0;z<W;z++){for(;Q[v+1]<z;)v++;Y[Se+z*he]=j[O=P[v]]+(z-O)*(z-O)}}Je.prototype._draw=function(Y,Se){var P,Q,z,v,x,O,A,b,y,he=this.ctx.measureText(Y),W=he.width,j=2*this.buffer;Se&&this.useMetrics?(x=Math.floor(he.actualBoundingBoxAscent),b=this.buffer+Math.ceil(he.actualBoundingBoxAscent),O=this.buffer,A=this.buffer,P=(Q=Math.min(this.size,Math.ceil(he.actualBoundingBoxRight-he.actualBoundingBoxLeft)))+j,z=(v=Math.min(this.size-O,Math.ceil(he.actualBoundingBoxAscent+he.actualBoundingBoxDescent)))+j,this.ctx.textBaseline="alphabetic"):(P=Q=this.size,z=v=this.size,x=19*this.fontSize/24,O=A=0,b=this.middle,this.ctx.textBaseline="middle"),Q&&v&&(this.ctx.clearRect(A,O,Q,v),this.ctx.fillText(Y,this.buffer,b),y=this.ctx.getImageData(A,O,Q,v));var S=new Uint8ClampedArray(P*z);return function(Y,Se,he,W,j,P,Q){P.fill(it,0,Se*he),Q.fill(0,0,Se*he);for(var z=(Se-W)/2,v=0;v<j;v++)for(var x=0;x<W;x++){var O=(v+z)*Se+x+z,A=Y.data[4*(v*W+x)+3]/255;if(1===A)P[O]=0,Q[O]=it;else if(0===A)P[O]=it,Q[O]=0;else{var b=Math.max(0,.5-A),y=Math.max(0,A-.5);P[O]=b*b,Q[O]=y*y}}}(y,P,z,Q,v,this.gridOuter,this.gridInner),Tt(this.gridOuter,P,z,this.f,this.v,this.z),Tt(this.gridInner,P,z,this.f,this.v,this.z),function(Y,Se,he,W,j,P,Q){for(var z=0;z<Se*he;z++){var v=Math.sqrt(W[z])-Math.sqrt(j[z]);Y[z]=Math.round(255-255*(v/P+Q))}}(S,P,z,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:S,metrics:{width:Q,height:v,sdfWidth:P,sdfHeight:z,top:x,left:0,advance:W}}},Je.prototype.draw=function(Y){return this._draw(Y,!1).data},Je.prototype.drawWithMetrics=function(Y){return this._draw(Y,!0)}},322:Ut=>{Ut.exports=function(Je,yt){var ee=yt.length;if(0!==ee){var Tt=Je.length;Je.length+=ee;for(var dt=0;dt<ee;dt++)Je[Tt+dt]=yt[dt]}}},517:(Ut,it)=>{"use strict";var yt=(()=>{return(Tt=yt||(yt={})).typeOfFunction="function",Tt.boolTrue=!0,yt;var Tt})();function ee(Tt,dt,Y){if(!Y||typeof Y.value!==yt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:yt.boolTrue,get:function(){var Se=Y.value.bind(this);return Object.defineProperty(this,dt,{value:Se,configurable:yt.boolTrue,writable:yt.boolTrue}),Se}}}it.ak=ee,it.ZP=ee},266:(Ut,it,Je)=>{Ut.exports={ResizeSensor:Je(835),ElementQueries:Je(845)}},845:function(Ut,it,Je){"use strict";var yt,ee,Tt;"undefined"!=typeof window&&window,ee=[Je(835)],void 0!==(Tt="function"==typeof(yt=function(dt){var Y=function(){var he,W={},j=[];function P(D){D||(D=document.documentElement);var I=window.getComputedStyle(D,null).fontSize;return parseFloat(I)||16}function z(D,I){var X=I.split(/\d/),E=X[X.length-1];switch(I=parseFloat(I),E){case"px":return I;case"em":return I*P(D);case"rem":return I*P();case"vw":return I*document.documentElement.clientWidth/100;case"vh":return I*document.documentElement.clientHeight/100;case"vmin":case"vmax":var $=document.documentElement.clientWidth/100,Z=document.documentElement.clientHeight/100;return I*(0,Math["vmin"===E?"min":"max"])($,Z);default:return I}}function v(D,I){this.element=D;var X,E,$,Z,oe,se,te,Ce,me=["min-width","min-height","max-width","max-height"];this.call=function(){for(X in $=function(D){if(!D.getBoundingClientRect)return{width:D.offsetWidth,height:D.offsetHeight};var I=D.getBoundingClientRect();return{width:Math.round(I.width),height:Math.round(I.height)}}(this.element),se={},W[I])!W[I].hasOwnProperty(X)||(Z=z(this.element,(E=W[I][X]).value),oe="width"===E.property?$.width:$.height,te="","min"===E.mode&&oe>=Z&&(te+=E.value),"max"===E.mode&&oe<=Z&&(te+=E.value),se[Ce=E.mode+"-"+E.property]||(se[Ce]=""),te&&-1===(" "+se[Ce]+" ").indexOf(" "+te+" ")&&(se[Ce]+=" "+te));for(var ne in me)!me.hasOwnProperty(ne)||(se[me[ne]]?this.element.setAttribute(me[ne],se[me[ne]].substr(1)):this.element.removeAttribute(me[ne]))}}function x(D,I){D.elementQueriesSetupInformation||(D.elementQueriesSetupInformation=new v(D,I)),D.elementQueriesSensor||(D.elementQueriesSensor=new dt(D,function(){D.elementQueriesSetupInformation.call()}))}function O(D,I,X,E){if(void 0===W[D]){W[D]=[];var $=j.length;he.innerHTML+="\n"+D+" {animation: 0.1s element-queries;}",he.innerHTML+="\n"+D+" > .resize-sensor {min-width: "+$+"px;}",j.push(D)}W[D].push({mode:I,property:X,value:E})}function A(D){var I;if(document.querySelectorAll&&(I=D?D.querySelectorAll.bind(D):document.querySelectorAll.bind(document)),!I&&"undefined"!=typeof $$&&(I=$$),!I&&"undefined"!=typeof jQuery&&(I=jQuery),!I)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return I}function y(D){var I=[],X=[],E=[],$=0,Z=-1,oe=[];for(var se in D.children)if(D.children.hasOwnProperty(se)&&D.children[se].tagName&&"img"===D.children[se].tagName.toLowerCase()){I.push(D.children[se]);var te=D.children[se].getAttribute("min-width")||D.children[se].getAttribute("data-min-width"),Ce=D.children[se].getAttribute("data-src")||D.children[se].getAttribute("url");E.push(Ce),X.push({minWidth:te}),te?D.children[se].style.display="none":($=I.length-1,D.children[se].style.display="block")}function ne(){var Ie,_e=!1;for(Ie in I)!I.hasOwnProperty(Ie)||X[Ie].minWidth&&D.offsetWidth>X[Ie].minWidth&&(_e=Ie);if(_e||(_e=$),Z!==_e)if(oe[_e])I[Z].style.display="none",I[_e].style.display="block",Z=_e;else{var Ge=new Image;Ge.onload=function(){I[_e].src=E[_e],I[Z].style.display="none",I[_e].style.display="block",oe[_e]=!0,Z=_e},Ge.src=E[_e]}else I[_e].src=E[_e]}Z=$,D.resizeSensorInstance=new dt(D,ne),ne()}var T=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,V=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function R(D){var I,X,E,$;for(D=D.replace(/'/g,'"');null!==(I=T.exec(D));)for(X=I[1]+I[3],E=I[2];null!==($=V.exec(E));)O(X,$[1],$[2],$[3])}function K(D){var I="";if(D)if("string"==typeof D)(-1!==(D=D.toLowerCase()).indexOf("min-width")||-1!==D.indexOf("max-width"))&&R(D);else for(var X=0,E=D.length;X<E;X++)1===D[X].type?(-1!==(I=D[X].selectorText||D[X].cssText).indexOf("min-height")||-1!==I.indexOf("max-height")||-1!==I.indexOf("min-width")||-1!==I.indexOf("max-width"))&&R(I):4===D[X].type?K(D[X].cssRules||D[X].rules):3===D[X].type&&D[X].styleSheet.hasOwnProperty("cssRules")&&K(D[X].styleSheet.cssRules)}var ce=!1;this.init=function(){var D="animationstart";void 0!==document.documentElement.style.webkitAnimationName?D="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?D="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(D="oanimationstart"),document.body.addEventListener(D,function(E){var $=E.target,Z=$&&window.getComputedStyle($,null),oe=Z&&Z.getPropertyValue("animation-name");if(oe&&-1!==oe.indexOf("element-queries")){$.elementQueriesSensor=new dt($,function(){$.elementQueriesSetupInformation&&$.elementQueriesSetupInformation.call()});var Ce=window.getComputedStyle($.resizeSensor,null).getPropertyValue("min-width");Ce=parseInt(Ce.replace("px","")),x(E.target,j[Ce])}}),ce||((he=document.createElement("style")).type="text/css",he.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",he.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(he),ce=!0);for(var I=0,X=document.styleSheets.length;I<X;I++)try{document.styleSheets[I].href&&0===document.styleSheets[I].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[I].href),K(document.styleSheets[I].cssRules||document.styleSheets[I].rules||document.styleSheets[I].cssText)}catch(E){}!function(){for(var I=A()("[data-responsive-image],[responsive-image]"),X=0,E=I.length;X<E;X++)y(I[X])}()},this.findElementQueriesElements=function(D){!function(D){var I=A(D);for(var X in W)if(W.hasOwnProperty(X))for(var E=I(X,D),$=0,Z=E.length;$<Z;$++)x(E[$],X)}(D)},this.update=function(){this.init()}};Y.update=function(){Y.instance.update()},Y.detach=function(he){he.elementQueriesSetupInformation?(he.elementQueriesSensor.detach(),delete he.elementQueriesSetupInformation,delete he.elementQueriesSensor):he.resizeSensorInstance&&(he.resizeSensorInstance.detach(),delete he.resizeSensorInstance)},Y.init=function(){Y.instance||(Y.instance=new Y),Y.instance.init()};return Y.findElementQueriesElements=function(he){Y.instance.findElementQueriesElements(he)},Y.listen=function(){!function(he){if(document.addEventListener)document.addEventListener("DOMContentLoaded",he,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var W=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(he(),clearInterval(W))},10);else window.onload=he}(Y.init)},Y})?yt.apply(it,ee):yt)&&(Ut.exports=Tt)},835:function(Ut,it,Je){"use strict";var yt,ee;"undefined"!=typeof window&&window,void 0!==(ee="function"==typeof(yt=function(){if("undefined"==typeof window)return null;var Tt="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=Tt.requestAnimationFrame||Tt.mozRequestAnimationFrame||Tt.webkitRequestAnimationFrame||function(Q){return Tt.setTimeout(Q,20)},Y=Tt.cancelAnimationFrame||Tt.mozCancelAnimationFrame||Tt.webkitCancelAnimationFrame||function(Q){Tt.clearTimeout(Q)};function Se(Q,z){var v=Object.prototype.toString.call(Q),x="[object Array]"===v||"[object NodeList]"===v||"[object HTMLCollection]"===v||"[object Object]"===v||"undefined"!=typeof jQuery&&Q instanceof jQuery||"undefined"!=typeof Elements&&Q instanceof Elements,O=0,A=Q.length;if(x)for(;O<A;O++)z(Q[O]);else z(Q)}function he(Q){if(!Q.getBoundingClientRect)return{width:Q.offsetWidth,height:Q.offsetHeight};var z=Q.getBoundingClientRect();return{width:Math.round(z.width),height:Math.round(z.height)}}function W(Q,z){Object.keys(z).forEach(function(v){Q.style[v]=z[v]})}var j=function(Q,z){var v=0;function x(){var b,y,A=[];this.add=function(S){A.push(S)},this.call=function(S){for(b=0,y=A.length;b<y;b++)A[b].call(this,S)},this.remove=function(S){var T=[];for(b=0,y=A.length;b<y;b++)A[b]!==S&&T.push(A[b]);A=T},this.length=function(){return A.length}}function O(A,b){if(A){if(A.resizedAttached)return void A.resizedAttached.add(b);A.resizedAttached=new x,A.resizedAttached.add(b),A.resizeSensor=document.createElement("div"),A.resizeSensor.dir="ltr",A.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},S={position:"absolute",left:"0px",top:"0px",transition:"0s"};W(A.resizeSensor,y);var T=document.createElement("div");T.className="resize-sensor-expand",W(T,y);var V=document.createElement("div");W(V,S),T.appendChild(V);var R=document.createElement("div");R.className="resize-sensor-shrink",W(R,y);var K=document.createElement("div");W(K,S),W(K,{width:"200%",height:"200%"}),R.appendChild(K),A.resizeSensor.appendChild(T),A.resizeSensor.appendChild(R),A.appendChild(A.resizeSensor);var ce=window.getComputedStyle(A),D=ce?ce.getPropertyValue("position"):null;"absolute"!==D&&"relative"!==D&&"fixed"!==D&&"sticky"!==D&&(A.style.position="relative");var I=!1,X=0,E=he(A),$=0,Z=0,oe=!0;v=0;var te=function(){if(oe){if(0===A.offsetWidth&&0===A.offsetHeight)return void(v||(v=dt(function(){v=0,te()})));oe=!1}var _e,Ie;Ie=A.offsetHeight,V.style.width=(_e=A.offsetWidth)+10+"px",V.style.height=Ie+10+"px",T.scrollLeft=_e+10,T.scrollTop=Ie+10,R.scrollLeft=_e+10,R.scrollTop=Ie+10};A.resizeSensor.resetSensor=te;var Ce=function(){X=0,I&&($=E.width,Z=E.height,A.resizedAttached&&A.resizedAttached.call(E))},me=function(){E=he(A),(I=E.width!==$||E.height!==Z)&&!X&&(X=dt(Ce)),te()},ne=function(_e,Ie,Ge){_e.attachEvent?_e.attachEvent("on"+Ie,Ge):_e.addEventListener(Ie,Ge)};ne(T,"scroll",me),ne(R,"scroll",me),v=dt(function(){v=0,te()})}}Se(Q,function(A){O(A,z)}),this.detach=function(A){v||(Y(v),v=0),j.detach(Q,A)},this.reset=function(){Q.resizeSensor.resetSensor()}};if(j.reset=function(Q){Se(Q,function(z){z.resizeSensor.resetSensor()})},j.detach=function(Q,z){Se(Q,function(v){!v||v.resizedAttached&&"function"==typeof z&&(v.resizedAttached.remove(z),v.resizedAttached.length())||v.resizeSensor&&(v.contains(v.resizeSensor)&&v.removeChild(v.resizeSensor),delete v.resizeSensor,delete v.resizedAttached)})},"undefined"!=typeof MutationObserver){var P=new MutationObserver(function(Q){for(var z in Q)if(Q.hasOwnProperty(z))for(var v=Q[z].addedNodes,x=0;x<v.length;x++)v[x].resizeSensor&&j.reset(v[x])});document.addEventListener("DOMContentLoaded",function(Q){P.observe(document.body,{childList:!0,subtree:!0})})}return j})?yt.call(it,Je,it,Ut):yt)&&(Ut.exports=ee)},445:(Ut,it,Je)=>{var yt=Je(910),ee=Je(369),Tt=Je(322);function dt(Q,z,v){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!Q.hasNode(z))throw new Error('graphology-shortest-path: the "'+z+'" source node does not exist in the given graph.');if(!Q.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" target node does not exist in the given graph.');if((z=""+z)==(v=""+v))return[z];var x=Q.inboundNeighbors.bind(Q),O=Q.outboundNeighbors.bind(Q),A={},b={};A[z]=null,b[v]=null;var T,V,R,K,ce,D,I,X,y=[z],S=[v],E=!1;e:for(;y.length&&S.length;)if(y.length<=S.length){for(T=y,y=[],ce=0,I=T.length;ce<I;ce++)for(D=0,X=(R=O(V=T[ce])).length;D<X;D++)if((K=R[D])in A||(y.push(K),A[K]=V),K in b){E=!0;break e}}else for(T=S,S=[],ce=0,I=T.length;ce<I;ce++)for(V=T[ce],R=x(V),D=0,X=R.length;D<X;D++)if(K=R[D],K in b||(S.push(K),b[K]=V),K in A){E=!0;break e}if(!E)return null;for(var $=[];K;)$.unshift(K),K=A[K];for(K=b[$[$.length-1]];K;)$.push(K),K=b[K];return $.length?$:null}function Y(Q,z){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!Q.hasNode(z))throw new Error('graphology-shortest-path: the "'+z+'" source node does not exist in the given graph.');var O,A,b,y,S,T,v={},x={};for(v[z=""+z]=!0,x[z]=[z];Object.keys(v).length;)for(b in O=v,v={},O)for(S=0,T=(A=Q.outboundNeighbors(b)).length;S<T;S++)x[y=A[S]]||(x[y]=x[b].concat(y),v[y]=!0);return x}function Se(Q,z,v){if(!yt(z))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!z.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" source node does not exist in the given graph.');v=""+v;var x=new Set,O={},A=0;O[v]=0;for(var y,S,T,b=[v];0!==b.length;){var V=[];for(y=0,S=b.length;y<S;y++)!x.has(T=b[y])&&(x.add(T),Tt(V,z[Q](T)),O[T]=A);A++,b=V}return O}var he=Se.bind(null,"outboundNeighbors"),W=Se.bind(null,"neighbors");function j(Q,z,v){return arguments.length<3?Y(Q,z):dt(Q,z,v)}j.bidirectional=dt,j.singleSource=Y,j.singleSourceLength=he,j.undirectedSingleSourceLength=W,j.brandes=function(Q,z){z=""+z;var b,y,S,T,V,R,K,ce,D,v=[],x={},O={},A=Q.nodes();for(R=0,ce=A.length;R<ce;R++)x[T=A[R]]=[],O[T]=0;var I={};O[z]=1,I[z]=0;for(var X=ee.of(z);X.size;)for(T=X.dequeue(),v.push(T),b=I[T],y=O[T],K=0,D=(S=Q.outboundNeighbors(T)).length;K<D;K++)(V=S[K])in I||(X.enqueue(V),I[V]=b+1),I[V]===b+1&&(O[V]+=y,x[V].push(T));return[v,x,O]},Ut.exports=j},910:Ut=>{Ut.exports=function(Je){return null!==Je&&"object"==typeof Je&&"function"==typeof Je.addUndirectedEdgeWithKey&&"function"==typeof Je.dropNode&&"boolean"==typeof Je.multi}},698:function(Ut){Ut.exports=function(){"use strict";function it(ie){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(fe){return typeof fe}:function(fe){return fe&&"function"==typeof Symbol&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe})(ie)}function Je(ie,fe){ie.prototype=Object.create(fe.prototype),ie.prototype.constructor=ie,ee(ie,fe)}function yt(ie){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(fe){return fe.__proto__||Object.getPrototypeOf(fe)})(ie)}function ee(ie,fe){return(ee=Object.setPrototypeOf||function(re,M){return re.__proto__=M,re})(ie,fe)}function Tt(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ie){return!1}}function dt(ie,fe,re){return(dt=Tt()?Reflect.construct:function(M,k,J){var we=[null];we.push.apply(we,k);var Fe=new(Function.bind.apply(M,we));return J&&ee(Fe,J.prototype),Fe}).apply(null,arguments)}function Y(ie){var fe="function"==typeof Map?new Map:void 0;return(Y=function(re){if(null===re||-1===Function.toString.call(re).indexOf("[native code]"))return re;if("function"!=typeof re)throw new TypeError("Super expression must either be null or a function");if(void 0!==fe){if(fe.has(re))return fe.get(re);fe.set(re,k)}function k(){return dt(re,arguments,yt(this).constructor)}return k.prototype=Object.create(re.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),ee(k,re)})(ie)}function Se(ie){if(void 0===ie)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ie}var he=function(){for(var ie=arguments[0],fe=1,re=arguments.length;fe<re;fe++)if(arguments[fe])for(var M in arguments[fe])ie[M]=arguments[fe][M];return ie};function W(ie,fe,re,M){var k=ie._nodes.get(fe),J=null;return k?J="mixed"===M?k.out&&k.out[re]||k.undirected&&k.undirected[re]:"directed"===M?k.out&&k.out[re]:k.undirected&&k.undirected[re]:J}function j(ie){return null!==ie&&"object"===it(ie)&&"function"==typeof ie.addUndirectedEdgeWithKey&&"function"==typeof ie.dropNode}function P(ie){return"object"===it(ie)&&null!==ie&&ie.constructor===Object}function Q(ie){var fe;for(fe in ie)return!1;return!0}function z(ie,fe,re){Object.defineProperty(ie,fe,{enumerable:!1,configurable:!1,writable:!0,value:re})}function v(ie,fe,re){var M={enumerable:!0,configurable:!0};"function"==typeof re?M.get=re:(M.value=re,M.writable=!1),Object.defineProperty(ie,fe,M)}function x(ie){return!(!P(ie)||ie.attributes&&!Array.isArray(ie.attributes))}"function"==typeof Object.assign&&(he=Object.assign);var O,A={exports:{}},b="object"==typeof Reflect?Reflect:null,y=b&&"function"==typeof b.apply?b.apply:function(ie,fe,re){return Function.prototype.apply.call(ie,fe,re)};O=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(ie){return Object.getOwnPropertyNames(ie).concat(Object.getOwnPropertySymbols(ie))}:function(ie){return Object.getOwnPropertyNames(ie)};var S=Number.isNaN||function(ie){return ie!=ie};function T(){T.init.call(this)}A.exports=T,A.exports.once=function(ie,fe){return new Promise(function(re,M){function k(we){ie.removeListener(fe,J),M(we)}function J(){"function"==typeof ie.removeListener&&ie.removeListener("error",k),re([].slice.call(arguments))}var we;Z(ie,fe,J,{once:!0}),"error"!==fe&&("function"==typeof(we=ie).on&&Z(we,"error",k,{once:!0}))})},T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var V=10;function R(ie){if("function"!=typeof ie)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ie)}function K(ie){return void 0===ie._maxListeners?T.defaultMaxListeners:ie._maxListeners}function ce(ie,fe,re,M){var k,J,we;if(R(re),void 0===(J=ie._events)?(J=ie._events=Object.create(null),ie._eventsCount=0):(void 0!==J.newListener&&(ie.emit("newListener",fe,re.listener?re.listener:re),J=ie._events),we=J[fe]),void 0===we)we=J[fe]=re,++ie._eventsCount;else if("function"==typeof we?we=J[fe]=M?[re,we]:[we,re]:M?we.unshift(re):we.push(re),(k=K(ie))>0&&we.length>k&&!we.warned){we.warned=!0;var nt=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");nt.name="MaxListenersExceededWarning",nt.emitter=ie,nt.type=fe,nt.count=we.length,console&&console.warn&&console.warn(nt)}return ie}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(ie,fe,re){var M={fired:!1,wrapFn:void 0,target:ie,type:fe,listener:re},k=D.bind(M);return k.listener=re,M.wrapFn=k,k}function X(ie,fe,re){var M=ie._events;if(void 0===M)return[];var k=M[fe];return void 0===k?[]:"function"==typeof k?re?[k.listener||k]:[k]:re?function(J){for(var we=new Array(J.length),Fe=0;Fe<we.length;++Fe)we[Fe]=J[Fe].listener||J[Fe];return we}(k):$(k,k.length)}function E(ie){var fe=this._events;if(void 0!==fe){var re=fe[ie];if("function"==typeof re)return 1;if(void 0!==re)return re.length}return 0}function $(ie,fe){for(var re=new Array(fe),M=0;M<fe;++M)re[M]=ie[M];return re}function Z(ie,fe,re,M){if("function"==typeof ie.on)M.once?ie.once(fe,re):ie.on(fe,re);else{if("function"!=typeof ie.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ie);ie.addEventListener(fe,function k(J){M.once&&ie.removeEventListener(fe,k),re(J)})}}function oe(ie){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ie}),this.done=!1}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return V},set:function(ie){if("number"!=typeof ie||ie<0||S(ie))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ie+".");V=ie}}),T.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(ie){if("number"!=typeof ie||ie<0||S(ie))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ie+".");return this._maxListeners=ie,this},T.prototype.getMaxListeners=function(){return K(this)},T.prototype.emit=function(ie){for(var fe=[],re=1;re<arguments.length;re++)fe.push(arguments[re]);var M="error"===ie,k=this._events;if(void 0!==k)M=M&&void 0===k.error;else if(!M)return!1;if(M){var J;if(fe.length>0&&(J=fe[0]),J instanceof Error)throw J;var we=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw we.context=J,we}var Fe=k[ie];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,fe);else{var nt=Fe.length,Ot=$(Fe,nt);for(re=0;re<nt;++re)y(Ot[re],this,fe)}return!0},T.prototype.on=T.prototype.addListener=function(ie,fe){return ce(this,ie,fe,!1)},T.prototype.prependListener=function(ie,fe){return ce(this,ie,fe,!0)},T.prototype.once=function(ie,fe){return R(fe),this.on(ie,I(this,ie,fe)),this},T.prototype.prependOnceListener=function(ie,fe){return R(fe),this.prependListener(ie,I(this,ie,fe)),this},T.prototype.off=T.prototype.removeListener=function(ie,fe){var re,M,k,J,we;if(R(fe),void 0===(M=this._events))return this;if(void 0===(re=M[ie]))return this;if(re===fe||re.listener===fe)0==--this._eventsCount?this._events=Object.create(null):(delete M[ie],M.removeListener&&this.emit("removeListener",ie,re.listener||fe));else if("function"!=typeof re){for(k=-1,J=re.length-1;J>=0;J--)if(re[J]===fe||re[J].listener===fe){we=re[J].listener,k=J;break}if(k<0)return this;0===k?re.shift():function(Fe,nt){for(;nt+1<Fe.length;nt++)Fe[nt]=Fe[nt+1];Fe.pop()}(re,k),1===re.length&&(M[ie]=re[0]),void 0!==M.removeListener&&this.emit("removeListener",ie,we||fe)}return this},T.prototype.removeAllListeners=function(ie){var fe,re,M;if(void 0===(re=this._events))return this;if(void 0===re.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==re[ie]&&(0==--this._eventsCount?this._events=Object.create(null):delete re[ie]),this;if(0===arguments.length){var k,J=Object.keys(re);for(M=0;M<J.length;++M)"removeListener"!==(k=J[M])&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(fe=re[ie]))this.removeListener(ie,fe);else if(void 0!==fe)for(M=fe.length-1;M>=0;M--)this.removeListener(ie,fe[M]);return this},T.prototype.listeners=function(ie){return X(this,ie,!0)},T.prototype.rawListeners=function(ie){return X(this,ie,!1)},T.listenerCount=function(ie,fe){return"function"==typeof ie.listenerCount?ie.listenerCount(fe):E.call(ie,fe)},T.prototype.listenerCount=E,T.prototype.eventNames=function(){return this._eventsCount>0?O(this._events):[]},oe.prototype.next=function(){if(this.done)return{done:!0};var ie=this._next();return ie.done&&(this.done=!0),ie},"undefined"!=typeof Symbol&&(oe.prototype[Symbol.iterator]=function(){return this}),oe.of=function(){var ie=arguments,fe=ie.length,re=0;return new oe(function(){return re>=fe?{done:!0}:{done:!1,value:ie[re++]}})},oe.empty=function(){var ie=new oe(null);return ie.done=!0,ie},oe.is=function(ie){return ie instanceof oe||"object"==typeof ie&&null!==ie&&"function"==typeof ie.next};var se=oe,te=function(ie,fe){for(var re,M=arguments.length>1?fe:1/0,k=M!==1/0?new Array(M):[],J=0;;){if(J===M)return k;if((re=ie.next()).done)return J!==fe?k.slice(0,J):k;k[J++]=re.value}},Ce=function(ie){function fe(re,M){var k;return(k=ie.call(this)||this).name="GraphError",k.message=re||"",k.data=M||{},k}return Je(fe,ie),fe}(Y(Error)),me=function(ie){function fe(re,M){var k;return(k=ie.call(this,re,M)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(k),fe.prototype.constructor),k}return Je(fe,ie),fe}(Ce),ne=function(ie){function fe(re,M){var k;return(k=ie.call(this,re,M)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(k),fe.prototype.constructor),k}return Je(fe,ie),fe}(Ce),_e=function(ie){function fe(re,M){var k;return(k=ie.call(this,re,M)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(k),fe.prototype.constructor),k}return Je(fe,ie),fe}(Ce);function Ie(ie,fe){this.key=ie,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function Ge(ie,fe){this.key=ie,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function st(ie,fe){this.key=ie,this.attributes=fe,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Xe(ie,fe,re,M,k,J){this.key=fe,this.attributes=J,this.undirected=ie,this.source=M,this.target=k,this.generatedKey=re}function tt(ie,fe,re,M,k,J,we){var Fe,nt,Ot="out",We="in";if(fe&&(Ot=We="undirected"),ie.multi){if(void 0===(nt=(Fe=J[Ot])[k])&&(nt=new Set,Fe[k]=nt),nt.add(re),M===k&&fe)return;void 0===(Fe=we[We])[M]&&(Fe[M]=nt)}else{if(J[Ot][k]=re,M===k&&fe)return;we[We][M]=re}}function Ye(ie,fe,re){var M=ie.multi,k=re.source,J=re.target,we=k.key,Fe=J.key,nt=k[fe?"undirected":"out"],Ot=fe?"undirected":"in";if(Fe in nt)if(M){var We=nt[Fe];1===We.size?(delete nt[Fe],delete J[Ot][we]):We.delete(re)}else delete nt[Fe];M||delete J[Ot][we]}Ge.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},st.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var Ue=[{name:function(ie){return"get".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+k;if(k=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return J.attributes[k]}}},{name:function(ie){return"get".concat(ie,"Attributes")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M){var k;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var J=""+M,we=""+arguments[1];if(!(k=W(this,J,we,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(J,'" - "').concat(we,'").'))}else if(!(k=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&k.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return k.attributes}}},{name:function(ie){return"has".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+k;if(k=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return J.attributes.hasOwnProperty(k)}}},{name:function(ie){return"set".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k,J){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+M,nt=""+k;if(k=arguments[2],J=arguments[3],!(we=W(this,Fe,nt,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(nt,'").'))}else if(!(we=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return we.attributes[k]=J,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:k}),this}}},{name:function(ie){return"update".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k,J){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+M,nt=""+k;if(k=arguments[2],J=arguments[3],!(we=W(this,Fe,nt,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(nt,'").'))}else if(!(we=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("function"!=typeof J)throw new me("Graph.".concat(fe,": updater should be a function."));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return we.attributes[k]=J(we.attributes[k]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:k}),this}}},{name:function(ie){return"remove".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+k;if(k=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return delete J.attributes[k],this.emit("edgeAttributesUpdated",{key:J.key,type:"remove",attributes:J.attributes,name:k}),this}}},{name:function(ie){return"replace".concat(ie,"Attributes")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+k;if(k=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!P(k))throw new me("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return J.attributes=k,this.emit("edgeAttributesUpdated",{key:J.key,type:"replace",attributes:J.attributes}),this}}},{name:function(ie){return"merge".concat(ie,"Attributes")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,k){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+k;if(k=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!P(k))throw new me("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return he(J.attributes,k),this.emit("edgeAttributesUpdated",{key:J.key,type:"merge",attributes:J.attributes,data:k}),this}}}],ke=se,Ke=function(){var ie,fe=arguments,re=-1;return new ke(function M(){if(!ie){if(++re>=fe.length)return{done:!0};ie=fe[re]}var k=ie.next();return k.done?(ie=null,M()):k})},Me=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ve(ie,fe){for(var re in fe)ie.push(fe[re].key)}function $e(ie,fe){for(var re in fe)fe[re].forEach(function(M){return ie.push(M.key)})}function Ne(ie,fe,re){for(var M in ie)if(M!==re){var k=ie[M];fe(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey)}}function q(ie,fe,re){for(var M in ie)M!==re&&ie[M].forEach(function(k){return fe(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey)})}function G(ie,fe,re){for(var M in ie)if(M!==re){var k=ie[M];if(fe(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey))return!0}return!1}function pe(ie,fe,re){var M,k,J,we,Fe;for(var nt in ie)if(nt!==re)for(M=ie[nt].values();!0!==(k=M.next()).done;)if(we=(J=k.value).source,fe(J.key,J.attributes,we.key,(Fe=J.target).key,we.attributes,Fe.attributes,J.undirected,J.generatedKey))return!0;return!1}function ue(ie,fe){var re=Object.keys(ie),M=re.length,k=null,J=0;return new se(function we(){var Fe;if(k){var nt=k.next();if(nt.done)return k=null,J++,we();Fe=nt.value}else{if(J>=M)return{done:!0};var Ot=re[J];if(Ot===fe)return J++,we();if((Fe=ie[Ot])instanceof Set)return k=Fe.values(),we();J++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function je(ie,fe,re){var M=fe[re];M&&ie.push(M.key)}function _t(ie,fe,re){var M=fe[re];M&&M.forEach(function(k){return ie.push(k.key)})}function pt(ie,fe,re){var M=ie[fe];if(M){var k=M.source,J=M.target;re(M.key,M.attributes,k.key,J.key,k.attributes,J.attributes,M.undirected,M.generatedKey)}}function ve(ie,fe,re){var M=ie[fe];M&&M.forEach(function(k){return re(k.key,k.attributes,k.source.key,k.target.key,k.source.attributes,k.target.attributes,k.undirected,k.generatedKey)})}function L(ie,fe,re){var M=ie[fe];if(M){var k=M.source,J=M.target;return re(M.key,M.attributes,k.key,J.key,k.attributes,J.attributes,M.undirected,M.generatedKey)}}function N(ie,fe,re){var M=ie[fe];if(M){for(var k,J,we=M.values();!0!==(k=we.next()).done;)if(re((J=k.value).key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes,J.undirected,J.generatedKey))return!0;return!1}}function B(ie,fe){var re=ie[fe];if(re instanceof Set){var M=re.values();return new se(function(){var k=M.next();if(k.done)return k;var J=k.value;return{done:!1,value:[J.key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes]}})}return se.of([re.key,re.attributes,re.source.key,re.target.key,re.source.attributes,re.target.attributes])}function Re(ie,fe){if(0===ie.size)return[];if("mixed"===fe||fe===ie.type)return"function"==typeof Array.from?Array.from(ie._edges.keys()):te(ie._edges.keys(),ie._edges.size);for(var re,M,J=new Array("undirected"===fe?ie.undirectedSize:ie.directedSize),we="undirected"===fe,Fe=ie._edges.values(),nt=0;!0!==(re=Fe.next()).done;)(M=re.value).undirected===we&&(J[nt++]=M.key);return J}function Qe(ie,fe,re){if(0!==ie.size)for(var M,k,J="mixed"!==fe&&fe!==ie.type,we="undirected"===fe,Fe=ie._edges.values();!0!==(M=Fe.next()).done;)if(k=M.value,!J||k.undirected===we){var Wt=k.source,Ct=k.target;re(k.key,k.attributes,Wt.key,Ct.key,Wt.attributes,Ct.attributes,k.undirected,k.generatedKey)}}function St(ie,fe,re){if(0!==ie.size)for(var M,k,J="mixed"!==fe&&fe!==ie.type,we="undirected"===fe,Fe=ie._edges.values();!0!==(M=Fe.next()).done;)if(k=M.value,!J||k.undirected===we){var Wt=k.source,Ct=k.target;if(re(k.key,k.attributes,Wt.key,Ct.key,Wt.attributes,Ct.attributes,k.undirected,k.generatedKey))break}}function Nt(ie,fe){if(0===ie.size)return se.empty();var re="mixed"!==fe&&fe!==ie.type,M="undirected"===fe,k=ie._edges.values();return new se(function(){for(var J,we;;){if((J=k.next()).done)return J;if(we=J.value,!re||we.undirected===M)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function On(ie,fe,re,M){var k=[],J=ie?$e:Ve;return"undirected"!==fe&&("out"!==re&&J(k,M.in),"in"!==re&&J(k,M.out),!re&&M.directedSelfLoops>0&&k.splice(k.lastIndexOf(M.key),1)),"directed"!==fe&&J(k,M.undirected),k}function kn(ie,fe,re,M,k){var J=ie?q:Ne;"undirected"!==fe&&("out"!==re&&J(M.in,k),"in"!==re&&J(M.out,k,re?null:M.key)),"directed"!==fe&&J(M.undirected,k)}function Yn(ie,fe,re,M,k){var J=ie?pe:G;"undirected"!==fe&&("out"!==re&&J(M.in,k)||"in"!==re&&J(M.out,k,re?null:M.key))||"directed"===fe||J(M.undirected,k)}function Ti(ie,fe,re){var M=se.empty();return"undirected"!==ie&&("out"!==fe&&void 0!==re.in&&(M=Ke(M,ue(re.in))),"in"!==fe&&void 0!==re.out&&(M=Ke(M,ue(re.out,fe?null:re.key)))),"directed"!==ie&&void 0!==re.undirected&&(M=Ke(M,ue(re.undirected))),M}function wi(ie,fe,re,M,k){var J=fe?_t:je,we=[];return"undirected"!==ie&&(void 0!==M.in&&"out"!==re&&J(we,M.in,k),void 0!==M.out&&"in"!==re&&J(we,M.out,k),!re&&M.directedSelfLoops>0&&we.splice(we.lastIndexOf(M.key),1)),"directed"!==ie&&void 0!==M.undirected&&J(we,M.undirected,k),we}function Kr(ie,fe,re,M,k,J){var we=fe?ve:pt;"undirected"!==ie&&(void 0!==M.in&&"out"!==re&&we(M.in,k,J),M.key!==k&&void 0!==M.out&&"in"!==re&&we(M.out,k,J)),"directed"!==ie&&void 0!==M.undirected&&we(M.undirected,k,J)}function Ls(ie,fe,re,M,k,J){var we=fe?N:L;"undirected"!==ie&&(void 0!==M.in&&"out"!==re&&we(M.in,k,J)||M.key!==k&&void 0!==M.out&&"in"!==re&&we(M.out,k,J,re?null:M.key))||"directed"===ie||void 0===M.undirected||we(M.undirected,k,J)}function gs(ie,fe,re,M){var k=se.empty();return"undirected"!==ie&&(void 0!==re.in&&"out"!==fe&&M in re.in&&(k=Ke(k,B(re.in,M))),void 0!==re.out&&"in"!==fe&&M in re.out&&(k=Ke(k,B(re.out,M)))),"directed"!==ie&&void 0!==re.undirected&&M in re.undirected&&(k=Ke(k,B(re.undirected,M))),k}var Bs=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Xr(ie,fe){if(void 0!==fe)for(var re in fe)ie.add(re)}function Ja(ie,fe,re){if("mixed"!==ie){if("undirected"===ie)return Object.keys(re.undirected);if("string"==typeof fe)return Object.keys(re[fe])}var M=new Set;return"undirected"!==ie&&("out"!==fe&&Xr(M,re.in),"in"!==fe&&Xr(M,re.out)),"directed"!==ie&&Xr(M,re.undirected),te(M.values(),M.size)}function Nl(ie,fe,re){for(var M in fe){var k=fe[M];k instanceof Set&&(k=k.values().next().value);var J=k.source,Fe=J===ie?k.target:J;re(Fe.key,Fe.attributes)}}function Ea(ie,fe,re,M){for(var k in re){var J=re[k];J instanceof Set&&(J=J.values().next().value);var we=J.source,nt=we===fe?J.target:we;ie.has(nt.key)||(ie.add(nt.key),M(nt.key,nt.attributes))}}function Es(ie,fe,re){for(var M in fe){var k=fe[M];k instanceof Set&&(k=k.values().next().value);var J=k.source,Fe=J===ie?k.target:J;if(re(Fe.key,Fe.attributes))return!0}return!1}function Zt(ie,fe,re,M){for(var k in re){var J=re[k];J instanceof Set&&(J=J.values().next().value);var we=J.source,nt=we===fe?J.target:we;if(!ie.has(nt.key)&&(ie.add(nt.key),M(nt.key,nt.attributes)))return!0}return!1}function el(ie,fe){var re=Object.keys(fe),M=re.length,k=0;return new se(function(){if(k>=M)return{done:!0};var J=fe[re[k++]];J instanceof Set&&(J=J.values().next().value);var we=J.source,nt=we===ie?J.target:we;return{done:!1,value:[nt.key,nt.attributes]}})}function rt(ie,fe,re){var M=Object.keys(re),k=M.length,J=0;return new se(function we(){if(J>=k)return{done:!0};var Fe=re[M[J++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var nt=Fe.source,We=nt===fe?Fe.target:nt;return ie.has(We.key)?we():(ie.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function lt(ie,fe,re,M,k){var J=ie._nodes.get(M);if("undirected"!==fe){if("out"!==re&&void 0!==J.in)for(var we in J.in)if(we===k)return!0;if("in"!==re&&void 0!==J.out)for(var Fe in J.out)if(Fe===k)return!0}if("directed"!==fe&&void 0!==J.undirected)for(var nt in J.undirected)if(nt===k)return!0;return!1}function Le(ie,fe,re){for(var M,k,J,we,Fe,nt,Ot,We=fe._nodes.values(),Wt=fe.type;!0!==(M=We.next()).done;){if(k=M.value,"undirected"!==Wt)for(J in we=k.out)if(nt=(Fe=we[J]).target,Ot=re(k.key,nt.key,k.attributes,nt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ie&&Ot)return;if("directed"!==Wt)for(J in we=k.undirected)if((nt=(Fe=we[J]).target).key!==J&&(nt=Fe.source),Ot=re(k.key,nt.key,k.attributes,nt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ie&&Ot)return}}function ut(ie,fe,re){for(var M,k,J,we,Fe,nt,Ot,We,Wt,Ct=fe._nodes.values(),yn=fe.type;!0!==(M=Ct.next()).done;){if(k=M.value,"undirected"!==yn)for(J in nt=k.out)for(we=nt[J].values();!0!==(Fe=we.next()).done;)if(We=(Ot=Fe.value).target,Wt=re(k.key,We.key,k.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),ie&&Wt)return;if("directed"!==yn)for(J in nt=k.undirected)for(we=nt[J].values();!0!==(Fe=we.next()).done;)if((We=(Ot=Fe.value).target).key!==J&&(We=Ot.source),Wt=re(k.key,We.key,k.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),ie&&Wt)return}}function Ze(ie,fe){var re={key:ie};return Q(fe.attributes)||(re.attributes=he({},fe.attributes)),re}function At(ie,fe){var re={source:fe.source.key,target:fe.target.key};return fe.generatedKey||(re.key=ie),Q(fe.attributes)||(re.attributes=he({},fe.attributes)),fe.undirected&&(re.undirected=!0),re}function Mt(ie){return P(ie)?"key"in ie?!("attributes"in ie)||P(ie.attributes)&&null!==ie.attributes?null:"invalid-attributes":"no-key":"not-object"}function Dt(ie){return P(ie)?"source"in ie?"target"in ie?!("attributes"in ie)||P(ie.attributes)&&null!==ie.attributes?"undirected"in ie&&"boolean"!=typeof ie.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Xt=new Set(["directed","undirected","mixed"]),zn=new Set(["domain","_events","_eventsCount","_maxListeners"]),ai={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function Nn(ie,fe,re){var M=new ie.NodeDataClass(fe,re);return ie._nodes.set(fe,M),ie.emit("nodeAdded",{key:fe,attributes:re}),M}function _n(ie,fe,re,M,k,J,we,Fe){if(!M&&"undirected"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!P(Fe))throw new me("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(J=""+J,we=""+we,Fe=Fe||{},!ie.allowSelfLoops&&J===we)throw new _e("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var nt=ie._nodes.get(J),Ot=ie._nodes.get(we);if(!nt)throw new ne("Graph.".concat(fe,': source node "').concat(J,'" not found.'));if(!Ot)throw new ne("Graph.".concat(fe,': target node "').concat(we,'" not found.'));var We={key:null,undirected:M,source:J,target:we,attributes:Fe};if(re&&(k=ie._edgeKeyGenerator(We)),ie._edges.has(k=""+k))throw new _e("Graph.".concat(fe,': the "').concat(k,'" edge already exists in the graph.'));if(!ie.multi&&(M?void 0!==nt.undirected[we]:void 0!==nt.out[we]))throw new _e("Graph.".concat(fe,': an edge linking "').concat(J,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var Wt=new Xe(M,k,re,nt,Ot,Fe);return ie._edges.set(k,Wt),J===we?M?(nt.undirectedSelfLoops++,ie._undirectedSelfLoopCount++):(nt.directedSelfLoops++,ie._directedSelfLoopCount++):M?(nt.undirectedDegree++,Ot.undirectedDegree++):(nt.outDegree++,Ot.inDegree++),tt(ie,M,Wt,J,we,nt,Ot),M?ie._undirectedSize++:ie._directedSize++,We.key=k,ie.emit("edgeAdded",We),k}function $n(ie,fe,re,M,k,J,we,Fe,nt){if(!M&&"undirected"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(nt){if("function"!=typeof Fe)throw new me("Graph.".concat(fe,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!P(Fe))throw new me("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Ot;if(J=""+J,we=""+we,nt&&(Ot=Fe,Fe=void 0),!ie.allowSelfLoops&&J===we)throw new _e("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,Wt,Ct=ie._nodes.get(J),yn=ie._nodes.get(we);if(!re&&(We=ie._edges.get(k))){if(We.source.key!==J||We.target.key!==we||M&&(We.source.key!==we||We.target.key!==J))throw new _e("Graph.".concat(fe,': inconsistency detected when attempting to merge the "').concat(k,'" edge with "').concat(J,'" source & "').concat(we,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));Wt=We}if(Wt||ie.multi||!Ct||(Wt=M?Ct.undirected[we]:Ct.out[we]),Wt)return(nt?Ot:Fe)?(nt?(Wt.attributes=Ot(Wt.attributes),ie.emit("edgeAttributesUpdated",{type:"replace",key:Wt.key,attributes:Wt.attributes})):(he(Wt.attributes,Fe),ie.emit("edgeAttributesUpdated",{type:"merge",key:Wt.key,attributes:Wt.attributes,data:Fe})),Wt.key):Wt.key;Fe=Fe||{},nt&&Ot&&(Fe=Ot(Fe));var Zr={key:null,undirected:M,source:J,target:we,attributes:Fe};if(re&&(k=ie._edgeKeyGenerator(Zr)),ie._edges.has(k=""+k))throw new _e("Graph.".concat(fe,': the "').concat(k,'" edge already exists in the graph.'));return Ct||(Ct=Nn(ie,J,{}),J===we&&(yn=Ct)),yn||(yn=Nn(ie,we,{})),We=new Xe(M,k,re,Ct,yn,Fe),ie._edges.set(k,We),J===we?M?(Ct.undirectedSelfLoops++,ie._undirectedSelfLoopCount++):(Ct.directedSelfLoops++,ie._directedSelfLoopCount++):M?(Ct.undirectedDegree++,yn.undirectedDegree++):(Ct.outDegree++,yn.inDegree++),tt(ie,M,We,J,we,Ct,yn),M?ie._undirectedSize++:ie._directedSize++,Zr.key=k,ie.emit("edgeAdded",Zr),k}var ie,Cn=function(ie){function fe(M){var k;if(k=ie.call(this)||this,(M=he({},ai,M)).edgeKeyGenerator&&"function"!=typeof M.edgeKeyGenerator)throw new me("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(M.edgeKeyGenerator,'".'));if("boolean"!=typeof M.multi)throw new me("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(M.multi,'".'));if(!Xt.has(M.type))throw new me('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(M.type,'".'));if("boolean"!=typeof M.allowSelfLoops)throw new me("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(M.allowSelfLoops,'".'));var J,we="mixed"===M.type?Ie:"directed"===M.type?Ge:st;return z(Se(k),"NodeDataClass",we),z(Se(k),"_attributes",{}),z(Se(k),"_nodes",new Map),z(Se(k),"_edges",new Map),z(Se(k),"_directedSize",0),z(Se(k),"_undirectedSize",0),z(Se(k),"_directedSelfLoopCount",0),z(Se(k),"_undirectedSelfLoopCount",0),z(Se(k),"_edgeKeyGenerator",M.edgeKeyGenerator||(J=0,function(){return J++})),z(Se(k),"_options",M),zn.forEach(function(Fe){return z(Se(k),Fe,k[Fe])}),v(Se(k),"order",function(){return k._nodes.size}),v(Se(k),"size",function(){return k._edges.size}),v(Se(k),"directedSize",function(){return k._directedSize}),v(Se(k),"undirectedSize",function(){return k._undirectedSize}),v(Se(k),"selfLoopCount",function(){return k._directedSelfLoopCount+k._undirectedSelfLoopCount}),v(Se(k),"directedSelfLoopCount",function(){return k._directedSelfLoopCount}),v(Se(k),"undirectedSelfLoopCount",function(){return k._undirectedSelfLoopCount}),v(Se(k),"multi",k._options.multi),v(Se(k),"type",k._options.type),v(Se(k),"allowSelfLoops",k._options.allowSelfLoops),v(Se(k),"implementation",function(){return"graphology"}),k}Je(fe,ie);var re=fe.prototype;return re.hasNode=function(M){return this._nodes.has(""+M)},re.hasDirectedEdge=function(M,k){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+M);return!!we&&!we.undirected}if(2===arguments.length){k=""+k;var Fe=this._nodes.get(M=""+M);if(!Fe)return!1;var nt=Fe.out[k];return!(!nt||this.multi&&!nt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasUndirectedEdge=function(M,k){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+M);return!!we&&we.undirected}if(2===arguments.length){k=""+k;var Fe=this._nodes.get(M=""+M);if(!Fe)return!1;var nt=Fe.undirected[k];return!(!nt||this.multi&&!nt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasEdge=function(M,k){if(1===arguments.length)return this._edges.has(""+M);if(2===arguments.length){k=""+k;var we=this._nodes.get(M=""+M);if(!we)return!1;var Fe=void 0!==we.out&&we.out[k];return Fe||(Fe=void 0!==we.undirected&&we.undirected[k]),!(!Fe||this.multi&&!Fe.size)}throw new me("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.directedEdge=function(M,k){if("undirected"!==this.type){if(M=""+M,k=""+k,this.multi)throw new _e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.directedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(k))throw new ne('Graph.directedEdge: could not find the "'.concat(k,'" target node in the graph.'));var we=J.out&&J.out[k]||void 0;return we?we.key:void 0}},re.undirectedEdge=function(M,k){if("directed"!==this.type){if(M=""+M,k=""+k,this.multi)throw new _e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.undirectedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(k))throw new ne('Graph.undirectedEdge: could not find the "'.concat(k,'" target node in the graph.'));var we=J.undirected&&J.undirected[k]||void 0;return we?we.key:void 0}},re.edge=function(M,k){if(this.multi)throw new _e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");k=""+k;var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.edge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(k))throw new ne('Graph.edge: could not find the "'.concat(k,'" target node in the graph.'));var we=J.out&&J.out[k]||J.undirected&&J.undirected[k]||void 0;if(we)return we.key},re.inDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.inDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.inDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.inDegree+(k?J.directedSelfLoops:0)},re.outDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.outDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.outDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.outDegree+(k?J.directedSelfLoops:0)},re.directedDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.directedDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.directedDegree: could not find the "'.concat(M,'" node in the graph.'));if("undirected"===this.type)return 0;var we=k?J.directedSelfLoops:0;return J.inDegree+we+(J.outDegree+we)},re.undirectedDegree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.undirectedDegree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.undirectedDegree: could not find the "'.concat(M,'" node in the graph.'));return"directed"===this.type?0:J.undirectedDegree+2*(k?J.undirectedSelfLoops:0)},re.degree=function(M){var k=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof k)throw new me('Graph.degree: Expecting a boolean but got "'.concat(k,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.degree: could not find the "'.concat(M,'" node in the graph.'));var we=0,Fe=0;return"directed"!==this.type&&(k&&(Fe=J.undirectedSelfLoops),we+=J.undirectedDegree+2*Fe),"undirected"!==this.type&&(k&&(Fe=J.directedSelfLoops),we+=J.inDegree+J.outDegree+2*Fe),we},re.source=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.source: could not find the "'.concat(M,'" edge in the graph.'));return k.source.key},re.target=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.target: could not find the "'.concat(M,'" edge in the graph.'));return k.target.key},re.extremities=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.extremities: could not find the "'.concat(M,'" edge in the graph.'));return[k.source.key,k.target.key]},re.opposite=function(M,k){M=""+M;var J=this._edges.get(k=""+k);if(!J)throw new ne('Graph.opposite: could not find the "'.concat(k,'" edge in the graph.'));var we=J.source.key,Fe=J.target.key;if(M!==we&&M!==Fe)throw new ne('Graph.opposite: the "'.concat(M,'" node is not attached to the "').concat(k,'" edge (').concat(we,", ").concat(Fe,")."));return M===we?Fe:we},re.hasExtremity=function(M,k){k=""+k;var J=this._edges.get(M=""+M);if(!J)throw new ne('Graph.hasExtremity: could not find the "'.concat(M,'" edge in the graph.'));return J.source.key===k||J.target.key===k},re.isUndirected=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.isUndirected: could not find the "'.concat(M,'" edge in the graph.'));return k.undirected},re.isDirected=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.isDirected: could not find the "'.concat(M,'" edge in the graph.'));return!k.undirected},re.isSelfLoop=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.isSelfLoop: could not find the "'.concat(M,'" edge in the graph.'));return k.source===k.target},re.hasGeneratedKey=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.hasGeneratedKey: could not find the "'.concat(M,'" edge in the graph.'));return k.generatedKey},re.addNode=function(M,k){return function(J,we,Fe){if(Fe&&!P(Fe))throw new me('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},J._nodes.has(we=""+we))throw new _e('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var nt=new J.NodeDataClass(we,Fe);return J._nodes.set(we,nt),J.emit("nodeAdded",{key:we,attributes:Fe}),nt}(this,M,k).key},re.mergeNode=function(M,k){if(k&&!P(k))throw new me('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(k,'"'));k=k||{};var J=this._nodes.get(M=""+M);return J?(k&&(he(J.attributes,k),this.emit("nodeAttributesUpdated",{type:"merge",key:M,attributes:J.attributes,data:k})),M):(J=new this.NodeDataClass(M,k),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:k}),M)},re.updateNode=function(M,k){if(k&&"function"!=typeof k)throw new me('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(k,'"'));var J=this._nodes.get(M=""+M);if(J)return k&&(J.attributes=k(J.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:M,attributes:J.attributes})),M;var Fe=k?k({}):{};return J=new this.NodeDataClass(M,Fe),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:Fe}),M},re.dropNode=function(M){var k=this,J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.dropNode: could not find the "'.concat(M,'" node in the graph.'));this.forEachEdge(M,function(we){k.dropEdge(we)}),this._nodes.delete(M),this.emit("nodeDropped",{key:M,attributes:J.attributes})},re.dropEdge=function(M){var k;if(arguments.length>1){var J=""+arguments[0],we=""+arguments[1];if(!(k=W(this,J,we,this.type)))throw new ne('Graph.dropEdge: could not find the "'.concat(J,'" -> "').concat(we,'" edge in the graph.'))}else if(!(k=this._edges.get(M=""+M)))throw new ne('Graph.dropEdge: could not find the "'.concat(M,'" edge in the graph.'));this._edges.delete(k.key);var nt=k.source,Ot=k.target,We=k.attributes,Wt=k.undirected;return nt===Ot?Wt?(nt.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(nt.directedSelfLoops--,this._directedSelfLoopCount--):Wt?(nt.undirectedDegree--,Ot.undirectedDegree--):(nt.outDegree--,Ot.inDegree--),Ye(this,Wt,k),Wt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:M,attributes:We,source:nt.key,target:Ot.key,undirected:Wt}),this},re.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},re.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},re.getAttribute=function(M){return this._attributes[M]},re.getAttributes=function(){return this._attributes},re.hasAttribute=function(M){return this._attributes.hasOwnProperty(M)},re.setAttribute=function(M,k){return this._attributes[M]=k,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},re.updateAttribute=function(M,k){if("function"!=typeof k)throw new me("Graph.updateAttribute: updater should be a function.");return this._attributes[M]=k(this._attributes[M]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},re.removeAttribute=function(M){return delete this._attributes[M],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:M}),this},re.replaceAttributes=function(M){if(!P(M))throw new me("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=M,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},re.mergeAttributes=function(M){if(!P(M))throw new me("Graph.mergeAttributes: provided attributes are not a plain object.");return he(this._attributes,M),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:M}),this},re.getNodeAttribute=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.getNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes[k]},re.getNodeAttributes=function(M){var k=this._nodes.get(M=""+M);if(!k)throw new ne('Graph.getNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));return k.attributes},re.hasNodeAttribute=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes.hasOwnProperty(k)},re.setNodeAttribute=function(M,k,J){var we=this._nodes.get(M=""+M);if(!we)throw new ne('Graph.setNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[k]=J,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:we.attributes,name:k}),this},re.updateNodeAttribute=function(M,k,J){var we=this._nodes.get(M=""+M);if(!we)throw new ne('Graph.updateNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof J)throw new me("Graph.updateAttribute: updater should be a function.");var Fe=we.attributes,nt=J(Fe[k]);return Fe[k]=nt,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:we.attributes,name:k}),this},re.removeNodeAttribute=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return delete J.attributes[k],this.emit("nodeAttributesUpdated",{key:M,type:"remove",attributes:J.attributes,name:k}),this},re.replaceNodeAttributes=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.replaceNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!P(k))throw new me("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return J.attributes=k,this.emit("nodeAttributesUpdated",{key:M,type:"replace",attributes:J.attributes}),this},re.mergeNodeAttributes=function(M,k){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.mergeNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!P(k))throw new me("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return he(J.attributes,k),this.emit("nodeAttributesUpdated",{key:M,type:"merge",attributes:J.attributes,data:k}),this},re.updateEachNodeAttributes=function(M,k){if("function"!=typeof M)throw new me("Graph.updateEachNodeAttributes: expecting an updater function.");if(k&&!x(k))throw new me("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,we,Fe=this._nodes.values();!0!==(J=Fe.next()).done;)(we=J.value).attributes=M(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:k||null})},re.updateEachEdgeAttributes=function(M,k){if("function"!=typeof M)throw new me("Graph.updateEachEdgeAttributes: expecting an updater function.");if(k&&!x(k))throw new me("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,we,Fe=this._edges.values();!0!==(J=Fe.next()).done;)(we=J.value).attributes=M(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:k||null})},re.forEach=function(M){if("function"!=typeof M)throw new me("Graph.forEach: expecting a callback.");this.multi?ut(!1,this,M):Le(!1,this,M)},re.forEachUntil=function(M){if("function"!=typeof M)throw new me("Graph.forEach: expecting a callback.");this.multi?ut(!0,this,M):Le(!0,this,M)},re.adjacency=function(){return this.multi?(nt=(M=this)._nodes.values(),Ot=M.type,We="outer",Wt=null,new se(function Ct(){var yn;if("outer"===We)return!0===(yn=nt.next()).done?yn:(k=yn.value,We="directed",Ct());if("directed"===We)return"undirected"===Ot?(We="undirected",Ct()):(we=k.out,J=Object.keys(k.out),Fe=0,We="inner-directed",Ct());if("undirected"===We){if("directed"===Ot)return We="outer",Ct();we=k.undirected,J=Object.keys(k.undirected),Fe=0,We="inner-undirected"}if(!Wt&&Fe>=J.length)return We="inner-undirected"===We?"outer":"undirected",Ct();if(!Wt){var Ss=J[Fe++];return Wt=we[Ss].values(),Ct()}if((yn=Wt.next()).done)return Wt=null,Ct();var Zr=yn.value,Qs=Zr.target;return"inner-undirected"===We&&Qs.key===k.key&&(Qs=Zr.source),{done:!1,value:[k.key,Qs.key,k.attributes,Qs.attributes,Zr.key,Zr.attributes]}})):(Pl=(Ct=this)._nodes.values(),po=Ct.type,jr="outer",new se(function js(){var Sc;if("outer"===jr)return!0===(Sc=Pl.next()).done?Sc:(yn=Sc.value,jr="directed",js());if("directed"===jr)return"undirected"===po?(jr="undirected",js()):(Zr=yn.out,Ss=Object.keys(yn.out),Qs=0,jr="inner-directed",js());if("undirected"===jr){if("directed"===po)return jr="outer",js();Zr=yn.undirected,Ss=Object.keys(yn.undirected),Qs=0,jr="inner-undirected"}if(Qs>=Ss.length)return jr="inner-undirected"===jr?"outer":"undirected",js();var wn=Ss[Qs++],go=Zr[wn],Fl=go.target;return"inner-undirected"===jr&&Fl.key===yn.key&&(Fl=go.source),{done:!1,value:[yn.key,Fl.key,yn.attributes,Fl.attributes,go.key,go.attributes]}}));var Ct,yn,Ss,Zr,Qs,Pl,po,jr,M,k,J,we,Fe,nt,Ot,We,Wt},re.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):te(this._nodes.keys(),this._nodes.size)},re.forEachNode=function(M){if("function"!=typeof M)throw new me("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(k,J){M(J,k.attributes)})},re.forEachNodeUntil=function(M){if("function"!=typeof M)throw new me("Graph.forEachNode: expecting a callback.");for(var k,J,we=this._nodes.values();!0!==(k=we.next())&&!M((J=k.value).key,J.attributes););},re.nodeEntries=function(){var M=this._nodes.values();return new se(function(){var k=M.next();if(k.done)return k;var J=k.value;return{value:[J.key,J.attributes],done:!1}})},re.exportNode=function(M){var k=this._nodes.get(M=""+M);if(!k)throw new ne('Graph.exportNode: could not find the "'.concat(M,'" node in the graph.'));return Ze(M,k)},re.exportEdge=function(M){var k=this._edges.get(M=""+M);if(!k)throw new ne('Graph.exportEdge: could not find the "'.concat(M,'" edge in the graph.'));return At(M,k)},re.export=function(){var M=new Array(this._nodes.size),k=0;this._nodes.forEach(function(we,Fe){M[k++]=Ze(Fe,we)});var J=new Array(this._edges.size);return k=0,this._edges.forEach(function(we,Fe){J[k++]=At(Fe,we)}),{attributes:this.getAttributes(),nodes:M,edges:J,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},re.importNode=function(M){var k=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Mt(M);if(J){if("not-object"===J)throw new me('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===J)throw new me("Graph.importNode: no key provided.");if("invalid-attributes"===J)throw new me("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=M.key,Fe=M.attributes,nt=void 0===Fe?{}:Fe;return k?this.mergeNode(we,nt):this.addNode(we,nt),this},re.importEdge=function(M){var k=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Dt(M);if(J){if("not-object"===J)throw new me('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===J)throw new me("Graph.importEdge: missing souce.");if("no-target"===J)throw new me("Graph.importEdge: missing target.");if("invalid-attributes"===J)throw new me("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===J)throw new me("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=M.source,Fe=M.target,nt=M.attributes,Ot=void 0===nt?{}:nt,We=M.undirected,Wt=void 0!==We&&We;return"key"in M?(k?Wt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Wt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,M.key,we,Fe,Ot):(k?Wt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Wt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Fe,Ot),this},re.import=function(M){var k,J,we,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(j(M))return this.import(M.export(),Fe),this;if(!P(M))throw new me("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(M.attributes){if(!P(M.attributes))throw new me("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(M.attributes):this.replaceAttributes(M.attributes)}if(M.nodes){if(we=M.nodes,!Array.isArray(we))throw new me("Graph.import: invalid nodes. Expecting an array.");for(k=0,J=we.length;k<J;k++)this.importNode(we[k],Fe)}if(M.edges){if(we=M.edges,!Array.isArray(we))throw new me("Graph.import: invalid edges. Expecting an array.");for(k=0,J=we.length;k<J;k++)this.importEdge(we[k],Fe)}return this},re.nullCopy=function(M){return new fe(he({},this._options,M))},re.emptyCopy=function(M){var k=this.nullCopy(M);return this._nodes.forEach(function(J,we){var Fe=he({},J.attributes);J=new k.NodeDataClass(we,Fe),k._nodes.set(we,J)}),k},re.copy=function(){var M=new fe(this._options);return M.import(this),M},re.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(M){return M.upgradeToMixed()}),this._options.type="mixed",v(this,"type",this._options.type),z(this,"NodeDataClass",Ie)),this},re.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,v(this,"multi",!0),(M=this)._nodes.forEach(function(k,J){if(k.out)for(var we in k.out){var Fe=new Set;Fe.add(k.out[we]),k.out[we]=Fe,M._nodes.get(we).in[J]=Fe}if(k.undirected)for(var nt in k.undirected)if(!(nt>J)){var Ot=new Set;Ot.add(k.undirected[nt]),k.undirected[nt]=Ot,M._nodes.get(nt).undirected[J]=Ot}})),this;var M},re.clearIndex=function(){return this._nodes.forEach(function(M){void 0!==M.in&&(M.in={},M.out={}),void 0!==M.undirected&&(M.undirected={})}),this},re.toJSON=function(){return this.export()},re.toString=function(){return"[object Graph]"},re.inspect=function(){var M=this,k={};this._nodes.forEach(function(Ot,We){k[We]=Ot.attributes});var J={},we={};this._edges.forEach(function(Ot,We){var Wt=Ot.undirected?"--":"->",Ct="",yn="(".concat(Ot.source.key,")").concat(Wt,"(").concat(Ot.target.key,")");Ot.generatedKey?M.multi&&(void 0===we[yn]?we[yn]=0:we[yn]++,Ct+="".concat(we[yn],". ")):Ct+="[".concat(We,"]: "),J[Ct+=yn]=Ot.attributes});var Fe={};for(var nt in this)this.hasOwnProperty(nt)&&!zn.has(nt)&&"function"!=typeof this[nt]&&(Fe[nt]=this[nt]);return Fe.attributes=this._attributes,Fe.nodes=k,Fe.edges=J,z(Fe,"constructor",this.constructor),Fe},fe}(A.exports.EventEmitter);"undefined"!=typeof Symbol&&(Cn.prototype[Symbol.for("nodejs.util.inspect.custom")]=Cn.prototype.inspect),[{name:function(ie){return"".concat(ie,"Edge")},generateKey:!0},{name:function(ie){return"".concat(ie,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ie){return"".concat(ie,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ie){return"".concat(ie,"EdgeWithKey")}},{name:function(ie){return"".concat(ie,"DirectedEdgeWithKey")},type:"directed"},{name:function(ie){return"".concat(ie,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ie){["add","merge","update"].forEach(function(fe){var re=ie.name(fe),M="add"===fe?_n:$n;Cn.prototype[re]=ie.generateKey?function(k,J,we){return M(this,re,!0,"undirected"===(ie.type||this.type),null,k,J,we,"update"===fe)}:function(k,J,we,Fe){return M(this,re,!1,"undirected"===(ie.type||this.type),k,J,we,Fe,"update"===fe)}})}),"undefined"!=typeof Symbol&&(Cn.prototype[Symbol.iterator]=Cn.prototype.adjacency),ie=Cn,Ue.forEach(function(fe){var re=fe.name,M=fe.attacher;M(ie,re("Edge"),"mixed"),M(ie,re("DirectedEdge"),"directed"),M(ie,re("UndirectedEdge"),"undirected")}),function(ie){Me.forEach(function(fe){var M,k,J,we;J=(M=fe).type,we=M.direction,ie.prototype[k=M.name]=function(Fe,nt){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(!arguments.length)return Re(this,J);if(1===arguments.length){var Ot=this._nodes.get(Fe=""+Fe);if(void 0===Ot)throw new ne("Graph.".concat(k,': could not find the "').concat(Fe,'" node in the graph.'));return On(this.multi,"mixed"===J?this.type:J,we,Ot)}if(2===arguments.length){nt=""+nt;var We=this._nodes.get(Fe=""+Fe);if(!We)throw new ne("Graph.".concat(k,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(nt))throw new ne("Graph.".concat(k,':  could not find the "').concat(nt,'" target node in the graph.'));return wi(J,this.multi,we,We,nt)}throw new me("Graph.".concat(k,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(re,M){var k=M.name,J=M.type,we=M.direction,Fe="forEach"+k[0].toUpperCase()+k.slice(1,-1);re.prototype[Fe]=function(nt,Ot,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return Qe(this,J,We=nt);if(2===arguments.length){We=Ot;var Wt=this._nodes.get(nt=""+nt);if(void 0===Wt)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return kn(this.multi,"mixed"===J?this.type:J,we,Wt,We)}if(3===arguments.length){Ot=""+Ot;var Ct=this._nodes.get(nt=""+nt);if(!Ct)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return Kr(J,this.multi,we,Ct,Ot,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ie,fe),function(re,M){var k=M.name,J=M.type,we=M.direction,Fe="forEach"+k[0].toUpperCase()+k.slice(1,-1)+"Until";re.prototype[Fe]=function(nt,Ot,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return St(this,J,We=nt);if(2===arguments.length){We=Ot;var Wt=this._nodes.get(nt=""+nt);if(void 0===Wt)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Yn(this.multi,"mixed"===J?this.type:J,we,Wt,We)}if(3===arguments.length){Ot=""+Ot;var Ct=this._nodes.get(nt=""+nt);if(!Ct)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return Ls(J,this.multi,we,Ct,Ot,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ie,fe),function(re,M){var J=M.type,we=M.direction,Fe=M.name.slice(0,-1)+"Entries";re.prototype[Fe]=function(nt,Ot){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return se.empty();if(!arguments.length)return Nt(this,J);if(1===arguments.length){var We=this._nodes.get(nt=""+nt);if(!We)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Ti(J,we,We)}if(2===arguments.length){Ot=""+Ot;var Wt=this._nodes.get(nt=""+nt);if(!Wt)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return gs(J,we,Wt,Ot)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ie,fe)})}(Cn),function(ie){Bs.forEach(function(fe){var M,k,J,we;J=(M=fe).type,we=M.direction,ie.prototype[k=M.name]=function(Fe){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(2===arguments.length){var nt=""+arguments[0],Ot=""+arguments[1];if(!this._nodes.has(nt))throw new ne("Graph.".concat(k,': could not find the "').concat(nt,'" node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(k,': could not find the "').concat(Ot,'" node in the graph.'));return lt(this,J,we,nt,Ot)}if(1===arguments.length){var We=this._nodes.get(Fe=""+Fe);if(void 0===We)throw new ne("Graph.".concat(k,': could not find the "').concat(Fe,'" node in the graph.'));return Ja("mixed"===J?this.type:J,we,We)}throw new me("Graph.".concat(k,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ie,fe){var re=fe.name,M=fe.type,k=fe.direction,J="forEach"+re[0].toUpperCase()+re.slice(1,-1);ie.prototype[J]=function(we,Fe){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(we=""+we);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(we,'" node in the graph.'));!function(Ot,We,Wt,Ct){if("mixed"!==Ot){if("undirected"===Ot)return Nl(Wt,Wt.undirected,Ct);if("string"==typeof We)return Nl(Wt,Wt[We],Ct)}var yn=new Set;"undirected"!==Ot&&("out"!==We&&Ea(yn,Wt,Wt.in,Ct),"in"!==We&&Ea(yn,Wt,Wt.out,Ct)),"directed"!==Ot&&Ea(yn,Wt,Wt.undirected,Ct)}("mixed"===M?this.type:M,k,nt,Fe)}}}(ie,fe),function(ie,fe){var re=fe.name,M=fe.type,k=fe.direction,J="forEach"+re[0].toUpperCase()+re.slice(1,-1)+"Until";ie.prototype[J]=function(we,Fe){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(we=""+we);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(we,'" node in the graph.'));!function(Ot,We,Wt,Ct){if("mixed"!==Ot){if("undirected"===Ot)return Es(Wt,Wt.undirected,Ct);if("string"==typeof We)return Es(Wt,Wt[We],Ct)}var yn=new Set;"undirected"!==Ot&&("out"!==We&&Zt(yn,Wt,Wt.in,Ct)||"in"!==We&&Zt(yn,Wt,Wt.out,Ct))||"directed"===Ot||Zt(yn,Wt,Wt.undirected,Ct)}("mixed"===M?this.type:M,k,nt,Fe)}}}(ie,fe),function(ie,fe){var M=fe.type,k=fe.direction,J=fe.name.slice(0,-1)+"Entries";ie.prototype[J]=function(we){if("mixed"!==M&&"mixed"!==this.type&&M!==this.type)return se.empty();var Fe=this._nodes.get(we=""+we);if(void 0===Fe)throw new ne("Graph.".concat(J,': could not find the "').concat(we,'" node in the graph.'));return function(nt,Ot,We){if("mixed"!==nt){if("undirected"===nt)return el(We,We.undirected);if("string"==typeof Ot)return el(We,We[Ot])}var Wt=se.empty(),Ct=new Set;return"undirected"!==nt&&("out"!==Ot&&(Wt=Ke(Wt,rt(Ct,We,We.in))),"in"!==Ot&&(Wt=Ke(Wt,rt(Ct,We,We.out)))),"directed"!==nt&&(Wt=Ke(Wt,rt(Ct,We,We.undirected))),Wt}("mixed"===M?this.type:M,k,Fe)}}(ie,fe)})}(Cn);var lr=function(ie){function fe(re){var M=he({type:"directed"},re);if("multi"in M&&!1!==M.multi)throw new me("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==M.type)throw new me('DirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(Cn),cr=function(ie){function fe(re){var M=he({type:"undirected"},re);if("multi"in M&&!1!==M.multi)throw new me("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==M.type)throw new me('UndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(Cn),Xn=function(ie){function fe(re){var M=he({multi:!0},re);if("multi"in M&&!0!==M.multi)throw new me("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ie.call(this,M)||this}return Je(fe,ie),fe}(Cn),qi=function(ie){function fe(re){var M=he({type:"directed",multi:!0},re);if("multi"in M&&!0!==M.multi)throw new me("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==M.type)throw new me('MultiDirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(Cn),Sa=function(ie){function fe(re){var M=he({type:"undirected",multi:!0},re);if("multi"in M&&!0!==M.multi)throw new me("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==M.type)throw new me('MultiUndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(Cn);function Qr(ie){ie.from=function(fe,re){var M=he({},fe.options,re),k=new ie(M);return k.import(fe),k}}return Qr(Cn),Qr(lr),Qr(cr),Qr(Xn),Qr(qi),Qr(Sa),Cn.Graph=Cn,Cn.DirectedGraph=lr,Cn.UndirectedGraph=cr,Cn.MultiGraph=Xn,Cn.MultiDirectedGraph=qi,Cn.MultiUndirectedGraph=Sa,Cn.InvalidArgumentsGraphError=me,Cn.NotFoundGraphError=ne,Cn.UsageGraphError=_e,Cn}()},524:(Ut,it,Je)=>{var yt;!function(ee,Tt,dt,Y){"use strict";var A,Se=["","webkit","Moz","MS","ms","o"],he=Tt.createElement("div"),j=Math.round,P=Math.abs,Q=Date.now;function z(ye,De,He){return setTimeout(T(ye,He),De)}function v(ye,De,He){return!!Array.isArray(ye)&&(x(ye,He[De],He),!0)}function x(ye,De,He){var bt;if(ye)if(ye.forEach)ye.forEach(De,He);else if(ye.length!==Y)for(bt=0;bt<ye.length;)De.call(He,ye[bt],bt,ye),bt++;else for(bt in ye)ye.hasOwnProperty(bt)&&De.call(He,ye[bt],bt,ye)}function O(ye,De,He){var bt="DEPRECATED METHOD: "+De+"\n"+He+" AT \n";return function(){var Gt=new Error("get-stack-trace"),Yt=Gt&&Gt.stack?Gt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",li=ee.console&&(ee.console.warn||ee.console.log);return li&&li.call(ee.console,bt,Yt),ye.apply(this,arguments)}}A="function"!=typeof Object.assign?function(De){if(De===Y||null===De)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(De),bt=1;bt<arguments.length;bt++){var Gt=arguments[bt];if(Gt!==Y&&null!==Gt)for(var Yt in Gt)Gt.hasOwnProperty(Yt)&&(He[Yt]=Gt[Yt])}return He}:Object.assign;var b=O(function(De,He,bt){for(var Gt=Object.keys(He),Yt=0;Yt<Gt.length;)(!bt||bt&&De[Gt[Yt]]===Y)&&(De[Gt[Yt]]=He[Gt[Yt]]),Yt++;return De},"extend","Use `assign`."),y=O(function(De,He){return b(De,He,!0)},"merge","Use `assign`.");function S(ye,De,He){var Gt,bt=De.prototype;(Gt=ye.prototype=Object.create(bt)).constructor=ye,Gt._super=bt,He&&A(Gt,He)}function T(ye,De){return function(){return ye.apply(De,arguments)}}function V(ye,De){return"function"==typeof ye?ye.apply(De&&De[0]||Y,De):ye}function R(ye,De){return ye===Y?De:ye}function K(ye,De,He){x(X(De),function(bt){ye.addEventListener(bt,He,!1)})}function ce(ye,De,He){x(X(De),function(bt){ye.removeEventListener(bt,He,!1)})}function D(ye,De){for(;ye;){if(ye==De)return!0;ye=ye.parentNode}return!1}function I(ye,De){return ye.indexOf(De)>-1}function X(ye){return ye.trim().split(/\s+/g)}function E(ye,De,He){if(ye.indexOf&&!He)return ye.indexOf(De);for(var bt=0;bt<ye.length;){if(He&&ye[bt][He]==De||!He&&ye[bt]===De)return bt;bt++}return-1}function $(ye){return Array.prototype.slice.call(ye,0)}function Z(ye,De,He){for(var bt=[],Gt=[],Yt=0;Yt<ye.length;){var li=De?ye[Yt][De]:ye[Yt];E(Gt,li)<0&&bt.push(ye[Yt]),Gt[Yt]=li,Yt++}return He&&(bt=De?bt.sort(function(Jr,xs){return Jr[De]>xs[De]}):bt.sort()),bt}function oe(ye,De){for(var He,bt,Gt=De[0].toUpperCase()+De.slice(1),Yt=0;Yt<Se.length;){if((bt=(He=Se[Yt])?He+Gt:De)in ye)return bt;Yt++}return Y}var se=1;function Ce(ye){var De=ye.ownerDocument||ye;return De.defaultView||De.parentWindow||ee}var ne="ontouchstart"in ee,_e=oe(ee,"PointerEvent")!==Y,Ie=ne&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ge="touch",Xe="mouse",_t=["x","y"],pt=["clientX","clientY"];function ve(ye,De){var He=this;this.manager=ye,this.callback=De,this.element=ye.element,this.target=ye.options.inputTarget,this.domHandler=function(bt){V(ye.options.enable,[ye])&&He.handler(bt)},this.init()}function N(ye,De,He){var bt=He.pointers.length,Gt=He.changedPointers.length,Yt=1&De&&bt-Gt==0,li=12&De&&bt-Gt==0;He.isFirst=!!Yt,He.isFinal=!!li,Yt&&(ye.session={}),He.eventType=De,function(ye,De){var He=ye.session,bt=De.pointers,Gt=bt.length;He.firstInput||(He.firstInput=St(De)),Gt>1&&!He.firstMultiple?He.firstMultiple=St(De):1===Gt&&(He.firstMultiple=!1);var Yt=He.firstInput,li=He.firstMultiple,Vr=li?li.center:Yt.center,Jr=De.center=Nt(bt);De.timeStamp=Q(),De.deltaTime=De.timeStamp-Yt.timeStamp,De.angle=Ti(Vr,Jr),De.distance=Yn(Vr,Jr),function(ye,De){var He=De.center,bt=ye.offsetDelta||{},Gt=ye.prevDelta||{},Yt=ye.prevInput||{};(1===De.eventType||4===Yt.eventType)&&(Gt=ye.prevDelta={x:Yt.deltaX||0,y:Yt.deltaY||0},bt=ye.offsetDelta={x:He.x,y:He.y}),De.deltaX=Gt.x+(He.x-bt.x),De.deltaY=Gt.y+(He.y-bt.y)}(He,De),De.offsetDirection=kn(De.deltaX,De.deltaY);var xs=On(De.deltaTime,De.deltaX,De.deltaY);De.overallVelocityX=xs.x,De.overallVelocityY=xs.y,De.overallVelocity=P(xs.x)>P(xs.y)?xs.x:xs.y,De.scale=li?function(ye,De){return Yn(De[0],De[1],pt)/Yn(ye[0],ye[1],pt)}(li.pointers,bt):1,De.rotation=li?function(ye,De){return Ti(De[1],De[0],pt)+Ti(ye[1],ye[0],pt)}(li.pointers,bt):0,De.maxPointers=He.prevInput?De.pointers.length>He.prevInput.maxPointers?De.pointers.length:He.prevInput.maxPointers:De.pointers.length,function(ye,De){var Gt,Yt,li,Vr,He=ye.lastInterval||De,bt=De.timeStamp-He.timeStamp;if(8!=De.eventType&&(bt>25||He.velocity===Y)){var Jr=De.deltaX-He.deltaX,xs=De.deltaY-He.deltaY,Qn=On(bt,Jr,xs);Yt=Qn.x,li=Qn.y,Gt=P(Qn.x)>P(Qn.y)?Qn.x:Qn.y,Vr=kn(Jr,xs),ye.lastInterval=De}else Gt=He.velocity,Yt=He.velocityX,li=He.velocityY,Vr=He.direction;De.velocity=Gt,De.velocityX=Yt,De.velocityY=li,De.direction=Vr}(He,De);var Qn=ye.element;D(De.srcEvent.target,Qn)&&(Qn=De.srcEvent.target),De.target=Qn}(ye,He),ye.emit("hammer.input",He),ye.recognize(He),ye.session.prevInput=He}function St(ye){for(var De=[],He=0;He<ye.pointers.length;)De[He]={clientX:j(ye.pointers[He].clientX),clientY:j(ye.pointers[He].clientY)},He++;return{timeStamp:Q(),pointers:De,center:Nt(De),deltaX:ye.deltaX,deltaY:ye.deltaY}}function Nt(ye){var De=ye.length;if(1===De)return{x:j(ye[0].clientX),y:j(ye[0].clientY)};for(var He=0,bt=0,Gt=0;Gt<De;)He+=ye[Gt].clientX,bt+=ye[Gt].clientY,Gt++;return{x:j(He/De),y:j(bt/De)}}function On(ye,De,He){return{x:De/ye||0,y:He/ye||0}}function kn(ye,De){return ye===De?1:P(ye)>=P(De)?ye<0?2:4:De<0?8:16}function Yn(ye,De,He){He||(He=_t);var bt=De[He[0]]-ye[He[0]],Gt=De[He[1]]-ye[He[1]];return Math.sqrt(bt*bt+Gt*Gt)}function Ti(ye,De,He){return He||(He=_t),180*Math.atan2(De[He[1]]-ye[He[1]],De[He[0]]-ye[He[0]])/Math.PI}ve.prototype={handler:function(){},init:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(Ce(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ce(this.element,this.evEl,this.domHandler),this.evTarget&&ce(this.target,this.evTarget,this.domHandler),this.evWin&&ce(Ce(this.element),this.evWin,this.domHandler)}};var Ls={mousedown:1,mousemove:2,mouseup:4},gs="mousedown",Bs="mousemove mouseup";function Xr(){this.evEl=gs,this.evWin=Bs,this.pressed=!1,ve.apply(this,arguments)}S(Xr,ve,{handler:function(De){var He=Ls[De.type];1&He&&0===De.button&&(this.pressed=!0),2&He&&1!==De.which&&(He=4),this.pressed&&(4&He&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[De],changedPointers:[De],pointerType:Xe,srcEvent:De}))}});var Ja={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Nl={2:Ge,3:"pen",4:Xe,5:"kinect"},Ea="pointerdown",Es="pointermove pointerup pointercancel";function Zt(){this.evEl=Ea,this.evWin=Es,ve.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ee.MSPointerEvent&&!ee.PointerEvent&&(Ea="MSPointerDown",Es="MSPointerMove MSPointerUp MSPointerCancel"),S(Zt,ve,{handler:function(De){var He=this.store,bt=!1,Gt=De.type.toLowerCase().replace("ms",""),Yt=Ja[Gt],li=Nl[De.pointerType]||De.pointerType,Vr=li==Ge,Jr=E(He,De.pointerId,"pointerId");1&Yt&&(0===De.button||Vr)?Jr<0&&(He.push(De),Jr=He.length-1):12&Yt&&(bt=!0),!(Jr<0)&&(He[Jr]=De,this.callback(this.manager,Yt,{pointers:He,changedPointers:[De],pointerType:li,srcEvent:De}),bt&&He.splice(Jr,1))}});var el={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",lt="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=rt,this.evWin=lt,this.started=!1,ve.apply(this,arguments)}function ge(ye,De){var He=$(ye.touches),bt=$(ye.changedTouches);return 12&De&&(He=Z(He.concat(bt),"identifier",!0)),[He,bt]}S(ht,ve,{handler:function(De){var He=el[De.type];if(1===He&&(this.started=!0),this.started){var bt=ge.call(this,De,He);12&He&&bt[0].length-bt[1].length==0&&(this.started=!1),this.callback(this.manager,He,{pointers:bt[0],changedPointers:bt[1],pointerType:Ge,srcEvent:De})}}});var be={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Le="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=Le,this.targetIds={},ve.apply(this,arguments)}function Ze(ye,De){var He=$(ye.touches),bt=this.targetIds;if(3&De&&1===He.length)return bt[He[0].identifier]=!0,[He,He];var Gt,Yt,li=$(ye.changedTouches),Vr=[],Jr=this.target;if(Yt=He.filter(function(xs){return D(xs.target,Jr)}),1===De)for(Gt=0;Gt<Yt.length;)bt[Yt[Gt].identifier]=!0,Gt++;for(Gt=0;Gt<li.length;)bt[li[Gt].identifier]&&Vr.push(li[Gt]),12&De&&delete bt[li[Gt].identifier],Gt++;return Vr.length?[Z(Yt.concat(Vr),"identifier",!0),Vr]:void 0}function Dt(){ve.apply(this,arguments);var ye=T(this.handler,this);this.touch=new ut(this.manager,ye),this.mouse=new Xr(this.manager,ye),this.primaryTouch=null,this.lastTouches=[]}function Xt(ye,De){1&ye?(this.primaryTouch=De.changedPointers[0].identifier,zn.call(this,De)):12&ye&&zn.call(this,De)}function zn(ye){var De=ye.changedPointers[0];if(De.identifier===this.primaryTouch){var He={x:De.clientX,y:De.clientY};this.lastTouches.push(He);var bt=this.lastTouches;setTimeout(function(){var Yt=bt.indexOf(He);Yt>-1&&bt.splice(Yt,1)},2500)}}function ai(ye){for(var De=ye.srcEvent.clientX,He=ye.srcEvent.clientY,bt=0;bt<this.lastTouches.length;bt++){var Gt=this.lastTouches[bt],Yt=Math.abs(De-Gt.x),li=Math.abs(He-Gt.y);if(Yt<=25&&li<=25)return!0}return!1}S(ut,ve,{handler:function(De){var He=be[De.type],bt=Ze.call(this,De,He);!bt||this.callback(this.manager,He,{pointers:bt[0],changedPointers:bt[1],pointerType:Ge,srcEvent:De})}}),S(Dt,ve,{handler:function(De,He,bt){var Yt=bt.pointerType==Xe;if(!(Yt&&bt.sourceCapabilities&&bt.sourceCapabilities.firesTouchEvents)){if(bt.pointerType==Ge)Xt.call(this,He,bt);else if(Yt&&ai.call(this,bt))return;this.callback(De,He,bt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Nn=oe(he.style,"touchAction"),_n=Nn!==Y,$n="compute",lr="manipulation",cr="none",Xn="pan-x",qi="pan-y",Sa=function(){if(!_n)return!1;var ye={},De=ee.CSS&&ee.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){ye[He]=!De||ee.CSS.supports("touch-action",He)}),ye}();function Qr(ye,De){this.manager=ye,this.set(De)}function Ot(ye){this.options=A({},this.defaults,ye||{}),this.id=se++,this.manager=null,this.options.enable=R(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(ye){return 16&ye?"cancel":8&ye?"end":4&ye?"move":2&ye?"start":""}function Wt(ye){return 16==ye?"down":8==ye?"up":2==ye?"left":4==ye?"right":""}function Ct(ye,De){var He=De.manager;return He?He.get(ye):ye}function yn(){Ot.apply(this,arguments)}function Ss(){yn.apply(this,arguments),this.pX=null,this.pY=null}function Zr(){yn.apply(this,arguments)}function Qs(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Pl(){yn.apply(this,arguments)}function po(){yn.apply(this,arguments)}function jr(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function js(ye,De){return(De=De||{}).recognizers=R(De.recognizers,js.defaults.preset),new go(ye,De)}function go(ye,De){this.options=A({},js.defaults,De||{}),this.options.inputTarget=this.options.inputTarget||ye,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ye,this.input=function(ye){return new(ye.options.inputClass||(_e?Zt:Ie?ut:ne?Dt:Xr))(ye,N)}(this),this.touchAction=new Qr(this,this.options.touchAction),Fl(this,!0),x(this.options.recognizers,function(He){var bt=this.add(new He[0](He[1]));He[2]&&bt.recognizeWith(He[2]),He[3]&&bt.requireFailure(He[3])},this)}function Fl(ye,De){var bt,He=ye.element;He.style&&(x(ye.options.cssProps,function(Gt,Yt){bt=oe(He.style,Yt),De?(ye.oldCssProps[bt]=He.style[bt],He.style[bt]=Gt):He.style[bt]=ye.oldCssProps[bt]||""}),De||(ye.oldCssProps={}))}Qr.prototype={set:function(ye){ye==$n&&(ye=this.compute()),_n&&this.manager.element.style&&Sa[ye]&&(this.manager.element.style[Nn]=ye),this.actions=ye.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ye=[];return x(this.manager.recognizers,function(De){V(De.options.enable,[De])&&(ye=ye.concat(De.getTouchAction()))}),function(ye){if(I(ye,cr))return cr;var De=I(ye,Xn),He=I(ye,qi);return De&&He?cr:De||He?De?Xn:qi:I(ye,lr)?lr:"auto"}(ye.join(" "))},preventDefaults:function(ye){var De=ye.srcEvent,He=ye.offsetDirection;if(!this.manager.session.prevented){var bt=this.actions,Gt=I(bt,cr)&&!Sa[cr],Yt=I(bt,qi)&&!Sa[qi],li=I(bt,Xn)&&!Sa[Xn];if(Gt&&1===ye.pointers.length&&ye.distance<2&&ye.deltaTime<250)return;return li&&Yt||!(Gt||Yt&&6&He||li&&24&He)?void 0:this.preventSrc(De)}De.preventDefault()},preventSrc:function(ye){this.manager.session.prevented=!0,ye.preventDefault()}},Ot.prototype={defaults:{},set:function(ye){return A(this.options,ye),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ye){if(v(ye,"recognizeWith",this))return this;var De=this.simultaneous;return De[(ye=Ct(ye,this)).id]||(De[ye.id]=ye,ye.recognizeWith(this)),this},dropRecognizeWith:function(ye){return v(ye,"dropRecognizeWith",this)||(ye=Ct(ye,this),delete this.simultaneous[ye.id]),this},requireFailure:function(ye){if(v(ye,"requireFailure",this))return this;var De=this.requireFail;return-1===E(De,ye=Ct(ye,this))&&(De.push(ye),ye.requireFailure(this)),this},dropRequireFailure:function(ye){if(v(ye,"dropRequireFailure",this))return this;ye=Ct(ye,this);var De=E(this.requireFail,ye);return De>-1&&this.requireFail.splice(De,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ye){return!!this.simultaneous[ye.id]},emit:function(ye){var De=this,He=this.state;function bt(Gt){De.manager.emit(Gt,ye)}He<8&&bt(De.options.event+We(He)),bt(De.options.event),ye.additionalEvent&&bt(ye.additionalEvent),He>=8&&bt(De.options.event+We(He))},tryEmit:function(ye){if(this.canEmit())return this.emit(ye);this.state=32},canEmit:function(){for(var ye=0;ye<this.requireFail.length;){if(!(33&this.requireFail[ye].state))return!1;ye++}return!0},recognize:function(ye){var De=A({},ye);if(!V(this.options.enable,[this,De]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(De),30&this.state&&this.tryEmit(De)},process:function(ye){},getTouchAction:function(){},reset:function(){}},S(yn,Ot,{defaults:{pointers:1},attrTest:function(ye){var De=this.options.pointers;return 0===De||ye.pointers.length===De},process:function(ye){var De=this.state,He=ye.eventType,bt=6&De,Gt=this.attrTest(ye);return bt&&(8&He||!Gt)?16|De:bt||Gt?4&He?8|De:2&De?4|De:2:32}}),S(Ss,yn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ye=this.options.direction,De=[];return 6&ye&&De.push(qi),24&ye&&De.push(Xn),De},directionTest:function(ye){var De=this.options,He=!0,bt=ye.distance,Gt=ye.direction,Yt=ye.deltaX,li=ye.deltaY;return Gt&De.direction||(6&De.direction?(Gt=0===Yt?1:Yt<0?2:4,He=Yt!=this.pX,bt=Math.abs(ye.deltaX)):(Gt=0===li?1:li<0?8:16,He=li!=this.pY,bt=Math.abs(ye.deltaY))),ye.direction=Gt,He&&bt>De.threshold&&Gt&De.direction},attrTest:function(ye){return yn.prototype.attrTest.call(this,ye)&&(2&this.state||!(2&this.state)&&this.directionTest(ye))},emit:function(ye){this.pX=ye.deltaX,this.pY=ye.deltaY;var De=Wt(ye.direction);De&&(ye.additionalEvent=this.options.event+De),this._super.emit.call(this,ye)}}),S(Zr,yn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[cr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.scale-1)>this.options.threshold||2&this.state)},emit:function(ye){1!==ye.scale&&(ye.additionalEvent=this.options.event+(ye.scale<1?"in":"out")),this._super.emit.call(this,ye)}}),S(Qs,Ot,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ye){var De=this.options,He=ye.pointers.length===De.pointers,bt=ye.distance<De.threshold,Gt=ye.deltaTime>De.time;if(this._input=ye,!bt||!He||12&ye.eventType&&!Gt)this.reset();else if(1&ye.eventType)this.reset(),this._timer=z(function(){this.state=8,this.tryEmit()},De.time,this);else if(4&ye.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ye){8===this.state&&(ye&&4&ye.eventType?this.manager.emit(this.options.event+"up",ye):(this._input.timeStamp=Q(),this.manager.emit(this.options.event,this._input)))}}),S(Pl,yn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[cr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.rotation)>this.options.threshold||2&this.state)}}),S(po,yn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ss.prototype.getTouchAction.call(this)},attrTest:function(ye){var He,De=this.options.direction;return 30&De?He=ye.overallVelocity:6&De?He=ye.overallVelocityX:24&De&&(He=ye.overallVelocityY),this._super.attrTest.call(this,ye)&&De&ye.offsetDirection&&ye.distance>this.options.threshold&&ye.maxPointers==this.options.pointers&&P(He)>this.options.velocity&&4&ye.eventType},emit:function(ye){var De=Wt(ye.offsetDirection);De&&this.manager.emit(this.options.event+De,ye),this.manager.emit(this.options.event,ye)}}),S(jr,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[lr]},process:function(ye){var De=this.options,He=ye.pointers.length===De.pointers,bt=ye.distance<De.threshold,Gt=ye.deltaTime<De.time;if(this.reset(),1&ye.eventType&&0===this.count)return this.failTimeout();if(bt&&Gt&&He){if(4!=ye.eventType)return this.failTimeout();var Yt=!this.pTime||ye.timeStamp-this.pTime<De.interval,li=!this.pCenter||Yn(this.pCenter,ye.center)<De.posThreshold;if(this.pTime=ye.timeStamp,this.pCenter=ye.center,li&&Yt?this.count+=1:this.count=1,this._input=ye,0==this.count%De.taps)return this.hasRequireFailures()?(this._timer=z(function(){this.state=8,this.tryEmit()},De.interval,this),2):8}return 32},failTimeout:function(){return this._timer=z(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),js.VERSION="2.0.7",js.defaults={domEvents:!1,touchAction:$n,enable:!0,inputTarget:null,inputClass:null,preset:[[Pl,{enable:!1}],[Zr,{enable:!1},["rotate"]],[po,{direction:6}],[Ss,{direction:6},["swipe"]],[jr],[jr,{event:"doubletap",taps:2},["tap"]],[Qs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},go.prototype={set:function(ye){return A(this.options,ye),ye.touchAction&&this.touchAction.update(),ye.inputTarget&&(this.input.destroy(),this.input.target=ye.inputTarget,this.input.init()),this},stop:function(ye){this.session.stopped=ye?2:1},recognize:function(ye){var De=this.session;if(!De.stopped){this.touchAction.preventDefaults(ye);var He,bt=this.recognizers,Gt=De.curRecognizer;(!Gt||Gt&&8&Gt.state)&&(Gt=De.curRecognizer=null);for(var Yt=0;Yt<bt.length;)He=bt[Yt],2===De.stopped||Gt&&He!=Gt&&!He.canRecognizeWith(Gt)?He.reset():He.recognize(ye),!Gt&&14&He.state&&(Gt=De.curRecognizer=He),Yt++}},get:function(ye){if(ye instanceof Ot)return ye;for(var De=this.recognizers,He=0;He<De.length;He++)if(De[He].options.event==ye)return De[He];return null},add:function(ye){if(v(ye,"add",this))return this;var De=this.get(ye.options.event);return De&&this.remove(De),this.recognizers.push(ye),ye.manager=this,this.touchAction.update(),ye},remove:function(ye){if(v(ye,"remove",this))return this;if(ye=this.get(ye)){var De=this.recognizers,He=E(De,ye);-1!==He&&(De.splice(He,1),this.touchAction.update())}return this},on:function(ye,De){if(ye!==Y&&De!==Y){var He=this.handlers;return x(X(ye),function(bt){He[bt]=He[bt]||[],He[bt].push(De)}),this}},off:function(ye,De){if(ye!==Y){var He=this.handlers;return x(X(ye),function(bt){De?He[bt]&&He[bt].splice(E(He[bt],De),1):delete He[bt]}),this}},emit:function(ye,De){this.options.domEvents&&function(ye,De){var He=Tt.createEvent("Event");He.initEvent(ye,!0,!0),He.gesture=De,De.target.dispatchEvent(He)}(ye,De);var He=this.handlers[ye]&&this.handlers[ye].slice();if(He&&He.length){De.type=ye,De.preventDefault=function(){De.srcEvent.preventDefault()};for(var bt=0;bt<He.length;)He[bt](De),bt++}},destroy:function(){this.element&&Fl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},A(js,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:go,Input:ve,TouchAction:Qr,TouchInput:ut,MouseInput:Xr,PointerEventInput:Zt,TouchMouseInput:Dt,SingleTouchInput:ht,Recognizer:Ot,AttrRecognizer:yn,Tap:jr,Pan:Ss,Swipe:po,Pinch:Zr,Rotate:Pl,Press:Qs,on:K,off:ce,each:x,merge:y,extend:b,assign:A,inherit:S,bindFn:T,prefixed:oe}),(void 0!==ee?ee:"undefined"!=typeof self?self:{}).Hammer=js,(yt=function(){return js}.call(it,Je,it,Ut))!==Y&&(Ut.exports=yt)}(window,document)},815:function(Ut,it,Je){var yt;Ut=Je.nmd(Ut),function(){var ee,Se="Expected a function",W="__lodash_hash_undefined__",P="__lodash_placeholder__",V=32,K=128,te=1/0,Ce=9007199254740991,_e=4294967295,st=[["ary",K],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",V],["partialRight",64],["rearg",256]],Xe="[object Arguments]",tt="[object Array]",Ue="[object Boolean]",ke="[object Date]",Me="[object Error]",Ve="[object Function]",$e="[object GeneratorFunction]",Ne="[object Map]",q="[object Number]",pe="[object Object]",ue="[object Promise]",_t="[object RegExp]",pt="[object Set]",ve="[object String]",L="[object Symbol]",B="[object WeakMap]",Qe="[object ArrayBuffer]",St="[object DataView]",Nt="[object Float32Array]",On="[object Float64Array]",kn="[object Int8Array]",Yn="[object Int16Array]",Ti="[object Int32Array]",wi="[object Uint8Array]",Kr="[object Uint8ClampedArray]",Ls="[object Uint16Array]",gs="[object Uint32Array]",Bs=/\b__p \+= '';/g,Xr=/\b(__p \+=) '' \+/g,Ja=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Nl=/&(?:amp|lt|gt|quot|#39);/g,Ea=/[&<>"']/g,Es=RegExp(Nl.source),Zt=RegExp(Ea.source),el=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,lt=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Le=/[\\^$.*+?()[\]{}|]/g,ut=RegExp(Le.source),Ze=/^\s+/,At=/\s/,Mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dt=/\{\n\/\* \[wrapped with (.+)\] \*/,Xt=/,? & /,zn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ai=/[()=,{}\[\]\/\s]/,Nn=/\\(\\)?/g,_n=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,$n=/\w*$/,Cn=/^[-+]0x[0-9a-f]+$/i,lr=/^0b[01]+$/i,cr=/^\[object .+?Constructor\]$/,Xn=/^0o[0-7]+$/i,qi=/^(?:0|[1-9]\d*)$/,Sa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qr=/($^)/,ie=/['\n\r\u2028\u2029\\]/g,fe="\\ud800-\\udfff",J="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",Ct="A-Z\\xc0-\\xd6\\xd8-\\xde",yn="\\ufe0e\\ufe0f",Ss="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qs="["+fe+"]",Pl="["+Ss+"]",po="["+J+"]",jr="\\d+",js="["+we+"]",Sc="["+Fe+"]",wn="[^"+fe+Ss+jr+we+Fe+Ct+"]",go="\\ud83c[\\udffb-\\udfff]",xa="[^"+fe+"]",wd="(?:\\ud83c[\\udde6-\\uddff]){2}",ye="[\\ud800-\\udbff][\\udc00-\\udfff]",De="["+Ct+"]",bt="(?:"+Sc+"|"+wn+")",Gt="(?:"+De+"|"+wn+")",Yt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",li="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Vr="(?:"+po+"|"+go+")?",Jr="["+yn+"]?",N1=Jr+Vr+"(?:\\u200d(?:"+[xa,wd,ye].join("|")+")"+Jr+Vr+")*",Ed="(?:"+[js,wd,ye].join("|")+")"+N1,ir="(?:"+[xa+po+"?",po,wd,ye,Qs].join("|")+")",fp=RegExp("['\u2019]","g"),i_=RegExp(po,"g"),Dh=RegExp(go+"(?="+go+")|"+ir+N1,"g"),dv=RegExp([De+"?"+Sc+"+"+Yt+"(?="+[Pl,De,"$"].join("|")+")",Gt+"+"+li+"(?="+[Pl,De+bt,"$"].join("|")+")",De+"?"+bt+"+"+Yt,De+"+"+li,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",jr,Ed].join("|"),"g"),P1=RegExp("[\\u200d"+fe+J+yn+"]"),kl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ih=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],F1=-1,cn={};cn[Nt]=cn[On]=cn[kn]=cn[Yn]=cn[Ti]=cn[wi]=cn[Kr]=cn[Ls]=cn[gs]=!0,cn[Xe]=cn[tt]=cn[Qe]=cn[Ue]=cn[St]=cn[ke]=cn[Me]=cn[Ve]=cn[Ne]=cn[q]=cn[pe]=cn[_t]=cn[pt]=cn[ve]=cn[B]=!1;var ur={};ur[Xe]=ur[tt]=ur[Qe]=ur[St]=ur[Ue]=ur[ke]=ur[Nt]=ur[On]=ur[kn]=ur[Yn]=ur[Ti]=ur[Ne]=ur[q]=ur[pe]=ur[_t]=ur[pt]=ur[ve]=ur[L]=ur[wi]=ur[Kr]=ur[Ls]=ur[gs]=!0,ur[Me]=ur[Ve]=ur[B]=!1;var an={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},k1=parseFloat,gv=parseInt,Rt="object"==typeof global&&global&&global.Object===Object&&global,Vs="object"==typeof self&&self&&self.Object===Object&&self,Ui=Rt||Vs||Function("return this")(),Ll=it&&!it.nodeType&&it,Ca=Ll&&Ut&&!Ut.nodeType&&Ut,Oo=Ca&&Ca.exports===Ll,r_=Oo&&Rt.process,Sr=function(){try{return Ca&&Ca.require&&Ca.require("util").types||r_&&r_.binding&&r_.binding("util")}catch(It){}}(),nn=Sr&&Sr.isArrayBuffer,hi=Sr&&Sr.isDate,fr=Sr&&Sr.isMap,mo=Sr&&Sr.isRegExp,xc=Sr&&Sr.isSet,as=Sr&&Sr.isTypedArray;function ls(at,It,Et){switch(Et.length){case 0:return at.call(It);case 1:return at.call(It,Et[0]);case 2:return at.call(It,Et[0],Et[1]);case 3:return at.call(It,Et[0],Et[1],Et[2])}return at.apply(It,Et)}function Ur(at,It,Et,un){for(var Dn=-1,Bi=null==at?0:at.length;++Dn<Bi;){var es=at[Dn];It(un,es,Et(es),at)}return un}function Us(at,It){for(var Et=-1,un=null==at?0:at.length;++Et<un&&!1!==It(at[Et],Et,at););return at}function Sd(at,It){for(var Et=null==at?0:at.length;Et--&&!1!==It(at[Et],Et,at););return at}function ti(at,It){for(var Et=-1,un=null==at?0:at.length;++Et<un;)if(!It(at[Et],Et,at))return!1;return!0}function Aa(at,It){for(var Et=-1,un=null==at?0:at.length,Dn=0,Bi=[];++Et<un;){var es=at[Et];It(es,Et,at)&&(Bi[Dn++]=es)}return Bi}function Bl(at,It){return!(null==at||!at.length)&&tl(at,It,0)>-1}function Oh(at,It,Et){for(var un=-1,Dn=null==at?0:at.length;++un<Dn;)if(Et(It,at[un]))return!0;return!1}function Xi(at,It){for(var Et=-1,un=null==at?0:at.length,Dn=Array(un);++Et<un;)Dn[Et]=It(at[Et],Et,at);return Dn}function zr(at,It){for(var Et=-1,un=It.length,Dn=at.length;++Et<un;)at[Dn+Et]=It[Et];return at}function mu(at,It,Et,un){var Dn=-1,Bi=null==at?0:at.length;for(un&&Bi&&(Et=at[++Dn]);++Dn<Bi;)Et=It(Et,at[Dn],Dn,at);return Et}function xd(at,It,Et,un){var Dn=null==at?0:at.length;for(un&&Dn&&(Et=at[--Dn]);Dn--;)Et=It(Et,at[Dn],Dn,at);return Et}function Ro(at,It){for(var Et=-1,un=null==at?0:at.length;++Et<un;)if(It(at[Et],Et,at))return!0;return!1}var dr=s_("length");function Rh(at,It,Et){var un;return Et(at,function(Dn,Bi,es){if(It(Dn,Bi,es))return un=Bi,!1}),un}function Cd(at,It,Et,un){for(var Dn=at.length,Bi=Et+(un?1:-1);un?Bi--:++Bi<Dn;)if(It(at[Bi],Bi,at))return Bi;return-1}function tl(at,It,Et){return It==It?function(at,It,Et){for(var un=Et-1,Dn=at.length;++un<Dn;)if(at[un]===It)return un;return-1}(at,It,Et):Cd(at,Cc,Et)}function pp(at,It,Et,un){for(var Dn=Et-1,Bi=at.length;++Dn<Bi;)if(un(at[Dn],It))return Dn;return-1}function Cc(at){return at!=at}function Cs(at,It){var Et=null==at?0:at.length;return Et?Ad(at,It)/Et:NaN}function s_(at){return function(It){return null==It?ee:It[at]}}function Qo(at){return function(It){return null==at?ee:at[It]}}function Zo(at,It,Et,un,Dn){return Dn(at,function(Bi,es,Qi){Et=un?(un=!1,Bi):It(Et,Bi,es,Qi)}),Et}function Ad(at,It){for(var Et,un=-1,Dn=at.length;++un<Dn;){var Bi=It(at[un]);Bi!==ee&&(Et=Et===ee?Bi:Et+Bi)}return Et}function Td(at,It){for(var Et=-1,un=Array(at);++Et<at;)un[Et]=It(Et);return un}function mv(at){return at&&at.slice(0,Ac(at)+1).replace(Ze,"")}function Jo(at){return function(It){return at(It)}}function a_(at,It){return Xi(It,function(Et){return at[Et]})}function Nh(at,It){return at.has(It)}function j1(at,It){for(var Et=-1,un=at.length;++Et<un&&tl(It,at[Et],0)>-1;);return Et}function V1(at,It){for(var Et=at.length;Et--&&tl(It,at[Et],0)>-1;);return Et}function f2(at,It){for(var Et=at.length,un=0;Et--;)at[Et]===It&&++un;return un}var p2=Qo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),g2=Qo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function m2(at){return"\\"+an[at]}function Ph(at){return P1.test(at)}function _v(at){var It=-1,Et=Array(at.size);return at.forEach(function(un,Dn){Et[++It]=[Dn,un]}),Et}function U1(at,It){return function(Et){return at(It(Et))}}function _u(at,It){for(var Et=-1,un=at.length,Dn=0,Bi=[];++Et<un;){var es=at[Et];(es===It||es===P)&&(at[Et]=P,Bi[Dn++]=Et)}return Bi}function l_(at){var It=-1,Et=Array(at.size);return at.forEach(function(un){Et[++It]=un}),Et}function Fh(at){return Ph(at)?function(at){for(var It=Dh.lastIndex=0;Dh.test(at);)++It;return It}(at):dr(at)}function nl(at){return Ph(at)?function(at){return at.match(Dh)||[]}(at):function(at){return at.split("")}(at)}function Ac(at){for(var It=at.length;It--&&At.test(at.charAt(It)););return It}var u_=Qo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),kh=function at(It){var d,Et=(It=null==It?Ui:kh.defaults(Ui.Object(),It,kh.pick(Ui,Ih))).Array,un=It.Date,Dn=It.Error,Bi=It.Function,es=It.Math,Qi=It.Object,d_=It.RegExp,h_=It.String,Ma=It.TypeError,pr=Et.prototype,yu=Qi.prototype,gp=It["__core-js_shared__"],xr=Bi.prototype.toString,Zi=yu.hasOwnProperty,E2=0,Lh=(d=/[^.]+$/.exec(gp&&gp.keys&&gp.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",Zs=yu.toString,G1=xr.call(Qi),f_=Ui._,Md=d_("^"+xr.call(Zi).replace(Le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=Oo?It.Buffer:ee,jl=It.Symbol,Dd=It.Uint8Array,vv=zs?zs.allocUnsafe:ee,Da=U1(Qi.getPrototypeOf,Qi),p_=Qi.create,mp=yu.propertyIsEnumerable,Bn=pr.splice,$1=jl?jl.isConcatSpreadable:ee,Bh=jl?jl.iterator:ee,bu=jl?jl.toStringTag:ee,_p=function(){try{var d=kc(Qi,"defineProperty");return d({},"",{}),d}catch(f){}}(),wv=It.clearTimeout!==Ui.clearTimeout&&It.clearTimeout,W1=un&&un.now!==Ui.Date.now&&un.now,q1=It.setTimeout!==Ui.setTimeout&&It.setTimeout,jt=es.ceil,Ei=es.floor,Cr=Qi.getOwnPropertySymbols,cs=zs?zs.isBuffer:ee,g_=It.isFinite,jh=pr.join,il=U1(Qi.keys,Qi),Hr=es.max,ms=es.min,S2=un.now,Y1=It.parseInt,Vh=es.random,yp=pr.reverse,As=kc(It,"DataView"),_o=kc(It,"Map"),bp=kc(It,"Promise"),Ia=kc(It,"Set"),No=kc(It,"WeakMap"),Uh=kc(Qi,"create"),zh=No&&new No,Id={},K1=Ou(As),m_=Ou(_o),__=Ou(bp),Ev=Ou(Ia),y_=Ou(No),vp=jl?jl.prototype:ee,Od=vp?vp.valueOf:ee,Hh=vp?vp.toString:ee;function Ee(d){if(Mr(d)&&!Rn(d)&&!(d instanceof fi)){if(d instanceof Po)return d;if(Zi.call(d,"__wrapped__"))return nf(d)}return new Po(d)}var vu=function(){function d(){}return function(f){if(!Tr(f))return{};if(p_)return p_(f);d.prototype=f;var _=new d;return d.prototype=ee,_}}();function Gh(){}function Po(d,f){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=ee}function fi(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function yo(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Vl(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function rl(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Oa(d){var f=-1,_=null==d?0:d.length;for(this.__data__=new rl;++f<_;)this.add(d[f])}function Ra(d){var f=this.__data__=new Vl(d);this.size=f.size}function Wh(d,f){var _=Rn(d),F=!_&&fl(d),ae=!_&&!F&&pl(d),Te=!_&&!F&&!ae&&cf(d),ze=_||F||ae||Te,qe=ze?Td(d.length,h_):[],ct=qe.length;for(var Pt in d)(f||Zi.call(d,Pt))&&(!ze||!("length"==Pt||ae&&("offset"==Pt||"parent"==Pt)||Te&&("buffer"==Pt||"byteLength"==Pt||"byteOffset"==Pt)||Bo(Pt,ct)))&&qe.push(Pt);return qe}function E_(d){var f=d.length;return f?d[Ul(0,f-1)]:ee}function Av(d,f){return Wd(eo(d),wu(f,0,d.length))}function Rd(d){return Wd(eo(d))}function S_(d,f,_){(_!==ee&&!In(d[f],_)||_===ee&&!(f in d))&&ol(d,f,_)}function sl(d,f,_){var F=d[f];(!Zi.call(d,f)||!In(F,_)||_===ee&&!(f in d))&&ol(d,f,_)}function Nd(d,f){for(var _=d.length;_--;)if(In(d[_][0],f))return _;return-1}function Cp(d,f,_,F){return Dc(d,function(ae,Te,ze){f(F,ae,_(ae),ze)}),F}function sA(d,f){return d&&Pa(f,Os(f),d)}function ol(d,f,_){"__proto__"==f&&_p?_p(d,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):d[f]=_}function x_(d,f){for(var _=-1,F=f.length,ae=Et(F),Te=null==d;++_<F;)ae[_]=Te?ee:hf(d,f[_]);return ae}function wu(d,f,_){return d==d&&(_!==ee&&(d=d<=_?d:_),f!==ee&&(d=d>=f?d:f)),d}function Hs(d,f,_,F,ae,Te){var ze,qe=1&f,ct=2&f,Pt=4&f;if(_&&(ze=ae?_(d,F,ae,Te):_(d)),ze!==ee)return ze;if(!Tr(d))return d;var Ft=Rn(d);if(Ft){if(ze=function(d){var f=d.length,_=new d.constructor(f);return f&&"string"==typeof d[0]&&Zi.call(d,"index")&&(_.index=d.index,_.input=d.input),_}(d),!qe)return eo(d,ze)}else{var zt=$s(d),en=zt==Ve||zt==$e;if(pl(d))return Np(d,qe);if(zt==pe||zt==Xe||en&&!ae){if(ze=ct||en?{}:Kv(d),!qe)return ct?function(d,f){return Pa(d,Wv(d),f)}(d,function(d,f){return d&&Pa(f,no(f),d)}(ze,d)):function(d,f){return Pa(d,V_(d),f)}(d,sA(ze,d))}else{if(!ur[zt])return ae?d:{};ze=function(d,f,_){var F=d.constructor;switch(f){case Qe:return Tu(d);case Ue:case ke:return new F(+d);case St:return function(d,f){var _=f?Tu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.byteLength)}(d,_);case Nt:case On:case kn:case Yn:case Ti:case wi:case Kr:case Ls:case gs:return F_(d,_);case Ne:return new F;case q:case ve:return new F(d);case _t:return function(d){var f=new d.constructor(d.source,$n.exec(d));return f.lastIndex=d.lastIndex,f}(d);case pt:return new F;case L:return function(d){return Od?Qi(Od.call(d)):{}}(d)}}(d,zt,qe)}}Te||(Te=new Ra);var bn=Te.get(d);if(bn)return bn;Te.set(d,ze),CT(d)?d.forEach(function(jn){ze.add(Hs(jn,f,_,jn,d,Te))}):wT(d)&&d.forEach(function(jn,mi){ze.set(mi,Hs(jn,f,_,mi,d,Te))});var gi=Ft?ee:(Pt?ct?B_:$l:ct?no:Os)(d);return Us(gi||d,function(jn,mi){gi&&(jn=d[mi=jn]),sl(ze,mi,Hs(jn,f,_,mi,d,Te))}),ze}function Ap(d,f,_){var F=_.length;if(null==d)return!F;for(d=Qi(d);F--;){var ae=_[F],ze=d[ae];if(ze===ee&&!(ae in d)||!(0,f[ae])(ze))return!1}return!0}function qh(d,f,_){if("function"!=typeof d)throw new Ma(Se);return ef(function(){d.apply(ee,_)},f)}function Mc(d,f,_,F){var ae=-1,Te=Bl,ze=!0,qe=d.length,ct=[],Pt=f.length;if(!qe)return ct;_&&(f=Xi(f,Jo(_))),F?(Te=Oh,ze=!1):f.length>=200&&(Te=Nh,ze=!1,f=new Oa(f));e:for(;++ae<qe;){var Ft=d[ae],zt=null==_?Ft:_(Ft);if(Ft=F||0!==Ft?Ft:0,ze&&zt==zt){for(var en=Pt;en--;)if(f[en]===zt)continue e;ct.push(Ft)}else Te(f,zt,F)||ct.push(Ft)}return ct}Ee.templateSettings={escape:el,evaluate:rt,interpolate:lt,variable:"",imports:{_:Ee}},(Ee.prototype=Gh.prototype).constructor=Ee,(Po.prototype=vu(Gh.prototype)).constructor=Po,(fi.prototype=vu(Gh.prototype)).constructor=fi,yo.prototype.clear=function(){this.__data__=Uh?Uh(null):{},this.size=0},yo.prototype.delete=function(d){var f=this.has(d)&&delete this.__data__[d];return this.size-=f?1:0,f},yo.prototype.get=function(d){var f=this.__data__;if(Uh){var _=f[d];return _===W?ee:_}return Zi.call(f,d)?f[d]:ee},yo.prototype.has=function(d){var f=this.__data__;return Uh?f[d]!==ee:Zi.call(f,d)},yo.prototype.set=function(d,f){var _=this.__data__;return this.size+=this.has(d)?0:1,_[d]=Uh&&f===ee?W:f,this},Vl.prototype.clear=function(){this.__data__=[],this.size=0},Vl.prototype.delete=function(d){var f=this.__data__,_=Nd(f,d);return!(_<0||(_==f.length-1?f.pop():Bn.call(f,_,1),--this.size,0))},Vl.prototype.get=function(d){var f=this.__data__,_=Nd(f,d);return _<0?ee:f[_][1]},Vl.prototype.has=function(d){return Nd(this.__data__,d)>-1},Vl.prototype.set=function(d,f){var _=this.__data__,F=Nd(_,d);return F<0?(++this.size,_.push([d,f])):_[F][1]=f,this},rl.prototype.clear=function(){this.size=0,this.__data__={hash:new yo,map:new(_o||Vl),string:new yo}},rl.prototype.delete=function(d){var f=Gs(this,d).delete(d);return this.size-=f?1:0,f},rl.prototype.get=function(d){return Gs(this,d).get(d)},rl.prototype.has=function(d){return Gs(this,d).has(d)},rl.prototype.set=function(d,f){var _=Gs(this,d),F=_.size;return _.set(d,f),this.size+=_.size==F?0:1,this},Oa.prototype.add=Oa.prototype.push=function(d){return this.__data__.set(d,W),this},Oa.prototype.has=function(d){return this.__data__.has(d)},Ra.prototype.clear=function(){this.__data__=new Vl,this.size=0},Ra.prototype.delete=function(d){var f=this.__data__,_=f.delete(d);return this.size=f.size,_},Ra.prototype.get=function(d){return this.__data__.get(d)},Ra.prototype.has=function(d){return this.__data__.has(d)},Ra.prototype.set=function(d,f){var _=this.__data__;if(_ instanceof Vl){var F=_.__data__;if(!_o||F.length<199)return F.push([d,f]),this.size=++_.size,this;_=this.__data__=new rl(F)}return _.set(d,f),this.size=_.size,this};var Dc=cl(al),A_=cl(Tp,!0);function Mv(d,f){var _=!0;return Dc(d,function(F,ae,Te){return _=!!f(F,ae,Te)}),_}function Yh(d,f,_){for(var F=-1,ae=d.length;++F<ae;){var Te=d[F],ze=f(Te);if(null!=ze&&(qe===ee?ze==ze&&!ca(ze):_(ze,qe)))var qe=ze,ct=Te}return ct}function Iv(d,f){var _=[];return Dc(d,function(F,ae,Te){f(F,ae,Te)&&_.push(F)}),_}function Ts(d,f,_,F,ae){var Te=-1,ze=d.length;for(_||(_=SA),ae||(ae=[]);++Te<ze;){var qe=d[Te];f>0&&_(qe)?f>1?Ts(qe,f-1,_,F,ae):zr(ae,qe):F||(ae[ae.length]=qe)}return ae}var Pd=Lv(),Fd=Lv(!0);function al(d,f){return d&&Pd(d,f,Os)}function Tp(d,f){return d&&Fd(d,f,Os)}function Kh(d,f){return Aa(f,function(_){return la(d[_])})}function ea(d,f){for(var _=0,F=(f=Nc(f,d)).length;null!=d&&_<F;)d=d[ni(f[_++])];return _&&_==F?d:ee}function rr(d,f,_){var F=f(d);return Rn(d)?F:zr(F,_(d))}function Ms(d){return null==d?d===ee?"[object Undefined]":"[object Null]":bu&&bu in Qi(d)?function(d){var f=Zi.call(d,bu),_=d[bu];try{d[bu]=ee;var F=!0}catch(Te){}var ae=Zs.call(d);return F&&(f?d[bu]=_:delete d[bu]),ae}(d):function(d){return Zs.call(d)}(d)}function Fo(d,f){return d>f}function kd(d,f){return null!=d&&Zi.call(d,f)}function Ld(d,f){return null!=d&&f in Qi(d)}function Eu(d,f,_){for(var F=_?Oh:Bl,ae=d[0].length,Te=d.length,ze=Te,qe=Et(Te),ct=1/0,Pt=[];ze--;){var Ft=d[ze];ze&&f&&(Ft=Xi(Ft,Jo(f))),ct=ms(Ft.length,ct),qe[ze]=!_&&(f||ae>=120&&Ft.length>=120)?new Oa(ze&&Ft):ee}Ft=d[0];var zt=-1,en=qe[0];e:for(;++zt<ae&&Pt.length<ct;){var bn=Ft[zt],Ln=f?f(bn):bn;if(bn=_||0!==bn?bn:0,!(en?Nh(en,Ln):F(Pt,Ln,_))){for(ze=Te;--ze;){var gi=qe[ze];if(!(gi?Nh(gi,Ln):F(d[ze],Ln,_)))continue e}en&&en.push(Ln),Pt.push(bn)}}return Pt}function Na(d,f,_){var F=null==(d=G_(d,f=Nc(f,d)))?d:d[ni(sa(f))];return null==F?ee:ls(F,d,_)}function oA(d){return Mr(d)&&Ms(d)==Xe}function Mp(d,f,_,F,ae){return d===f||(null==d||null==f||!Mr(d)&&!Mr(f)?d!=d&&f!=f:function(d,f,_,F,ae,Te){var ze=Rn(d),qe=Rn(f),ct=ze?tt:$s(d),Pt=qe?tt:$s(f),Ft=(ct=ct==Xe?pe:ct)==pe,zt=(Pt=Pt==Xe?pe:Pt)==pe,en=ct==Pt;if(en&&pl(d)){if(!pl(f))return!1;ze=!0,Ft=!1}if(en&&!Ft)return Te||(Te=new Ra),ze||cf(d)?jp(d,f,_,F,ae,Te):function(d,f,_,F,ae,Te,ze){switch(_){case St:if(d.byteLength!=f.byteLength||d.byteOffset!=f.byteOffset)return!1;d=d.buffer,f=f.buffer;case Qe:return!(d.byteLength!=f.byteLength||!Te(new Dd(d),new Dd(f)));case Ue:case ke:case q:return In(+d,+f);case Me:return d.name==f.name&&d.message==f.message;case _t:case ve:return d==f+"";case Ne:var qe=_v;case pt:if(qe||(qe=l_),d.size!=f.size&&!(1&F))return!1;var Pt=ze.get(d);if(Pt)return Pt==f;F|=2,ze.set(d,f);var Ft=jp(qe(d),qe(f),F,ae,Te,ze);return ze.delete(d),Ft;case L:if(Od)return Od.call(d)==Od.call(f)}return!1}(d,f,ct,_,F,ae,Te);if(!(1&_)){var bn=Ft&&Zi.call(d,"__wrapped__"),Ln=zt&&Zi.call(f,"__wrapped__");if(bn||Ln){var gi=bn?d.value():d,jn=Ln?f.value():f;return Te||(Te=new Ra),ae(gi,jn,_,F,Te)}}return!!en&&(Te||(Te=new Ra),function(d,f,_,F,ae,Te){var ze=1&_,qe=$l(d),ct=qe.length;if(ct!=$l(f).length&&!ze)return!1;for(var zt=ct;zt--;){var en=qe[zt];if(!(ze?en in f:Zi.call(f,en)))return!1}var bn=Te.get(d),Ln=Te.get(f);if(bn&&Ln)return bn==f&&Ln==d;var gi=!0;Te.set(d,f),Te.set(f,d);for(var jn=ze;++zt<ct;){var mi=d[en=qe[zt]],Mi=f[en];if(F)var wo=ze?F(Mi,mi,en,f,d,Te):F(mi,Mi,en,d,f,Te);if(!(wo===ee?mi===Mi||ae(mi,Mi,_,F,Te):wo)){gi=!1;break}jn||(jn="constructor"==en)}if(gi&&!jn){var qs=d.constructor,ua=f.constructor;qs!=ua&&"constructor"in d&&"constructor"in f&&!("function"==typeof qs&&qs instanceof qs&&"function"==typeof ua&&ua instanceof ua)&&(gi=!1)}return Te.delete(d),Te.delete(f),gi}(d,f,_,F,ae,Te))}(d,f,_,F,Mp,ae))}function M_(d,f,_,F){var ae=_.length,Te=ae,ze=!F;if(null==d)return!Te;for(d=Qi(d);ae--;){var qe=_[ae];if(ze&&qe[2]?qe[1]!==d[qe[0]]:!(qe[0]in d))return!1}for(;++ae<Te;){var ct=(qe=_[ae])[0],Pt=d[ct],Ft=qe[1];if(ze&&qe[2]){if(Pt===ee&&!(ct in d))return!1}else{var zt=new Ra;if(F)var en=F(Pt,Ft,ct,d,f,zt);if(!(en===ee?Mp(Ft,Pt,3,F,zt):en))return!1}}return!0}function D_(d){return!(!Tr(d)||function(d){return!!Lh&&Lh in d}(d))&&(la(d)?Md:cr).test(Ou(d))}function cA(d){return"function"==typeof d?d:null==d?io:"object"==typeof d?Rn(d)?jd(d[0],d[1]):dA(d):Fu(d)}function Ov(d){if(!zp(d))return il(d);var f=[];for(var _ in Qi(d))Zi.call(d,_)&&"constructor"!=_&&f.push(_);return f}function Rv(d,f){return d<f}function uA(d,f){var _=-1,F=bo(d)?Et(d.length):[];return Dc(d,function(ae,Te,ze){F[++_]=f(ae,Te,ze)}),F}function dA(d){var f=ia(d);return 1==f.length&&f[0][2]?CA(f[0][0],f[0][1]):function(_){return _===d||M_(_,d,f)}}function jd(d,f){return ra(d)&&xA(f)?CA(ni(d),f):function(_){var F=hf(_,d);return F===ee&&F===f?eg(_,d):Mp(f,F,3)}}function I_(d,f,_,F,ae){d!==f&&Pd(f,function(Te,ze){if(ae||(ae=new Ra),Tr(Te))!function(d,f,_,F,ae,Te,ze){var qe=$_(d,_),ct=$_(f,_),Pt=ze.get(ct);if(Pt)S_(d,_,Pt);else{var Ft=Te?Te(qe,ct,_+"",d,f,ze):ee,zt=Ft===ee;if(zt){var en=Rn(ct),bn=!en&&pl(ct),Ln=!en&&!bn&&cf(ct);Ft=ct,en||bn||Ln?Rn(qe)?Ft=qe:Ar(qe)?Ft=eo(qe):bn?(zt=!1,Ft=Np(ct,!0)):Ln?(zt=!1,Ft=F_(ct,!0)):Ft=[]:Jp(ct)||fl(ct)?(Ft=qe,fl(qe)?Ft=Uw(qe):(!Tr(qe)||la(qe))&&(Ft=Kv(ct))):zt=!1}zt&&(ze.set(ct,Ft),ae(Ft,ct,F,Te,ze),ze.delete(ct)),S_(d,_,Ft)}}(d,f,ze,_,I_,F,ae);else{var qe=F?F($_(d,ze),Te,ze+"",d,f,ae):ee;qe===ee&&(qe=Te),S_(d,ze,qe)}},no)}function Su(d,f){var _=d.length;if(_)return Bo(f+=f<0?_:0,_)?d[f]:ee}function Xh(d,f,_){f=f.length?Xi(f,function(Te){return Rn(Te)?function(ze){return ea(ze,1===Te.length?Te[0]:Te)}:Te}):[io];var F=-1;return f=Xi(f,Jo(Fn())),function(at,It){var Et=at.length;for(at.sort(function(Te,ze){return function(d,f,_){for(var F=-1,ae=d.criteria,Te=f.criteria,ze=ae.length,qe=_.length;++F<ze;){var ct=Pc(ae[F],Te[F]);if(ct)return F>=qe?ct:ct*("desc"==_[F]?-1:1)}return d.index-f.index}(Te,ze,_)});Et--;)at[Et]=at[Et].value;return at}(uA(d,function(Te,ze,qe){return{criteria:Xi(f,function(Pt){return Pt(Te)}),index:++F,value:Te}}))}function Nv(d,f,_){for(var F=-1,ae=f.length,Te={};++F<ae;){var ze=f[F],qe=ea(d,ze);_(qe,ze)&&Ip(Te,Nc(ze,d),qe)}return Te}function na(d,f,_,F){var ae=F?pp:tl,Te=-1,ze=f.length,qe=d;for(d===f&&(f=eo(f)),_&&(qe=Xi(d,Jo(_)));++Te<ze;)for(var ct=0,Pt=f[Te],Ft=_?_(Pt):Pt;(ct=ae(qe,Ft,ct,F))>-1;)qe!==d&&Bn.call(qe,ct,1),Bn.call(d,ct,1);return d}function Qh(d,f){for(var _=d?f.length:0,F=_-1;_--;){var ae=f[_];if(_==F||ae!==Te){var Te=ae;Bo(ae)?Bn.call(d,ae,1):xu(d,ae)}}return d}function Ul(d,f){return d+Ei(Vh()*(f-d+1))}function Dp(d,f){var _="";if(!d||f<1||f>Ce)return _;do{f%2&&(_+=d),(f=Ei(f/2))&&(d+=d)}while(f);return _}function pi(d,f){return Hp(AA(d,f,io),d+"")}function hA(d){return E_(th(d))}function R2(d,f){var _=th(d);return Wd(_,wu(f,0,_.length))}function Ip(d,f,_,F){if(!Tr(d))return d;for(var ae=-1,Te=(f=Nc(f,d)).length,ze=Te-1,qe=d;null!=qe&&++ae<Te;){var ct=ni(f[ae]),Pt=_;if("__proto__"===ct||"constructor"===ct||"prototype"===ct)return d;if(ae!=ze){var Ft=qe[ct];(Pt=F?F(Ft,ct,qe):ee)===ee&&(Pt=Tr(Ft)?Ft:Bo(f[ae+1])?[]:{})}sl(qe,ct,Pt),qe=qe[ct]}return d}var O_=zh?function(d,f){return zh.set(d,f),d}:io,ko=_p?function(d,f){return _p(d,"toString",{configurable:!0,enumerable:!1,value:Ry(f),writable:!0})}:io;function R_(d){return Wd(th(d))}function Ds(d,f,_){var F=-1,ae=d.length;f<0&&(f=-f>ae?0:ae+f),(_=_>ae?ae:_)<0&&(_+=ae),ae=f>_?0:_-f>>>0,f>>>=0;for(var Te=Et(ae);++F<ae;)Te[F]=d[F+f];return Te}function N2(d,f){var _;return Dc(d,function(F,ae,Te){return!(_=f(F,ae,Te))}),!!_}function Zh(d,f,_){var F=0,ae=null==d?F:d.length;if("number"==typeof f&&f==f&&ae<=2147483647){for(;F<ae;){var Te=F+ae>>>1,ze=d[Te];null!==ze&&!ca(ze)&&(_?ze<=f:ze<f)?F=Te+1:ae=Te}return ae}return N_(d,f,io,_)}function N_(d,f,_,F){var ae=0,Te=null==d?0:d.length;if(0===Te)return 0;for(var ze=(f=_(f))!=f,qe=null===f,ct=ca(f),Pt=f===ee;ae<Te;){var Ft=Ei((ae+Te)/2),zt=_(d[Ft]),en=zt!==ee,bn=null===zt,Ln=zt==zt,gi=ca(zt);if(ze)var jn=F||Ln;else jn=Pt?Ln&&(F||en):qe?Ln&&en&&(F||!bn):ct?Ln&&en&&!bn&&(F||!gi):!bn&&!gi&&(F?zt<=f:zt<f);jn?ae=Ft+1:Te=Ft}return ms(Te,4294967294)}function Pv(d,f){for(var _=-1,F=d.length,ae=0,Te=[];++_<F;){var ze=d[_],qe=f?f(ze):ze;if(!_||!In(qe,ct)){var ct=qe;Te[ae++]=0===ze?0:ze}}return Te}function Fv(d){return"number"==typeof d?d:ca(d)?NaN:+d}function Lo(d){if("string"==typeof d)return d;if(Rn(d))return Xi(d,Lo)+"";if(ca(d))return Hh?Hh.call(d):"";var f=d+"";return"0"==f&&1/d==-te?"-0":f}function Oc(d,f,_){var F=-1,ae=Bl,Te=d.length,ze=!0,qe=[],ct=qe;if(_)ze=!1,ae=Oh;else if(Te>=200){var Pt=f?null:L_(d);if(Pt)return l_(Pt);ze=!1,ae=Nh,ct=new Oa}else ct=f?[]:qe;e:for(;++F<Te;){var Ft=d[F],zt=f?f(Ft):Ft;if(Ft=_||0!==Ft?Ft:0,ze&&zt==zt){for(var en=ct.length;en--;)if(ct[en]===zt)continue e;f&&ct.push(zt),qe.push(Ft)}else ae(ct,zt,_)||(ct!==qe&&ct.push(zt),qe.push(Ft))}return qe}function xu(d,f){return null==(d=G_(d,f=Nc(f,d)))||delete d[ni(sa(f))]}function Op(d,f,_,F){return Ip(d,f,_(ea(d,f)),F)}function Cu(d,f,_,F){for(var ae=d.length,Te=F?ae:-1;(F?Te--:++Te<ae)&&f(d[Te],Te,d););return _?Ds(d,F?0:Te,F?Te+1:ae):Ds(d,F?Te+1:0,F?ae:Te)}function fA(d,f){var _=d;return _ instanceof fi&&(_=_.value()),mu(f,function(F,ae){return ae.func.apply(ae.thisArg,zr([F],ae.args))},_)}function Au(d,f,_){var F=d.length;if(F<2)return F?Oc(d[0]):[];for(var ae=-1,Te=Et(F);++ae<F;)for(var ze=d[ae],qe=-1;++qe<F;)qe!=ae&&(Te[ae]=Mc(Te[ae]||ze,d[qe],f,_));return Oc(Ts(Te,1),f,_)}function Rp(d,f,_){for(var F=-1,ae=d.length,Te=f.length,ze={};++F<ae;)_(ze,d[F],F<Te?f[F]:ee);return ze}function Rc(d){return Ar(d)?d:[]}function P_(d){return"function"==typeof d?d:io}function Nc(d,f){return Rn(d)?d:ra(d,f)?[d]:Jv(Hi(d))}var pA=pi;function ll(d,f,_){var F=d.length;return _=_===ee?F:_,!f&&_>=F?d:Ds(d,f,_)}var gA=wv||function(d){return Ui.clearTimeout(d)};function Np(d,f){if(f)return d.slice();var _=d.length,F=vv?vv(_):new d.constructor(_);return d.copy(F),F}function Tu(d){var f=new d.constructor(d.byteLength);return new Dd(f).set(new Dd(d)),f}function F_(d,f){var _=f?Tu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.length)}function Pc(d,f){if(d!==f){var _=d!==ee,F=null===d,ae=d==d,Te=ca(d),ze=f!==ee,qe=null===f,ct=f==f,Pt=ca(f);if(!qe&&!Pt&&!Te&&d>f||Te&&ze&&ct&&!qe&&!Pt||F&&ze&&ct||!_&&ct||!ae)return 1;if(!F&&!Te&&!Pt&&d<f||Pt&&_&&ae&&!F&&!Te||qe&&_&&ae||!ze&&ae||!ct)return-1}return 0}function Ud(d,f,_,F){for(var ae=-1,Te=d.length,ze=_.length,qe=-1,ct=f.length,Pt=Hr(Te-ze,0),Ft=Et(ct+Pt),zt=!F;++qe<ct;)Ft[qe]=f[qe];for(;++ae<ze;)(zt||ae<Te)&&(Ft[_[ae]]=d[ae]);for(;Pt--;)Ft[qe++]=d[ae++];return Ft}function kv(d,f,_,F){for(var ae=-1,Te=d.length,ze=-1,qe=_.length,ct=-1,Pt=f.length,Ft=Hr(Te-qe,0),zt=Et(Ft+Pt),en=!F;++ae<Ft;)zt[ae]=d[ae];for(var bn=ae;++ct<Pt;)zt[bn+ct]=f[ct];for(;++ze<qe;)(en||ae<Te)&&(zt[bn+_[ze]]=d[ae++]);return zt}function eo(d,f){var _=-1,F=d.length;for(f||(f=Et(F));++_<F;)f[_]=d[_];return f}function Pa(d,f,_,F){var ae=!_;_||(_={});for(var Te=-1,ze=f.length;++Te<ze;){var qe=f[Te],ct=F?F(_[qe],d[qe],qe,_,d):ee;ct===ee&&(ct=d[qe]),ae?ol(_,qe,ct):sl(_,qe,ct)}return _}function ts(d,f){return function(_,F){var ae=Rn(_)?Ur:Cp,Te=f?f():{};return ae(_,d,Fn(F,2),Te)}}function zl(d){return pi(function(f,_){var F=-1,ae=_.length,Te=ae>1?_[ae-1]:ee,ze=ae>2?_[2]:ee;for(Te=d.length>3&&"function"==typeof Te?(ae--,Te):ee,ze&&Ws(_[0],_[1],ze)&&(Te=ae<3?ee:Te,ae=1),f=Qi(f);++F<ae;){var qe=_[F];qe&&d(f,qe,F,Te)}return f})}function cl(d,f){return function(_,F){if(null==_)return _;if(!bo(_))return d(_,F);for(var ae=_.length,Te=f?ae:-1,ze=Qi(_);(f?Te--:++Te<ae)&&!1!==F(ze[Te],Te,ze););return _}}function Lv(d){return function(f,_,F){for(var ae=-1,Te=Qi(f),ze=F(f),qe=ze.length;qe--;){var ct=ze[d?qe:++ae];if(!1===_(Te[ct],ct,Te))break}return f}}function Pp(d){return function(f){var _=Ph(f=Hi(f))?nl(f):ee,F=_?_[0]:f.charAt(0),ae=_?ll(_,1).join(""):f.slice(1);return F[d]()+ae}}function Hl(d){return function(f){return mu(Iy(Sy(f).replace(fp,"")),d,"")}}function Hd(d){return function(){var f=arguments;switch(f.length){case 0:return new d;case 1:return new d(f[0]);case 2:return new d(f[0],f[1]);case 3:return new d(f[0],f[1],f[2]);case 4:return new d(f[0],f[1],f[2],f[3]);case 5:return new d(f[0],f[1],f[2],f[3],f[4]);case 6:return new d(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new d(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=vu(d.prototype),F=d.apply(_,f);return Tr(F)?F:_}}function jv(d){return function(f,_,F){var ae=Qi(f);if(!bo(f)){var Te=Fn(_,3);f=Os(f),_=function(qe){return Te(ae[qe],qe,ae)}}var ze=d(f,_,F);return ze>-1?ae[Te?f[ze]:ze]:ee}}function Du(d){return ul(function(f){var _=f.length,F=_,ae=Po.prototype.thru;for(d&&f.reverse();F--;){var Te=f[F];if("function"!=typeof Te)throw new Ma(Se);if(ae&&!ze&&"wrapper"==Vp(Te))var ze=new Po([],!0)}for(F=ze?F:_;++F<_;){var qe=Vp(Te=f[F]),ct="wrapper"==qe?j_(Te):ee;ze=ct&&Up(ct[0])&&424==ct[1]&&!ct[4].length&&1==ct[9]?ze[Vp(ct[0])].apply(ze,ct[3]):1==Te.length&&Up(Te)?ze[qe]():ze.thru(Te)}return function(){var Pt=arguments,Ft=Pt[0];if(ze&&1==Pt.length&&Rn(Ft))return ze.plant(Ft).value();for(var zt=0,en=_?f[zt].apply(this,Pt):Ft;++zt<_;)en=f[zt].call(this,en);return en}})}function Fc(d,f,_,F,ae,Te,ze,qe,ct,Pt){var Ft=f&K,zt=1&f,en=2&f,bn=24&f,Ln=512&f,gi=en?ee:Hd(d);return function jn(){for(var mi=arguments.length,Mi=Et(mi),wo=mi;wo--;)Mi[wo]=arguments[wo];if(bn)var qs=$d(jn),ua=f2(Mi,qs);if(F&&(Mi=Ud(Mi,F,ae,bn)),Te&&(Mi=kv(Mi,Te,ze,bn)),mi-=ua,bn&&mi<Pt){var Gi=_u(Mi,qs);return zv(d,f,Fc,jn.placeholder,_,Mi,Gi,qe,ct,Pt-mi)}var _l=zt?_:this,Vc=en?_l[d]:d;return mi=Mi.length,qe?Mi=TA(Mi,qe):Ln&&mi>1&&Mi.reverse(),Ft&&ct<mi&&(Mi.length=ct),this&&this!==Ui&&this instanceof jn&&(Vc=gi||Hd(Vc)),Vc.apply(_l,Mi)}}function Vv(d,f){return function(_,F){return function(d,f,_,F){return al(d,function(ae,Te,ze){f(F,_(ae),Te,ze)}),F}(_,d,f(F),{})}}function k_(d,f){return function(_,F){var ae;if(_===ee&&F===ee)return f;if(_!==ee&&(ae=_),F!==ee){if(ae===ee)return F;"string"==typeof _||"string"==typeof F?(_=Lo(_),F=Lo(F)):(_=Fv(_),F=Fv(F)),ae=d(_,F)}return ae}}function Fp(d){return ul(function(f){return f=Xi(f,Jo(Fn())),pi(function(_){var F=this;return d(f,function(ae){return ls(ae,F,_)})})})}function kp(d,f){var _=(f=f===ee?" ":Lo(f)).length;if(_<2)return _?Dp(f,d):f;var F=Dp(f,jt(d/Fh(f)));return Ph(f)?ll(nl(F),0,d).join(""):F.slice(0,d)}function Uv(d){return function(f,_,F){return F&&"number"!=typeof F&&Ws(f,_,F)&&(_=F=ee),f=gl(f),_===ee?(_=f,f=0):_=gl(_),function(d,f,_,F){for(var ae=-1,Te=Hr(jt((f-d)/(_||1)),0),ze=Et(Te);Te--;)ze[F?Te:++ae]=d,d+=_;return ze}(f,_,F=F===ee?f<_?1:-1:gl(F),d)}}function Lp(d){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=vo(f),_=vo(_)),d(f,_)}}function zv(d,f,_,F,ae,Te,ze,qe,ct,Pt){var Ft=8&f;f|=Ft?V:64,4&(f&=~(Ft?64:V))||(f&=-4);var gi=[d,f,ae,Ft?Te:ee,Ft?ze:ee,Ft?ee:Te,Ft?ee:ze,qe,ct,Pt],jn=_.apply(ee,gi);return Up(d)&&Zv(jn,gi),jn.placeholder=F,tf(jn,d,f)}function Gd(d){var f=es[d];return function(_,F){if(_=vo(_),(F=null==F?0:ms(Jn(F),292))&&g_(_)){var ae=(Hi(_)+"e").split("e");return+((ae=(Hi(f(ae[0]+"e"+(+ae[1]+F)))+"e").split("e"))[0]+"e"+(+ae[1]-F))}return f(_)}}var L_=Ia&&1/l_(new Ia([,-0]))[1]==te?function(d){return new Ia(d)}:Fy;function Iu(d){return function(f){var _=$s(f);return _==Ne?_v(f):_==pt?function(at){var It=-1,Et=Array(at.size);return at.forEach(function(un){Et[++It]=[un,un]}),Et}(f):function(at,It){return Xi(It,function(Et){return[Et,at[Et]]})}(f,d(f))}}function Gl(d,f,_,F,ae,Te,ze,qe){var ct=2&f;if(!ct&&"function"!=typeof d)throw new Ma(Se);var Pt=F?F.length:0;if(Pt||(f&=-97,F=ae=ee),ze=ze===ee?ze:Hr(Jn(ze),0),qe=qe===ee?qe:Jn(qe),Pt-=ae?ae.length:0,64&f){var Ft=F,zt=ae;F=ae=ee}var en=ct?ee:j_(d),bn=[d,f,_,F,ae,Ft,zt,Te,ze,qe];if(en&&function(d,f){var _=d[1],F=f[1],ae=_|F;if(!(ae<131||(F==K&&8==_||F==K&&256==_&&d[7].length<=f[8]||384==F&&f[7].length<=f[8]&&8==_)))return d;1&F&&(d[2]=f[2],ae|=1&_?0:4);var qe=f[3];if(qe){var ct=d[3];d[3]=ct?Ud(ct,qe,f[4]):qe,d[4]=ct?_u(d[3],P):f[4]}(qe=f[5])&&(d[5]=(ct=d[5])?kv(ct,qe,f[6]):qe,d[6]=ct?_u(d[5],P):f[6]),(qe=f[7])&&(d[7]=qe),F&K&&(d[8]=null==d[8]?f[8]:ms(d[8],f[8])),null==d[9]&&(d[9]=f[9]),d[0]=f[0],d[1]=ae}(bn,en),d=bn[0],f=bn[1],_=bn[2],F=bn[3],ae=bn[4],!(qe=bn[9]=bn[9]===ee?ct?0:d.length:Hr(bn[9]-Pt,0))&&24&f&&(f&=-25),f&&1!=f)Ln=8==f||16==f?function(d,f,_){var F=Hd(d);return function ae(){for(var Te=arguments.length,ze=Et(Te),qe=Te,ct=$d(ae);qe--;)ze[qe]=arguments[qe];var Pt=Te<3&&ze[0]!==ct&&ze[Te-1]!==ct?[]:_u(ze,ct);return(Te-=Pt.length)<_?zv(d,f,Fc,ae.placeholder,ee,ze,Pt,ee,ee,_-Te):ls(this&&this!==Ui&&this instanceof ae?F:d,this,ze)}}(d,f,qe):f!=V&&33!=f||ae.length?Fc.apply(ee,bn):function(d,f,_,F){var ae=1&f,Te=Hd(d);return function ze(){for(var qe=-1,ct=arguments.length,Pt=-1,Ft=F.length,zt=Et(Ft+ct),en=this&&this!==Ui&&this instanceof ze?Te:d;++Pt<Ft;)zt[Pt]=F[Pt];for(;ct--;)zt[Pt++]=arguments[++qe];return ls(en,ae?_:this,zt)}}(d,f,_,F);else var Ln=function(d,f,_){var F=1&f,ae=Hd(d);return function Te(){return(this&&this!==Ui&&this instanceof Te?ae:d).apply(F?_:this,arguments)}}(d,f,_);return tf((en?O_:Zv)(Ln,bn),d,f)}function Hv(d,f,_,F){return d===ee||In(d,yu[_])&&!Zi.call(F,_)?f:d}function yA(d,f,_,F,ae,Te){return Tr(d)&&Tr(f)&&(Te.set(f,d),I_(d,f,ee,yA,Te),Te.delete(f)),d}function Bp(d){return Jp(d)?ee:d}function jp(d,f,_,F,ae,Te){var ze=1&_,qe=d.length,ct=f.length;if(qe!=ct&&!(ze&&ct>qe))return!1;var Pt=Te.get(d),Ft=Te.get(f);if(Pt&&Ft)return Pt==f&&Ft==d;var zt=-1,en=!0,bn=2&_?new Oa:ee;for(Te.set(d,f),Te.set(f,d);++zt<qe;){var Ln=d[zt],gi=f[zt];if(F)var jn=ze?F(gi,Ln,zt,f,d,Te):F(Ln,gi,zt,d,f,Te);if(jn!==ee){if(jn)continue;en=!1;break}if(bn){if(!Ro(f,function(mi,Mi){if(!Nh(bn,Mi)&&(Ln===mi||ae(Ln,mi,_,F,Te)))return bn.push(Mi)})){en=!1;break}}else if(Ln!==gi&&!ae(Ln,gi,_,F,Te)){en=!1;break}}return Te.delete(d),Te.delete(f),en}function ul(d){return Hp(AA(d,ee,Is),d+"")}function $l(d){return rr(d,Os,V_)}function B_(d){return rr(d,no,Wv)}var j_=zh?function(d){return zh.get(d)}:Fy;function Vp(d){for(var f=d.name+"",_=Id[f],F=Zi.call(Id,f)?_.length:0;F--;){var ae=_[F],Te=ae.func;if(null==Te||Te==d)return ae.name}return f}function $d(d){return(Zi.call(Ee,"placeholder")?Ee:d).placeholder}function Fn(){var d=Ee.iteratee||Pu;return d=d===Pu?cA:d,arguments.length?d(arguments[0],arguments[1]):d}function Gs(d,f){var _=d.__data__;return function(d){var f=typeof d;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==d:null===d}(f)?_["string"==typeof f?"string":"hash"]:_.map}function ia(d){for(var f=Os(d),_=f.length;_--;){var F=f[_],ae=d[F];f[_]=[F,ae,xA(ae)]}return f}function kc(d,f){var _=function(at,It){return null==at?ee:at[It]}(d,f);return D_(_)?_:ee}var V_=Cr?function(d){return null==d?[]:(d=Qi(d),Aa(Cr(d),function(f){return mp.call(d,f)}))}:jc,Wv=Cr?function(d){for(var f=[];d;)zr(f,V_(d)),d=Da(d);return f}:jc,$s=Ms;function Yv(d,f,_){for(var F=-1,ae=(f=Nc(f,d)).length,Te=!1;++F<ae;){var ze=ni(f[F]);if(!(Te=null!=d&&_(d,ze)))break;d=d[ze]}return Te||++F!=ae?Te:!!(ae=null==d?0:d.length)&&py(ae)&&Bo(ze,ae)&&(Rn(d)||fl(d))}function Kv(d){return"function"!=typeof d.constructor||zp(d)?{}:vu(Da(d))}function SA(d){return Rn(d)||fl(d)||!!($1&&d&&d[$1])}function Bo(d,f){var _=typeof d;return!!(f=null==f?Ce:f)&&("number"==_||"symbol"!=_&&qi.test(d))&&d>-1&&d%1==0&&d<f}function Ws(d,f,_){if(!Tr(_))return!1;var F=typeof f;return!!("number"==F?bo(_)&&Bo(f,_.length):"string"==F&&f in _)&&In(_[f],d)}function ra(d,f){if(Rn(d))return!1;var _=typeof d;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=d&&!ca(d))||ge.test(d)||!ht.test(d)||null!=f&&d in Qi(f)}function Up(d){var f=Vp(d),_=Ee[f];if("function"!=typeof _||!(f in fi.prototype))return!1;if(d===_)return!0;var F=j_(_);return!!F&&d===F[0]}(As&&$s(new As(new ArrayBuffer(1)))!=St||_o&&$s(new _o)!=Ne||bp&&$s(bp.resolve())!=ue||Ia&&$s(new Ia)!=pt||No&&$s(new No)!=B)&&($s=function(d){var f=Ms(d),_=f==pe?d.constructor:ee,F=_?Ou(_):"";if(F)switch(F){case K1:return St;case m_:return Ne;case __:return ue;case Ev:return pt;case y_:return B}return f});var Qv=gp?la:Ly;function zp(d){var f=d&&d.constructor;return d===("function"==typeof f&&f.prototype||yu)}function xA(d){return d==d&&!Tr(d)}function CA(d,f){return function(_){return null!=_&&_[d]===f&&(f!==ee||d in Qi(_))}}function AA(d,f,_){return f=Hr(f===ee?d.length-1:f,0),function(){for(var F=arguments,ae=-1,Te=Hr(F.length-f,0),ze=Et(Te);++ae<Te;)ze[ae]=F[f+ae];ae=-1;for(var qe=Et(f+1);++ae<f;)qe[ae]=F[ae];return qe[f]=_(ze),ls(d,this,qe)}}function G_(d,f){return f.length<2?d:ea(d,Ds(f,0,-1))}function TA(d,f){for(var _=d.length,F=ms(f.length,_),ae=eo(d);F--;){var Te=f[F];d[F]=Bo(Te,_)?ae[Te]:ee}return d}function $_(d,f){if(("constructor"!==f||"function"!=typeof d[f])&&"__proto__"!=f)return d[f]}var Zv=W_(O_),ef=q1||function(d,f){return Ui.setTimeout(d,f)},Hp=W_(ko);function tf(d,f,_){var F=f+"";return Hp(d,function(d,f){var _=f.length;if(!_)return d;var F=_-1;return f[F]=(_>1?"& ":"")+f[F],f=f.join(_>2?", ":" "),d.replace(Mt,"{\n/* [wrapped with "+f+"] */\n")}(F,function(d,f){return Us(st,function(_){var F="_."+_[0];f&_[1]&&!Bl(d,F)&&d.push(F)}),d.sort()}(function(d){var f=d.match(Dt);return f?f[1].split(Xt):[]}(F),_)))}function W_(d){var f=0,_=0;return function(){var F=S2(),ae=16-(F-_);if(_=F,ae>0){if(++f>=800)return arguments[0]}else f=0;return d.apply(ee,arguments)}}function Wd(d,f){var _=-1,F=d.length,ae=F-1;for(f=f===ee?F:f;++_<f;){var Te=Ul(_,ae),ze=d[Te];d[Te]=d[_],d[_]=ze}return d.length=f,d}var f,_,Jv=(f=lf(function(d){var f=[];return 46===d.charCodeAt(0)&&f.push(""),d.replace(be,function(_,F,ae,Te){f.push(ae?Te.replace(Nn,"$1"):F||_)}),f},function(F){return 500===_.size&&_.clear(),F}),_=f.cache,f);function ni(d){if("string"==typeof d||ca(d))return d;var f=d+"";return"0"==f&&1/d==-te?"-0":f}function Ou(d){if(null!=d){try{return xr.call(d)}catch(f){}try{return d+""}catch(f){}}return""}function nf(d){if(d instanceof fi)return d.clone();var f=new Po(d.__wrapped__,d.__chain__);return f.__actions__=eo(d.__actions__),f.__index__=d.__index__,f.__values__=d.__values__,f}var OA=pi(function(d,f){return Ar(d)?Mc(d,Ts(f,1,Ar,!0)):[]}),RA=pi(function(d,f){var _=sa(f);return Ar(_)&&(_=ee),Ar(d)?Mc(d,Ts(f,1,Ar,!0),Fn(_,2)):[]}),NA=pi(function(d,f){var _=sa(f);return Ar(_)&&(_=ee),Ar(d)?Mc(d,Ts(f,1,Ar,!0),ee,_):[]});function Y_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=null==_?0:Jn(_);return ae<0&&(ae=Hr(F+ae,0)),Cd(d,Fn(f,3),ae)}function K_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=F-1;return _!==ee&&(ae=Jn(_),ae=_<0?Hr(F+ae,0):ms(ae,F-1)),Cd(d,Fn(f,3),ae,!0)}function Is(d){return null!=d&&d.length?Ts(d,1):[]}function tw(d){return d&&d.length?d[0]:ee}var iw=pi(function(d){var f=Xi(d,Rc);return f.length&&f[0]===d[0]?Eu(f):[]}),kA=pi(function(d){var f=sa(d),_=Xi(d,Rc);return f===sa(_)?f=ee:_.pop(),_.length&&_[0]===d[0]?Eu(_,Fn(f,2)):[]}),rw=pi(function(d){var f=sa(d),_=Xi(d,Rc);return(f="function"==typeof f?f:ee)&&_.pop(),_.length&&_[0]===d[0]?Eu(_,ee,f):[]});function sa(d){var f=null==d?0:d.length;return f?d[f-1]:ee}var Q_=pi(Z_);function Z_(d,f){return d&&d.length&&f&&f.length?na(d,f):d}var ow=ul(function(d,f){var _=null==d?0:d.length,F=x_(d,f);return Qh(d,Xi(f,function(ae){return Bo(ae,_)?+ae:ae}).sort(Pc)),F});function J_(d){return null==d?d:yp.call(d)}var cw=pi(function(d){return Oc(Ts(d,1,Ar,!0))}),YA=pi(function(d){var f=sa(d);return Ar(f)&&(f=ee),Oc(Ts(d,1,Ar,!0),Fn(f,2))}),KA=pi(function(d){var f=sa(d);return f="function"==typeof f?f:ee,Oc(Ts(d,1,Ar,!0),ee,f)});function uw(d){if(!d||!d.length)return[];var f=0;return d=Aa(d,function(_){if(Ar(_))return f=Hr(_.length,f),!0}),Td(f,function(_){return Xi(d,s_(_))})}function QA(d,f){if(!d||!d.length)return[];var _=uw(d);return null==f?_:Xi(_,function(F){return ls(f,ee,F)})}var dw=pi(function(d,f){return Ar(d)?Mc(d,f):[]}),z2=pi(function(d){return Au(Aa(d,Ar))}),jo=pi(function(d){var f=sa(d);return Ar(f)&&(f=ee),Au(Aa(d,Ar),Fn(f,2))}),ey=pi(function(d){var f=sa(d);return f="function"==typeof f?f:ee,Au(Aa(d,Ar),ee,f)}),ty=pi(uw),of=pi(function(d){var f=d.length,_=f>1?d[f-1]:ee;return _="function"==typeof _?(d.pop(),_):ee,QA(d,_)});function ny(d){var f=Ee(d);return f.__chain__=!0,f}function Yd(d,f){return f(d)}var iy=ul(function(d){var f=d.length,_=f?d[0]:0,F=this.__wrapped__,ae=function(Te){return x_(Te,d)};return!(f>1||this.__actions__.length)&&F instanceof fi&&Bo(_)?((F=F.slice(_,+_+(f?1:0))).__actions__.push({func:Yd,args:[ae],thisArg:ee}),new Po(F,this.__chain__).thru(function(Te){return f&&!Te.length&&Te.push(ee),Te})):this.thru(ae)}),eT=ts(function(d,f,_){Zi.call(d,_)?++d[_]:ol(d,_,1)}),iT=jv(Y_),rT=jv(K_);function ay(d,f){return(Rn(d)?Us:Dc)(d,Fn(f,3))}function Wp(d,f){return(Rn(d)?Sd:A_)(d,Fn(f,3))}var oT=ts(function(d,f,_){Zi.call(d,_)?d[_].push(f):ol(d,_,[f])}),_w=pi(function(d,f,_){var F=-1,ae="function"==typeof f,Te=bo(d)?Et(d.length):[];return Dc(d,function(ze){Te[++F]=ae?ls(f,ze,_):Na(ze,f,_)}),Te}),yw=ts(function(d,f,_){ol(d,_,f)});function hl(d,f){return(Rn(d)?Xi:uA)(d,Fn(f,3))}var vw=ts(function(d,f,_){d[_?0:1].push(f)},function(){return[[],[]]}),Yp=pi(function(d,f){if(null==d)return[];var _=f.length;return _>1&&Ws(d,f[0],f[1])?f=[]:_>2&&Ws(f[0],f[1],f[2])&&(f=[f[0]]),Xh(d,Ts(f,1),[])}),Ru=W1||function(){return Ui.Date.now()};function Kp(d,f,_){return f=_?ee:f,Gl(d,K,ee,ee,ee,ee,f=d&&null==f?d.length:f)}function cy(d,f){var _;if("function"!=typeof f)throw new Ma(Se);return d=Jn(d),function(){return--d>0&&(_=f.apply(this,arguments)),d<=1&&(f=ee),_}}var af=pi(function(d,f,_){var F=1;if(_.length){var ae=_u(_,$d(af));F|=V}return Gl(d,F,f,_,ae)}),Xd=pi(function(d,f,_){var F=3;if(_.length){var ae=_u(_,$d(Xd));F|=V}return Gl(f,F,d,_,ae)});function Tw(d,f,_){var F,ae,Te,ze,qe,ct,Pt=0,Ft=!1,zt=!1,en=!0;if("function"!=typeof d)throw new Ma(Se);function bn(Gi){var _l=F,Vc=ae;return F=ae=ee,Pt=Gi,ze=d.apply(Vc,_l)}function Ln(Gi){return Pt=Gi,qe=ef(mi,f),Ft?bn(Gi):ze}function jn(Gi){var _l=Gi-ct;return ct===ee||_l>=f||_l<0||zt&&Gi-Pt>=Te}function mi(){var Gi=Ru();if(jn(Gi))return Mi(Gi);qe=ef(mi,function(Gi){var gM=f-(Gi-ct);return zt?ms(gM,Te-(Gi-Pt)):gM}(Gi))}function Mi(Gi){return qe=ee,en&&F?bn(Gi):(F=ae=ee,ze)}function ua(){var Gi=Ru(),_l=jn(Gi);if(F=arguments,ae=this,ct=Gi,_l){if(qe===ee)return Ln(ct);if(zt)return gA(qe),qe=ef(mi,f),bn(ct)}return qe===ee&&(qe=ef(mi,f)),ze}return f=vo(f)||0,Tr(_)&&(Ft=!!_.leading,Te=(zt="maxWait"in _)?Hr(vo(_.maxWait)||0,f):Te,en="trailing"in _?!!_.trailing:en),ua.cancel=function(){qe!==ee&&gA(qe),Pt=0,F=ct=ae=qe=ee},ua.flush=function(){return qe===ee?ze:Mi(Ru())},ua}var uT=pi(function(d,f){return qh(d,1,f)}),Mw=pi(function(d,f,_){return qh(d,vo(f)||0,_)});function lf(d,f){if("function"!=typeof d||null!=f&&"function"!=typeof f)throw new Ma(Se);var _=function(){var F=arguments,ae=f?f.apply(this,F):F[0],Te=_.cache;if(Te.has(ae))return Te.get(ae);var ze=d.apply(this,F);return _.cache=Te.set(ae,ze)||Te,ze};return _.cache=new(lf.Cache||rl),_}function hy(d){if("function"!=typeof d)throw new Ma(Se);return function(){var f=arguments;switch(f.length){case 0:return!d.call(this);case 1:return!d.call(this,f[0]);case 2:return!d.call(this,f[0],f[1]);case 3:return!d.call(this,f[0],f[1],f[2])}return!d.apply(this,f)}}lf.Cache=rl;var dT=pA(function(d,f){var _=(f=1==f.length&&Rn(f[0])?Xi(f[0],Jo(Fn())):Xi(Ts(f,1),Jo(Fn()))).length;return pi(function(F){for(var ae=-1,Te=ms(F.length,_);++ae<Te;)F[ae]=f[ae].call(this,F[ae]);return ls(d,this,F)})}),Xp=pi(function(d,f){var _=_u(f,$d(Xp));return Gl(d,V,ee,f,_)}),Iw=pi(function(d,f){var _=_u(f,$d(Iw));return Gl(d,64,ee,f,_)}),hT=ul(function(d,f){return Gl(d,256,ee,ee,ee,f)});function In(d,f){return d===f||d!=d&&f!=f}var Jt=Lp(Fo),Nw=Lp(function(d,f){return d>=f}),fl=oA(function(){return arguments}())?oA:function(d){return Mr(d)&&Zi.call(d,"callee")&&!mp.call(d,"callee")},Rn=Et.isArray,Pw=nn?Jo(nn):function(d){return Mr(d)&&Ms(d)==Qe};function bo(d){return null!=d&&py(d.length)&&!la(d)}function Ar(d){return Mr(d)&&bo(d)}var pl=cs||Ly,Fw=hi?Jo(hi):function(d){return Mr(d)&&Ms(d)==ke};function ka(d){if(!Mr(d))return!1;var f=Ms(d);return f==Me||"[object DOMException]"==f||"string"==typeof d.message&&"string"==typeof d.name&&!Jp(d)}function la(d){if(!Tr(d))return!1;var f=Ms(d);return f==Ve||f==$e||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Zp(d){return"number"==typeof d&&d==Jn(d)}function py(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=Ce}function Tr(d){var f=typeof d;return null!=d&&("object"==f||"function"==f)}function Mr(d){return null!=d&&"object"==typeof d}var wT=fr?Jo(fr):function(d){return Mr(d)&&$s(d)==Ne};function xT(d){return"number"==typeof d||Mr(d)&&Ms(d)==q}function Jp(d){if(!Mr(d)||Ms(d)!=pe)return!1;var f=Da(d);if(null===f)return!0;var _=Zi.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&xr.call(_)==G1}var jw=mo?Jo(mo):function(d){return Mr(d)&&Ms(d)==_t},CT=xc?Jo(xc):function(d){return Mr(d)&&$s(d)==pt};function my(d){return"string"==typeof d||!Rn(d)&&Mr(d)&&Ms(d)==ve}function ca(d){return"symbol"==typeof d||Mr(d)&&Ms(d)==L}var cf=as?Jo(as):function(d){return Mr(d)&&py(d.length)&&!!cn[Ms(d)]},Lc=Lp(Rv),_y=Lp(function(d,f){return d<=f});function Vw(d){if(!d)return[];if(bo(d))return my(d)?nl(d):eo(d);if(Bh&&d[Bh])return function(at){for(var It,Et=[];!(It=at.next()).done;)Et.push(It.value);return Et}(d[Bh]());var f=$s(d);return(f==Ne?_v:f==pt?l_:th)(d)}function gl(d){return d?(d=vo(d))===te||d===-te?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function Jn(d){var f=gl(d),_=f%1;return f==f?_?f-_:f:0}function yy(d){return d?wu(Jn(d),0,_e):0}function vo(d){if("number"==typeof d)return d;if(ca(d))return NaN;if(Tr(d)){var f="function"==typeof d.valueOf?d.valueOf():d;d=Tr(f)?f+"":f}if("string"!=typeof d)return 0===d?d:+d;d=mv(d);var _=lr.test(d);return _||Xn.test(d)?gv(d.slice(2),_?2:8):Cn.test(d)?NaN:+d}function Uw(d){return Pa(d,no(d))}function Hi(d){return null==d?"":Lo(d)}var AT=zl(function(d,f){if(zp(f)||bo(f))Pa(f,Os(f),d);else for(var _ in f)Zi.call(f,_)&&sl(d,_,f[_])}),TT=zl(function(d,f){Pa(f,no(f),d)}),Qd=zl(function(d,f,_,F){Pa(f,no(f),d,F)}),MT=zl(function(d,f,_,F){Pa(f,Os(f),d,F)}),zw=ul(x_),IT=pi(function(d,f){d=Qi(d);var _=-1,F=f.length,ae=F>2?f[2]:ee;for(ae&&Ws(f[0],f[1],ae)&&(F=1);++_<F;)for(var Te=f[_],ze=no(Te),qe=-1,ct=ze.length;++qe<ct;){var Pt=ze[qe],Ft=d[Pt];(Ft===ee||In(Ft,yu[Pt])&&!Zi.call(d,Pt))&&(d[Pt]=Te[Pt])}return d}),uf=pi(function(d){return d.push(ee,yA),ls(Yw,ee,d)});function hf(d,f,_){var F=null==d?ee:ea(d,f);return F===ee?_:F}function eg(d,f){return null!=d&&Yv(d,f,Ld)}var tg=Vv(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Zs.call(f)),d[f]=_},Ry(io)),RT=Vv(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Zs.call(f)),Zi.call(d,f)?d[f].push(_):d[f]=[_]},Fn),$w=pi(Na);function Os(d){return bo(d)?Wh(d):Ov(d)}function no(d){return bo(d)?Wh(d,!0):function(d){if(!Tr(d))return function(d){var f=[];if(null!=d)for(var _ in Qi(d))f.push(_);return f}(d);var f=zp(d),_=[];for(var F in d)"constructor"==F&&(f||!Zi.call(d,F))||_.push(F);return _}(d)}var qw=zl(function(d,f,_){I_(d,f,_)}),Yw=zl(function(d,f,_,F){I_(d,f,_,F)}),PT=ul(function(d,f){var _={};if(null==d)return _;var F=!1;f=Xi(f,function(Te){return Te=Nc(Te,d),F||(F=Te.length>1),Te}),Pa(d,B_(d),_),F&&(_=Hs(_,7,Bp));for(var ae=f.length;ae--;)xu(_,f[ae]);return _}),FT=ul(function(d,f){return null==d?{}:function(d,f){return Nv(d,f,function(_,F){return eg(d,F)})}(d,f)});function Kw(d,f){if(null==d)return{};var _=Xi(B_(d),function(F){return[F]});return f=Fn(f),Nv(d,_,function(F,ae){return f(F,ae[0])})}var kT=Iu(Os),Qw=Iu(no);function th(d){return null==d?[]:a_(d,Os(d))}var UT=Hl(function(d,f,_){return f=f.toLowerCase(),d+(_?Ey(f):f)});function Ey(d){return ig(Hi(d).toLowerCase())}function Sy(d){return(d=Hi(d))&&d.replace(Sa,p2).replace(i_,"")}var HT=Hl(function(d,f,_){return d+(_?"-":"")+f.toLowerCase()}),GT=Hl(function(d,f,_){return d+(_?" ":"")+f.toLowerCase()}),J2=Pp("toLowerCase"),XT=Hl(function(d,f,_){return d+(_?"_":"")+f.toLowerCase()}),Ay=Hl(function(d,f,_){return d+(_?" ":"")+ig(f)}),iE=Hl(function(d,f,_){return d+(_?" ":"")+f.toUpperCase()}),ig=Pp("toUpperCase");function Iy(d,f,_){return d=Hi(d),(f=_?ee:f)===ee?function(at){return kl.test(at)}(d)?function(at){return at.match(dv)||[]}(d):function(at){return at.match(zn)||[]}(d):d.match(f)||[]}var Oy=pi(function(d,f){try{return ls(d,ee,f)}catch(_){return ka(_)?_:new Dn(_)}}),rE=ul(function(d,f){return Us(f,function(_){_=ni(_),ol(d,_,af(d[_],d))}),d});function Ry(d){return function(){return d}}var tk=Du(),Nu=Du(!0);function io(d){return d}function Pu(d){return cA("function"==typeof d?d:Hs(d,1))}var Ny=pi(function(d,f){return function(_){return Na(_,d,f)}}),sE=pi(function(d,f){return function(_){return Na(d,_,f)}});function Py(d,f,_){var F=Os(f),ae=Kh(f,F);null==_&&(!Tr(f)||!ae.length&&F.length)&&(_=f,f=d,d=this,ae=Kh(f,Os(f)));var Te=!(Tr(_)&&"chain"in _&&!_.chain),ze=la(d);return Us(ae,function(qe){var ct=f[qe];d[qe]=ct,ze&&(d.prototype[qe]=function(){var Pt=this.__chain__;if(Te||Pt){var Ft=d(this.__wrapped__),zt=Ft.__actions__=eo(this.__actions__);return zt.push({func:ct,args:arguments,thisArg:d}),Ft.__chain__=Pt,Ft}return ct.apply(d,zr([this.value()],arguments))})}),d}function Fy(){}var iM=Fp(Xi),rM=Fp(ti),aE=Fp(Ro);function Fu(d){return ra(d)?s_(ni(d)):function(d){return function(f){return ea(f,d)}}(d)}var sM=Uv(),oM=Uv(!0);function jc(){return[]}function Ly(){return!1}var Wn=k_(function(d,f){return d+f},0),By=Gd("ceil"),ik=k_(function(d,f){return d/f},1),Yl=Gd("floor"),dE=k_(function(d,f){return d*f},1),hE=Gd("round"),fE=k_(function(d,f){return d-f},0);return Ee.after=function(d,f){if("function"!=typeof f)throw new Ma(Se);return d=Jn(d),function(){if(--d<1)return f.apply(this,arguments)}},Ee.ary=Kp,Ee.assign=AT,Ee.assignIn=TT,Ee.assignInWith=Qd,Ee.assignWith=MT,Ee.at=zw,Ee.before=cy,Ee.bind=af,Ee.bindAll=rE,Ee.bindKey=Xd,Ee.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return Rn(d)?d:[d]},Ee.chain=ny,Ee.chunk=function(d,f,_){f=(_?Ws(d,f,_):f===ee)?1:Hr(Jn(f),0);var F=null==d?0:d.length;if(!F||f<1)return[];for(var ae=0,Te=0,ze=Et(jt(F/f));ae<F;)ze[Te++]=Ds(d,ae,ae+=f);return ze},Ee.compact=function(d){for(var f=-1,_=null==d?0:d.length,F=0,ae=[];++f<_;){var Te=d[f];Te&&(ae[F++]=Te)}return ae},Ee.concat=function(){var d=arguments.length;if(!d)return[];for(var f=Et(d-1),_=arguments[0],F=d;F--;)f[F-1]=arguments[F];return zr(Rn(_)?eo(_):[_],Ts(f,1))},Ee.cond=function(d){var f=null==d?0:d.length,_=Fn();return d=f?Xi(d,function(F){if("function"!=typeof F[1])throw new Ma(Se);return[_(F[0]),F[1]]}):[],pi(function(F){for(var ae=-1;++ae<f;){var Te=d[ae];if(ls(Te[0],this,F))return ls(Te[1],this,F)}})},Ee.conforms=function(d){return function(d){var f=Os(d);return function(_){return Ap(_,d,f)}}(Hs(d,1))},Ee.constant=Ry,Ee.countBy=eT,Ee.create=function(d,f){var _=vu(d);return null==f?_:sA(_,f)},Ee.curry=function Aw(d,f,_){var F=Gl(d,8,ee,ee,ee,ee,ee,f=_?ee:f);return F.placeholder=Aw.placeholder,F},Ee.curryRight=function uy(d,f,_){var F=Gl(d,16,ee,ee,ee,ee,ee,f=_?ee:f);return F.placeholder=uy.placeholder,F},Ee.debounce=Tw,Ee.defaults=IT,Ee.defaultsDeep=uf,Ee.defer=uT,Ee.delay=Mw,Ee.difference=OA,Ee.differenceBy=RA,Ee.differenceWith=NA,Ee.drop=function(d,f,_){var F=null==d?0:d.length;return F?Ds(d,(f=_||f===ee?1:Jn(f))<0?0:f,F):[]},Ee.dropRight=function(d,f,_){var F=null==d?0:d.length;return F?Ds(d,0,(f=F-(f=_||f===ee?1:Jn(f)))<0?0:f):[]},Ee.dropRightWhile=function(d,f){return d&&d.length?Cu(d,Fn(f,3),!0,!0):[]},Ee.dropWhile=function(d,f){return d&&d.length?Cu(d,Fn(f,3),!0):[]},Ee.fill=function(d,f,_,F){var ae=null==d?0:d.length;return ae?(_&&"number"!=typeof _&&Ws(d,f,_)&&(_=0,F=ae),function(d,f,_,F){var ae=d.length;for((_=Jn(_))<0&&(_=-_>ae?0:ae+_),(F=F===ee||F>ae?ae:Jn(F))<0&&(F+=ae),F=_>F?0:yy(F);_<F;)d[_++]=f;return d}(d,f,_,F)):[]},Ee.filter=function(d,f){return(Rn(d)?Aa:Iv)(d,Fn(f,3))},Ee.flatMap=function(d,f){return Ts(hl(d,f),1)},Ee.flatMapDeep=function(d,f){return Ts(hl(d,f),te)},Ee.flatMapDepth=function(d,f,_){return _=_===ee?1:Jn(_),Ts(hl(d,f),_)},Ee.flatten=Is,Ee.flattenDeep=function(d){return null!=d&&d.length?Ts(d,te):[]},Ee.flattenDepth=function(d,f){return null!=d&&d.length?Ts(d,f=f===ee?1:Jn(f)):[]},Ee.flip=function(d){return Gl(d,512)},Ee.flow=tk,Ee.flowRight=Nu,Ee.fromPairs=function(d){for(var f=-1,_=null==d?0:d.length,F={};++f<_;){var ae=d[f];F[ae[0]]=ae[1]}return F},Ee.functions=function(d){return null==d?[]:Kh(d,Os(d))},Ee.functionsIn=function(d){return null==d?[]:Kh(d,no(d))},Ee.groupBy=oT,Ee.initial=function(d){return null!=d&&d.length?Ds(d,0,-1):[]},Ee.intersection=iw,Ee.intersectionBy=kA,Ee.intersectionWith=rw,Ee.invert=tg,Ee.invertBy=RT,Ee.invokeMap=_w,Ee.iteratee=Pu,Ee.keyBy=yw,Ee.keys=Os,Ee.keysIn=no,Ee.map=hl,Ee.mapKeys=function(d,f){var _={};return f=Fn(f,3),al(d,function(F,ae,Te){ol(_,f(F,ae,Te),F)}),_},Ee.mapValues=function(d,f){var _={};return f=Fn(f,3),al(d,function(F,ae,Te){ol(_,ae,f(F,ae,Te))}),_},Ee.matches=function(d){return dA(Hs(d,1))},Ee.matchesProperty=function(d,f){return jd(d,Hs(f,1))},Ee.memoize=lf,Ee.merge=qw,Ee.mergeWith=Yw,Ee.method=Ny,Ee.methodOf=sE,Ee.mixin=Py,Ee.negate=hy,Ee.nthArg=function(d){return d=Jn(d),pi(function(f){return Su(f,d)})},Ee.omit=PT,Ee.omitBy=function(d,f){return Kw(d,hy(Fn(f)))},Ee.once=function(d){return cy(2,d)},Ee.orderBy=function(d,f,_,F){return null==d?[]:(Rn(f)||(f=null==f?[]:[f]),Rn(_=F?ee:_)||(_=null==_?[]:[_]),Xh(d,f,_))},Ee.over=iM,Ee.overArgs=dT,Ee.overEvery=rM,Ee.overSome=aE,Ee.partial=Xp,Ee.partialRight=Iw,Ee.partition=vw,Ee.pick=FT,Ee.pickBy=Kw,Ee.property=Fu,Ee.propertyOf=function(d){return function(f){return null==d?ee:ea(d,f)}},Ee.pull=Q_,Ee.pullAll=Z_,Ee.pullAllBy=function(d,f,_){return d&&d.length&&f&&f.length?na(d,f,Fn(_,2)):d},Ee.pullAllWith=function(d,f,_){return d&&d.length&&f&&f.length?na(d,f,ee,_):d},Ee.pullAt=ow,Ee.range=sM,Ee.rangeRight=oM,Ee.rearg=hT,Ee.reject=function(d,f){return(Rn(d)?Aa:Iv)(d,hy(Fn(f,3)))},Ee.remove=function(d,f){var _=[];if(!d||!d.length)return _;var F=-1,ae=[],Te=d.length;for(f=Fn(f,3);++F<Te;){var ze=d[F];f(ze,F,d)&&(_.push(ze),ae.push(F))}return Qh(d,ae),_},Ee.rest=function(d,f){if("function"!=typeof d)throw new Ma(Se);return pi(d,f=f===ee?f:Jn(f))},Ee.reverse=J_,Ee.sampleSize=function(d,f,_){return f=(_?Ws(d,f,_):f===ee)?1:Jn(f),(Rn(d)?Av:R2)(d,f)},Ee.set=function(d,f,_){return null==d?d:Ip(d,f,_)},Ee.setWith=function(d,f,_,F){return F="function"==typeof F?F:ee,null==d?d:Ip(d,f,_,F)},Ee.shuffle=function(d){return(Rn(d)?Rd:R_)(d)},Ee.slice=function(d,f,_){var F=null==d?0:d.length;return F?(_&&"number"!=typeof _&&Ws(d,f,_)?(f=0,_=F):(f=null==f?0:Jn(f),_=_===ee?F:Jn(_)),Ds(d,f,_)):[]},Ee.sortBy=Yp,Ee.sortedUniq=function(d){return d&&d.length?Pv(d):[]},Ee.sortedUniqBy=function(d,f){return d&&d.length?Pv(d,Fn(f,2)):[]},Ee.split=function(d,f,_){return _&&"number"!=typeof _&&Ws(d,f,_)&&(f=_=ee),(_=_===ee?_e:_>>>0)?(d=Hi(d))&&("string"==typeof f||null!=f&&!jw(f))&&!(f=Lo(f))&&Ph(d)?ll(nl(d),0,_):d.split(f,_):[]},Ee.spread=function(d,f){if("function"!=typeof d)throw new Ma(Se);return f=null==f?0:Hr(Jn(f),0),pi(function(_){var F=_[f],ae=ll(_,0,f);return F&&zr(ae,F),ls(d,this,ae)})},Ee.tail=function(d){var f=null==d?0:d.length;return f?Ds(d,1,f):[]},Ee.take=function(d,f,_){return d&&d.length?Ds(d,0,(f=_||f===ee?1:Jn(f))<0?0:f):[]},Ee.takeRight=function(d,f,_){var F=null==d?0:d.length;return F?Ds(d,(f=F-(f=_||f===ee?1:Jn(f)))<0?0:f,F):[]},Ee.takeRightWhile=function(d,f){return d&&d.length?Cu(d,Fn(f,3),!1,!0):[]},Ee.takeWhile=function(d,f){return d&&d.length?Cu(d,Fn(f,3)):[]},Ee.tap=function(d,f){return f(d),d},Ee.throttle=function(d,f,_){var F=!0,ae=!0;if("function"!=typeof d)throw new Ma(Se);return Tr(_)&&(F="leading"in _?!!_.leading:F,ae="trailing"in _?!!_.trailing:ae),Tw(d,f,{leading:F,maxWait:f,trailing:ae})},Ee.thru=Yd,Ee.toArray=Vw,Ee.toPairs=kT,Ee.toPairsIn=Qw,Ee.toPath=function(d){return Rn(d)?Xi(d,ni):ca(d)?[d]:eo(Jv(Hi(d)))},Ee.toPlainObject=Uw,Ee.transform=function(d,f,_){var F=Rn(d),ae=F||pl(d)||cf(d);if(f=Fn(f,4),null==_){var Te=d&&d.constructor;_=ae?F?new Te:[]:Tr(d)&&la(Te)?vu(Da(d)):{}}return(ae?Us:al)(d,function(ze,qe,ct){return f(_,ze,qe,ct)}),_},Ee.unary=function(d){return Kp(d,1)},Ee.union=cw,Ee.unionBy=YA,Ee.unionWith=KA,Ee.uniq=function(d){return d&&d.length?Oc(d):[]},Ee.uniqBy=function(d,f){return d&&d.length?Oc(d,Fn(f,2)):[]},Ee.uniqWith=function(d,f){return f="function"==typeof f?f:ee,d&&d.length?Oc(d,ee,f):[]},Ee.unset=function(d,f){return null==d||xu(d,f)},Ee.unzip=uw,Ee.unzipWith=QA,Ee.update=function(d,f,_){return null==d?d:Op(d,f,P_(_))},Ee.updateWith=function(d,f,_,F){return F="function"==typeof F?F:ee,null==d?d:Op(d,f,P_(_),F)},Ee.values=th,Ee.valuesIn=function(d){return null==d?[]:a_(d,no(d))},Ee.without=dw,Ee.words=Iy,Ee.wrap=function(d,f){return Xp(P_(f),d)},Ee.xor=z2,Ee.xorBy=jo,Ee.xorWith=ey,Ee.zip=ty,Ee.zipObject=function(d,f){return Rp(d||[],f||[],sl)},Ee.zipObjectDeep=function(d,f){return Rp(d||[],f||[],Ip)},Ee.zipWith=of,Ee.entries=kT,Ee.entriesIn=Qw,Ee.extend=TT,Ee.extendWith=Qd,Py(Ee,Ee),Ee.add=Wn,Ee.attempt=Oy,Ee.camelCase=UT,Ee.capitalize=Ey,Ee.ceil=By,Ee.clamp=function(d,f,_){return _===ee&&(_=f,f=ee),_!==ee&&(_=(_=vo(_))==_?_:0),f!==ee&&(f=(f=vo(f))==f?f:0),wu(vo(d),f,_)},Ee.clone=function(d){return Hs(d,4)},Ee.cloneDeep=function(d){return Hs(d,5)},Ee.cloneDeepWith=function(d,f){return Hs(d,5,f="function"==typeof f?f:ee)},Ee.cloneWith=function(d,f){return Hs(d,4,f="function"==typeof f?f:ee)},Ee.conformsTo=function(d,f){return null==f||Ap(d,f,Os(f))},Ee.deburr=Sy,Ee.defaultTo=function(d,f){return null==d||d!=d?f:d},Ee.divide=ik,Ee.endsWith=function(d,f,_){d=Hi(d),f=Lo(f);var F=d.length,ae=_=_===ee?F:wu(Jn(_),0,F);return(_-=f.length)>=0&&d.slice(_,ae)==f},Ee.eq=In,Ee.escape=function(d){return(d=Hi(d))&&Zt.test(d)?d.replace(Ea,g2):d},Ee.escapeRegExp=function(d){return(d=Hi(d))&&ut.test(d)?d.replace(Le,"\\$&"):d},Ee.every=function(d,f,_){var F=Rn(d)?ti:Mv;return _&&Ws(d,f,_)&&(f=ee),F(d,Fn(f,3))},Ee.find=iT,Ee.findIndex=Y_,Ee.findKey=function(d,f){return Rh(d,Fn(f,3),al)},Ee.findLast=rT,Ee.findLastIndex=K_,Ee.findLastKey=function(d,f){return Rh(d,Fn(f,3),Tp)},Ee.floor=Yl,Ee.forEach=ay,Ee.forEachRight=Wp,Ee.forIn=function(d,f){return null==d?d:Pd(d,Fn(f,3),no)},Ee.forInRight=function(d,f){return null==d?d:Fd(d,Fn(f,3),no)},Ee.forOwn=function(d,f){return d&&al(d,Fn(f,3))},Ee.forOwnRight=function(d,f){return d&&Tp(d,Fn(f,3))},Ee.get=hf,Ee.gt=Jt,Ee.gte=Nw,Ee.has=function(d,f){return null!=d&&Yv(d,f,kd)},Ee.hasIn=eg,Ee.head=tw,Ee.identity=io,Ee.includes=function(d,f,_,F){d=bo(d)?d:th(d),_=_&&!F?Jn(_):0;var ae=d.length;return _<0&&(_=Hr(ae+_,0)),my(d)?_<=ae&&d.indexOf(f,_)>-1:!!ae&&tl(d,f,_)>-1},Ee.indexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=null==_?0:Jn(_);return ae<0&&(ae=Hr(F+ae,0)),tl(d,f,ae)},Ee.inRange=function(d,f,_){return f=gl(f),_===ee?(_=f,f=0):_=gl(_),function(d,f,_){return d>=ms(f,_)&&d<Hr(f,_)}(d=vo(d),f,_)},Ee.invoke=$w,Ee.isArguments=fl,Ee.isArray=Rn,Ee.isArrayBuffer=Pw,Ee.isArrayLike=bo,Ee.isArrayLikeObject=Ar,Ee.isBoolean=function(d){return!0===d||!1===d||Mr(d)&&Ms(d)==Ue},Ee.isBuffer=pl,Ee.isDate=Fw,Ee.isElement=function(d){return Mr(d)&&1===d.nodeType&&!Jp(d)},Ee.isEmpty=function(d){if(null==d)return!0;if(bo(d)&&(Rn(d)||"string"==typeof d||"function"==typeof d.splice||pl(d)||cf(d)||fl(d)))return!d.length;var f=$s(d);if(f==Ne||f==pt)return!d.size;if(zp(d))return!Ov(d).length;for(var _ in d)if(Zi.call(d,_))return!1;return!0},Ee.isEqual=function(d,f){return Mp(d,f)},Ee.isEqualWith=function(d,f,_){var F=(_="function"==typeof _?_:ee)?_(d,f):ee;return F===ee?Mp(d,f,ee,_):!!F},Ee.isError=ka,Ee.isFinite=function(d){return"number"==typeof d&&g_(d)},Ee.isFunction=la,Ee.isInteger=Zp,Ee.isLength=py,Ee.isMap=wT,Ee.isMatch=function(d,f){return d===f||M_(d,f,ia(f))},Ee.isMatchWith=function(d,f,_){return _="function"==typeof _?_:ee,M_(d,f,ia(f),_)},Ee.isNaN=function(d){return xT(d)&&d!=+d},Ee.isNative=function(d){if(Qv(d))throw new Dn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return D_(d)},Ee.isNil=function(d){return null==d},Ee.isNull=function(d){return null===d},Ee.isNumber=xT,Ee.isObject=Tr,Ee.isObjectLike=Mr,Ee.isPlainObject=Jp,Ee.isRegExp=jw,Ee.isSafeInteger=function(d){return Zp(d)&&d>=-Ce&&d<=Ce},Ee.isSet=CT,Ee.isString=my,Ee.isSymbol=ca,Ee.isTypedArray=cf,Ee.isUndefined=function(d){return d===ee},Ee.isWeakMap=function(d){return Mr(d)&&$s(d)==B},Ee.isWeakSet=function(d){return Mr(d)&&"[object WeakSet]"==Ms(d)},Ee.join=function(d,f){return null==d?"":jh.call(d,f)},Ee.kebabCase=HT,Ee.last=sa,Ee.lastIndexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=F;return _!==ee&&(ae=(ae=Jn(_))<0?Hr(F+ae,0):ms(ae,F-1)),f==f?function(at,It,Et){for(var un=Et+1;un--;)if(at[un]===It)return un;return un}(d,f,ae):Cd(d,Cc,ae,!0)},Ee.lowerCase=GT,Ee.lowerFirst=J2,Ee.lt=Lc,Ee.lte=_y,Ee.max=function(d){return d&&d.length?Yh(d,io,Fo):ee},Ee.maxBy=function(d,f){return d&&d.length?Yh(d,Fn(f,2),Fo):ee},Ee.mean=function(d){return Cs(d,io)},Ee.meanBy=function(d,f){return Cs(d,Fn(f,2))},Ee.min=function(d){return d&&d.length?Yh(d,io,Rv):ee},Ee.minBy=function(d,f){return d&&d.length?Yh(d,Fn(f,2),Rv):ee},Ee.stubArray=jc,Ee.stubFalse=Ly,Ee.stubObject=function(){return{}},Ee.stubString=function(){return""},Ee.stubTrue=function(){return!0},Ee.multiply=dE,Ee.nth=function(d,f){return d&&d.length?Su(d,Jn(f)):ee},Ee.noConflict=function(){return Ui._===this&&(Ui._=f_),this},Ee.noop=Fy,Ee.now=Ru,Ee.pad=function(d,f,_){d=Hi(d);var F=(f=Jn(f))?Fh(d):0;if(!f||F>=f)return d;var ae=(f-F)/2;return kp(Ei(ae),_)+d+kp(jt(ae),_)},Ee.padEnd=function(d,f,_){d=Hi(d);var F=(f=Jn(f))?Fh(d):0;return f&&F<f?d+kp(f-F,_):d},Ee.padStart=function(d,f,_){d=Hi(d);var F=(f=Jn(f))?Fh(d):0;return f&&F<f?kp(f-F,_)+d:d},Ee.parseInt=function(d,f,_){return _||null==f?f=0:f&&(f=+f),Y1(Hi(d).replace(Ze,""),f||0)},Ee.random=function(d,f,_){if(_&&"boolean"!=typeof _&&Ws(d,f,_)&&(f=_=ee),_===ee&&("boolean"==typeof f?(_=f,f=ee):"boolean"==typeof d&&(_=d,d=ee)),d===ee&&f===ee?(d=0,f=1):(d=gl(d),f===ee?(f=d,d=0):f=gl(f)),d>f){var F=d;d=f,f=F}if(_||d%1||f%1){var ae=Vh();return ms(d+ae*(f-d+k1("1e-"+((ae+"").length-1))),f)}return Ul(d,f)},Ee.reduce=function(d,f,_){var F=Rn(d)?mu:Zo,ae=arguments.length<3;return F(d,Fn(f,4),_,ae,Dc)},Ee.reduceRight=function(d,f,_){var F=Rn(d)?xd:Zo,ae=arguments.length<3;return F(d,Fn(f,4),_,ae,A_)},Ee.repeat=function(d,f,_){return f=(_?Ws(d,f,_):f===ee)?1:Jn(f),Dp(Hi(d),f)},Ee.replace=function(){var d=arguments,f=Hi(d[0]);return d.length<3?f:f.replace(d[1],d[2])},Ee.result=function(d,f,_){var F=-1,ae=(f=Nc(f,d)).length;for(ae||(ae=1,d=ee);++F<ae;){var Te=null==d?ee:d[ni(f[F])];Te===ee&&(F=ae,Te=_),d=la(Te)?Te.call(d):Te}return d},Ee.round=hE,Ee.runInContext=at,Ee.sample=function(d){return(Rn(d)?E_:hA)(d)},Ee.size=function(d){if(null==d)return 0;if(bo(d))return my(d)?Fh(d):d.length;var f=$s(d);return f==Ne||f==pt?d.size:Ov(d).length},Ee.snakeCase=XT,Ee.some=function(d,f,_){var F=Rn(d)?Ro:N2;return _&&Ws(d,f,_)&&(f=ee),F(d,Fn(f,3))},Ee.sortedIndex=function(d,f){return Zh(d,f)},Ee.sortedIndexBy=function(d,f,_){return N_(d,f,Fn(_,2))},Ee.sortedIndexOf=function(d,f){var _=null==d?0:d.length;if(_){var F=Zh(d,f);if(F<_&&In(d[F],f))return F}return-1},Ee.sortedLastIndex=function(d,f){return Zh(d,f,!0)},Ee.sortedLastIndexBy=function(d,f,_){return N_(d,f,Fn(_,2),!0)},Ee.sortedLastIndexOf=function(d,f){if(null!=d&&d.length){var F=Zh(d,f,!0)-1;if(In(d[F],f))return F}return-1},Ee.startCase=Ay,Ee.startsWith=function(d,f,_){return d=Hi(d),_=null==_?0:wu(Jn(_),0,d.length),f=Lo(f),d.slice(_,_+f.length)==f},Ee.subtract=fE,Ee.sum=function(d){return d&&d.length?Ad(d,io):0},Ee.sumBy=function(d,f){return d&&d.length?Ad(d,Fn(f,2)):0},Ee.template=function(d,f,_){var F=Ee.templateSettings;_&&Ws(d,f,_)&&(f=ee),d=Hi(d),f=Qd({},f,F,Hv);var qe,ct,ae=Qd({},f.imports,F.imports,Hv),Te=Os(ae),ze=a_(ae,Te),Pt=0,Ft=f.interpolate||Qr,zt="__p += '",en=d_((f.escape||Qr).source+"|"+Ft.source+"|"+(Ft===lt?_n:Qr).source+"|"+(f.evaluate||Qr).source+"|$","g"),bn="//# sourceURL="+(Zi.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++F1+"]")+"\n";d.replace(en,function(jn,mi,Mi,wo,qs,ua){return Mi||(Mi=wo),zt+=d.slice(Pt,ua).replace(ie,m2),mi&&(qe=!0,zt+="' +\n__e("+mi+") +\n'"),qs&&(ct=!0,zt+="';\n"+qs+";\n__p += '"),Mi&&(zt+="' +\n((__t = ("+Mi+")) == null ? '' : __t) +\n'"),Pt=ua+jn.length,jn}),zt+="';\n";var Ln=Zi.call(f,"variable")&&f.variable;if(Ln){if(ai.test(Ln))throw new Dn("Invalid `variable` option passed into `_.template`")}else zt="with (obj) {\n"+zt+"\n}\n";zt=(ct?zt.replace(Bs,""):zt).replace(Xr,"$1").replace(Ja,"$1;"),zt="function("+(Ln||"obj")+") {\n"+(Ln?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(qe?", __e = _.escape":"")+(ct?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+zt+"return __p\n}";var gi=Oy(function(){return Bi(Te,bn+"return "+zt).apply(ee,ze)});if(gi.source=zt,ka(gi))throw gi;return gi},Ee.times=function(d,f){if((d=Jn(d))<1||d>Ce)return[];var _=_e,F=ms(d,_e);f=Fn(f),d-=_e;for(var ae=Td(F,f);++_<d;)f(_);return ae},Ee.toFinite=gl,Ee.toInteger=Jn,Ee.toLength=yy,Ee.toLower=function(d){return Hi(d).toLowerCase()},Ee.toNumber=vo,Ee.toSafeInteger=function(d){return d?wu(Jn(d),-Ce,Ce):0===d?d:0},Ee.toString=Hi,Ee.toUpper=function(d){return Hi(d).toUpperCase()},Ee.trim=function(d,f,_){if((d=Hi(d))&&(_||f===ee))return mv(d);if(!d||!(f=Lo(f)))return d;var F=nl(d),ae=nl(f);return ll(F,j1(F,ae),V1(F,ae)+1).join("")},Ee.trimEnd=function(d,f,_){if((d=Hi(d))&&(_||f===ee))return d.slice(0,Ac(d)+1);if(!d||!(f=Lo(f)))return d;var F=nl(d);return ll(F,0,V1(F,nl(f))+1).join("")},Ee.trimStart=function(d,f,_){if((d=Hi(d))&&(_||f===ee))return d.replace(Ze,"");if(!d||!(f=Lo(f)))return d;var F=nl(d);return ll(F,j1(F,nl(f))).join("")},Ee.truncate=function(d,f){var _=30,F="...";if(Tr(f)){var ae="separator"in f?f.separator:ae;_="length"in f?Jn(f.length):_,F="omission"in f?Lo(f.omission):F}var Te=(d=Hi(d)).length;if(Ph(d)){var ze=nl(d);Te=ze.length}if(_>=Te)return d;var qe=_-Fh(F);if(qe<1)return F;var ct=ze?ll(ze,0,qe).join(""):d.slice(0,qe);if(ae===ee)return ct+F;if(ze&&(qe+=ct.length-qe),jw(ae)){if(d.slice(qe).search(ae)){var Pt,Ft=ct;for(ae.global||(ae=d_(ae.source,Hi($n.exec(ae))+"g")),ae.lastIndex=0;Pt=ae.exec(Ft);)var zt=Pt.index;ct=ct.slice(0,zt===ee?qe:zt)}}else if(d.indexOf(Lo(ae),qe)!=qe){var en=ct.lastIndexOf(ae);en>-1&&(ct=ct.slice(0,en))}return ct+F},Ee.unescape=function(d){return(d=Hi(d))&&Es.test(d)?d.replace(Nl,u_):d},Ee.uniqueId=function(d){var f=++E2;return Hi(d)+f},Ee.upperCase=iE,Ee.upperFirst=ig,Ee.each=ay,Ee.eachRight=Wp,Ee.first=tw,Py(Ee,function(){var d={};return al(Ee,function(f,_){Zi.call(Ee.prototype,_)||(d[_]=f)}),d}(),{chain:!1}),Ee.VERSION="4.17.21",Us(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){Ee[d].placeholder=Ee}),Us(["drop","take"],function(d,f){fi.prototype[d]=function(_){_=_===ee?1:Hr(Jn(_),0);var F=this.__filtered__&&!f?new fi(this):this.clone();return F.__filtered__?F.__takeCount__=ms(_,F.__takeCount__):F.__views__.push({size:ms(_,_e),type:d+(F.__dir__<0?"Right":"")}),F},fi.prototype[d+"Right"]=function(_){return this.reverse()[d](_).reverse()}}),Us(["filter","map","takeWhile"],function(d,f){var _=f+1,F=1==_||3==_;fi.prototype[d]=function(ae){var Te=this.clone();return Te.__iteratees__.push({iteratee:Fn(ae,3),type:_}),Te.__filtered__=Te.__filtered__||F,Te}}),Us(["head","last"],function(d,f){var _="take"+(f?"Right":"");fi.prototype[d]=function(){return this[_](1).value()[0]}}),Us(["initial","tail"],function(d,f){var _="drop"+(f?"":"Right");fi.prototype[d]=function(){return this.__filtered__?new fi(this):this[_](1)}}),fi.prototype.compact=function(){return this.filter(io)},fi.prototype.find=function(d){return this.filter(d).head()},fi.prototype.findLast=function(d){return this.reverse().find(d)},fi.prototype.invokeMap=pi(function(d,f){return"function"==typeof d?new fi(this):this.map(function(_){return Na(_,d,f)})}),fi.prototype.reject=function(d){return this.filter(hy(Fn(d)))},fi.prototype.slice=function(d,f){d=Jn(d);var _=this;return _.__filtered__&&(d>0||f<0)?new fi(_):(d<0?_=_.takeRight(-d):d&&(_=_.drop(d)),f!==ee&&(_=(f=Jn(f))<0?_.dropRight(-f):_.take(f-d)),_)},fi.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},fi.prototype.toArray=function(){return this.take(_e)},al(fi.prototype,function(d,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),F=/^(?:head|last)$/.test(f),ae=Ee[F?"take"+("last"==f?"Right":""):f],Te=F||/^find/.test(f);!ae||(Ee.prototype[f]=function(){var ze=this.__wrapped__,qe=F?[1]:arguments,ct=ze instanceof fi,Pt=qe[0],Ft=ct||Rn(ze),zt=function(mi){var Mi=ae.apply(Ee,zr([mi],qe));return F&&en?Mi[0]:Mi};Ft&&_&&"function"==typeof Pt&&1!=Pt.length&&(ct=Ft=!1);var en=this.__chain__,bn=!!this.__actions__.length,Ln=Te&&!en,gi=ct&&!bn;if(!Te&&Ft){ze=gi?ze:new fi(this);var jn=d.apply(ze,qe);return jn.__actions__.push({func:Yd,args:[zt],thisArg:ee}),new Po(jn,en)}return Ln&&gi?d.apply(this,qe):(jn=this.thru(zt),Ln?F?jn.value()[0]:jn.value():jn)})}),Us(["pop","push","shift","sort","splice","unshift"],function(d){var f=pr[d],_=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",F=/^(?:pop|shift)$/.test(d);Ee.prototype[d]=function(){var ae=arguments;if(F&&!this.__chain__){var Te=this.value();return f.apply(Rn(Te)?Te:[],ae)}return this[_](function(ze){return f.apply(Rn(ze)?ze:[],ae)})}}),al(fi.prototype,function(d,f){var _=Ee[f];if(_){var F=_.name+"";Zi.call(Id,F)||(Id[F]=[]),Id[F].push({name:f,func:_})}}),Id[Fc(ee,2).name]=[{name:"wrapper",func:ee}],fi.prototype.clone=function(){var d=new fi(this.__wrapped__);return d.__actions__=eo(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=eo(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=eo(this.__views__),d},fi.prototype.reverse=function(){if(this.__filtered__){var d=new fi(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},fi.prototype.value=function(){var d=this.__wrapped__.value(),f=this.__dir__,_=Rn(d),F=f<0,ae=_?d.length:0,Te=function(d,f,_){for(var F=-1,ae=_.length;++F<ae;){var Te=_[F],ze=Te.size;switch(Te.type){case"drop":d+=ze;break;case"dropRight":f-=ze;break;case"take":f=ms(f,d+ze);break;case"takeRight":d=Hr(d,f-ze)}}return{start:d,end:f}}(0,ae,this.__views__),ze=Te.start,qe=Te.end,ct=qe-ze,Pt=F?qe:ze-1,Ft=this.__iteratees__,zt=Ft.length,en=0,bn=ms(ct,this.__takeCount__);if(!_||!F&&ae==ct&&bn==ct)return fA(d,this.__actions__);var Ln=[];e:for(;ct--&&en<bn;){for(var gi=-1,jn=d[Pt+=f];++gi<zt;){var mi=Ft[gi],wo=mi.type,qs=(0,mi.iteratee)(jn);if(2==wo)jn=qs;else if(!qs){if(1==wo)continue e;break e}}Ln[en++]=jn}return Ln},Ee.prototype.at=iy,Ee.prototype.chain=function(){return ny(this)},Ee.prototype.commit=function(){return new Po(this.value(),this.__chain__)},Ee.prototype.next=function(){this.__values__===ee&&(this.__values__=Vw(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?ee:this.__values__[this.__index__++]}},Ee.prototype.plant=function(d){for(var f,_=this;_ instanceof Gh;){var F=nf(_);F.__index__=0,F.__values__=ee,f?ae.__wrapped__=F:f=F;var ae=F;_=_.__wrapped__}return ae.__wrapped__=d,f},Ee.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof fi){var f=d;return this.__actions__.length&&(f=new fi(this)),(f=f.reverse()).__actions__.push({func:Yd,args:[J_],thisArg:ee}),new Po(f,this.__chain__)}return this.thru(J_)},Ee.prototype.toJSON=Ee.prototype.valueOf=Ee.prototype.value=function(){return fA(this.__wrapped__,this.__actions__)},Ee.prototype.first=Ee.prototype.head,Bh&&(Ee.prototype[Bh]=function(){return this}),Ee}();Ui._=kh,(yt=function(){return kh}.call(it,Je,it,Ut))!==ee&&(Ut.exports=yt)}.call(this)},478:function(Ut){Ut.exports=function(){"use strict";function it(rt,lt){for(var ht=0;ht<lt.length;ht++){var ge=lt[ht];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(rt,ge.key,ge)}}function ee(rt,lt){(null==lt||lt>rt.length)&&(lt=rt.length);for(var ht=0,ge=new Array(lt);ht<lt;ht++)ge[ht]=rt[ht];return ge}function Tt(rt,lt){var ht="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ht)return(ht=ht.call(rt)).next.bind(ht);if(Array.isArray(rt)||(ht=function(rt,lt){if(rt){if("string"==typeof rt)return ee(rt,lt);var ht=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ht&&rt.constructor&&(ht=rt.constructor.name),"Map"===ht||"Set"===ht)return Array.from(rt);if("Arguments"===ht||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ht))return ee(rt,lt)}}(rt))||lt&&rt&&"number"==typeof rt.length){ht&&(rt=ht);var ge=0;return function(){return ge>=rt.length?{done:!0}:{done:!1,value:rt[ge++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function Y(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:Y,changeDefaults:function(rt){dt.exports.defaults=rt}};var he=/[&<>"']/,W=/[&<>"']/g,j=/[<>"']|&(?!#?\w+;)/,P=/[<>"']|&(?!#?\w+;)/g,Q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z=function(lt){return Q[lt]};var x=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function O(rt){return rt.replace(x,function(lt,ht){return"colon"===(ht=ht.toLowerCase())?":":"#"===ht.charAt(0)?"x"===ht.charAt(1)?String.fromCharCode(parseInt(ht.substring(2),16)):String.fromCharCode(+ht.substring(1)):""})}var A=/(^|[^\[])\^/g;var y=/[^\w:]/g,S=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var V={},R=/^[^:]+:\/*[^/]*$/,K=/^([^:]+:)[\s\S]*$/,ce=/^([^:]+:\/*[^/]*)[\s\S]*$/;function D(rt,lt){V[" "+rt]||(V[" "+rt]=R.test(rt)?rt+"/":$(rt,"/",!0));var ht=-1===(rt=V[" "+rt]).indexOf(":");return"//"===lt.substring(0,2)?ht?lt:rt.replace(K,"$1")+lt:"/"===lt.charAt(0)?ht?lt:rt.replace(ce,"$1")+lt:rt+lt}function $(rt,lt,ht){var ge=rt.length;if(0===ge)return"";for(var be=0;be<ge;){var Le=rt.charAt(ge-be-1);if(Le!==lt||ht){if(Le===lt||!ht)break;be++}else be++}return rt.substr(0,ge-be)}var te_escape=function(rt,lt){if(lt){if(he.test(rt))return rt.replace(W,z)}else if(j.test(rt))return rt.replace(P,z);return rt},te_unescape=O,te_edit=function(rt,lt){rt=rt.source||rt,lt=lt||"";var ht={replace:function(be,Le){return Le=(Le=Le.source||Le).replace(A,"$1"),rt=rt.replace(be,Le),ht},getRegex:function(){return new RegExp(rt,lt)}};return ht},te_cleanUrl=function(rt,lt,ht){if(rt){var ge;try{ge=decodeURIComponent(O(ht)).replace(y,"").toLowerCase()}catch(be){return null}if(0===ge.indexOf("javascript:")||0===ge.indexOf("vbscript:")||0===ge.indexOf("data:"))return null}lt&&!S.test(ht)&&(ht=D(lt,ht));try{ht=encodeURI(ht).replace(/%25/g,"%")}catch(be){return null}return ht},te_noopTest={exec:function(){}},te_merge=function(rt){for(var ht,ge,lt=1;lt<arguments.length;lt++)for(ge in ht=arguments[lt])Object.prototype.hasOwnProperty.call(ht,ge)&&(rt[ge]=ht[ge]);return rt},te_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},te_repeatString=function(rt,lt){if(lt<1)return"";for(var ht="";lt>1;)1&lt&&(ht+=rt),lt>>=1,rt+=rt;return ht+rt},Ce=dt.exports.defaults,me=$,ne=function(rt,lt){var ge=rt.replace(/\|/g,function(Le,ut,Ze){for(var At=!1,Mt=ut;--Mt>=0&&"\\"===Ze[Mt];)At=!At;return At?"|":" |"}).split(/ \|/),be=0;if(ge.length>lt)ge.splice(lt);else for(;ge.length<lt;)ge.push("");for(;be<ge.length;be++)ge[be]=ge[be].trim().replace(/\\\|/g,"|");return ge},_e=te_escape,Ie=function(rt,lt){if(-1===rt.indexOf(lt[1]))return-1;for(var ht=rt.length,ge=0,be=0;be<ht;be++)if("\\"===rt[be])be++;else if(rt[be]===lt[0])ge++;else if(rt[be]===lt[1]&&--ge<0)return be;return-1};function Ge(rt,lt,ht){var ge=lt.href,be=lt.title?_e(lt.title):null,Le=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ht,href:ge,title:be,text:Le}:{type:"image",raw:ht,href:ge,title:be,text:_e(Le)}}var Xe=function(){function rt(ht){this.options=ht||Ce}var lt=rt.prototype;return lt.space=function(ge){var be=this.rules.block.newline.exec(ge);if(be)return be[0].length>1?{type:"space",raw:be[0]}:{raw:"\n"}},lt.code=function(ge){var be=this.rules.block.code.exec(ge);if(be){var Le=be[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:be[0],codeBlockStyle:"indented",text:this.options.pedantic?Le:me(Le,"\n")}}},lt.fences=function(ge){var be=this.rules.block.fences.exec(ge);if(be){var Le=be[0],ut=function(rt,lt){var ht=rt.match(/^(\s+)(?:```)/);if(null===ht)return lt;var ge=ht[1];return lt.split("\n").map(function(be){var Le=be.match(/^\s+/);return null===Le?be:Le[0].length>=ge.length?be.slice(ge.length):be}).join("\n")}(Le,be[3]||"");return{type:"code",raw:Le,lang:be[2]?be[2].trim():be[2],text:ut}}},lt.heading=function(ge){var be=this.rules.block.heading.exec(ge);if(be){var Le=be[2].trim();if(/#$/.test(Le)){var ut=me(Le,"#");(this.options.pedantic||!ut||/ $/.test(ut))&&(Le=ut.trim())}return{type:"heading",raw:be[0],depth:be[1].length,text:Le}}},lt.nptable=function(ge){var be=this.rules.block.nptable.exec(ge);if(be){var Le={type:"table",header:ne(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[],raw:be[0]};if(Le.header.length===Le.align.length){var Ze,ut=Le.align.length;for(Ze=0;Ze<ut;Ze++)Le.align[Ze]=/^ *-+: *$/.test(Le.align[Ze])?"right":/^ *:-+: *$/.test(Le.align[Ze])?"center":/^ *:-+ *$/.test(Le.align[Ze])?"left":null;for(ut=Le.cells.length,Ze=0;Ze<ut;Ze++)Le.cells[Ze]=ne(Le.cells[Ze],Le.header.length);return Le}}},lt.hr=function(ge){var be=this.rules.block.hr.exec(ge);if(be)return{type:"hr",raw:be[0]}},lt.blockquote=function(ge){var be=this.rules.block.blockquote.exec(ge);if(be){var Le=be[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:be[0],text:Le}}},lt.list=function(ge){var be=this.rules.block.list.exec(ge);if(be){var Xt,zn,ai,Nn,_n,$n,Cn,lr,cr,Le=be[0],ut=be[2],Ze=ut.length>1,At={type:"list",raw:Le,ordered:Ze,start:Ze?+ut.slice(0,-1):"",loose:!1,items:[]},Mt=be[0].match(this.rules.block.item),Dt=!1,Xn=Mt.length;ai=this.rules.block.listItemStart.exec(Mt[0]);for(var qi=0;qi<Xn;qi++){if(Le=Xt=Mt[qi],this.options.pedantic||(cr=Xt.match(new RegExp("\\n\\s*\\n {0,"+(ai[0].length-1)+"}\\S")))&&(_n=Xt.length-cr.index+Mt.slice(qi+1).join("\n").length,At.raw=At.raw.substring(0,At.raw.length-_n),Le=Xt=Xt.substring(0,cr.index),Xn=qi+1),qi!==Xn-1){if(Nn=this.rules.block.listItemStart.exec(Mt[qi+1]),this.options.pedantic?Nn[1].length>ai[1].length:Nn[1].length>=ai[0].length||Nn[1].length>3){Mt.splice(qi,2,Mt[qi]+(!this.options.pedantic&&Nn[1].length<ai[0].length&&!Mt[qi].match(/\n$/)?"":"\n")+Mt[qi+1]),qi--,Xn--;continue}(!this.options.pedantic||this.options.smartLists?Nn[2][Nn[2].length-1]!==ut[ut.length-1]:Ze===(1===Nn[2].length))&&(_n=Mt.slice(qi+1).join("\n").length,At.raw=At.raw.substring(0,At.raw.length-_n),qi=Xn-1),ai=Nn}zn=Xt.length,~(Xt=Xt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(zn-=Xt.length,Xt=Xt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+zn+"}","gm"),"")),Xt=me(Xt,"\n"),qi!==Xn-1&&(Le+="\n"),$n=Dt||/\n\n(?!\s*$)/.test(Le),qi!==Xn-1&&(Dt="\n\n"===Le.slice(-2),$n||($n=Dt)),$n&&(At.loose=!0),this.options.gfm&&(lr=void 0,(Cn=/^\[[ xX]\] /.test(Xt))&&(lr=" "!==Xt[1],Xt=Xt.replace(/^\[[ xX]\] +/,""))),At.items.push({type:"list_item",raw:Le,task:Cn,checked:lr,loose:$n,text:Xt})}return At}},lt.html=function(ge){var be=this.rules.block.html.exec(ge);if(be)return{type:this.options.sanitize?"paragraph":"html",raw:be[0],pre:!this.options.sanitizer&&("pre"===be[1]||"script"===be[1]||"style"===be[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(be[0]):_e(be[0]):be[0]}},lt.def=function(ge){var be=this.rules.block.def.exec(ge);if(be)return be[3]&&(be[3]=be[3].substring(1,be[3].length-1)),{type:"def",tag:be[1].toLowerCase().replace(/\s+/g," "),raw:be[0],href:be[2],title:be[3]}},lt.table=function(ge){var be=this.rules.block.table.exec(ge);if(be){var Le={type:"table",header:ne(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[]};if(Le.header.length===Le.align.length){Le.raw=be[0];var Ze,ut=Le.align.length;for(Ze=0;Ze<ut;Ze++)Le.align[Ze]=/^ *-+: *$/.test(Le.align[Ze])?"right":/^ *:-+: *$/.test(Le.align[Ze])?"center":/^ *:-+ *$/.test(Le.align[Ze])?"left":null;for(ut=Le.cells.length,Ze=0;Ze<ut;Ze++)Le.cells[Ze]=ne(Le.cells[Ze].replace(/^ *\| *| *\| *$/g,""),Le.header.length);return Le}}},lt.lheading=function(ge){var be=this.rules.block.lheading.exec(ge);if(be)return{type:"heading",raw:be[0],depth:"="===be[2].charAt(0)?1:2,text:be[1]}},lt.paragraph=function(ge){var be=this.rules.block.paragraph.exec(ge);if(be)return{type:"paragraph",raw:be[0],text:"\n"===be[1].charAt(be[1].length-1)?be[1].slice(0,-1):be[1]}},lt.text=function(ge){var be=this.rules.block.text.exec(ge);if(be)return{type:"text",raw:be[0],text:be[0]}},lt.escape=function(ge){var be=this.rules.inline.escape.exec(ge);if(be)return{type:"escape",raw:be[0],text:_e(be[1])}},lt.tag=function(ge,be,Le){var ut=this.rules.inline.tag.exec(ge);if(ut)return!be&&/^<a /i.test(ut[0])?be=!0:be&&/^<\/a>/i.test(ut[0])&&(be=!1),!Le&&/^<(pre|code|kbd|script)(\s|>)/i.test(ut[0])?Le=!0:Le&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ut[0])&&(Le=!1),{type:this.options.sanitize?"text":"html",raw:ut[0],inLink:be,inRawBlock:Le,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):_e(ut[0]):ut[0]}},lt.link=function(ge){var be=this.rules.inline.link.exec(ge);if(be){var Le=be[2].trim();if(!this.options.pedantic&&/^</.test(Le)){if(!/>$/.test(Le))return;var ut=me(Le.slice(0,-1),"\\");if((Le.length-ut.length)%2==0)return}else{var Ze=Ie(be[2],"()");if(Ze>-1){var Mt=(0===be[0].indexOf("!")?5:4)+be[1].length+Ze;be[2]=be[2].substring(0,Ze),be[0]=be[0].substring(0,Mt).trim(),be[3]=""}}var Dt=be[2],Xt="";if(this.options.pedantic){var zn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Dt);zn&&(Dt=zn[1],Xt=zn[3])}else Xt=be[3]?be[3].slice(1,-1):"";return Dt=Dt.trim(),/^</.test(Dt)&&(Dt=this.options.pedantic&&!/>$/.test(Le)?Dt.slice(1):Dt.slice(1,-1)),Ge(be,{href:Dt&&Dt.replace(this.rules.inline._escapes,"$1"),title:Xt&&Xt.replace(this.rules.inline._escapes,"$1")},be[0])}},lt.reflink=function(ge,be){var Le;if((Le=this.rules.inline.reflink.exec(ge))||(Le=this.rules.inline.nolink.exec(ge))){var ut=(Le[2]||Le[1]).replace(/\s+/g," ");if(!(ut=be[ut.toLowerCase()])||!ut.href){var Ze=Le[0].charAt(0);return{type:"text",raw:Ze,text:Ze}}return Ge(Le,ut,Le[0])}},lt.emStrong=function(ge,be,Le){void 0===Le&&(Le="");var ut=this.rules.inline.emStrong.lDelim.exec(ge);if(ut&&(!ut[3]||!Le.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Ze=ut[1]||ut[2]||"";if(!Ze||Ze&&(""===Le||this.rules.inline.punctuation.exec(Le))){var Mt,Dt,At=ut[0].length-1,Xt=At,zn=0,ai="*"===ut[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ai.lastIndex=0,be=be.slice(-1*ge.length+At);null!=(ut=ai.exec(be));)if(Mt=ut[1]||ut[2]||ut[3]||ut[4]||ut[5]||ut[6]){if(Dt=Mt.length,ut[3]||ut[4]){Xt+=Dt;continue}if((ut[5]||ut[6])&&At%3&&!((At+Dt)%3)){zn+=Dt;continue}if(!((Xt-=Dt)>0))return Dt=Math.min(Dt,Dt+Xt+zn),Math.min(At,Dt)%2?{type:"em",raw:ge.slice(0,At+ut.index+Dt+1),text:ge.slice(1,At+ut.index+Dt)}:{type:"strong",raw:ge.slice(0,At+ut.index+Dt+1),text:ge.slice(2,At+ut.index+Dt-1)}}}}},lt.codespan=function(ge){var be=this.rules.inline.code.exec(ge);if(be){var Le=be[2].replace(/\n/g," "),ut=/[^ ]/.test(Le),Ze=/^ /.test(Le)&&/ $/.test(Le);return ut&&Ze&&(Le=Le.substring(1,Le.length-1)),Le=_e(Le,!0),{type:"codespan",raw:be[0],text:Le}}},lt.br=function(ge){var be=this.rules.inline.br.exec(ge);if(be)return{type:"br",raw:be[0]}},lt.del=function(ge){var be=this.rules.inline.del.exec(ge);if(be)return{type:"del",raw:be[0],text:be[2]}},lt.autolink=function(ge,be){var ut,Ze,Le=this.rules.inline.autolink.exec(ge);if(Le)return Ze="@"===Le[2]?"mailto:"+(ut=_e(this.options.mangle?be(Le[1]):Le[1])):ut=_e(Le[1]),{type:"link",raw:Le[0],text:ut,href:Ze,tokens:[{type:"text",raw:ut,text:ut}]}},lt.url=function(ge,be){var Le;if(Le=this.rules.inline.url.exec(ge)){var ut,Ze;if("@"===Le[2])Ze="mailto:"+(ut=_e(this.options.mangle?be(Le[0]):Le[0]));else{var At;do{At=Le[0],Le[0]=this.rules.inline._backpedal.exec(Le[0])[0]}while(At!==Le[0]);ut=_e(Le[0]),Ze="www."===Le[1]?"http://"+ut:ut}return{type:"link",raw:Le[0],text:ut,href:Ze,tokens:[{type:"text",raw:ut,text:ut}]}}},lt.inlineText=function(ge,be,Le){var Ze,ut=this.rules.inline.text.exec(ge);if(ut)return Ze=be?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):_e(ut[0]):ut[0]:_e(this.options.smartypants?Le(ut[0]):ut[0]),{type:"text",raw:ut[0],text:Ze}},rt}(),tt=te_noopTest,Ye=te_edit,Ue=te_merge,ke={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:tt,table:tt,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};ke.def=Ye(ke.def).replace("label",ke._label).replace("title",ke._title).getRegex(),ke.bullet=/(?:[*+-]|\d{1,9}[.)])/,ke.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,ke.item=Ye(ke.item,"gm").replace(/bull/g,ke.bullet).getRegex(),ke.listItemStart=Ye(/^( *)(bull) */).replace("bull",ke.bullet).getRegex(),ke.list=Ye(ke.list).replace(/bull/g,ke.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ke.def.source+")").getRegex(),ke._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ke._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,ke.html=Ye(ke.html,"i").replace("comment",ke._comment).replace("tag",ke._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ke.paragraph=Ye(ke._paragraph).replace("hr",ke.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ke._tag).getRegex(),ke.blockquote=Ye(ke.blockquote).replace("paragraph",ke.paragraph).getRegex(),ke.normal=Ue({},ke),ke.gfm=Ue({},ke.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),ke.gfm.nptable=Ye(ke.gfm.nptable).replace("hr",ke.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ke._tag).getRegex(),ke.gfm.table=Ye(ke.gfm.table).replace("hr",ke.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ke._tag).getRegex(),ke.pedantic=Ue({},ke.normal,{html:Ye("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",ke._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tt,paragraph:Ye(ke.normal._paragraph).replace("hr",ke.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",ke.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ke={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:tt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:tt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ke.punctuation=Ye(Ke.punctuation).replace(/punctuation/g,Ke._punctuation).getRegex(),Ke.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ke.escapedEmSt=/\\\*|\\_/g,Ke._comment=Ye(ke._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ke.emStrong.lDelim=Ye(Ke.emStrong.lDelim).replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimAst=Ye(Ke.emStrong.rDelimAst,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimUnd=Ye(Ke.emStrong.rDelimUnd,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ke._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ke._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ke.autolink=Ye(Ke.autolink).replace("scheme",Ke._scheme).replace("email",Ke._email).getRegex(),Ke._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ke.tag=Ye(Ke.tag).replace("comment",Ke._comment).replace("attribute",Ke._attribute).getRegex(),Ke._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ke._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ke._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ke.link=Ye(Ke.link).replace("label",Ke._label).replace("href",Ke._href).replace("title",Ke._title).getRegex(),Ke.reflink=Ye(Ke.reflink).replace("label",Ke._label).getRegex(),Ke.reflinkSearch=Ye(Ke.reflinkSearch,"g").replace("reflink",Ke.reflink).replace("nolink",Ke.nolink).getRegex(),Ke.normal=Ue({},Ke),Ke.pedantic=Ue({},Ke.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ye(/^!?\[(label)\]\((.*?)\)/).replace("label",Ke._label).getRegex(),reflink:Ye(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ke._label).getRegex()}),Ke.gfm=Ue({},Ke.normal,{escape:Ye(Ke.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ke.gfm.url=Ye(Ke.gfm.url,"i").replace("email",Ke.gfm._extended_email).getRegex(),Ke.breaks=Ue({},Ke.gfm,{br:Ye(Ke.br).replace("{2,}","*").getRegex(),text:Ye(Ke.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Me={block:ke,inline:Ke},Ve=Xe,$e=dt.exports.defaults,Ne=Me.block,q=Me.inline,G=te_repeatString;function pe(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function ue(rt){var ht,ge,lt="",be=rt.length;for(ht=0;ht<be;ht++)ge=rt.charCodeAt(ht),Math.random()>.5&&(ge="x"+ge.toString(16)),lt+="&#"+ge+";";return lt}var je=function(){function rt(ht){this.tokens=[],this.tokens.links=Object.create(null),this.options=ht||$e,this.options.tokenizer=this.options.tokenizer||new Ve,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var ge={block:Ne.normal,inline:q.normal};this.options.pedantic?(ge.block=Ne.pedantic,ge.inline=q.pedantic):this.options.gfm&&(ge.block=Ne.gfm,ge.inline=this.options.breaks?q.breaks:q.gfm),this.tokenizer.rules=ge}rt.lex=function(ge,be){return new rt(be).lex(ge)},rt.lexInline=function(ge,be){return new rt(be).inlineTokens(ge)};var lt=rt.prototype;return lt.lex=function(ge){return ge=ge.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(ge,this.tokens,!0),this.inline(this.tokens),this.tokens},lt.blockTokens=function(ge,be,Le){var Ze,At,Mt,Dt,Xt,zn,ut=this;for(void 0===be&&(be=[]),void 0===Le&&(Le=!0),this.options.pedantic&&(ge=ge.replace(/^ +$/gm,""));ge;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(Nn){return!!(Ze=Nn.call(ut,ge,be))&&(ge=ge.substring(Ze.raw.length),be.push(Ze),!0)}))){if(Ze=this.tokenizer.space(ge)){ge=ge.substring(Ze.raw.length),Ze.type&&be.push(Ze);continue}if(Ze=this.tokenizer.code(ge)){ge=ge.substring(Ze.raw.length),(Dt=be[be.length-1])&&"paragraph"===Dt.type?(Dt.raw+="\n"+Ze.raw,Dt.text+="\n"+Ze.text):be.push(Ze);continue}if(Ze=this.tokenizer.fences(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.heading(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.nptable(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.hr(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.blockquote(ge)){ge=ge.substring(Ze.raw.length),Ze.tokens=this.blockTokens(Ze.text,[],Le),be.push(Ze);continue}if(Ze=this.tokenizer.list(ge)){for(ge=ge.substring(Ze.raw.length),Mt=Ze.items.length,At=0;At<Mt;At++)Ze.items[At].tokens=this.blockTokens(Ze.items[At].text,[],!1);be.push(Ze);continue}if(Ze=this.tokenizer.html(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Le&&(Ze=this.tokenizer.def(ge))){ge=ge.substring(Ze.raw.length),this.tokens.links[Ze.tag]||(this.tokens.links[Ze.tag]={href:Ze.href,title:Ze.title});continue}if(Ze=this.tokenizer.table(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.lheading(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Xt=ge,this.options.extensions&&this.options.extensions.startBlock&&function(){var Nn=1/0,_n=ge.slice(1),$n=void 0;ut.options.extensions.startBlock.forEach(function(Cn){"number"==typeof($n=Cn.call(this,_n))&&$n>=0&&(Nn=Math.min(Nn,$n))}),Nn<1/0&&Nn>=0&&(Xt=ge.substring(0,Nn+1))}(),Le&&(Ze=this.tokenizer.paragraph(Xt))){Dt=be[be.length-1],zn&&"paragraph"===Dt.type?(Dt.raw+="\n"+Ze.raw,Dt.text+="\n"+Ze.text):be.push(Ze),zn=Xt.length!==ge.length,ge=ge.substring(Ze.raw.length);continue}if(Ze=this.tokenizer.text(ge)){ge=ge.substring(Ze.raw.length),(Dt=be[be.length-1])&&"text"===Dt.type?(Dt.raw+="\n"+Ze.raw,Dt.text+="\n"+Ze.text):be.push(Ze);continue}if(ge){var ai="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(ai);break}throw new Error(ai)}}return be},lt.inline=function(ge){var be,Le,ut,Ze,At,Mt,Dt=ge.length;for(be=0;be<Dt;be++)switch(Mt=ge[be],Mt.type){case"paragraph":case"text":case"heading":Mt.tokens=[],this.inlineTokens(Mt.text,Mt.tokens);break;case"table":for(Mt.tokens={header:[],cells:[]},Ze=Mt.header.length,Le=0;Le<Ze;Le++)Mt.tokens.header[Le]=[],this.inlineTokens(Mt.header[Le],Mt.tokens.header[Le]);for(Ze=Mt.cells.length,Le=0;Le<Ze;Le++)for(At=Mt.cells[Le],Mt.tokens.cells[Le]=[],ut=0;ut<At.length;ut++)Mt.tokens.cells[Le][ut]=[],this.inlineTokens(At[ut],Mt.tokens.cells[Le][ut]);break;case"blockquote":this.inline(Mt.tokens);break;case"list":for(Ze=Mt.items.length,Le=0;Le<Ze;Le++)this.inline(Mt.items[Le].tokens)}return ge},lt.inlineTokens=function(ge,be,Le,ut){var Ze=this;void 0===be&&(be=[]),void 0===Le&&(Le=!1),void 0===ut&&(ut=!1);var At,Mt,Dt,zn,ai,Nn,Xt=ge;if(this.tokens.links){var _n=Object.keys(this.tokens.links);if(_n.length>0)for(;null!=(zn=this.tokenizer.rules.inline.reflinkSearch.exec(Xt));)_n.includes(zn[0].slice(zn[0].lastIndexOf("[")+1,-1))&&(Xt=Xt.slice(0,zn.index)+"["+G("a",zn[0].length-2)+"]"+Xt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(zn=this.tokenizer.rules.inline.blockSkip.exec(Xt));)Xt=Xt.slice(0,zn.index)+"["+G("a",zn[0].length-2)+"]"+Xt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(zn=this.tokenizer.rules.inline.escapedEmSt.exec(Xt));)Xt=Xt.slice(0,zn.index)+"++"+Xt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;ge;)if(ai||(Nn=""),ai=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Cn){return!!(At=Cn.call(Ze,ge,be))&&(ge=ge.substring(At.raw.length),be.push(At),!0)}))){if(At=this.tokenizer.escape(ge)){ge=ge.substring(At.raw.length),be.push(At);continue}if(At=this.tokenizer.tag(ge,Le,ut)){ge=ge.substring(At.raw.length),Le=At.inLink,ut=At.inRawBlock,(Mt=be[be.length-1])&&"text"===At.type&&"text"===Mt.type?(Mt.raw+=At.raw,Mt.text+=At.text):be.push(At);continue}if(At=this.tokenizer.link(ge)){ge=ge.substring(At.raw.length),"link"===At.type&&(At.tokens=this.inlineTokens(At.text,[],!0,ut)),be.push(At);continue}if(At=this.tokenizer.reflink(ge,this.tokens.links)){ge=ge.substring(At.raw.length),Mt=be[be.length-1],"link"===At.type?(At.tokens=this.inlineTokens(At.text,[],!0,ut),be.push(At)):Mt&&"text"===At.type&&"text"===Mt.type?(Mt.raw+=At.raw,Mt.text+=At.text):be.push(At);continue}if(At=this.tokenizer.emStrong(ge,Xt,Nn)){ge=ge.substring(At.raw.length),At.tokens=this.inlineTokens(At.text,[],Le,ut),be.push(At);continue}if(At=this.tokenizer.codespan(ge)){ge=ge.substring(At.raw.length),be.push(At);continue}if(At=this.tokenizer.br(ge)){ge=ge.substring(At.raw.length),be.push(At);continue}if(At=this.tokenizer.del(ge)){ge=ge.substring(At.raw.length),At.tokens=this.inlineTokens(At.text,[],Le,ut),be.push(At);continue}if(At=this.tokenizer.autolink(ge,ue)){ge=ge.substring(At.raw.length),be.push(At);continue}if(!Le&&(At=this.tokenizer.url(ge,ue))){ge=ge.substring(At.raw.length),be.push(At);continue}if(Dt=ge,this.options.extensions&&this.options.extensions.startInline&&function(){var Cn=1/0,lr=ge.slice(1),cr=void 0;Ze.options.extensions.startInline.forEach(function(Xn){"number"==typeof(cr=Xn.call(this,lr))&&cr>=0&&(Cn=Math.min(Cn,cr))}),Cn<1/0&&Cn>=0&&(Dt=ge.substring(0,Cn+1))}(),At=this.tokenizer.inlineText(Dt,ut,pe)){ge=ge.substring(At.raw.length),"_"!==At.raw.slice(-1)&&(Nn=At.raw.slice(-1)),ai=!0,(Mt=be[be.length-1])&&"text"===Mt.type?(Mt.raw+=At.raw,Mt.text+=At.text):be.push(At);continue}if(ge){var $n="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error($n);break}throw new Error($n)}}return be},function(rt,lt,ht){lt&&it(rt.prototype,lt),ht&&it(rt,ht)}(rt,null,[{key:"rules",get:function(){return{block:Ne,inline:q}}}]),rt}(),_t=dt.exports.defaults,pt=te_cleanUrl,ve=te_escape,L=function(){function rt(ht){this.options=ht||_t}var lt=rt.prototype;return lt.code=function(ge,be,Le){var ut=(be||"").match(/\S*/)[0];if(this.options.highlight){var Ze=this.options.highlight(ge,ut);null!=Ze&&Ze!==ge&&(Le=!0,ge=Ze)}return ge=ge.replace(/\n$/,"")+"\n",ut?'<pre><code class="'+this.options.langPrefix+ve(ut,!0)+'">'+(Le?ge:ve(ge,!0))+"</code></pre>\n":"<pre><code>"+(Le?ge:ve(ge,!0))+"</code></pre>\n"},lt.blockquote=function(ge){return"<blockquote>\n"+ge+"</blockquote>\n"},lt.html=function(ge){return ge},lt.heading=function(ge,be,Le,ut){return this.options.headerIds?"<h"+be+' id="'+this.options.headerPrefix+ut.slug(Le)+'">'+ge+"</h"+be+">\n":"<h"+be+">"+ge+"</h"+be+">\n"},lt.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},lt.list=function(ge,be,Le){var ut=be?"ol":"ul";return"<"+ut+(be&&1!==Le?' start="'+Le+'"':"")+">\n"+ge+"</"+ut+">\n"},lt.listitem=function(ge){return"<li>"+ge+"</li>\n"},lt.checkbox=function(ge){return"<input "+(ge?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},lt.paragraph=function(ge){return"<p>"+ge+"</p>\n"},lt.table=function(ge,be){return be&&(be="<tbody>"+be+"</tbody>"),"<table>\n<thead>\n"+ge+"</thead>\n"+be+"</table>\n"},lt.tablerow=function(ge){return"<tr>\n"+ge+"</tr>\n"},lt.tablecell=function(ge,be){var Le=be.header?"th":"td";return(be.align?"<"+Le+' align="'+be.align+'">':"<"+Le+">")+ge+"</"+Le+">\n"},lt.strong=function(ge){return"<strong>"+ge+"</strong>"},lt.em=function(ge){return"<em>"+ge+"</em>"},lt.codespan=function(ge){return"<code>"+ge+"</code>"},lt.br=function(){return this.options.xhtml?"<br/>":"<br>"},lt.del=function(ge){return"<del>"+ge+"</del>"},lt.link=function(ge,be,Le){if(null===(ge=pt(this.options.sanitize,this.options.baseUrl,ge)))return Le;var ut='<a href="'+ve(ge)+'"';return be&&(ut+=' title="'+be+'"'),ut+">"+Le+"</a>"},lt.image=function(ge,be,Le){if(null===(ge=pt(this.options.sanitize,this.options.baseUrl,ge)))return Le;var ut='<img src="'+ge+'" alt="'+Le+'"';return be&&(ut+=' title="'+be+'"'),ut+(this.options.xhtml?"/>":">")},lt.text=function(ge){return ge},rt}(),N=function(){function rt(){}var lt=rt.prototype;return lt.strong=function(ge){return ge},lt.em=function(ge){return ge},lt.codespan=function(ge){return ge},lt.del=function(ge){return ge},lt.html=function(ge){return ge},lt.text=function(ge){return ge},lt.link=function(ge,be,Le){return""+Le},lt.image=function(ge,be,Le){return""+Le},lt.br=function(){return""},rt}(),B=function(){function rt(){this.seen={}}var lt=rt.prototype;return lt.serialize=function(ge){return ge.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},lt.getNextSafeSlug=function(ge,be){var Le=ge,ut=0;if(this.seen.hasOwnProperty(Le)){ut=this.seen[ge];do{Le=ge+"-"+ ++ut}while(this.seen.hasOwnProperty(Le))}return be||(this.seen[ge]=ut,this.seen[Le]=0),Le},lt.slug=function(ge,be){void 0===be&&(be={});var Le=this.serialize(ge);return this.getNextSafeSlug(Le,be.dryrun)},rt}(),Re=L,Qe=N,St=B,Nt=dt.exports.defaults,On=te_unescape,Yn=je,Ti=function(){function rt(ht){this.options=ht||Nt,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Qe,this.slugger=new St}rt.parse=function(ge,be){return new rt(be).parse(ge)},rt.parseInline=function(ge,be){return new rt(be).parseInline(ge)};var lt=rt.prototype;return lt.parse=function(ge,be){void 0===be&&(be=!0);var ut,Ze,At,Mt,Dt,Xt,zn,ai,Nn,_n,$n,Cn,lr,cr,Xn,qi,Sa,Qr,ie,Le="",fe=ge.length;for(ut=0;ut<fe;ut++)if(_n=ge[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[_n.type]&&(!1!==(ie=this.options.extensions.renderers[_n.type].call(this,_n))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(_n.type)))Le+=ie||"";else switch(_n.type){case"space":continue;case"hr":Le+=this.renderer.hr();continue;case"heading":Le+=this.renderer.heading(this.parseInline(_n.tokens),_n.depth,On(this.parseInline(_n.tokens,this.textRenderer)),this.slugger);continue;case"code":Le+=this.renderer.code(_n.text,_n.lang,_n.escaped);continue;case"table":for(ai="",zn="",Mt=_n.header.length,Ze=0;Ze<Mt;Ze++)zn+=this.renderer.tablecell(this.parseInline(_n.tokens.header[Ze]),{header:!0,align:_n.align[Ze]});for(ai+=this.renderer.tablerow(zn),Nn="",Mt=_n.cells.length,Ze=0;Ze<Mt;Ze++){for(zn="",Dt=(Xt=_n.tokens.cells[Ze]).length,At=0;At<Dt;At++)zn+=this.renderer.tablecell(this.parseInline(Xt[At]),{header:!1,align:_n.align[At]});Nn+=this.renderer.tablerow(zn)}Le+=this.renderer.table(ai,Nn);continue;case"blockquote":Nn=this.parse(_n.tokens),Le+=this.renderer.blockquote(Nn);continue;case"list":for($n=_n.ordered,Cn=_n.start,lr=_n.loose,Mt=_n.items.length,Nn="",Ze=0;Ze<Mt;Ze++)qi=(Xn=_n.items[Ze]).checked,Sa=Xn.task,cr="",Xn.task&&(Qr=this.renderer.checkbox(qi),lr?Xn.tokens.length>0&&"text"===Xn.tokens[0].type?(Xn.tokens[0].text=Qr+" "+Xn.tokens[0].text,Xn.tokens[0].tokens&&Xn.tokens[0].tokens.length>0&&"text"===Xn.tokens[0].tokens[0].type&&(Xn.tokens[0].tokens[0].text=Qr+" "+Xn.tokens[0].tokens[0].text)):Xn.tokens.unshift({type:"text",text:Qr}):cr+=Qr),cr+=this.parse(Xn.tokens,lr),Nn+=this.renderer.listitem(cr,Sa,qi);Le+=this.renderer.list(Nn,$n,Cn);continue;case"html":Le+=this.renderer.html(_n.text);continue;case"paragraph":Le+=this.renderer.paragraph(this.parseInline(_n.tokens));continue;case"text":for(Nn=_n.tokens?this.parseInline(_n.tokens):_n.text;ut+1<fe&&"text"===ge[ut+1].type;)Nn+="\n"+((_n=ge[++ut]).tokens?this.parseInline(_n.tokens):_n.text);Le+=be?this.renderer.paragraph(Nn):Nn;continue;default:var re='Token with "'+_n.type+'" type was not found.';if(this.options.silent)return void console.error(re);throw new Error(re)}return Le},lt.parseInline=function(ge,be){be=be||this.renderer;var ut,Ze,At,Le="",Mt=ge.length;for(ut=0;ut<Mt;ut++)if(Ze=ge[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Ze.type]&&(!1!==(At=this.options.extensions.renderers[Ze.type].call(this,Ze))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Ze.type)))Le+=At||"";else switch(Ze.type){case"escape":Le+=be.text(Ze.text);break;case"html":Le+=be.html(Ze.text);break;case"link":Le+=be.link(Ze.href,Ze.title,this.parseInline(Ze.tokens,be));break;case"image":Le+=be.image(Ze.href,Ze.title,Ze.text);break;case"strong":Le+=be.strong(this.parseInline(Ze.tokens,be));break;case"em":Le+=be.em(this.parseInline(Ze.tokens,be));break;case"codespan":Le+=be.codespan(Ze.text);break;case"br":Le+=be.br();break;case"del":Le+=be.del(this.parseInline(Ze.tokens,be));break;case"text":Le+=be.text(Ze.text);break;default:var Dt='Token with "'+Ze.type+'" type was not found.';if(this.options.silent)return void console.error(Dt);throw new Error(Dt)}return Le},rt}(),wi=Xe,Kr=L,Ls=N,gs=B,Bs=te_merge,Xr=te_checkSanitizeDeprecation,Ja=te_escape,Nl=dt.exports.getDefaults,Ea=dt.exports.changeDefaults,Es=dt.exports.defaults;function Zt(rt,lt,ht){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof lt&&(ht=lt,lt=null),lt=Bs({},Zt.defaults,lt||{}),Xr(lt),ht){var be,ge=lt.highlight;try{be=Yn.lex(rt,lt)}catch(At){return ht(At)}var Le=function(Mt){var Dt;if(!Mt)try{lt.walkTokens&&Zt.walkTokens(be,lt.walkTokens),Dt=Ti.parse(be,lt)}catch(Xt){Mt=Xt}return lt.highlight=ge,Mt?ht(Mt):ht(null,Dt)};if(!ge||ge.length<3||(delete lt.highlight,!be.length))return Le();var ut=0;return Zt.walkTokens(be,function(At){"code"===At.type&&(ut++,setTimeout(function(){ge(At.text,At.lang,function(Mt,Dt){if(Mt)return Le(Mt);null!=Dt&&Dt!==At.text&&(At.text=Dt,At.escaped=!0),0==--ut&&Le()})},0))}),void(0===ut&&Le())}try{var Ze=Yn.lex(rt,lt);return lt.walkTokens&&Zt.walkTokens(Ze,lt.walkTokens),Ti.parse(Ze,lt)}catch(At){if(At.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+Ja(At.message+"",!0)+"</pre>";throw At}}return Zt.options=Zt.setOptions=function(rt){return Bs(Zt.defaults,rt),Ea(Zt.defaults),Zt},Zt.getDefaults=Nl,Zt.defaults=Es,Zt.use=function(){for(var rt=this,lt=arguments.length,ht=new Array(lt),ge=0;ge<lt;ge++)ht[ge]=arguments[ge];var ut,be=Bs.apply(void 0,[{}].concat(ht)),Le=Zt.defaults.extensions||{renderers:{},childTokens:{}};ht.forEach(function(Ze){if(Ze.extensions&&(ut=!0,Ze.extensions.forEach(function(Mt){if(!Mt.name)throw new Error("extension name required");if(Mt.renderer){var Dt=Le.renderers?Le.renderers[Mt.name]:null;Le.renderers[Mt.name]=Dt?function(){for(var Xt=arguments.length,zn=new Array(Xt),ai=0;ai<Xt;ai++)zn[ai]=arguments[ai];var Nn=Mt.renderer.apply(this,zn);return!1===Nn&&(Nn=Dt.apply(this,zn)),Nn}:Mt.renderer}if(Mt.tokenizer){if(!Mt.level||"block"!==Mt.level&&"inline"!==Mt.level)throw new Error("extension level must be 'block' or 'inline'");Le[Mt.level]?Le[Mt.level].unshift(Mt.tokenizer):Le[Mt.level]=[Mt.tokenizer],Mt.start&&("block"===Mt.level?Le.startBlock?Le.startBlock.push(Mt.start):Le.startBlock=[Mt.start]:"inline"===Mt.level&&(Le.startInline?Le.startInline.push(Mt.start):Le.startInline=[Mt.start]))}Mt.childTokens&&(Le.childTokens[Mt.name]=Mt.childTokens)})),Ze.renderer&&function(){var Mt=Zt.defaults.renderer||new Kr,Dt=function(ai){var Nn=Mt[ai];Mt[ai]=function(){for(var _n=arguments.length,$n=new Array(_n),Cn=0;Cn<_n;Cn++)$n[Cn]=arguments[Cn];var lr=Ze.renderer[ai].apply(Mt,$n);return!1===lr&&(lr=Nn.apply(Mt,$n)),lr}};for(var Xt in Ze.renderer)Dt(Xt);be.renderer=Mt}(),Ze.tokenizer&&function(){var Mt=Zt.defaults.tokenizer||new wi,Dt=function(ai){var Nn=Mt[ai];Mt[ai]=function(){for(var _n=arguments.length,$n=new Array(_n),Cn=0;Cn<_n;Cn++)$n[Cn]=arguments[Cn];var lr=Ze.tokenizer[ai].apply(Mt,$n);return!1===lr&&(lr=Nn.apply(Mt,$n)),lr}};for(var Xt in Ze.tokenizer)Dt(Xt);be.tokenizer=Mt}(),Ze.walkTokens){var At=Zt.defaults.walkTokens;be.walkTokens=function(Mt){Ze.walkTokens.call(rt,Mt),At&&At(Mt)}}ut&&(be.extensions=Le),Zt.setOptions(be)})},Zt.walkTokens=function(rt,lt){for(var be,ht=function(){var ut=be.value;switch(lt(ut),ut.type){case"table":for(var At,Ze=Tt(ut.tokens.header);!(At=Ze()).done;)Zt.walkTokens(At.value,lt);for(var Xt,Dt=Tt(ut.tokens.cells);!(Xt=Dt()).done;)for(var Nn,ai=Tt(Xt.value);!(Nn=ai()).done;)Zt.walkTokens(Nn.value,lt);break;case"list":Zt.walkTokens(ut.items,lt);break;default:Zt.defaults.extensions&&Zt.defaults.extensions.childTokens&&Zt.defaults.extensions.childTokens[ut.type]?Zt.defaults.extensions.childTokens[ut.type].forEach(function($n){Zt.walkTokens(ut[$n],lt)}):ut.tokens&&Zt.walkTokens(ut.tokens,lt)}},ge=Tt(rt);!(be=ge()).done;)ht()},Zt.parseInline=function(rt,lt){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");lt=Bs({},Zt.defaults,lt||{}),Xr(lt);try{var ht=Yn.lexInline(rt,lt);return lt.walkTokens&&Zt.walkTokens(ht,lt.walkTokens),Ti.parseInline(ht,lt)}catch(ge){if(ge.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+Ja(ge.message+"",!0)+"</pre>";throw ge}},Zt.Parser=Ti,Zt.parser=Ti.parse,Zt.Renderer=Kr,Zt.TextRenderer=Ls,Zt.Lexer=Yn,Zt.lexer=Yn.lex,Zt.Tokenizer=wi,Zt.Slugger=gs,Zt.parse=Zt,Zt}()},369:(Ut,it,Je)=>{var yt=Je(284),ee=Je(830);function Tt(){this.clear()}Tt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},Tt.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},Tt.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},Tt.prototype.peek=function(){if(this.size)return this.items[this.offset]},Tt.prototype.forEach=function(dt,Y){Y=arguments.length>1?Y:this;for(var Se=this.offset,he=0,W=this.items.length;Se<W;Se++,he++)dt.call(Y,this.items[Se],he,this)},Tt.prototype.toArray=function(){return this.items.slice(this.offset)},Tt.prototype.values=function(){var dt=this.items,Y=this.offset;return new yt(function(){if(Y>=dt.length)return{done:!0};var Se=dt[Y];return Y++,{value:Se,done:!1}})},Tt.prototype.entries=function(){var dt=this.items,Y=this.offset,Se=0;return new yt(function(){if(Y>=dt.length)return{done:!0};var he=dt[Y];return Y++,{value:[Se++,he],done:!1}})},"undefined"!=typeof Symbol&&(Tt.prototype[Symbol.iterator]=Tt.prototype.values),Tt.prototype.toString=function(){return this.toArray().join(",")},Tt.prototype.toJSON=function(){return this.toArray()},Tt.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:Tt,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(Tt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Tt.prototype.inspect),Tt.from=function(dt){var Y=new Tt;return ee(dt,function(Se){Y.enqueue(Se)}),Y},Tt.of=function(){return Tt.from(arguments)},Ut.exports=Tt},830:Ut=>{var it="undefined"!=typeof ArrayBuffer,Je="undefined"!=typeof Symbol;function yt(ee,Tt){var dt,Y,Se,he,W;if(!ee)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof Tt)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(Se=0,he=ee.length;Se<he;Se++)Tt(ee[Se],Se);else if("function"!=typeof ee.forEach)if(Je&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&Tt(ee[Y],Y);else for(dt=ee,Se=0;!0!==(W=dt.next()).done;)Tt(W.value,Se),Se++;else ee.forEach(Tt)}yt.forEachWithNullKeys=function(ee,Tt){var dt,Y,Se,he,W;if(!ee)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof Tt)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(Se=0,he=ee.length;Se<he;Se++)Tt(ee[Se],null);else if(ee instanceof Set)ee.forEach(function(j){Tt(j,null)});else if("function"!=typeof ee.forEach)if(Je&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&Tt(ee[Y],Y);else for(dt=ee,Se=0;!0!==(W=dt.next()).done;)Tt(W.value,null),Se++;else ee.forEach(Tt)},Ut.exports=yt},284:Ut=>{function it(Je){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:Je}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var Je=this._next();return Je.done&&(this.done=!0),Je},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var Je=arguments,yt=Je.length,ee=0;return new it(function(){return ee>=yt?{done:!0}:{done:!1,value:Je[ee++]}})},it.empty=function(){var Je=new it(null);return Je.done=!0,Je},it.is=function(Je){return Je instanceof it||"object"==typeof Je&&null!==Je&&"function"==typeof Je.next},Ut.exports=it},310:(Ut,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==ee.window.orientation},it.default=function(he){if(!he&&!(0,Tt.default)())return"Node";if((0,dt.default)(he))return"Electron";var W="undefined"!=typeof navigator?navigator:{},j=he||W.userAgent||"";if(j.indexOf("Edge")>-1)return"Edge";var P=-1!==j.indexOf("MSIE "),Q=-1!==j.indexOf("Trident/");return P||Q?"IE":ee.window.chrome?"Chrome":ee.window.safari?"Safari":ee.window.mozInnerScreenX?"Firefox":"Unknown"};var ee=Je(151),Tt=yt(Je(602)),dt=yt(Je(344))},151:(Ut,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var ee=yt(Je(321)),Tt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&process};it.self=Tt.self||Tt.window||Tt.global,it.window=Tt.window||Tt.self||Tt.global,it.global=Tt.global||Tt.self||Tt.window,it.document=Tt.document||{},it.process=Tt.process||{};var j=console;it.console=j},761:(Ut,it,Je)=>{"use strict";var ee=Je(948),Tt=Je(321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return Se.default}});var dt=Je(151),Se=(j(Je(602)),j(Je(310)));ee(Je(344));function W(P){if("function"!=typeof WeakMap)return null;var Q=new WeakMap,z=new WeakMap;return(W=function(x){return x?z:Q})(P)}function j(P,Q){if(!Q&&P&&P.__esModule)return P;if(null===P||"object"!==Tt(P)&&"function"!=typeof P)return{default:P};var z=W(Q);if(z&&z.has(P))return z.get(P);var v={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in P)if("default"!==O&&Object.prototype.hasOwnProperty.call(P,O)){var A=x?Object.getOwnPropertyDescriptor(P,O):null;A&&(A.get||A.set)?Object.defineProperty(v,O,A):v[O]=P[O]}return v.default=P,z&&z.set(P,v),v}},602:(Ut,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=dt,it.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var ee=yt(Je(321)),Tt=yt(Je(344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,Tt.default)()}},344:(Ut,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(dt){if("undefined"!=typeof window&&"object"===(0,ee.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,ee.default)(process.versions)&&Boolean(process.versions.electron))return!0;var Y="object"===("undefined"==typeof navigator?"undefined":(0,ee.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Se=dt||Y;return!!(Se&&Se.indexOf("Electron")>=0)};var ee=yt(Je(321))},991:function(Ut,it,Je){"use strict";var yt=this&&this.__createBinding||(Object.create?function(Tt,dt,Y,Se){void 0===Se&&(Se=Y),Object.defineProperty(Tt,Se,{enumerable:!0,get:function(){return dt[Y]}})}:function(Tt,dt,Y,Se){void 0===Se&&(Se=Y),Tt[Se]=dt[Y]}),ee=this&&this.__exportStar||function(Tt,dt){for(var Y in Tt)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,Tt,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(Je(180),it),ee(Je(103),it),ee(Je(965),it),ee(Je(595),it),ee(Je(417),it),ee(Je(451),it),ee(Je(735),it)},180:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(ee){this.termType="BlankNode",this.value=ee}equals(ee){return!!ee&&"BlankNode"===ee.termType&&ee.value===this.value}}},103:(Ut,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const yt=Je(180),ee=Je(965),Tt=Je(595),dt=Je(417),Y=Je(451),Se=Je(735);let he=0;it.DataFactory=class{constructor(P){this.blankNodeCounter=0,this.blankNodePrefix=(P=P||{}).blankNodePrefix||`df_${he++}_`}namedNode(P){return new dt.NamedNode(P)}blankNode(P){return new yt.BlankNode(P||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(P,Q){return new Tt.Literal(P,Q)}variable(P){return new Se.Variable(P)}defaultGraph(){return ee.DefaultGraph.INSTANCE}quad(P,Q,z,v){return new Y.Quad(P,Q,z,v||this.defaultGraph())}fromTerm(P){switch(P.termType){case"NamedNode":return this.namedNode(P.value);case"BlankNode":return this.blankNode(P.value);case"Literal":return P.language?this.literal(P.value,P.language):P.datatype.equals(Tt.Literal.XSD_STRING)?this.literal(P.value):this.literal(P.value,this.fromTerm(P.datatype));case"Variable":return this.variable(P.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(P.subject),this.fromTerm(P.predicate),this.fromTerm(P.object),this.fromTerm(P.graph))}}fromQuad(P){return this.fromTerm(P)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class Je{constructor(){this.termType="DefaultGraph",this.value=""}equals(ee){return!!ee&&"DefaultGraph"===ee.termType}}it.DefaultGraph=Je,Je.INSTANCE=new Je},595:(Ut,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const yt=Je(417);class ee{constructor(dt,Y){this.termType="Literal",this.value=dt,"string"==typeof Y?(this.language=Y,this.datatype=ee.RDF_LANGUAGE_STRING):Y?(this.language="",this.datatype=Y):(this.language="",this.datatype=ee.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}it.Literal=ee,ee.RDF_LANGUAGE_STRING=new yt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),ee.XSD_STRING=new yt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(ee){this.termType="NamedNode",this.value=ee}equals(ee){return!!ee&&"NamedNode"===ee.termType&&ee.value===this.value}}},451:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(ee,Tt,dt,Y){this.termType="Quad",this.value="",this.subject=ee,this.predicate=Tt,this.object=dt,this.graph=Y}equals(ee){return!!ee&&("Quad"===ee.termType||!ee.termType)&&this.subject.equals(ee.subject)&&this.predicate.equals(ee.predicate)&&this.object.equals(ee.object)&&this.graph.equals(ee.graph)}}},735:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(ee){this.termType="Variable",this.value=ee}equals(ee){return!!ee&&"Variable"===ee.termType&&ee.value===this.value}}},609:function(Ut,it,Je){"use strict";var yt=this&&this.__createBinding||(Object.create?function(v,x,O,A){void 0===A&&(A=O),Object.defineProperty(v,A,{enumerable:!0,get:function(){return x[O]}})}:function(v,x,O,A){void 0===A&&(A=O),v[A]=x[O]}),ee=this&&this.__exportStar||function(v,x){for(var O in v)"default"!==O&&!Object.prototype.hasOwnProperty.call(x,O)&&yt(x,v,O)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const Tt=Je(991),dt=Je(938),Y=Je(60);ee(Je(938),it),ee(Je(871),it),ee(Je(60),it);const Se=new Tt.DataFactory,he=new Y.Translator;function W(v,x){return he.fromRdf(v,x)}he.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(v=>Se.namedNode(v)),["string"]),he.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(v=>Se.namedNode(v)),["boolean"]),he.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(v=>Se.namedNode(v)),["number"]),he.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(v=>Se.namedNode(v)),["number"]),he.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(v=>Se.namedNode(v)),["object"]),it.fromRdf=W,it.toRdf=function(v,x){return x&&"namedNode"in x&&(x={dataFactory:x}),(x=x||{})&&!x.dataFactory&&(x.dataFactory=Se),he.toRdf(v,x)},it.getTermRaw=function(v,x){return"Literal"===v.termType?W(v,x):v.value},it.getSupportedRdfDatatypes=function(){return he.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return he.getSupportedJavaScriptPrimitives()}},871:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},60:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(ee){throw new Error(`Invalid RDF ${ee.datatype.value} value: '${ee.value}'`)}registerHandler(ee,Tt,dt){for(const Y of Tt)this.supportedRdfDatatypes.push(Y),this.fromRdfHandlers[Y.value]=ee;for(const Y of dt){let Se=this.toRdfHandlers[Y];Se||(this.toRdfHandlers[Y]=Se=[]),Se.push(ee)}}fromRdf(ee,Tt){const dt=this.fromRdfHandlers[ee.datatype.value];return dt?dt.fromRdf(ee,Tt):ee.value}toRdf(ee,Tt){const dt=this.toRdfHandlers[typeof ee];if(dt)for(const Y of dt){const Se=Y.toRdf(ee,Tt);if(Se)return Se}throw new Error(`Invalid JavaScript value: '${ee}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Ut,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return Y&&yt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:Y,dataFactory:Se}){return Se.literal(dt?"true":"false",Y||Se.namedNode(ee.TYPE))}}it.TypeHandlerBoolean=ee,ee.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(Ut,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){switch(Y&&!dt.value.match(ee.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&yt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Se=dt.value.split("-");return new Date(0,parseInt(Se[0],10)-1,parseInt(Se[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:Y,dataFactory:Se}){if(Y=Y||Se.namedNode(ee.TYPES[0]),!(dt instanceof Date))return null;const he=dt;let W;switch(Y.value){case"http://www.w3.org/2001/XMLSchema#gDay":W=String(he.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":W=he.getUTCMonth()+1+"-"+he.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":W=String(he.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":W=he.getUTCFullYear()+"-"+(he.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":W=he.toISOString().replace(/T.*$/,"");break;default:W=he.toISOString()}return Se.literal(W,Y)}}it.TypeHandlerDate=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],ee.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(Ut,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){const Se=parseFloat(dt.value);return Y&&isNaN(Se)&&yt.Translator.incorrectRdfDataType(dt),Se}toRdf(dt,{datatype:Y,dataFactory:Se}){return Y=Y||Se.namedNode(ee.TYPES[0]),isNaN(dt)?Se.literal("NaN",Y):isFinite(dt)?dt%1==0?null:Se.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Y):Se.literal(dt>0?"INF":"-INF",Y)}}it.TypeHandlerNumberDouble=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(Ut,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){const Se=parseInt(dt.value,10);return Y&&(isNaN(Se)||dt.value.indexOf(".")>=0)&&yt.Translator.incorrectRdfDataType(dt),Se}toRdf(dt,{datatype:Y,dataFactory:Se}){return Se.literal(String(dt),Y||Se.namedNode(dt<=ee.MAX_INT&&dt>=ee.MIN_INT?ee.TYPES[0]:ee.TYPES[1]))}}it.TypeHandlerNumberInteger=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],ee.MAX_INT=2147483647,ee.MIN_INT=-2147483648},608:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class Je{fromRdf(ee){return ee.value}toRdf(ee,{datatype:Tt,dataFactory:dt}){return dt.literal(ee,Tt)}}it.TypeHandlerString=Je,Je.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(Ut,it,Je){"use strict";var yt=this&&this.__createBinding||(Object.create?function(Tt,dt,Y,Se){void 0===Se&&(Se=Y),Object.defineProperty(Tt,Se,{enumerable:!0,get:function(){return dt[Y]}})}:function(Tt,dt,Y,Se){void 0===Se&&(Se=Y),Tt[Se]=dt[Y]}),ee=this&&this.__exportStar||function(Tt,dt){for(var Y in Tt)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,Tt,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(Je(727),it),ee(Je(525),it),ee(Je(554),it),ee(Je(750),it),ee(Je(608),it)},970:(Ut,it,Je)=>{"use strict";var yt={};Je.r(yt),Je.d(yt,{decode:()=>Jme,encode:()=>e_e});var ee={};Je.r(ee),Je.d(ee,{decode:()=>s_e,encode:()=>o_e});var Tt={};Je.r(Tt),Je.d(Tt,{decode:()=>a_e,encode:()=>l_e});var dt={};function Y(n){return"function"==typeof n}Je.r(dt),Je.d(dt,{decode:()=>c_e,encode:()=>u_e});let Se=!1;const he={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Se&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Se=n},get useDeprecatedSynchronousErrorHandling(){return Se}};function W(n){setTimeout(()=>{throw n},0)}const j={closed:!0,next(n){},error(n){if(he.useDeprecatedSynchronousErrorHandling)throw n;W(n)},complete(){}},P=Array.isArray||(n=>n&&"number"==typeof n.length);function Q(n){return null!==n&&"object"==typeof n}const v=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class x{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof x)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(Y(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof v?O(o.errors):[o]}}if(P(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(Q(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof v?e=e.concat(O(c.errors)):e.push(c)}}}if(e)throw new v(e)}add(e){let t=e;if(!e)return x.EMPTY;switch(typeof e){case"function":t=new x(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof x)){const s=t;t=new x,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof x){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function O(n){return n.reduce((e,t)=>e.concat(t instanceof v?t.errors:t),[])}x.EMPTY=((n=new x).closed=!0,n);const A="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends x{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=j;break;case 1:if(!e){this.destination=j;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new S(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new S(this,e,t,i)}}[A](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class S extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;Y(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==j&&(o=Object.create(t),Y(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;he.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=he;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):W(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;W(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);he.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),he.useDeprecatedSynchronousErrorHandling)throw i;W(i)}}__tryOrSetError(e,t,i){if(!he.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return he.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(W(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const R="function"==typeof Symbol&&Symbol.observable||"@@observable";function K(n){return n}function ce(...n){return D(n)}function D(n){return 0===n.length?K:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let I=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[A])return n[A]()}return n||e||t?new y(n,e,t):new y(j)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||he.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),he.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){he.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=X(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[R](){return this}pipe(...t){return 0===t.length?this:D(t)(this)}toPromise(t){return new(t=X(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function X(n){if(n||(n=he.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const $=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Z extends x{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class oe extends y{constructor(e){super(e),this.destination=e}}let se=(()=>{class n extends I{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[A](){return new oe(this)}lift(t){const i=new te(this,this);return i.operator=t,i}next(t){if(this.closed)throw new $;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new $;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new $;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new $;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new $;return this.hasError?(t.error(this.thrownError),x.EMPTY):this.isStopped?(t.complete(),x.EMPTY):(this.observers.push(t),new Z(this,t))}asObservable(){const t=new I;return t.source=this,t}}return n.create=(e,t)=>new te(e,t),n})();class te extends se{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):x.EMPTY}}function Ce(n){return n&&"function"==typeof n.schedule}function me(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new ne(n,e))}}class ne{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _e(e,this.project,this.thisArg))}}class _e extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Ie=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Xe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",ke=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ke(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Me=n=>{if(n&&"function"==typeof n[R])return(n=>e=>{const t=n[R]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(ke(n))return Ie(n);if(Ke(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W),e))(n);if(n&&"function"==typeof n[Xe])return(n=>e=>{const t=n[Xe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${Q(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Ne(n,e){return new I(t=>{const i=new x;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function je(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[R]}(n))return function(n,e){return new I(t=>{const i=new x;return i.add(e.schedule(()=>{const r=n[R]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ke(n))return function(n,e){return new I(t=>{const i=new x;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(ke(n))return Ne(n,e);if(function(n){return n&&"function"==typeof n[Xe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new I(t=>{const i=new x;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Xe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof I?n:new I(Me(n))}class _t extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class ve extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function N(n,e){if(e.closed)return;if(n instanceof I)return n.subscribe(e);let t;try{t=Me(n)(e)}catch(i){e.error(i)}return t}function B(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(B((r,s)=>je(n(r,s)).pipe(me((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Re(n,t)))}class Re{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Qe(e,this.project,this.concurrent))}}class Qe extends ve{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Nt(n=Number.POSITIVE_INFINITY){return B(K,n)}function On(n,e){return e?Ne(n,e):new I(Ie(n))}function kn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Ce(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof I?n[0]:Nt(e)(On(n,t))}function Yn(){return function(e){return e.lift(new Ti(e))}}class Ti{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new wi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class wi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Kr extends I{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new x,e.add(this.source.subscribe(new gs(this.getSubject(),this))),e.closed&&(this._connection=null,e=x.EMPTY)),e}refCount(){return Yn()(this)}}const Ls=(()=>{const n=Kr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class gs extends oe{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function Ja(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Nl(r,e));const s=Object.create(i,Ls);return s.source=i,s.subjectFactory=r,s}}class Nl{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function Ea(){return new se}function Es(){return n=>Yn()(Ja(Ea)(n))}function Zt(n){for(let e in n)if(n[e]===Zt)return e;throw Error("Could not find renamed property on target object.")}function el(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function lt(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ht=Zt({__forward_ref__:Zt});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return rt(this())},n}function be(n){return Le(n)?n():n}function Le(n){return"function"==typeof n&&n.hasOwnProperty(ht)&&n.__forward_ref__===ge}class Ze extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Dt(n){return"string"==typeof n?n:null==n?"":String(n)}function Xt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Dt(n)}function _n(n,e){const t=e?` in ${e}`:"";throw new Ze("201",`No provider for ${Xt(n)} found${t}`)}function J(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ct(n){return{providers:n.providers||[],imports:n.imports||[]}}function yn(n){return Ss(n,po)||Ss(n,js)}function Ss(n,e){return n.hasOwnProperty(e)?n[e]:null}function Pl(n){return n&&(n.hasOwnProperty(jr)||n.hasOwnProperty(Sc))?n[jr]:null}const po=Zt({\u0275prov:Zt}),jr=Zt({\u0275inj:Zt}),js=Zt({ngInjectableDef:Zt}),Sc=Zt({ngInjectorDef:Zt});var wn=(()=>((wn=wn||{})[wn.Default=0]="Default",wn[wn.Host=1]="Host",wn[wn.Self=2]="Self",wn[wn.SkipSelf=4]="SkipSelf",wn[wn.Optional=8]="Optional",wn))();let go;function xa(n){const e=go;return go=n,e}function wd(n,e,t){const i=yn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&wn.Optional?null:void 0!==e?e:void _n(rt(n),"Injector")}function De(n){return{toString:n}.toString()}var He=(()=>((He=He||{})[He.OnPush=0]="OnPush",He[He.Default=1]="Default",He))(),Yt=(()=>((Yt=Yt||{})[Yt.Emulated=0]="Emulated",Yt[Yt.None=2]="None",Yt[Yt.ShadowDom=3]="ShadowDom",Yt))();const li="undefined"!=typeof globalThis&&globalThis,Vr="undefined"!=typeof window&&window,Jr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,xs="undefined"!=typeof global&&global,Qn=li||xs||Vr||Jr,Ed={},ir=[],fp=Zt({\u0275cmp:Zt}),i_=Zt({\u0275dir:Zt}),Dh=Zt({\u0275pipe:Zt}),dv=Zt({\u0275mod:Zt}),P1=Zt({\u0275loc:Zt}),kl=Zt({\u0275fac:Zt}),Ih=Zt({__NG_ELEMENT_ID__:Zt});let F1=0;function cn(n){return De(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===He.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||ir,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Yt.Emulated,id:"c",styles:n.styles||ir,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=F1++,i.inputs=gv(n.inputs,t),i.outputs=gv(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(hv):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(fv):null,i})}function hv(n){return Ui(n)||function(n){return n[i_]||null}(n)}function fv(n){return function(n){return n[Dh]||null}(n)}const pv={};function an(n){return De(()=>{const e={type:n.type,bootstrap:n.bootstrap||ir,declarations:n.declarations||ir,imports:n.imports||ir,exports:n.exports||ir,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(pv[n.id]=n.type),e})}function gv(n,e){if(null==n)return Ed;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Rt=cn;function Vs(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ui(n){return n[fp]||null}function Oo(n,e){const t=n[dv]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function Qo(n){return Array.isArray(n)&&"object"==typeof n[1]}function Zo(n){return Array.isArray(n)&&!0===n[1]}function o_(n){return 0!=(8&n.flags)}function Ad(n){return 2==(2&n.flags)}function Td(n){return 1==(1&n.flags)}function Ta(n){return null!==n.template}function mv(n){return 0!=(512&n[2])}function Ac(n,e){return n.hasOwnProperty(kl)?n[kl]:null}class u_{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function zi(){return bv}function bv(n){return n.type.prototype.ngOnChanges&&(n.setInput=H1),z1}function z1(){const n=at(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===Ed)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function H1(n,e,t,i){const r=at(n)||function(n,e){return n[kh]=e}(n,{previous:Ed,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new u_(l&&l.currentValue,e,o===Ed),n[i]=e}zi.ngInherit=!0;const kh="__ngSimpleChanges__";function at(n){return n[kh]||null}let Qi;function pr(n){return!!n.listen}const yu={createRenderer:(n,e)=>void 0!==Qi?Qi:"undefined"!=typeof document?document:void 0};function xr(n){for(;Array.isArray(n);)n=n[0];return n}function Lh(n,e){return xr(e[n])}function Zs(n,e){return xr(e[n.index])}function f_(n,e){return n.data[e]}function zs(n,e){const t=e[n];return Qo(t)?t:t[0]}function jl(n){return 4==(4&n[2])}function Dd(n){return 128==(128&n[2])}function Da(n,e){return null==e?null:n[e]}function p_(n){n[18]=0}function mp(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Bn={lFrame:vu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function wv(){return Bn.bindingsEnabled}function jt(){return Bn.lFrame.lView}function Ei(){return Bn.lFrame.tView}function Cr(n){return Bn.lFrame.contextLView=n,n[8]}function cs(){let n=g_();for(;null!==n&&64===n.type;)n=n.parent;return n}function g_(){return Bn.lFrame.currentTNode}function il(n,e){const t=Bn.lFrame;t.currentTNode=n,t.isParent=e}function Hr(){return Bn.lFrame.isParent}function ms(){Bn.lFrame.isParent=!1}function Vh(){return Bn.isInCheckNoChangesMode}function yp(n){Bn.isInCheckNoChangesMode=n}function Ia(){return Bn.lFrame.bindingIndex++}function No(n){const e=Bn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Id(n,e){const t=Bn.lFrame;t.bindingIndex=t.bindingRootIndex=n,m_(e)}function m_(n){Bn.lFrame.currentDirectiveIndex=n}function __(n){const e=Bn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function Ev(){return Bn.lFrame.currentQueryIndex}function y_(n){Bn.lFrame.currentQueryIndex=n}function vp(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function Od(n,e,t){if(t&wn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&wn.Host||(r=vp(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Bn.lFrame=Ee();return i.currentTNode=e,i.lView=n,!0}function Hh(n){const e=Ee(),t=n[1];Bn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Ee(){const n=Bn.lFrame,e=null===n?null:n.child;return null===e?vu(n):e}function vu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Gh(){const n=Bn.lFrame;return Bn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Po=Gh;function fi(){const n=Gh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Js(){return Bn.lFrame.selectedIndex}function yo(n){Bn.lFrame.selectedIndex=n}function kr(){const n=Bn.lFrame;return f_(n.tView,n.selectedIndex)}function wp(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function Ep(n,e,t){rl(n,e,3,t)}function Sp(n,e,t,i){(3&n[2])===t&&rl(n,e,t,i)}function b_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function rl(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(tA(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function tA(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class $h{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function xp(n,e,t){const i=pr(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];w_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Cv(n){return 3===n||4===n||6===n}function w_(n){return 64===n.charCodeAt(0)}function Wh(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||E_(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function E_(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function Av(n){return-1!==n}function Rd(n){return 32767&n}function sl(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Nd=!0;function Cp(n){const e=Nd;return Nd=n,e}let x_=0;function Hs(n,e){const t=Ap(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,C_(i.data,n),C_(e,null),C_(i.blueprint,null));const r=qh(n,e),s=n.injectorIndex;if(Av(r)){const o=Rd(r),a=sl(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function C_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ap(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function qh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Mc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ih)&&(i=t[Ih]),null==i&&(i=t[Ih]=x_++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function A_(n,e,t){if(t&wn.Optional)return n;_n(e,"NodeInjector")}function Mv(n,e,t,i){if(t&wn.Optional&&void 0===i&&(i=null),0==(t&(wn.Self|wn.Host))){const r=n[9],s=xa(void 0);try{return r?r.get(e,i,t&wn.Optional):wd(e,i,t&wn.Optional)}finally{xa(s)}}return A_(i,e,t)}function Yh(n,e,t,i=wn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ih)?n[Ih]:void 0;return"number"==typeof e?e>=0?255&e:Iv:e}(t);if("function"==typeof s){if(!Od(e,n,i))return i&wn.Host?A_(r,t,i):Mv(e,t,i,r);try{const o=s(i);if(null!=o||i&wn.Optional)return o;_n(t)}finally{Po()}}else if("number"==typeof s){let o=null,a=Ap(n,e),l=-1,c=i&wn.Host?e[16][6]:null;for((-1===a||i&wn.SkipSelf)&&(l=-1===a?qh(n,e):e[a+8],-1!==l&&Kh(i,!1)?(o=e[1],a=Rd(l),e=sl(l,e)):a=-1);-1!==a;){const u=e[1];if(Tp(s,a,u.data)){const h=Ts(a,e,t,o,i,c);if(h!==Dv)return h}l=e[a+8],-1!==l&&Kh(i,e[1].data[a+8]===c)&&Tp(s,a,e)?(o=u,a=Rd(l),e=sl(l,e)):a=-1}}}return Mv(e,t,i,r)}const Dv={};function Iv(){return new ea(cs(),jt())}function Ts(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Pd(a,o,t,null==i?Ad(a)&&Nd:i!=o&&0!=(3&a.type),r&wn.Host&&s===a);return null!==u?Fd(e,o,u,a):Dv}function Pd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,p=r?a+u:n.directiveEnd;for(let g=i?a:a+u;g<p;g++){const m=o[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=o[l];if(g&&Ta(g)&&g.type===t)return l}return null}function Fd(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof $h}(r)){const o=r;o.resolving&&function(n,e){throw new Ze("200",`Circular dependency in DI detected for ${n}`)}(Xt(s[t]));const a=Cp(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?xa(o.injectImpl):null;Od(n,i,wn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=bv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&xa(l),Cp(a),o.resolving=!1,Po()}}return r}function Tp(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Kh(n,e){return!(n&wn.Self||n&wn.Host&&e)}class ea{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Yh(this._tNode,this._lView,e,void 0,t)}}function rr(n){return De(()=>{const e=n.prototype.constructor,t=e[kl]||Ms(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[kl]||Ms(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Ms(n){return Le(n)?()=>{const e=Ms(be(n));return e&&e()}:Ac(n)}function Fo(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Cv(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(cs(),n)}const Ld="__parameters__";function Na(n,e,t){return De(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Ld)?l[Ld]:Object.defineProperty(l,Ld,{value:[]})[Ld];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Ht{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Su=Function;function ta(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),ta(i,e)):e!==n&&e.push(i)}return e}function na(n,e){n.forEach(t=>Array.isArray(t)?na(t,e):e(t))}function Qh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Ul(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ic(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function ko(n,e,t){let i=Ds(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function R_(n,e){const t=Ds(n,e);if(t>=0)return n[1|t]}function Ds(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Au={},Rp="__NG_DI_FLAG__",Rc="ngTempTokenPath",Nc=/\n/gm,ll="__source",Np=Zt({provide:String,useValue:Zt});let Tu;function Vd(n){const e=Tu;return Tu=n,e}function mA(n,e=wn.Default){if(void 0===Tu)throw new Error("inject() must be called from an injection context");return null===Tu?wd(n,void 0,e):Tu.get(n,e&wn.Optional?null:void 0,e)}function Oe(n,e=wn.Default){return(go||mA)(be(n),e)}const Pc=Oe;function Mu(n){const e=[];for(let t=0;t<n.length;t++){const i=be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=wn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=kv(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Oe(r,s))}else e.push(Oe(i))}return e}function Ud(n,e){return n[Rp]=e,n.prototype[Rp]=e,n}function kv(n){return n[Rp]}function eo(n,e,t,i){const r=n[Rc];throw e[ll]&&r.unshift(e[ll]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Nc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Rc]=null,n}const zd=Ud(Na("Inject",n=>({token:n})),-1),ts=Ud(Na("Optional"),8),cl=Ud(Na("SkipSelf"),4);let Gd;function Iu(n){var e;return(null===(e=function(){if(void 0===Gd&&(Gd=null,Qn.trustedTypes))try{Gd=Qn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Gd}())||void 0===e?void 0:e.createHTML(n))||n}class $l{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class B_ extends $l{getTypeName(){return"HTML"}}class j_ extends $l{getTypeName(){return"Style"}}class Vp extends $l{getTypeName(){return"Script"}}class $d extends $l{getTypeName(){return"URL"}}class Fn extends $l{getTypeName(){return"ResourceURL"}}function Gs(n){return n instanceof $l?n.changingThisBreaksApplicationSecurity:n}function ia(n,e){const t=kc(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function kc(n){return n instanceof $l&&n.getTypeName()||null}class Yv{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Iu(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class wA{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const i=this.inertDocument.createElement("body");t.appendChild(i)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Iu(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=Iu(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const EA=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,SA=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Bo(n){return(n=String(n)).match(EA)||n.match(SA)?n:"unsafe:"+n}function Ws(n){return(n=String(n)).split(",").map(e=>Bo(e.trim())).join(", ")}function ra(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function Jh(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const Up=ra("area,br,col,hr,img,wbr"),Xv=ra("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Qv=ra("rp,rt"),U_=Jh(Up,Jh(Xv,ra("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Jh(Qv,ra("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Jh(Qv,Xv)),z_=ra("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),H_=ra("srcset"),G_=Jh(z_,H_,ra("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ra("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),TA=ra("script,style,template");class $_{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!U_.hasOwnProperty(t))return this.sanitizedSomething=!0,!TA.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!G_.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;z_[a]&&(l=Bo(l)),H_[a]&&(l=Ws(l)),this.buf.push(" ",o,'="',Hp(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();U_.hasOwnProperty(t)&&!Up.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Hp(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Zv=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ef=/([^\#-~ |!])/g;function Hp(n){return n.replace(/&/g,"&amp;").replace(Zv,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(ef,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let tf;function W_(n,e){let t=null;try{tf=tf||function(n){const e=new wA(n);return function(){try{return!!(new window.DOMParser).parseFromString(Iu(""),"text/html")}catch(n){return!1}}()?new Yv(e):e}(n);let i=e?String(e):"";t=tf.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=tf.getInertBodyElement(i)}while(i!==s);return Iu((new $_).sanitizeChildren(Wd(t)||t))}finally{if(t){const i=Wd(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Wd(n){return"content"in n&&function(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var ni=(()=>((ni=ni||{})[ni.NONE=0]="NONE",ni[ni.HTML=1]="HTML",ni[ni.STYLE=2]="STYLE",ni[ni.SCRIPT=3]="SCRIPT",ni[ni.URL=4]="URL",ni[ni.RESOURCE_URL=5]="RESOURCE_URL",ni))();function nf(n){const e=function(){const n=jt();return n&&n[12]}();return e?e.sanitize(ni.URL,n)||"":ia(n,"URL")?Gs(n):Bo(Dt(n))}const K_="__ngContext__";function Is(n,e){n[K_]=e}function X_(n){const e=function(n){return n[K_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Gp(n){return n.ngOriginalError}function VA(n,...e){n.error(...e)}class oa{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||VA}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Gp(e)):null}_findOriginalError(e){let t=e&&Gp(e);for(;t&&Gp(t);)t=Gp(t);return t||null}}const cw=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Qn))();function dl(n){return n instanceof Function?n():n}var jo=(()=>((jo=jo||{})[jo.Important=1]="Important",jo[jo.DashCase=2]="DashCase",jo))();function ty(n,e){return undefined(n,e)}function of(n){const e=n[3];return Zo(e)?e[3]:e}function Yd(n){return pw(n[13])}function iy(n){return pw(n[4])}function pw(n){for(;null!==n&&!Zo(n);)n=n[4];return n}function Kd(n,e,t,i,r){if(null!=i){let s,o=!1;Zo(i)?s=i:Qo(i)&&(o=!0,i=i[0]);const a=xr(i);0===n&&null!==t?null==r?bw(e,t,a):hl(e,t,a,r||null,!0):1===n&&null!==t?hl(e,t,a,r||null,!0):2===n?function(n,e,t){const i=qp(n,e);i&&function(n,e,t,i){pr(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==xr(t)&&Kd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Xd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function sy(n,e,t){return pr(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function mw(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,mp(r,-1)),t.splice(i,1)}function oy(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&mw(r,i),e>0&&(n[t-1][4]=i[4]);const s=Ul(n,10+e);!function(n,e){Xd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function ay(n,e){if(!(256&e[2])){const t=e[11];pr(t)&&t.destroyNode&&Xd(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return Wp(n[1],n);for(;e;){let t=null;if(Qo(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Qo(e)&&Wp(e[1],e),e=e[3];null===e&&(e=n),Qo(e)&&Wp(e[1],e),t=e&&e[4]}e=t}}(e)}}function Wp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof $h)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):xr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&pr(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Zo(e[3])){t!==e[3]&&mw(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function _w(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Yt.None||r===Yt.Emulated)return null}return Zs(i,t)}(n,e.parent,t)}function hl(n,e,t,i,r){pr(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function bw(n,e,t){pr(n)?n.appendChild(e,t):e.appendChild(t)}function vw(n,e,t,i,r){null!==i?hl(n,e,t,i,r):bw(n,e,t)}function qp(n,e){return pr(n)?n.parentNode(e):e.parentNode}function ww(n,e,t){return Sw(n,e,t)}let Sw=function(n,e,t){return 40&n.type?Zs(n,t):null};function Yp(n,e,t,i){const r=_w(n,i,e),s=e[11],a=ww(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)vw(s,r,t[l],a,!1);else vw(s,r,t,a,!1)}function Ru(n,e){if(null!==e){const t=e.type;if(3&t)return Zs(e,n);if(4&t)return Kp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Ru(n,i);{const r=n[e.index];return Zo(r)?Kp(-1,r):xr(r)}}if(32&t)return ty(e,n)()||xr(n[e.index]);{const i=Cw(n,e);return null!==i?Array.isArray(i)?i[0]:Ru(of(n[16]),i):Ru(n,e.next)}}return null}function Cw(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Kp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Ru(i,r)}return e[7]}function af(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Is(xr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)af(n,e,t.child,i,r,s,!1),Kd(e,n,r,a,s);else if(32&l){const c=ty(t,i);let u;for(;u=c();)Kd(e,n,r,u,s);Kd(e,n,r,a,s)}else 16&l?uy(n,e,i,t,r,s):Kd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Xd(n,e,t,i,r,s){af(t,i,n.firstChild,e,r,s,!1)}function uy(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Kd(e,n,r,l[c],s);else af(n,e,l,o[3],r,s,!0)}function Mw(n,e,t){pr(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function dy(n,e,t){pr(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function lf(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const Dw="ng-template";function dT(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==lf(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Xp(n){return 4===n.type&&n.value!==Dw}function Iw(n,e,t){return e===(4!==n.type||t?n.value:Dw)}function hT(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(Cv(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Iw(n,l,t)||""===l&&1===e.length){if(Fa(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!dT(n.attrs,c,t)){if(Fa(i))return!1;o=!0}continue}const h=fT(8&i?"class":l,r,Xp(n),t);if(-1===h){if(Fa(i))return!1;o=!0;continue}if(""!==c){let p;p=h>s?"":r[h+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==lf(g,c,0)||2&i&&c!==p){if(Fa(i))return!1;o=!0}}}}else{if(!o&&!Fa(i)&&!Fa(l))return!1;if(o&&Fa(l))continue;o=!1,i=l|1&i}}return Fa(i)||o}function Fa(n){return 0==(1&n)}function fT(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Ow(n,e,t=!1){for(let i=0;i<e.length;i++)if(hT(n,e[i],t))return!0;return!1}function _T(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Rw(n,e){return n?":not("+e.trim()+")":e}function yT(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Fa(o)&&(e+=Rw(s,r),r=""),i=o,s=s||!Fa(i);t++}return""!==r&&(e+=Rw(s,r)),e}const In={};function Jt(n){Nw(Ei(),jt(),Js()+n,Vh())}function Nw(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&Ep(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Sp(e,s,0,t)}yo(t)}function fl(n,e){return n<<17|e<<2}function Rn(n){return n>>17&32767}function Ar(n){return 2|n}function Wl(n){return(131068&n)>>2}function pl(n,e){return-131069&n|e<<2}function fy(n){return 1|n}function zw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];y_(r),o.contentQueries(2,e[s],s)}}}function uf(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,p_(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function Zd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=g_(),o=Hr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Bn.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Bn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return il(s,!0),s}function Jd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function df(n,e,t){Hh(e);try{const i=n.viewQuery;null!==i&&Dy(1,i,t);const r=n.template;null!==r&&Hw(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&zw(n,e),n.staticViewQueries&&Dy(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)KT(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,fi()}}function eh(n,e,t,i){const r=e[2];if(256==(256&r))return;Hh(e);const s=Vh();try{p_(e),function(n){Bn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Hw(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&Ep(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Sp(e,c,0,null),b_(e,0)}if(function(n){for(let e=Yd(n);null!==e;e=iy(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&mp(s,1),r[2]|=1024}}}(e),function(n){for(let e=Yd(n);null!==e;e=iy(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];Dd(i)&&eh(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&zw(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&Ep(e,c)}else{const c=n.contentHooks;null!==c&&Sp(e,c,1),b_(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)yo(~r);else{const s=r,o=t[++i],a=t[++i];Id(o,s),a(2,e[s])}}}finally{yo(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)qT(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Dy(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&Ep(e,c)}else{const c=n.viewHooks;null!==c&&Sp(e,c,2),b_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,mp(e[3],-1))}finally{fi()}}function OT(n,e,t,i){const r=e[10],s=!Vh(),o=jl(e);try{s&&!o&&r.begin&&r.begin(),o&&df(n,e,i),eh(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function Hw(n,e,t,i,r){const s=Js(),o=2&i;try{yo(-1),o&&e.length>20&&Nw(n,e,20,Vh()),t(i,r)}finally{yo(s)}}function hf(n,e,t){!wv()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||Hs(t,e),Is(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Ta(l);c&&zT(e,t,l);const u=Fd(e,n,a,t);Is(u,e),null!==o&&HT(0,a-r,u,l,0,o),c&&(zs(t.index,e)[8]=u)}}(n,e,t,Zs(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Bn.lFrame.currentDirectiveIndex;try{yo(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];m_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Jw(c,u)}}finally{yo(-1),m_(a)}}(n,e,t))}function vy(n,e,t=Zs){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function eg(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=tg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function tg(n,e,t,i,r,s,o,a,l,c){const u=20+i,h=u+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:In);return t}(u,h),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function Ww(n,e,t,i){const r=iE(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&ig(n).push(i,r.length-1))}function qw(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Vo(n,e,t,i,r,s,o,a){const l=Zs(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(rE(n,t,u,i,r),Ad(e)&&function(n,e){const t=zs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,pr(s)?s.setProperty(l,i,r):w_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function wy(n,e,t,i){let r=!1;if(wv()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];Ow(t,o.selectors,!1)&&(r||(r=[]),Mc(Hs(t,e),n,o.type),Ta(o)?(eE(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,Ey(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Jd(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Wh(t.mergedAttrs,h.hostAttrs),Sy(n,t,e,c,h),UT(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const p=h.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,p=null===s||Xp(e)?null:GT(h,s);o.push(p),a=qw(h,c,a),l=qw(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Ze("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Wh(t.mergedAttrs,t.attrs),r}function Zw(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function Jw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function eE(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function UT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Ta(e)&&(t[""]=n)}}function Ey(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Sy(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Ac(r.type)),o=new $h(s,Ta(r),null);n.blueprint[i]=o,t[i]=o,Zw(n,e,0,i,Jd(n,t,r.hostVars,In),r)}function zT(n,e,t){const i=Zs(e,n),r=eg(t),s=n[10],o=ng(n,uf(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function ml(n,e,t,i,r,s){const o=Zs(n,e);!function(n,e,t,i,r,s,o){if(null==s)pr(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Dt(s):o(s,i||"",r);pr(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function HT(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function GT(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function tE(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function qT(n,e){const t=zs(e,n);if(Dd(t)){const i=t[1];80&t[2]?eh(i,t,i.template,t[8]):t[5]>0&&Cy(t)}}function Cy(n){for(let i=Yd(n);null!==i;i=iy(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];eh(o,s,o.template,s[8])}else s[5]>0&&Cy(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=zs(t[i],n);Dd(r)&&r[5]>0&&Cy(r)}}function KT(n,e){const t=zs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),df(i,t,t[8])}function ng(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Ay(n){for(;n;){n[2]|=64;const e=of(n);if(mv(n)&&!e)return n;n=e}return null}function My(n,e,t){const i=e[10];i.begin&&i.begin();try{eh(n,e,n.template,t)}catch(r){throw Oy(e,r),r}finally{i.end&&i.end()}}function nE(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=X_(t),r=i[1];OT(r,i,r.template,t)}}(n[8])}function Dy(n,e,t){y_(0),e(n,t)}const eM=(()=>Promise.resolve(null))();function iE(n){return n[7]||(n[7]=[])}function ig(n){return n.cleanup||(n.cleanup=[])}function Iy(n,e,t){return(null===n||Ta(n))&&(t=function(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(t[e.index])),t[11]}function Oy(n,e){const t=n[9],i=t?t.get(oa,null):null;i&&i.handleError(e)}function rE(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function ql(n,e,t){const i=Lh(e,n);!function(n,e,t){pr(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function rg(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=lt(r,a):2==s&&(i=lt(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Nu=new Ht("INJECTOR",-1);class io{get(e,t=Au){if(t===Au){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const Pu=new Ht("Set Injector scope."),ff={},nM={};let Ny;function sE(){return void 0===Ny&&(Ny=new io),Ny}function oE(n,e=null,t=null,i){return new Fy(n,t,e||sE(),i)}class Fy{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&na(t,a=>this.processProvider(a,e,t)),na([e],a=>this.processInjectorType(a,[],s)),this.records.set(Nu,Fu(void 0,this));const o=this.records.get(Pu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Au,i=wn.Default){this.assertNotDestroyed();const r=Vd(this),s=xa(void 0);try{if(!(i&wn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ht}(e)&&yn(e);a=l&&this.injectableDefInScope(l)?Fu(ky(e),ff):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&wn.Self?sE():this.parent).get(e,t=i&wn.Optional&&t===Au?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Rc]=o[Rc]||[]).unshift(rt(e)),r)throw o;return eo(o,e,"R3InjectorError",this.source)}throw o}finally{xa(s),Vd(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=be(e)))return!1;let r=Pl(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Pl(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{na(r.imports,h=>{this.processInjectorType(h,t,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:p,providers:g}=u[h];na(g,m=>this.processProvider(m,p,g||ir))}}this.injectorDefTypes.add(o);const l=Ac(o)||(()=>new o);this.records.set(o,Fu(l,ff));const c=r.providers;if(null!=c&&!a){const u=e;na(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=jc(e=be(e))?e:be(e&&e.provide);const s=function(n,e,t){return lE(n)?Fu(void 0,n.useValue):Fu(aE(n),ff)}(e);if(jc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Fu(void 0,ff,!0),o.factory=()=>Mu(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===ff&&(t.value=nM,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=be(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function ky(n){const e=yn(n),t=null!==e?e.factory:Ac(n);if(null!==t)return t;if(n instanceof Ht)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=Ic(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[po]||n[js]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function aE(n,e,t){let i;if(jc(n)){const r=be(n);return Ac(r)||ky(r)}if(lE(n))i=()=>be(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Mu(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Oe(be(n.useExisting));else{const r=be(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return Ac(r)||ky(r);i=()=>new r(...Mu(n.deps))}return i}function Fu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function lE(n){return null!==n&&"object"==typeof n&&Np in n}function jc(n){return"function"==typeof n}const cE=function(n,e,t){return function(n,e=null,t=null,i){const r=oE(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class Wn{static create(e,t){return Array.isArray(e)?cE(e,t,""):cE(e.providers,e.parent,e.name||"")}}function Zq(n,e){wp(X_(n)[1],cs())}function xn(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Ta(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=mM(n.inputs),o.declaredInputs=mM(n.declaredInputs),o.outputs=mM(n.outputs);const a=r.hostBindings;a&&nY(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&eY(n,l),c&&tY(n,c),el(n.inputs,r.inputs),el(n.declaredInputs,r.declaredInputs),el(n.outputs,r.outputs),Ta(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===xn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Wh(r.hostAttrs,t=Wh(t,r.hostAttrs))}}(i)}function mM(n){return n===Ed?{}:n===ir?[]:n}function eY(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function tY(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function nY(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}Wn.THROW_IF_NOT_FOUND=Au,Wn.NULL=new io,Wn.\u0275prov=We({token:Wn,providedIn:"any",factory:()=>Oe(Nu)}),Wn.__NG_ELEMENT_ID__=-1;let pE=null;function sg(){if(!pE){const n=Qn.Symbol;if(n&&n.iterator)pE=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(pE=i)}}}return pE}class Kl{constructor(e){this.wrapped=e}static wrap(e){return new Kl(e)}static unwrap(e){return Kl.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Kl}}function Uy(n){return!!_M(n)&&(Array.isArray(n)||!(n instanceof Map)&&sg()in n)}function _M(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Eo(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function ji(n,e,t,i){const r=jt();return Eo(r,Ia(),e)&&(Ei(),ml(kr(),r,n,e,t,i)),ji}function ag(n,e,t,i){return Eo(n,Ia(),t)?e+Dt(t)+i:In}function Di(n,e,t,i,r,s,o,a){const l=jt(),c=Ei(),u=n+20,h=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Zd(e,n,4,o||null,Da(c,a));wy(e,t,u,Da(c,l)),wp(e,u);const h=u.tViews=tg(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];il(h,!1);const p=l[11].createComment("");Yp(c,l,p,h),Is(p,l),ng(l,l[u]=tE(p,l,p,h)),Td(h)&&hf(c,l,h),null!=o&&vy(l,h,a)}function xe(n,e=wn.Default){const t=jt();return null===t?Oe(n,e):Yh(cs(),t,be(n),e)}function rn(n,e,t){const i=jt();return Eo(i,Ia(),e)&&Vo(Ei(),kr(),i,n,e,i[11],t,!1),rn}function EM(n,e,t,i,r){const o=r?"class":"style";rE(n,t,e.inputs[o],o,i)}function kt(n,e,t,i){const r=jt(),s=Ei(),o=20+n,a=r[11],l=r[o]=sy(a,e,Bn.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Zd(e,n,2,r,Da(a,s));return wy(e,t,c,Da(a,o)),null!==c.attrs&&rg(c,c.attrs,!1),null!==c.mergedAttrs&&rg(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];il(c,!0);const u=c.mergedAttrs;null!==u&&xp(a,l,u);const h=c.classes;null!==h&&dy(a,l,h);const p=c.styles;null!==p&&Mw(a,l,p),64!=(64&c.flags)&&Yp(s,r,l,c),0===Bn.lFrame.elementDepthCount&&Is(l,r),Bn.lFrame.elementDepthCount++,Td(c)&&(hf(s,r,c),function(n,e,t){if(o_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&vy(r,c)}function Lt(){let n=cs();Hr()?ms():(n=n.parent,il(n,!1));const e=n;Bn.lFrame.elementDepthCount--;const t=Ei();t.firstCreatePass&&(wp(t,n),o_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&EM(t,e,jt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&EM(t,e,jt(),e.stylesWithoutHost,!1)}function bi(n,e,t,i){kt(n,e,t,i),Lt()}function yg(n){return!!n&&"function"==typeof n.then}function Ok(n){return!!n&&"function"==typeof n.subscribe}const yE=Ok;function Un(n,e,t,i){const r=jt(),s=Ei(),o=cs();return Rk(s,r,r[11],o,n,e,!!t,i),Un}function bE(n,e){const t=cs(),i=jt(),r=Ei();return Rk(r,i,Iy(__(r.data),t,i),t,n,e,!1),bE}function Rk(n,e,t,i,r,s,o,a){const l=Td(i),u=n.firstCreatePass&&ig(n),h=e[8],p=iE(e);let g=!0;if(3&i.type||a){const C=Zs(i,e),H=a?a(C):C,U=p.length,de=a?Ae=>a(xr(Ae[i.index])):i.index;if(pr(t)){let Ae=null;if(!a&&l&&(Ae=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Ae)(Ae.__ngLastListenerFn__||Ae).__ngNextListenerFn__=s,Ae.__ngLastListenerFn__=s,g=!1;else{s=SM(i,e,h,s,!1);const Pe=t.listen(H,r,s);p.push(s,Pe),u&&u.push(r,de,U,U+1)}}else s=SM(i,e,h,s,!0),H.addEventListener(r,s,o),p.push(s),u&&u.push(r,de,U,o)}else s=SM(i,e,h,s,!1);const m=i.outputs;let w;if(g&&null!==m&&(w=m[r])){const C=w.length;if(C)for(let H=0;H<C;H+=2){const Be=e[w[H]][w[H+1]].subscribe(s),et=p.length;p.push(s,Be),u&&u.push(r,i.index,et,-(et+1))}}}function Nk(n,e,t,i){try{return!1!==t(i)}catch(r){return Oy(n,r),!1}}function SM(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?zs(n.index,e):e;0==(32&e[2])&&Ay(a);let l=Nk(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=Nk(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function ci(n=1){return function(n){return(Bn.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Bn.lFrame.contextLView))[8]}(n)}function kY(n,e){let t=null;const i=function(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?Ow(n,s,!0):_T(i,s))return r}else t=r}return t}function ns(n){const e=jt()[16][6];if(!e.projection){const i=e.projection=Ic(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?kY(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function si(n,e=0,t){const i=jt(),r=Ei(),s=Zd(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),ms(),64!=(64&s.flags)&&function(n,e,t){uy(e[11],0,e,t,_w(n,t,e),ww(t.parent||e[6],t,e))}(r,i,s)}function vE(n,e,t){return xM(n,"",e,"",t),vE}function xM(n,e,t,i,r){const s=jt(),o=ag(s,e,t,i);return o!==In&&Vo(Ei(),kr(),s,n,o,s[11],r,!1),xM}function zk(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Rn(s):Wl(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];jY(n[a],e)&&(l=!0,n[a+1]=i?fy(u):Ar(u)),a=i?Rn(u):Wl(u)}l&&(n[t+1]=i?Ar(s):fy(s))}function jY(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Ds(n,e)>=0}const Rs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Hk(n){return n.substring(Rs.key,Rs.keyEnd)}function Gk(n,e){const t=Rs.textEnd;return t===e?-1:(e=Rs.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Rs.key=e,t),bg(n,e,t))}function bg(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Hy(n,e,t){return Zl(n,e,t,!1),Hy}function vi(n,e){return Zl(n,e,null,!0),vi}function Ql(n){!function(n,e,t,i){const r=Ei(),s=No(2);r.firstUpdatePass&&Xk(r,null,s,i);const o=jt();if(t!==In&&Eo(o,s,t)){const a=r.data[Js()];if(eL(a,i)&&!Kk(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=lt(l,t||"")),EM(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===In&&(r=ir);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let w,m=null;u===h?(l+=2,c+=2,p!==g&&(m=h,w=g)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,w=g),null!==m&&Zk(n,e,t,i,m,w,o,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return ir;const i=[],r=Gs(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(ko,Hc,n,!0)}function Hc(n,e){for(let t=function(n){return function(n){Rs.key=0,Rs.keyEnd=0,Rs.value=0,Rs.valueEnd=0,Rs.textEnd=n.length}(n),Gk(n,bg(n,0,Rs.textEnd))}(e);t>=0;t=Gk(e,t))ko(n,Hk(e),!0)}function Zl(n,e,t,i){const r=jt(),s=Ei(),o=No(2);s.firstUpdatePass&&Xk(s,n,o,i),e!==In&&Eo(r,o,e)&&Zk(s,s.data[Js()],r,r[11],n,r[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=rt(Gs(n)))),n}(e,t),i,o)}function Kk(n,e){return e>=n.expandoStartIndex}function Xk(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Js()],o=Kk(n,t);eL(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=__(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Gy(t=CM(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=CM(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Wl(i))return n[Rn(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=CM(null,n,e,l[1],i),l=Gy(l,e.attrs,i),function(n,e,t,i){n[Rn(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Gy(i,n[s].hostAttrs,t);return Gy(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Rn(o),l=Wl(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Ds(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const p=Rn(n[a+1]);n[i+1]=fl(p,a),0!==p&&(n[p+1]=pl(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=fl(a,0),0!==a&&(n[a+1]=pl(n[a+1],i)),a=i;else n[i+1]=fl(l,0),0===a?a=i:n[l+1]=pl(n[l+1],i),l=i;c&&(n[i+1]=Ar(n[i+1])),zk(n,u,i,!0),zk(n,u,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Ds(s,e)>=0&&(t[i+1]=fy(t[i+1]))}(e,u,n,i,s),o=fl(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function CM(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Gy(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Gy(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ko(n,o,!!t||e[++s]))}return void 0===n?null:n}function Zk(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];wE(function(n){return 1==(1&n)}(c)?Jk(l,e,t,r,Wl(c),o):void 0)||(wE(s)||function(n){return 2==(2&n)}(c)&&(s=Jk(l,null,t,r,a,o)),function(n,e,t,i,r){const s=pr(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:jo.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=jo.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Lh(Js(),t),r,s))}function Jk(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let p=t[r+1];p===In&&(p=h?ir:void 0);let g=h?R_(p,i):u===i?p:void 0;if(c&&!wE(g)&&(g=R_(l,i)),wE(g)&&(a=g,o))return a;const m=n[r+1];r=o?Rn(m):Wl(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=R_(l,i))}return a}function wE(n){return void 0!==n}function eL(n,e){return 0!=(n.flags&(e?16:32))}function $i(n,e=""){const t=jt(),i=Ei(),r=n+20,s=i.firstCreatePass?Zd(i,r,1,e,null):i.data[r],o=t[r]=function(n,e){return pr(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Yp(i,t,o,s),il(s,!1)}function da(n){return ec("",n,""),da}function ec(n,e,t){const i=jt(),r=ag(i,n,e,t);return r!==In&&ql(i,Js(),r),ec}function ku(n,e,t){const i=jt();return Eo(i,Ia(),e)&&Vo(Ei(),kr(),i,n,e,i[11],t,!0),ku}function EE(n,e,t){const i=jt();if(Eo(i,Ia(),e)){const s=Ei(),o=kr();Vo(s,o,i,n,e,Iy(__(s.data),o,i),t,!0)}return EE}const gf=void 0;var bK=["en",[["a","p"],["AM","PM"],gf],[["AM","PM"],gf,gf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],gf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],gf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",gf,"{1} 'at' {0}",gf],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let vg={};function yL(n){return n in vg||(vg[n]=Qn.ng&&Qn.ng.common&&Qn.ng.common.locales&&Qn.ng.common.locales[n]),vg[n]}var ln=(()=>((ln=ln||{})[ln.LocaleId=0]="LocaleId",ln[ln.DayPeriodsFormat=1]="DayPeriodsFormat",ln[ln.DayPeriodsStandalone=2]="DayPeriodsStandalone",ln[ln.DaysFormat=3]="DaysFormat",ln[ln.DaysStandalone=4]="DaysStandalone",ln[ln.MonthsFormat=5]="MonthsFormat",ln[ln.MonthsStandalone=6]="MonthsStandalone",ln[ln.Eras=7]="Eras",ln[ln.FirstDayOfWeek=8]="FirstDayOfWeek",ln[ln.WeekendRange=9]="WeekendRange",ln[ln.DateFormat=10]="DateFormat",ln[ln.TimeFormat=11]="TimeFormat",ln[ln.DateTimeFormat=12]="DateTimeFormat",ln[ln.NumberSymbols=13]="NumberSymbols",ln[ln.NumberFormats=14]="NumberFormats",ln[ln.CurrencyCode=15]="CurrencyCode",ln[ln.CurrencySymbol=16]="CurrencySymbol",ln[ln.CurrencyName=17]="CurrencyName",ln[ln.Currencies=18]="Currencies",ln[ln.Directionality=19]="Directionality",ln[ln.PluralCase=20]="PluralCase",ln[ln.ExtraData=21]="ExtraData",ln))();const SE="en-US";let bL=SE;function TM(n){J(n,"Expected localeId to be defined"),"string"==typeof n&&(bL=n.toLowerCase().replace(/_/g,"-"))}function IM(n,e,t,i,r){if(n=be(n),Array.isArray(n))for(let s=0;s<n.length;s++)IM(n[s],e,t,i,r);else{const s=Ei(),o=jt();let a=jc(n)?n:be(n.provide),l=aE(n);const c=cs(),u=1048575&c.providerIndexes,h=c.directiveStart,p=c.providerIndexes>>20;if(jc(n)||!n.multi){const g=new $h(l,r,xe),m=RM(a,e,r?u:u+p,h);-1===m?(Mc(Hs(c,o),s,a),OM(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)):(t[m]=g,o[m]=g)}else{const g=RM(a,e,u+p,h),m=RM(a,e,u,u+p),w=g>=0&&t[g],C=m>=0&&t[m];if(r&&!C||!r&&!w){Mc(Hs(c,o),s,a);const H=function(n,e,t,i,r){const s=new $h(n,t,xe);return s.multi=[],s.index=e,s.componentProviders=0,HL(s,r,i&&!t),s}(r?mX:gX,t.length,r,i,l);!r&&C&&(t[m].providerFactory=H),OM(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(H),o.push(H)}else OM(s,n,g>-1?g:m,HL(t[r?m:g],l,!r&&i));!r&&i&&C&&t[m].componentProviders++}}}function OM(n,e,t,i){const r=jc(e);if(r||function(n){return!!n.useClass}(e)){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const l=a.indexOf(t);-1===l?a.push(t,[i,o]):a[l+1].push(i,o)}else a.push(t,o)}}}function HL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function RM(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function gX(n,e,t,i){return NM(this.multi,[])}function mX(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Fd(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),NM(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],NM(r,s);return s}function NM(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Hn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function(n,e,t){const i=Ei();if(i.firstCreatePass){const r=Ta(n);IM(t,i.data,i.blueprint,r,!0),IM(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class GL{}const WL="ngComponent";class bX{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[WL]=n,e}(e)}}class bl{}function ME(...n){}function Eg(n,e){return new vn(Zs(n,e))}bl.NULL=new bX;const EX=function(){return Eg(cs(),jt())};let vn=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=EX,n})();function qL(n){return n instanceof vn?n.nativeElement:n}class mf{}let FM=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Bu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const YL=new Bu("12.2.5");class KL{constructor(){}supports(e){return Uy(e)}create(e){return new MX(e)}}const TX=(n,e)=>e;class MX{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||TX}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<QL(i,r,s)?t:i,a=QL(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,m=g+p;u<=m&&m<c&&(s[p]=g+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Uy(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[sg()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new DX(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new XL),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new XL),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class DX{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class IX{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class XL{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new IX,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function QL(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class ZL{constructor(){}supports(e){return e instanceof Map||_M(e)}create(){return new OX}}class OX{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||_M(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new RX(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class RX{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function JL(){return new Sg([new KL])}let Sg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||JL()),deps:[[n,new cl,new ts]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:JL}),n})();function e3(){return new xg([new ZL])}let xg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||e3()),deps:[[n,new cl,new ts]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:e3}),n})();function DE(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(xr(s)),Zo(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&DE(l[1],l,c,i)}const o=t.type;if(8&o)DE(n,e,t.child,i);else if(32&o){const a=ty(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Cw(e,t);if(Array.isArray(a))i.push(...a);else{const l=of(e[16]);DE(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class Ky{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return DE(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Zo(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(oy(e,i),Ul(t,i))}this._attachedToViewContainer=!1}ay(this._lView[1],this._lView)}onDestroy(e){Ww(this._lView[1],this._lView,null,e)}markForCheck(){Ay(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){My(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){yp(!0);try{My(n,e,t)}finally{yp(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Xd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class PX extends Ky{constructor(e){super(e),this._view=e}detectChanges(){nE(this._view)}checkNoChanges(){!function(n){yp(!0);try{nE(n)}finally{yp(!1)}}(this._view)}get context(){return null}}const kX=function(n){return function(n,e,t){if(Ad(n)&&!t){const i=zs(n.index,e);return new Ky(i,i)}return 47&n.type?new Ky(e[16],e):null}(cs(),jt(),16==(16&n))};let Dr=(()=>{class n{}return n.__NG_ELEMENT_ID__=kX,n})();const jX=[new ZL],UX=new Sg([new KL]),zX=new xg(jX),GX=function(){return IE(cs(),jt())};let zo=(()=>{class n{}return n.__NG_ELEMENT_ID__=GX,n})();const $X=zo,WX=class extends $X{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=uf(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),df(t,i,e),new Ky(i)}};function IE(n,e){return 4&n.type?new WX(e,n,Eg(n,e)):null}class Gc{}const KX=function(){return s3(cs(),jt())};let Ns=(()=>{class n{}return n.__NG_ELEMENT_ID__=KX,n})();const QX=Ns,n3=class extends QX{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Eg(this._hostTNode,this._hostLView)}get injector(){return new ea(this._hostTNode,this._hostLView)}get parentInjector(){const e=qh(this._hostTNode,this._hostLView);if(Av(e)){const t=sl(e,this._hostLView),i=Rd(e);return new ea(t[1].data[i+8],t)}return new ea(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=r3(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Gc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return Zo(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],p=new n3(h,h[6],h[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Qh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Kp(s,o),l=i[11],c=qp(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Xd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Qh(kM(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=r3(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=oy(this._lContainer,t);i&&(Ul(kM(this._lContainer),t),ay(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=oy(this._lContainer,t);return i&&null!=Ul(kM(this._lContainer),t)?new Ky(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function r3(n){return n[8]}function kM(n){return n[8]||(n[8]=[])}function s3(n,e){let t;const i=e[n.index];if(Zo(i))t=i;else{let r;if(8&n.type)r=xr(i);else{const s=e[11];r=s.createComment("");const o=Zs(n,e);hl(s,qp(s,o),r,function(n,e){return pr(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=tE(i,e,r,n),ng(e,t)}return new n3(t,n,e)}const Mg={};class C3 extends bl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ui(e);return new T3(t,this.ngModule)}}function A3(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const qQ=new Ht("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>cw});class T3 extends GL{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(yT).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return A3(this.componentDef.inputs)}get outputs(){return A3(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,Mg,r);return s!==Mg||i===Mg?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(mf,yu),a=s.get(FM,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function(n,e,t){if(pr(n))return n.selectRootElement(e,t===Yt.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):sy(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),h=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||cw,clean:eM,playerHandler:e||null,flags:0}}(),g=tg(0,null,null,1,0,null,null,null,null,null),m=uf(null,g,p,h,null,null,o,l,a,s);let w,C;Hh(m);try{const H=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Zd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(rg(l,c,!0),null!==n&&(xp(r,n,c),null!==l.classes&&dy(r,n,l.classes),null!==l.styles&&Mw(r,n,l.styles)));const u=i.createRenderer(n,e),h=uf(t,eg(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(Mc(Hs(l,t),o,e.type),eE(o,l),Ey(l,t.length,1)),ng(t,h),t[20]=h}(u,this.componentDef,m,o,l);if(u)if(i)xp(l,u,["ng-version",YL.full]);else{const{attrs:U,classes:de}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Fa(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);U&&xp(l,u,U),de&&de.length>0&&dy(l,u,de.join(" "))}if(C=f_(g,20),void 0!==t){const U=C.projection=[];for(let de=0;de<this.ngContentSelectors.length;de++){const Ae=t[de];U.push(null!=Ae?Array.from(Ae):null)}}w=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=cs();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),Sy(n,i,e,Jd(n,e,1,null),t));const r=Fd(e,n,i.directiveStart,i);Is(r,e);const s=Zs(i,e);return s&&Is(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=cs();e.contentQueries(1,o,l.directiveStart)}const a=cs();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(yo(a.index),Zw(t[1],a,0,a.directiveStart,a.directiveEnd,e),Jw(e,o)),o}(H,this.componentDef,m,p,[Zq]),df(g,m,null)}finally{fi()}return new XQ(this.componentType,w,Eg(C,m),m,C)}}class XQ extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new PX(r),this.componentType=e}get injector(){return new ea(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Dg=new Map;class JQ extends Gc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new C3(this);const i=Oo(e),r=function(n){return n[P1]||null}(e);r&&TM(r),this._bootstrapComponents=dl(i.bootstrap),this._r3Injector=oE(e,t,[{provide:Gc,useValue:this},{provide:bl,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Wn.THROW_IF_NOT_FOUND,i=wn.Default){return e===Wn||e===Gc||e===Nu?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class KM extends class{}{constructor(e){super(),this.moduleType=e,null!==Oo(e)&&function(n){const e=new Set;!function t(i){const r=Oo(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,Dg.get(s),i),Dg.set(s,i));const o=dl(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new JQ(this.moduleType,e)}}function O3(n,e,t,i,r,s){const o=e+t;return Eo(n,o,r)?function(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===In?void 0:t}(n,o+1)}function ju(n,e){const t=Ei();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Ze("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Ac(i.type)),o=xa(xe);try{const a=Cp(!1),l=s();return Cp(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,jt(),r,l),l}finally{xa(o)}}function Vu(n,e,t){const i=n+20,r=jt(),s=function(n,e){return n[e]}(r,i);return function(n,e){Kl.isWrapped(e)&&(e=Kl.unwrap(e),n[Bn.lFrame.bindingIndex]=In);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?O3(r,function(){const n=Bn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t))}function XM(n){return e=>{setTimeout(n,void 0,e)}}const sn=class extends se{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=XM(l),a&&(a=XM(a)),c&&(c=XM(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof x&&e.add(u),u}};function gZ(){return this._results[sg()]()}class bf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=sg(),i=bf.prototype;i[t]||(i[t]=gZ)}get changes(){return this._changes||(this._changes=new sn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=ta(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class QM{constructor(e){this.queryList=e,this.matches=null}clone(){return new QM(this.queryList)}setDirty(){this.queryList.setDirty()}}class ZM{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new ZM(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==V3(e,t).matches&&this.queries[t].setDirty()}}class k3{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class JM{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new JM(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class eD{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new eD(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,yZ(t,s)),this.matchTNodeWithReadOption(e,t,Pd(t,e,s,!1,!1))}else i===zo?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Pd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===vn||r===Ns||r===zo&&4&t.type)this.addMatch(t.index,-2);else{const s=Pd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function yZ(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function vZ(n,e,t,i){return-1===t?function(n,e){return 11&n.type?Eg(n,e):4&n.type?IE(n,e):null}(e,n):-2===t?function(n,e,t){return t===vn?Eg(e,n):t===zo?IE(e,n):t===Ns?s3(e,n):void 0}(n,e,i):Fd(n,n[1],t,e)}function L3(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:vZ(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function tD(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=L3(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const p=u[h];p[17]===p[3]&&tD(p[1],p,c,i)}if(null!==u[9]){const h=u[9];for(let p=0;p<h.length;p++){const g=h[p];tD(g[1],g,c,i)}}}}}return i}function ii(n){const e=jt(),t=Ei(),i=Ev();y_(i+1);const r=V3(t,i);if(n.dirty&&jl(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?tD(t,e,i,[]):L3(t,e,r,i);n.reset(s,qL),n.notifyOnChanges()}return!0}return!1}function rs(n,e,t){const i=Ei();i.firstCreatePass&&(j3(i,new k3(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),B3(i,jt(),e)}function ri(){return function(n,e){return n[19].queries[e].queryList}(jt(),Ev())}function B3(n,e,t){const i=new bf(4==(4&t));Ww(n,e,i,i.destroy),null===e[19]&&(e[19]=new ZM),e[19].queries.push(new QM(i))}function j3(n,e,t){null===n.queries&&(n.queries=new JM),n.queries.track(new eD(e,t))}function V3(n,e){return n.queries.getByIndex(e)}const vf=new Ht("Application Initializer");let Og=(()=>{class n{constructor(t){this.appInits=t,this.resolve=ME,this.reject=ME,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(yg(s))t.push(s);else if(yE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Oe(vf,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const l0=new Ht("AppId"),QZ={provide:l0,useFactory:function(){return`${aD()}${aD()}${aD()}`},deps:[]};function aD(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const rB=new Ht("Platform Initializer"),$c=new Ht("Platform ID"),LE=new Ht("appBootstrapListener");let BE=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Uu=new Ht("LocaleId"),sB=new Ht("DefaultCurrencyCode");class JZ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const lD=function(n){return new KM(n)},eJ=lD,tJ=function(n){return Promise.resolve(lD(n))},oB=function(n){const e=lD(n),i=dl(Oo(n).declarations).reduce((r,s)=>{const o=Ui(s);return o&&r.push(new T3(o)),r},[]);return new JZ(e,i)},nJ=oB,iJ=function(n){return Promise.resolve(oB(n))};let wf=(()=>{class n{constructor(){this.compileModuleSync=eJ,this.compileModuleAsync=tJ,this.compileModuleAndAllComponentsSync=nJ,this.compileModuleAndAllComponentsAsync=iJ}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const aB=new Ht("compilerOptions"),sJ=(()=>Promise.resolve(0))();function cD(n){"undefined"==typeof Zone?sJ.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class fn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new sn(!1),this.onMicrotaskEmpty=new sn(!1),this.onStable=new sn(!1),this.onError=new sn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=Qn.requestAnimationFrame,e=Qn.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Qn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,dD(n),n.isCheckStableRunning=!0,uD(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),dD(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return lB(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),cB(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return lB(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),cB(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,dD(n),uD(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!fn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(fn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,aJ,ME,ME);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const aJ={};function uD(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function dD(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function lB(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function cB(n){n._nesting--,uD(n)}class uJ{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new sn,this.onMicrotaskEmpty=new sn,this.onStable=new sn,this.onError=new sn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let hD=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{fn.assertNotInAngularZone(),cD(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())cD(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Oe(fn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),uB=(()=>{class n{constructor(){this._applications=new Map,fD.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return fD.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class dJ{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let fD=new dJ,dB=!0,hB=!1;function La(){return hB=!0,dB}let ic;const fB=new Ht("AllowMultipleToken");function pB(n,e,t=[]){const i=`Platform: ${e}`,r=new Ht(i);return(s=[])=>{let o=gD();if(!o||o.injector.get(fB,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Pu,useValue:"platform"});!function(n){if(ic&&!ic.destroyed&&!ic.injector.get(fB,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");ic=n.get(gB);const e=n.get(rB,null);e&&e.forEach(t=>t())}(Wn.create({providers:a,name:i}))}return function(n){const e=gD();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function gD(){return ic&&!ic.destroyed?ic:null}let gB=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new uJ:("zone.js"===n?void 0:n)||new fn({enableLongStackTrace:La(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:fn,useValue:a}];return a.run(()=>{const c=Wn.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(oa,null);if(!h)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{h.handleError(g)}});u.onDestroy(()=>{mD(this._modules,u),p.unsubscribe()})}),function(n,e,t){try{const i=t();return yg(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,a,()=>{const p=u.injector.get(Og);return p.runInitializers(),p.donePromise.then(()=>(TM(u.injector.get(Uu,SE)||SE),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=mB({},i);return function(n,e,t){const i=new KM(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(ih);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Oe(Wn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function mB(n,e){return Array.isArray(e)?e.reduce(mB,n):Object.assign(Object.assign({},n),e)}let ih=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new I(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new I(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{fn.assertNotInAngularZone(),cD(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{fn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=kn(a,l.pipe(Es()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof GL?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Gc),a=r.create(Wn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(hD,null),u=c&&a.injector.get(uB);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),mD(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;mD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(LE,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Oe(fn),Oe(Wn),Oe(oa),Oe(bl),Oe(Og))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function mD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const BJ=pB(null,"core",[{provide:$c,useValue:"unknown"},{provide:gB,deps:[Wn]},{provide:uB,deps:[]},{provide:BE,deps:[]}]),HJ=[{provide:ih,useClass:ih,deps:[fn,Wn,oa,bl,Og]},{provide:qQ,deps:[fn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Og,useClass:Og,deps:[[new ts,vf]]},{provide:wf,useClass:wf,deps:[]},QZ,{provide:Sg,useFactory:function(){return UX},deps:[]},{provide:xg,useFactory:function(){return zX},deps:[]},{provide:Uu,useFactory:function(n){return TM(n=n||"undefined"!=typeof $localize&&$localize.locale||SE),n},deps:[[new zd(Uu),new ts,new cl]]},{provide:sB,useValue:"USD"}];let $J=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Oe(ih))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:HJ}),n})(),KE=null;function Wc(){return KE}const hn=new Ht("DocumentToken");let xf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:Gee,token:n,providedIn:"platform"}),n})();function Gee(){return Oe(GB)}let GB=(()=>{class n extends xf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Wc().getBaseHref(this._doc)}onPopState(t){const i=Wc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Wc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){$B()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){$B()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({factory:Wee,token:n,providedIn:"platform"}),n})();function $B(){return!!window.history.pushState}function Wee(){return new GB(Oe(hn))}function OD(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function WB(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Hu(n){return n&&"?"!==n[0]?"?"+n:n}let Cf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:qee,token:n,providedIn:"root"}),n})();function qee(n){const e=Oe(hn).location;return new qB(Oe(xf),e&&e.origin||"")}const RD=new Ht("appBaseHref");let qB=(()=>{class n extends Cf{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return OD(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Hu(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Hu(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Hu(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(xf),Oe(RD,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Pg=(()=>{class n{constructor(t,i){this._subject=new sn,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=WB(YB(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Hu(i))}normalize(t){return n.stripTrailingSlash(function(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,YB(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._platformStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Hu(i)),r)}replaceState(t,i="",r=null){this._platformStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Hu(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.\u0275fac=function(t){return new(t||n)(Oe(Cf),Oe(xf))},n.normalizeQueryParams=Hu,n.joinWithSlash=OD,n.stripTrailingSlash=WB,n.\u0275prov=We({factory:Kee,token:n,providedIn:"root"}),n})();function Kee(){return new Pg(Oe(Cf),Oe(xf))}function YB(n){return n.replace(/\/index.html$/,"")}var _s=(()=>((_s=_s||{})[_s.Zero=0]="Zero",_s[_s.One=1]="One",_s[_s.Two=2]="Two",_s[_s.Few=3]="Few",_s[_s.Many=4]="Many",_s[_s.Other=5]="Other",_s))();const ite=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=yL(e);if(t)return t;const i=e.split("-")[0];if(t=yL(i),t)return t;if("en"===i)return bK;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[ln.PluralCase]};class sS{}let Rte=(()=>{class n extends sS{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(ite(i||this.locale)(t)){case _s.Zero:return"zero";case _s.One:return"one";case _s.Two:return"two";case _s.Few:return"few";case _s.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Oe(Uu))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Pte{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Af=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=[];t.forEachOperation((r,s,o)=>{if(null==r.previousIndex){const a=this._viewContainer.createEmbeddedView(this._template,new Pte(null,this._ngForOf,-1,-1),null===o?void 0:o),l=new rj(r,a);i.push(l)}else if(null==o)this._viewContainer.remove(null===s?void 0:s);else if(null!==s){const a=this._viewContainer.get(s);this._viewContainer.move(a,o);const l=new rj(r,a);i.push(l)}});for(let r=0;r<i.length;r++)this._perViewChange(i[r].view,i[r].record);for(let r=0,s=this._viewContainer.length;r<s;r++){const o=this._viewContainer.get(r);o.context.index=r,o.context.count=s,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{this._viewContainer.get(r.currentIndex).context.$implicit=r.item})}_perViewChange(t,i){t.context.$implicit=i.item}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(xe(Ns),xe(zo),xe(Sg))},n.\u0275dir=Rt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class rj{constructor(e,t){this.record=e,this.view=t}}let ac=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new kte,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){sj("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){sj("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(xe(Ns),xe(zo))},n.\u0275dir=Rt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class kte{constructor(){this.$implicit=null,this.ngIf=null}}function sj(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${rt(e)}'.`)}class Vte{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class Ute{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const zte=new Ute,Hte=new Vte;let m0=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(yg(t))return zte;if(Ok(t))return Hte;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(xe(Dr,16))},n.\u0275pipe=Vs({name:"async",type:n,pure:!1}),n})(),ss=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[{provide:sS,useClass:Rte}]}),n})();const dj="browser";function Tf(n){return n===dj}class $D extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){KE||(KE=n)}(new $D)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(_0=_0||document.querySelector("base"),_0?_0.getAttribute("href"):null);return null==t?null:function(n){aS=aS||document.createElement("a"),aS.setAttribute("href",n);const e=aS.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){_0=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let aS,_0=null;const gj=new Ht("TRANSITION_ID"),pne=[{provide:vf,useFactory:function(n,e,t){return()=>{t.get(Og).donePromise.then(()=>{const i=Wc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[gj,hn,Wn],multi:!0}];class WD{static init(){!function(n){fD=n}(new WD)}addToWindow(e){Qn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Qn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Qn.getAllAngularRootElements=()=>e.getAllRootElements(),Qn.frameworkStabilizers||(Qn.frameworkStabilizers=[]),Qn.frameworkStabilizers.push(i=>{const r=Qn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Wc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let gne=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const y0=new Ht("EventManagerPlugins");let cS=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Oe(y0),Oe(fn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class qD{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Wc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let _j=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),b0=(()=>{class n extends _j{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(yj),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(yj))}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function yj(n){Wc().remove(n)}const YD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},KD=/%COMP%/g;function uS(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?uS(n,r,t):(r=r.replace(KD,n),t.push(r))}return t}function wj(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let dS=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new XD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Yt.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Ine(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Yt.ShadowDom:return new One(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=uS(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Oe(cS),Oe(b0),Oe(l0))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class XD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(YD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=YD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=YD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(jo.DashCase|jo.Important)?e.style.setProperty(t,i,r&jo.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&jo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,wj(i)):this.eventManager.addEventListener(e,t,wj(i))}}class Ine extends XD{constructor(e,t,i,r){super(e),this.component=i;const s=uS(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(KD,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(KD,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class One extends XD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=uS(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Rne=(()=>{class n extends qD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const xj=["alt","control","meta","shift"],jne={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Cj={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Vne={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Une=(()=>{class n extends qD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Wc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(xj.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&Cj.hasOwnProperty(e)&&(e=Cj[e]))}return jne[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),xj.forEach(s=>{s!=r&&Vne[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Mf=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return Oe(ZD)},token:n,providedIn:"root"}),n})(),ZD=(()=>{class n extends Mf{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case ni.NONE:return i;case ni.HTML:return ia(i,"HTML")?Gs(i):W_(this._doc,String(i)).toString();case ni.STYLE:return ia(i,"Style")?Gs(i):i;case ni.SCRIPT:if(ia(i,"Script"))return Gs(i);throw new Error("unsafe value used in a script context");case ni.URL:return kc(i),ia(i,"URL")?Gs(i):Bo(String(i));case ni.RESOURCE_URL:if(ia(i,"ResourceURL"))return Gs(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function(n){return new B_(n)}(t)}bypassSecurityTrustStyle(t){return function(n){return new j_(n)}(t)}bypassSecurityTrustScript(t){return function(n){return new Vp(n)}(t)}bypassSecurityTrustUrl(t){return function(n){return new $d(n)}(t)}bypassSecurityTrustResourceUrl(t){return function(n){return new Fn(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({factory:function(){return function(n){return new ZD(n.get(hn))}(Oe(Nu))},token:n,providedIn:"root"}),n})();const Kne=pB(BJ,"browser",[{provide:$c,useValue:dj},{provide:rB,useValue:function(){$D.makeCurrent(),WD.init()},multi:!0},{provide:hn,useFactory:function(){return function(n){Qi=n}(document),document},deps:[]}]),Xne=[[],{provide:Pu,useValue:"root"},{provide:oa,useFactory:function(){return new oa},deps:[]},{provide:y0,useClass:Rne,multi:!0,deps:[hn,fn,$c]},{provide:y0,useClass:Une,multi:!0,deps:[hn]},[],{provide:dS,useClass:dS,deps:[cS,b0,l0]},{provide:mf,useExisting:dS},{provide:_j,useExisting:b0},{provide:b0,useClass:b0,deps:[hn]},{provide:hD,useClass:hD,deps:[fn]},{provide:cS,useClass:cS,deps:[y0,fn]},{provide:class{},useClass:gne,deps:[]},[]];let JD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:l0,useValue:t.appId},{provide:gj,useExisting:l0},pne]}}}return n.\u0275fac=function(t){return new(t||n)(Oe(n,12))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:Xne,imports:[ss,$J]}),n})();"undefined"!=typeof window&&window;class rie extends x{constructor(e,t){super()}schedule(e,t=0){return this}}class hS extends rie{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let Tj=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class cc extends Tj{constructor(e,t=Tj.now){super(e,()=>cc.delegate&&cc.delegate!==this?cc.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return cc.delegate&&cc.delegate!==this?cc.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const aie=new class extends cc{}(class extends hS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),qc=new I(n=>n.complete());function fS(n){return n?function(n){return new I(e=>n.schedule(()=>e.complete()))}(n):qc}function dn(...n){let e=n[n.length-1];return Ce(e)?(n.pop(),Ne(n,e)):On(n)}function Fg(n,e){return new I(e?t=>e.schedule(cie,0,{error:n,subscriber:t}):t=>t.error(n))}function cie({error:n,subscriber:e}){e.error(n)}class fa{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return dn(this.value);case"E":return Fg(this.error);case"C":return fS()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new fa("N",e):fa.undefinedValueNotification}static createError(e){return new fa("E",void 0,e)}static createComplete(){return fa.completeNotification}}fa.completeNotification=new fa("C"),fa.undefinedValueNotification=new fa("N",void 0);class pS extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(pS.dispatch,this.delay,new die(e,this.destination)))}_next(e){this.scheduleMessage(fa.createNext(e))}_error(e){this.scheduleMessage(fa.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(fa.createComplete()),this.unsubscribe()}}class die{constructor(e,t){this.notification=e,this.destination=t}}class kg extends se{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new hie(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new $;if(this.isStopped||this.hasError?o=x.EMPTY:(this.observers.push(e),o=new Z(this,e)),r&&e.add(e=new pS(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||aie).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class hie{constructor(e,t){this.time=e,this.value=t}}function Ir(n,e){return"function"==typeof e?t=>t.pipe(Ir((i,r)=>je(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new fie(n))}class fie{constructor(e){this.project=e}call(e,t){return t.subscribe(new pie(e,this.project))}}class pie extends ve{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new _t(this),r=this.destination;r.add(i),this.innerSubscription=N(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const gS={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return gS.schedule(n,0);if(void 0===window.requestAnimationFrame)return gS.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let tI;function xie(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!tI){const t=Element.prototype;tI=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&tI.call(n,e)}(n,r)||(i=s,0))),i}class Aie{constructor(e,t){this.componentFactory=t.get(bl).resolveComponentFactory(e)}create(e){return new Tie(this.componentFactory,e)}}class Tie{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new kg(1),this.events=this.eventEmitters.pipe(Ir(i=>kn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(fn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=gS.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=Wn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=xie(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(Dr),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(ih).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(me(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=gS.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new u_(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class Mie extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const Iie={initialConfig:{},parse:{},rename:{}};class Oie{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},Iie),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,u=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(u)try{i[l]=u(c)}catch(h){console.warn(`Failed to parse ${e} = ${c}`,h.message)}else i[l]=c}}let Rie=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new Oie(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=Rt({type:n,features:[zi]}),n})();var nI;const v0={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:null!==(nI=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==nI?nI:""},googleAnalyticsToken:"portal.hubmapconsortium.org"===window.location.hostname?"G-1WRJHN9FM6":"G-J9HWV9QPJ4"};function or(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function Dj(n,e){return function(t,i){e(t,i,n)}}function uc(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function ki(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function Rj(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function rI(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||Rj()}const Nj="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",_S=rI();class kie{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function sI(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const Pj={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Fj(n){return"string"==typeof n?Pj[n.toUpperCase()]||Pj.WHITE:n}function yS(n,e){if(!n)throw new Error(e||"Assertion failed")}const dc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},w0=dc.window||dc.self||dc.global,kj=dc.process||{};function Lg(){let n;if(_S&&w0.performance)n=w0.performance.now();else if(kj.hrtime){const e=kj.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const Bg={debug:_S&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Hie={enabled:!0,level:0};function xl(){}const Lj={},Bj={once:!0};function Gie(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let oI=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=Nj,this._startTs=Lg(),this._deltaTs=Lg(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new kie("__probe-".concat(this.id,"__"),Hie),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Lg()-this._startTs).toPrecision(10))}getDelta(){return Number((Lg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){yS(t,i)}warn(t){return this._getLogFunction(0,t,Bg.warn,arguments,Bj)}error(t){return this._getLogFunction(0,t,Bg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,Bg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,Bg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,Bg.debug||Bg.info,arguments,Bj)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||xl,r&&[r],{tag:Gie(i)}):xl}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?_S?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=sI(r,e,t);console.log(...s)},r.src=n,xl}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...sI(n,e,t)),xl;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...sI(r,e,t)),r.src=n.toDataURL(),xl}return xl}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=Je(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):xl}({image:r,message:s,scale:o}):xl}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||xl)}group(t,i,r={collapsed:!1}){r=Vj({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||xl)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=jj(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=Vj({logLevel:t,message:i,args:s,opts:o}),yS(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Lg();const a=o.tag||o.message;if(o.once){if(Lj[a])return xl;Lj[a]=Lg()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!_S&&"string"==typeof n&&(e&&(e=Fj(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=Fj(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return xl}}return n.VERSION=Nj,n})();function jj(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return yS(Number.isFinite(e)&&e>=0),e}function Vj(n){const{logLevel:e,message:t}=n;n.logLevel=jj(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return yS("string"===r||"object"===r),Object.assign(n,n.opts)}const Oi=new oI({id:"deck"}),Vi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Vi,"IDENTITY",{get:()=>Oi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Yc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Uj={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},pn=new oI({id:"luma.gl"});function $o(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function bS(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function Si(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function vS(n){return $o(bS(n),"Invalid WebGLRenderingContext"),n}function Co(n){return $o(Si(n),"Requires WebGL2"),n}const E0={};const S0=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(S0.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Df=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(E0[i]=!0)}while(0!==i);for(i in E0)if(E0[i])return delete E0[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const h=t.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const p=h.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=u,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Df.prototype.VERTEX_ARRAY_BINDING_OES=34229,Df.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new S0(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Df.prototype.createVertexArrayOES=function(){const e=new S0(this);return this.vertexArrayObjects.push(e),e},Df.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Df.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof S0&&e.hasBeenBound&&e.ext===this)},Df.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){E0[n]=!0,void 0!==e&&function(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let h=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),h=!0),(h||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const zj="OES_element_index",Hj="WEBGL_draw_buffers",Gj="WEBGL_debug_renderer_info",br=n=>Si(n)?void 0:0,dre={3074:n=>Si(n)?void 0:36064,35723:n=>Si(n)?void 0:4352,35977:br,32937:br,36795:(n,e)=>{const t=Si(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(Gj);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(Gj);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:br,35071:br,37447:br,36063:(n,e)=>{if(!Si(n)){const t=n.getExtension(Hj);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:br,35374:br,35377:br,34852:n=>{if(!Si(n)){const e=n.getExtension(Hj);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(zj)?2147483647:65535,33001:n=>n.getExtension(zj)?16777216:65535,33e3:n=>16777216,37157:br,35373:br,35657:br,36183:br,37137:br,34045:br,35978:br,35979:br,35968:br,35376:br,35375:br,35659:br,37154:br,35371:br,35658:br,35076:br,35077:br,35380:br},$j="ANGLE_instanced_arrays",Wj={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{$o(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[$j]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){$o(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{$o(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{$o(!1)},deleteQuery:()=>{$o(!1)},beginQuery:()=>{$o(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},aI={readBuffer:(n,e,t)=>{Si(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:Si(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!Si(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!Si(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=dre[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function Sre(n,{extension:e,target:t,target2:i}){const r=Wj[e];$o(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let u=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?u=(...h)=>a[c](...h):"function"==typeof r[l]&&(u=r[l].bind(t))),u&&(t[l]=u,i[l]=u)}}globalThis.polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Df(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&Sre(n,{extension:t,target:n.luma,target2:n})}(n,Wj),function(n,{target:e,target2:t}){Object.keys(aI).forEach(i=>{if("function"==typeof aI[i]){const r=n[i]?n[i].bind(n):()=>{},s=aI[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const lI={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},oh=(n,e,t)=>e?n.enable(t):n.disable(t),qj=(n,e,t)=>n.hint(t,e),Ba=(n,e,t)=>n.pixelStorei(t,e);function x0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const Are={3042:oh,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:oh,2885:(n,e)=>n.cullFace(e),2929:oh,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:oh,35723:qj,36006:(n,e)=>{const t=Si(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:qj,2849:(n,e)=>n.lineWidth(e),32823:oh,32824:"polygonOffset",10752:"polygonOffset",35977:oh,32938:"sampleCoverage",32939:"sampleCoverage",3089:oh,3088:(n,e)=>n.scissor(...e),2960:oh,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Ba,3317:Ba,37440:Ba,37441:Ba,37443:Ba,3330:Ba,3332:Ba,3331:Ba,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Ba,32878:Ba,3316:Ba,3315:Ba,32877:Ba,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=x0(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=x0(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=x0(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=x0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=x0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function os(n,e,t){return void 0!==e[n]?e[n]:t[n]}const Tre={blendEquation:(n,e,t)=>n.blendEquationSeparate(os(32777,e,t),os(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(os(32969,e,t),os(32968,e,t),os(32971,e,t),os(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(os(32824,e,t),os(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(os(32938,e,t),os(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,os(2962,e,t),os(2967,e,t),os(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,os(34816,e,t),os(36003,e,t),os(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,os(2964,e,t),os(2965,e,t),os(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,os(34817,e,t),os(34818,e,t),os(34819,e,t))},Yj={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Kc=(n,e)=>n.isEnabled(e),Kj={3042:Kc,2884:Kc,2929:Kc,3024:Kc,32823:Kc,32926:Kc,32928:Kc,3089:Kc,2960:Kc,35977:Kc};function Xj(n){for(const e in n)return!1;return!0}function Mre(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function Qj(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache&&n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Dre(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class Ore{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||lI)){const r=e,s=Kj[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=Kj[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},lI),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){$o(this.stateStack.length>0),$u(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){$o(void 0!==s);const o=e[s],a=this.cache[s];Mre(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function Zj(n,e={}){const{enable:t=!0,copyState:i}=e;if($o(void 0!==i),!n.state){const{polyfillContext:r}=globalThis;r&&r(n),n.state=new Ore(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const s in Yj)Dre(n,s,Yj[s]);Qj(n,"getParameter"),Qj(n,"isEnabled")}return n.state.enable=t,n}function Jj(n){$o(n.state),n.state.pop()}function $u(n,e){if($o(bS(n),"setParameters requires a WebGL context"),Xj(e))return;const t={};for(const r in e){const s=Number(r),o=Are[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)Tre[r](n,e,i)}function hc(n,e,t){if(Xj(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||Zj(n,{copyState:!1}),n.state.push()}(n),$u(n,e),i)r=t(n),Jj(n);else try{r=t(n)}finally{Jj(n)}return r}function wS(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}()}function jg(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function cI(n,e,t=!0){return function(n,e,t,i,r){const s=eV(n[0],e,t);let o=tV(n[1],e,i,r),a=eV(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=tV(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,jg(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function eV(n,e,t){return Math.min(Math.round(n*e),t-1)}function tV(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const uI=wS(),Bre=uI&&"undefined"!=typeof document,nV={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function iV(n={}){$o(uI,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},nV,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(Bre&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=dI(r,n),function(n){const e=Si(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);pn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function dI(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},nV,e);const{manageState:t,debug:i}=e;return t&&Zj(n,{copyState:!1,log:(...r)=>pn.log(1,...r)()}),uI&&i&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),pn.level=Math.max(pn.level,1)):pn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function rV(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class sV{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=rV(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(rV()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class hI{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof sV?e:new sV(t,i)),this.stats[t]}}const C0="8.5.12",If=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new hI({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==C0)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${C0}`);function tn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function fI(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return tn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function ah(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}globalThis.luma||(wS()&&pn.log(1,`luma.gl ${C0} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=globalThis.luma||{VERSION:C0,version:C0,log:pn,stats:If,globals:{modules:{},nodeIO:{}}}),globalThis;const pI={};function pa(n="id"){return pI[n]=pI[n]||1,`${n}-${pI[n]++}`}function oV(n){return tn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Vg(n){let e=!0;for(const t in n){e=!1;break}return e}function aV(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw pn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Ug="Resource subclass must define virtual methods";class Wu{get[Symbol.toStringTag](){return"Resource"}constructor(e,t={}){vS(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||pa(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){tn(e=fI(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=Si(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=Si(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const h=i?ah(this.gl,l):l;o[h]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[h]=ah(this.gl,o[h]))}}return o}setParameter(e,t){tn(e=fI(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=Si(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=fI(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return aV(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Ug)}_deleteHandle(){throw new Error(Ug)}_bindHandle(e){throw new Error(Ug)}_getOptsFromHandle(){throw new Error(Ug)}_getParameter(e,t){throw new Error(Ug)}_setParameter(e,t){throw new Error(Ug)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=If.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];If.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const i=If.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=If.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function gI(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function A0(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Xre({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function mI(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&pn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&pn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];pn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Qre={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Zre={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ga{static getBytesPerElement(e){return A0(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return tn(e.size),A0(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new ga(...[Qre,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ga.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ga.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=mI("Accessor",e,Zre)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const cV={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Jre={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:cV},ese={removedProps:cV};class hr extends Wu{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/ga.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/ga.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=mI("Buffer",e,Jre),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=mI("Buffer",e,ese))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new ga(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;tn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Co(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return Co(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){Co(this.gl);const s=A0(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return tn((r=r||u)<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(tn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){tn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=gI(e);return tn(s),this.setAccessor(new ga(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){tn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/A0(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new ga(this.accessor,{type:gI(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return pn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return pn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return pn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return pn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ga(this.accessor,e),this}}const _I={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},uV={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},dV={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},ise=[9729,9728],hV=globalThis.WebGLBuffer||function(){};class Of extends Wu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=_I[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=Si(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=_I[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=pa("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(U=>this.initialize(Object.assign({},e,{pixels:U,data:U}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:h,height:p,dataFormat:g,type:m,compressed:w=!1,mipmaps:C=!0}=e;const{depth:H=0}=e;return({width:h,height:p,compressed:w,dataFormat:g,type:m}=this._deduceParameters({format:s,type:m,dataFormat:g,compressed:w,data:t,width:h,height:p})),this.width=h,this.height=p,this.depth=H,this.format=s,this.type=m,this.dataFormat=g,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),C&&this._isNPOT()&&(pn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),C=!1,this._updateForNPOT(l)),this.mipmaps=C,this.setImageData({data:t,width:h,height:p,depth:H,format:s,type:m,dataFormat:g,border:o,mipmaps:C,parameters:c,compressed:w}),C&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(pn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),hc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:h=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=e;c||(c=i),({type:u,dataFormat:g,compressed:m,width:h,height:p}=this._deduceParameters({format:s,type:u,dataFormat:g,compressed:m,data:c,width:h,height:p}));const{gl:w}=this;w.bindTexture(this.target,this.handle);let C=null;({data:c,dataType:C}=this._getDataType({data:c,compressed:m}));let H,U=0;return hc(this.gl,l,()=>{switch(C){case"null":w.texImage2D(t,r,s,h,p,o,g,u,c);break;case"typed-array":w.texImage2D(t,r,s,h,p,o,g,u,c,a);break;case"buffer":H=Co(w),H.bindBuffer(35052,c.handle||c),H.texImage2D(t,r,s,h,p,o,g,u,a),H.bindBuffer(35052,null);break;case"browser-object":Si(w)?w.texImage2D(t,r,s,h,p,o,g,u,c):w.texImage2D(t,r,s,g,u,c);break;case"compressed":for(const[de,Ae]of c.entries())w.compressedTexImage2D(t,de,Ae.format,Ae.width,Ae.height,o,Ae.data),U+=Ae.levelSize;break;default:tn(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===C?U:c&&c.byteLength?c.byteLength:this.width*this.height*(uV[this.dataFormat]||4)*(dV[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:p=!1,offset:g=0,border:m=this.border,parameters:w={}}){if(({type:u,dataFormat:h,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:p,data:i,width:o,height:a})),tn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const C=i;i=C.data,o=C.shape[0],a=C.shape[1]}i instanceof hr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),hc(this.gl,w,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,h,u,i,g);else if(i instanceof hV){const C=Co(this.gl);C.bindBuffer(35052,i),C.texSubImage2D(e,l,r,s,o,a,h,u,g),C.bindBuffer(35052,null)}else Si(this.gl)?Co(this.gl).texSubImage2D(e,l,r,s,o,a,h,u,i):this.gl.texSubImage2D(e,l,r,s,h,u,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return pn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof hr?{data:e.handle,dataType:"buffer"}:e instanceof hV?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=_I[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},tn(r,"Could not deduced texture size"),tn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),tn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:tn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(Si(this.gl)||!this.width||!this.height||oV(this.width)&&oV(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===ise.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function rse(n,e){return tn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class ma extends Of{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Of.isSupported(e,t)}constructor(e,t={}){vS(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:rse(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Rf="EXT_color_buffer_float",fV={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Rf,bpp:2},33327:{gl2:Rf,bpp:4},34842:{gl2:Rf,bpp:8},33326:{gl2:Rf,bpp:4},33328:{gl2:Rf,bpp:8},34836:{gl2:Rf,bpp:16},35898:{gl2:Rf,bpp:4}};class zg extends Wu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=Si(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,fV)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return tn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&Si(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*fV[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const yV="clear: bad arguments";function bI(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),tn(0!==o,yV),hc(n,s,()=>{n.clear(o)})}function bV(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function oi(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){bV(s,i,r,o,a,"next",l)}function a(l){bV(s,i,r,o,a,"throw",l)}o(void 0)})}}const vI=[34069,34070,34071,34072,34073,34074];let dse=(()=>{class n extends Of{get[Symbol.toStringTag](){return"TextureCube"}constructor(t,i={}){vS(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return oi(function*(){const{gl:u}=c,h=r||s,p=yield Promise.all(vI.map(g=>{const m=h[g];return Promise.all(Array.isArray(m)?m:[m])}));c.bind(),vI.forEach((g,m)=>{p[m].length>1&&!1!==c.opts.mipmaps&&pn.warn(`${c.id} has mipmap and multiple LODs.`)(),p[m].forEach((w,C)=>{t&&i?u.texImage2D(g,C,a,t,i,o,a,l,w):u.texImage2D(g,C,a,a,l,w)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:h}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?h.texImage2D(i,0,c,r,s,l,c,u,p):h.texImage2D(i,0,c,c,u,p),this}}return n.FACES=vI,n})();class hse extends Of{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Si(e)}constructor(e,t={}){Co(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),hc(this.gl,h,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,u),u instanceof hr&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*this.depth*(uV[this.dataFormat]||4)*(dV[this.type]||1),"Texture"),this.loaded=!0,this}}function vV(n,e){tn(n instanceof ma||n instanceof dse||n instanceof hse);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e))}function fse(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Fs(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function ES(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=T0(n);tn(u);const{gl:p,handle:g,attachments:m}=u;a=a||u.width,l=l||u.height,36064===s&&null===g&&(s=1028),tn(m[s]),c=c||m[s].type,o=function(n,e,t,i,r){if(n)return n;return new(A0(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return tn(!1),0}}(t))}(o,c,r,a,l),c=c||gI(o);const w=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,w||null),h&&u.delete(),o}function wI(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=ES(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Xre({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}function T0(n){return n instanceof Fs?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:fse(n),deleteFramebuffer:!0}}const wV="Multiple render targets not supported";class Fs extends Wu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Fs(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Co(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Co(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(tn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const u in i){const h=i[u];(Array.isArray(h)?h[0]:h).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return tn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&pn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){tn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof zg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,h=0,p=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:h,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Fs.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&bI(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){Co(n),hc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:tn(!1,yV)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return pn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return pn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return pn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return pn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return pn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return pn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=Co(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=ah(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?ah(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?ah(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(wI(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>pn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=wI(this,{targetMaxHeight:100});return pn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new ma(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new zg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new zg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&tn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof zg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Co(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:tn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return Si(n)?n:null}(this.gl);t?t.readBuffer(e):tn(36064===e||1029===e,wV),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Co(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):tn(1===e.length&&(36064===e[0]||1029===e[0]),wV)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in EV)void 0===n.luma.caps[e]&&(n.luma.caps[e]=xV(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Fs.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const EV={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new ma(n,{format:6408,type:5126,dataFormat:6408}),t=new Fs(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function EI(n,e){return SV(n,e)}function SV(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>xV(n,t))}function xV(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=EV[e];let i;tn(t,e);const r=Si(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:tn(!1);return i}(n,e)),n.luma.caps[e]||pn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class SI{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ot(ot({},this.source.getAccessor()),this.opts)}}const M0=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h;l&&(h=l*i+s);const p=this._allocate(c,u,a,h);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},Cse=1/Math.PI*180,Ase=1/180*Math.PI,Or={};function Mse(n,{precision:e=Or.precision||4}={}){return n=function(n){return Math.round(n/Or.EPSILON)*Or.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function lh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function qu(n,e,t){if(lh(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function CV(n){return function(n,e){return qu(n,t=>t*Ase,void 0)}(n)}function Ise(n){return function(n,e){return qu(n,t=>t*Cse,void 0)}(n)}function ja(n,e,t){return qu(n,i=>Math.max(e,Math.min(t,i)))}function SS(n,e,t){return lh(n)?n.map((i,r)=>SS(i,e[r],t)):t*e+(1-t)*n}function D0(n,e,t){const i=Or.EPSILON;t&&(Or.EPSILON=t);try{if(n===e)return!0;if(lh(n)&&lh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!D0(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Or.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Or.EPSILON=i}}function Yu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Or.EPSILON=1e-12,Or.debug=!1,Or.precision=4,Or.printTypes=!1,Or.printDegrees=!1,Or.printRowMajor=!0;class xS extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Yu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:lh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Or)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+Mse(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!D0(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Or.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function ar(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function I0(n,e,t=""){if(Or.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const AV={};function Hg(n,e){AV[n]||(AV[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class kse extends xS{get ELEMENTS(){return Yu(!1),0}copy(e){return Yu(!1),this}get x(){return this[0]}set x(e){this[0]=ar(e)}get y(){return this[1]}set y(e){this[1]=ar(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return ar(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return ar(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Yu(e>=0&&e<this.ELEMENTS,"index is out of range"),ar(this[e])}setComponent(e,t){return Yu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var Xc=1e-6,_a="undefined"!=typeof Float32Array?Float32Array:Array;function TV(){var n=new _a(3);return _a!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function MV(n,e,t){var i=new _a(3);return i[0]=n,i[1]=e,i[2]=t,i}function DV(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function O0(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function xI(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function CS(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function IV(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,h=s*a-i*c,p=i*l-r*a,g=r*p-s*h,m=s*u-i*p,w=i*h-r*u,C=2*t[3];return h*=C,p*=C,m*=2,w*=2,n[0]=a+(u*=C)+(g*=2),n[1]=l+h+m,n[2]=c+p+w,n}function OV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function RV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function NV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function PV(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&DV(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function FV(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}TV();const CI=[0,0,0],kV={};class Ao extends kse{static get ZERO(){return kV.ZERO=kV.ZERO||Object.freeze(new Ao(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&lh(e)?this.copy(e):(Or.debug&&(ar(e),ar(t),ar(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Or.debug&&(ar(e.x),ar(e.y),ar(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ar(e)}angle(e){return PV(this,e)}cross(e){return O0(this,this,e),this.check()}rotateX({radians:e,origin:t=CI}){return OV(this,this,t,e),this.check()}rotateY({radians:e,origin:t=CI}){return RV(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=CI}){return NV(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return xI(this,this,e),this.check()}transformAsVector(e){return FV(this,this,e),this.check()}transformByMatrix3(e){return CS(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return IV(this,this,e),this.check()}}const LV=new Ao;function Gg(n,e,t,i){LV.set(n,e,t);const r=LV.len();return{distance:i/r,normal:new Ao(-n/r,-e/r,-t/r)}}function Xse(n){return n-Math.fround(n)}let N0;function AI(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;N0=M0.allocate(N0,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];N0[o+a]=l,N0[o+a+e]=Xse(l)}o+=2*e}return N0.subarray(0,r*e*2)}function AS(n){return n.stride||n.size*n.bytesPerElement}function BV(n,e){e.offset&&Oi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=AS(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return Sn(ot({},e),{offset:s,stride:t})}function fc(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const jV=[],VV=[];function TS(n,e=0,t=1/0){let i=jV;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(VV.length=n.length,i=VV):i=jV,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function UV(n){return n&&n[Symbol.asyncIterator]}function TI(n,e=(()=>!0)){return Array.isArray(n)?zV(n,e,[]):e(n)?[n]:[]}function zV(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?zV(r,e,t):e(r)&&t.push(r)}return t}function eoe({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const toe=[],MS=[[0,1/0]];function MI({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let u=0;u<r;u++)e[t+l]=c[u]||0,l++}}const roe={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function HV(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ot(ot(ot({},roe[n.type]),e),n)):null}function GV(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function $V(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function WV(n){n.push(n.shift())}function DI(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function qV({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,h=DI(t,e),p=t.state.constant;if(!u&&i>=h)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const H=s;s=(U,de)=>t._normalizeConstant(H(U,de))}const m=p?(H,U)=>s(g,U):(H,U)=>s(g.subarray(H,H+a),U),w=n.getData({length:i}),C=new Float32Array(h);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return MI({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,h)=>i(u+a,h)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const h=r[u]*t,p=s[u]*t;MI({source:n.subarray(o,h),target:e,start:a,end:p,size:t,getData:l}),o=h,a=p}a<e.length&&MI({source:[],target:e,start:a,size:t,getData:l})})({source:w,target:C,sourceStartIndices:r,targetStartIndices:c,size:a,getData:m}),n.byteLength<C.byteLength+l&&n.reallocate(C.byteLength+l),n.subData({data:C,offset:l})}class II extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&EI(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new hr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*AS(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),M0.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=BV(n,e);return{high:t,low:Sn(ot({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new SI(this,s.high),i["".concat(e,"64Low")]=r?new SI(this,s.low):new Float32Array(this.size),i}if(t){const i=BV(this.getAccessor(),t);return{[e]:new SI(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof hr&&(e={buffer:e});const i=ot(ot({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=AS(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=AS(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=AI(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?AI(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=M0.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?AI(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Oi.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:MS,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return HV(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===MS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=MS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=toe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==MS}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(fc(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(u,{index:h,target:p})=>{if(!r){const C=h*a+l;for(let H=0;H<e;H++)p[H]=n[C+H];return p}const g=r[h],m=r[h+1]||c;let w;if(s){w=new Array(m-g);for(let C=g;C<m;C++){const H=C*a+l;p=new Array(e);for(let U=0;U<e;U++)p[U]=n[H+U];w[C-g]=p}}else if(a===e)w=n.subarray(g*e+l,m*e+l);else{w=new n.constructor((m-g)*e);let C=0;for(let H=g;H<m;H++){const U=H*a+l;for(let de=0;de<e;de++)w[C++]=n[U+de]}}return w}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:p,transform:g}=a,m=l.binaryAccessor||("function"==typeof p?p:s[p]);fc("function"==typeof m,'accessor "'.concat(p,'" is not a function'));let w=e.getVertexOffset(i);const{iterable:C,objectInfo:H}=TS(t,i,r);for(const U of C){H.index++;let de=m(U,H);if(g&&(de=g.call(this,de)),h){const Ae=(H.index<h.length-1?h[H.index+1]:o)-h[H.index];if(de&&Array.isArray(de[0])){let Pe=w;for(const Be of de)e._normalizeValue(Be,c,Pe),Pe+=u}else de&&de.length>u?c.set(de,w):(e._normalizeValue(de,H.target,0),eoe({target:c,source:H.target,start:w,count:Ae}));w+=Ae*u}else e._normalizeValue(de,c,w),w+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let OI={};function To(n){Oi.level>0&&OI[n]&&OI[n].call(...arguments)}function Va(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const YV="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",aoe=`#version 300 es\n${YV}`;function KV(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function XV(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?aoe:e>300?`#version ${e}\n${YV}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return Va(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class QV extends Wu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Si(e)}constructor(e,t={}){Co(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Vg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,pn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof hr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class doe{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof hr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&tn(Si(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new QV(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],tn(i[s]instanceof hr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new hr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function ZV(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const P0="vs",poe={[P0]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},DS="__LUMA_INJECT_DECLARATIONS__",JV=/void\s+main\s*\([^)]*\)\s*\{\n?/,eU=/}\n?[^{}]*$/,NI=[];function tU(n,e,t,i=!1){const r=e===P0;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),NI.length=o.length;for(let l=0,c=o.length;l<c;++l)NI[l]=o[l].injection;const a=`${NI.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(DS,a));break;case"vs:#main-start":r&&(n=n.replace(JV,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(eU,l=>a+l));break;case"fs:#decl":r||(n=n.replace(DS,a));break;case"fs:#main-start":r||(n=n.replace(JV,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(eU,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(DS,""),i&&(n=n.replace(/\}\s*$/,s=>s+poe[e])),n}function PI(n){const e={};return Va(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const goe={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},IS="transform_uSize_",nU="transform_position";const Soe={10241:9728,10240:9728,10242:33071,10243:33071};class Coe{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap)a[h]=i[this.samplerTextureMap[h]];this._setSourceTextureParameters();const u=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${IS}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${IS}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=ES(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Va(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof ma)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new hr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Fs(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(Soe)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=vV(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const u=l.split("\n"),h=u.slice();if(u.forEach((p,g,m)=>{if(s>0){const w=function(n,e){const t={},i=function(n){return KV(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${IS}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),h=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Va(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":h},samplerTextureMap:t}}return null}(p,e);if(w){const{updatedLine:C,inject:H}=w;h[g]=C,c=PI([c,H]),Object.assign(a,w.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=KV(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){tn(i);const p=`${IS}${t}`;c=PI([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${nU} = transform_getPos(${p});\n     gl_Position = vec4(${nU}, 0, 1.);\n`}])}l=h.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=PI([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||XV({version:ZV(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[goe].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const FI={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Toe(n){let e=iU(n);return"object"===e?n?"type"in n?Object.assign({},n,FI[n.type]):"value"in n?(e=iU(n.value),Object.assign({type:e},n,FI[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},FI[e])}function iU(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class kI{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}){Va("string"==typeof e),this.name=e,this.vs=t||u,this.fs=i||h,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=Toe(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Va(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Va(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function Ooe(n){return function(n){const e={},t={};return LI({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(sU(n))}function LI({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&LI({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function sU(n,e){return n.map(t=>(t instanceof kI||(Va("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Va(t.name,"shader module has no name"),(t=new kI(t)).dependencies=sU(t.dependencies)),t))}const BI={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Nf={};function joe(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(BI).forEach(n=>{Nf[n]=n});const jI={};function oU(n,e,t={}){const i=BI[e];if(Va(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in jI)return jI[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),jI[e]=l,l}function OS(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=BI[e];Va(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Va(!1===r||!0===r),r}(n,t))}function $g(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const aU=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Hoe=[...aU,[$g("attribute"),"in $1"],[$g("varying"),"out $1"]],Goe=[...aU,[$g("varying"),"in $1"]],lU=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],$oe=[...lU,[$g("in"),"attribute $1"],[$g("out"),"varying $1"]],Woe=[...lU,[$g("in"),"varying $1"]],VI="gl_FragColor",UI=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,qoe=/void\s+main\s*\([^)]*\)\s*\{\n?/;function RS(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const Qoe=`\n\n${DS}\n\n`,cU={[P0]:"vertex",fs:"fragment"};function uU(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){Va("string"==typeof t,"shader source must be a string");const h=i===P0,p=t.split("\n");let g=100,m="",w=t;0===p[0].indexOf("#version ")?(g=300,m=p[0],w=p.slice(1).join("\n")):m=`#version ${g}`;const C={};r.forEach(Be=>{Object.assign(C,Be.getDefines())}),Object.assign(C,s);let H=c?`${m}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${cU[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${cU[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:joe(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return OS(n,Nf.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),OS(n,Nf.GLSL_DERIVATIVES)&&oU(n,Nf.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),OS(n,Nf.GLSL_FRAG_DATA)&&oU(n,Nf.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),OS(n,Nf.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(C)}\n${h?"":"precision highp float;\n\n"}\n`:`${m}\n`;const U=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),de={},Ae={},Pe={};for(const Be in a){const et="string"==typeof a[Be]?{injection:a[Be],order:0}:a[Be],wt=Be.match(/^(v|f)s:(#)?([\w-]+)$/);if(wt){const xt=wt[3];wt[2]?"decl"===xt?Ae[Be]=[et]:Pe[Be]=[et]:de[Be]=[et]}else Pe[Be]=[et]}for(const Be of r){u&&Be.checkDeprecations(w,u),H+=Be.getModuleSource(i,g);const wt=Be.injections[i];for(const vt in wt){const xt=vt.match(/^(v|f)s:#([\w-]+)$/);if(xt){const $t="decl"===xt[2]?Ae:Pe;$t[vt]=$t[vt]||[],$t[vt].push(wt[vt])}else de[vt]=de[vt]||[],de[vt].push(wt[vt])}}return H+=Qoe,H=tU(H,i,Ae),H+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(U[i],de),H+=w,H=tU(H,i,Pe),H=function(n,e,t){switch(e){case 300:return t?RS(n,Hoe):function(n){const e=(n=RS(n,Goe)).match(UI);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${VI}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(qoe,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${VI}\\b`,"g"),t)}return n}(n);case 100:return t?RS(n,$oe):function(n){const e=(n=RS(n,Woe)).match(UI);if(e){const t=e[1];n=n.replace(UI,"").replace(new RegExp(`\\b${t}\\b`,"g"),VI)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(H,l?100:g,h),H}function eae(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const oae={5126:Rr.bind(null,"uniform1fv",Ua,1,Mo),35664:Rr.bind(null,"uniform2fv",Ua,2,Mo),35665:Rr.bind(null,"uniform3fv",Ua,3,Mo),35666:Rr.bind(null,"uniform4fv",Ua,4,Mo),5124:Rr.bind(null,"uniform1iv",ch,1,Mo),35667:Rr.bind(null,"uniform2iv",ch,2,Mo),35668:Rr.bind(null,"uniform3iv",ch,3,Mo),35669:Rr.bind(null,"uniform4iv",ch,4,Mo),35670:Rr.bind(null,"uniform1iv",ch,1,Mo),35671:Rr.bind(null,"uniform2iv",ch,2,Mo),35672:Rr.bind(null,"uniform3iv",ch,3,Mo),35673:Rr.bind(null,"uniform4iv",ch,4,Mo),35674:Rr.bind(null,"uniformMatrix2fv",Ua,4,Ku),35675:Rr.bind(null,"uniformMatrix3fv",Ua,9,Ku),35676:Rr.bind(null,"uniformMatrix4fv",Ua,16,Ku),35678:ro,35680:ro,5125:Rr.bind(null,"uniform1uiv",NS,1,Mo),36294:Rr.bind(null,"uniform2uiv",NS,2,Mo),36295:Rr.bind(null,"uniform3uiv",NS,3,Mo),36296:Rr.bind(null,"uniform4uiv",NS,4,Mo),35685:Rr.bind(null,"uniformMatrix2x3fv",Ua,6,Ku),35686:Rr.bind(null,"uniformMatrix2x4fv",Ua,8,Ku),35687:Rr.bind(null,"uniformMatrix3x2fv",Ua,6,Ku),35688:Rr.bind(null,"uniformMatrix3x4fv",Ua,12,Ku),35689:Rr.bind(null,"uniformMatrix4x2fv",Ua,8,Ku),35690:Rr.bind(null,"uniformMatrix4x3fv",Ua,12,Ku),35678:ro,35680:ro,35679:ro,35682:ro,36289:ro,36292:ro,36293:ro,36298:ro,36299:ro,36300:ro,36303:ro,36306:ro,36307:ro,36308:ro,36311:ro},aae={},lae={},cae={},dU=[0];function zI(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(dU[0]=n,n=dU);const r=n.length;if(r%e&&pn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Ua(n,e){return zI(n,e,Float32Array,aae)}function ch(n,e){return zI(n,e,Int32Array,lae)}function NS(n,e){return zI(n,e,Uint32Array,cae)}function hU(n,e,t){const i=oae[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function uae(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function hae(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Of||n instanceof zg)||n instanceof Fs&&Boolean(n.texture)}function fae(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function ro(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Rr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),s=u,h=!0;else{tn(s===u,"Uniform length cannot change.");for(let p=0;p<u;++p)if(c[p]!==r[p]){h=!0;break}}return h&&(i(o,n,a,c),r.set(c)),h}}function Mo(n,e,t,i){n[e](t,i)}function Ku(n,e,t,i){n[e](t,!1,i)}function PS(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function pU(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=gU(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function gU(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class F0 extends Wu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return tn(!1),"unknown"}}constructor(e,t){vS(e),tn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:PS(t.source,null)||t.id||pa(`unnamed ${F0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=PS(e,null);t&&(this.id=pa(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${F0.getTypeName(this.shaderType)}:${this.id}`}getName(){return PS(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||PS(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let u=0;u<r.length;u++){const h=r[u];if(h.length<=1)continue;const p=h.split(":"),g=p[0],m=parseInt(p[2],10);if(isNaN(m))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[m]=h:o[m]=h}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return gU(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:pU(s,c),warnings:pU(o,c)}}(i,this.source,this.shaderType,this.id);throw pn.error(`GLSL compilation errors in ${r}\n${s}`)(),pn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class HI extends F0{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class GI extends F0{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const ks=5126,k0=5124,L0=5125,$I={[ks]:[ks,1,"float"],35664:[ks,2,"vec2"],35665:[ks,3,"vec3"],35666:[ks,4,"vec4"],[k0]:[k0,1,"int"],35667:[k0,2,"ivec2"],35668:[k0,3,"ivec3"],35669:[k0,4,"ivec4"],[L0]:[L0,1,"uint"],36294:[L0,2,"uvec2"],36295:[L0,3,"uvec3"],36296:[L0,4,"uvec4"],35670:[ks,1,"bool"],35671:[ks,2,"bvec2"],35672:[ks,3,"bvec3"],35673:[ks,4,"bvec4"],35674:[ks,8,"mat2"],35685:[ks,8,"mat2x3"],35686:[ks,8,"mat2x4"],35675:[ks,12,"mat3"],35687:[ks,12,"mat3x2"],35688:[ks,12,"mat3x4"],35676:[ks,16,"mat4"],35689:[ks,16,"mat4x2"],35690:[ks,16,"mat4x3"]};function wU(n){const e=$I[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function EU(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=ks}for(const t in $I){const[i,r,s]=$I[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class qae{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Si(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=wU(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new ga(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=wU(i),l={location:e,name:t,accessor:new ga({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Yae=35981,Kae=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class xU extends Wu{get[Symbol.toStringTag](){return"Program"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",Kae),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=Yae}=e;return this.hash=t||"",this.vs="string"==typeof i?new HI(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new GI(this.gl,{id:`${e.id}-fs`,source:r}):r,tn(this.vs instanceof HI),tn(this.fs instanceof GI),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Co(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new qae(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:p,framebuffer:g,parameters:m={},uniforms:w,samplers:C}){if((w||C)&&(pn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(w||{})),pn.priority>=e){const H=g?g.id:"default",U=`mode=${ah(this.gl,t)} verts=${i} instances=${c} indexType=${ah(this.gl,l)} isInstanced=${u} isIndexed=${a} Framebuffer=${H}`;pn.log(e,U)()}return tn(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),p){const H=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return tn(!1),0}}(t);p.begin(H)}this._bindTextures(),hc(this.gl,m,()=>{a&&u?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&Si(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):u?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){pn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!hae(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Fs&&(s=s.texture),s instanceof Of)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&fae(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new HI({handle:r});break;case 35632:i.fs=new GI({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=pa(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),pn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),pn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||pn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=uae(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=hU(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=hU(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class B0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new B0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),h=this._getHash(i),p=c.map(de=>this._getHash(de.name)).sort(),g=o.map(de=>this._getHash(de)),m=Object.keys(r).sort(),w=Object.keys(s).sort(),C=[],H=[];for(const de of m)C.push(this._getHash(de)),C.push(this._getHash(r[de]));for(const de of w)H.push(this._getHash(de)),H.push(this._getHash(s[de]));const U=`${u}/${h}D${C.join("/")}M${p.join("/")}I${H.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[U]){const de=function(n,e){const{vs:t,fs:i}=e,r=Ooe(e.modules||[]);return{gl:n,vs:uU(n,Object.assign({},e,{source:t,type:P0,modules:r})),fs:uU(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:eae(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[U]=new xU(this.gl,{hash:U,vs:de.vs,fs:de.fs,varyings:o,bufferMode:a}),this._getUniforms[U]=de.getUniforms||(Ae=>{}),this._useCounts[U]=0}return this._useCounts[U]++,this._programCache[U]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let kS=null;class za extends Wu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e,t={}){return!t.constantAttributeZero||Si(e)||"Chrome"===function(n){if(!rI())return"Node";if(Rj(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":w0.chrome?"Chrome":w0.safari?"Safari":w0.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new za(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return za.MAX_ATTRIBUTES=za.MAX_ATTRIBUTES||e.getParameter(34921),za.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:za._setConstantFloatArray(e,t,i);break;case Int32Array:za._setConstantIntArray(e,t,i);break;case Uint32Array:za._setConstantUintArray(e,t,i);break;default:tn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return za.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return tn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:h,gl2:p}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,t.handle),c?(tn(Si(h)),p.vertexAttribIPointer(e,r,s,o,a)):h.vertexAttribPointer(e,r,s,l,o,a),h.enableVertexAttribArray(e),p.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!za.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new hr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!kS||kS.byteLength<n)&&(kS=new ArrayBuffer(n)),kS}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:tn(!1)}}static _setConstantIntArray(e,t,i){switch(tn(Si(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:tn(!1)}}static _setConstantUintArray(e,t,i){switch(tn(Si(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:tn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return tn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const nle=/^(.+)__LOCATION_([0-9]+)$/,ile=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class rle{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new za(e),aV(this,"VertexArray","v6.0",ile),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new hr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof hr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof hr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,pn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=ga.resolve(l.accessor,this.accessors[o]||{},i,r),{size:h,type:p}=u;return tn(Number.isFinite(h)&&Number.isFinite(p)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=nle.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof hr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof hr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof hr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(za.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){za.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof hr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return pn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function j0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=j0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function CU(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,h,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof hr){const p=e,{data:g,changed:m}=p.getDebugData();let w;return u=m?"*":"",h=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?w=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${ah(r,s)})`:(c=!0,w=`${l} bytes`),{[i]:`${u}${j0(h,{size:o,isInteger:c})}`,"Format ":w}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${j0(h,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function ale(n,e){const{type:t,size:i}=e,r=EU(t,i);return r?`${n} (${r.name})`:n}function AU({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){tn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&WI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&WI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||WI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const p in t){const g=t[p];a[p]||(u++,h[p]={Type:`NOT USED: ${g}`,[n]:j0(g)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function WI({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?j0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function TU(n){const{type:e,size:t}=n.accessor,i=EU(e,t);return i?`${i.name} ${n.name}`:n.name}const ule={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function hle(n,e){const{attributeMap:t=ule}=e||{};return t&&t[n]||n}function fle(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}tn(Number.isFinite(e.size),`attribute ${n} needs size`)}const MU=()=>{},mle={};class Kg{constructor(e,t={}){const{id:i=pa("model")}=t;tn(bS(e)),this.id=i,this.gl=e,this.id=t.id||pa("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||B0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},tn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return tn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return tn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=hle(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ot({},o);delete c.value,i[a]=[new hr(n,l),c],fle(s,c)}}if(r){const s=r.value||r;tn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new hr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Vg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return bI(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),pn.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:p=u.indexType,indexOffset:g=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&pn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:C}=this,{onBeforeRender:H=MU,onAfterRender:U=MU}=this.props;H(),this.program.setUniforms(this.uniforms);const de=this.program.draw(Object.assign(mle,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:p,isInstanced:w,instanceCount:C,offset:h?g:0}));return U(),pn.priority>=2&&this._logDrawCallEnd(c,l,i),de}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return pn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}tn(t instanceof xU,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new rle(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof hr&&t.delete()}}_setAnimationProps(e){this.animated&&tn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Vg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new QV(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),pn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:pn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=CU(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${ale(s.name,a)}`),t[o]=CU(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=AU({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=AU({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&pn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&pn.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${TU(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${TU(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);pn.table(e,s)(),pn.table(e,o)(),pn.table(e+1,h)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),pn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class qI{static isSupported(e){return Si(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();tn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Kg(t,Object.assign({},e,{fs:e.fs||XV({version:ZV(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(Vg(n.feedbackBuffers)&&Vg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new doe(e,t)),function(n){return!(Vg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Coe(e,t)),tn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function LS(){}const ble={onStart:LS,onUpdate:LS,onInterrupt:LS,onEnd:LS};class V0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ot(ot({},ble),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Tle={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new V0(i),this.attribute=t,this.attributeInTransition=new II(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=$V(e.size);return new qI(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new hr(e,r),new hr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;WV(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)qV(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=DI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:GV(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new V0(i),this.attribute=t,this.attributeInTransition=new II(e,Sn(ot({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new ma(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Fs(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=$V(e.size);return new qI(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new hr(e,r),new hr(e,r),new hr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)qV(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=DI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:GV(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),WV(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),ES(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Mle{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=qI.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Oi.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Tle[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Oi.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const DU="attributeManager.invalidate";class Ple{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Mle(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);To(DU,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);To(DU,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;To("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=i,s[c]&&Oi.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(o[h],e.startIndices)||!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=u.needsRedraw()}l&&To("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ot({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Oi.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=Sn(ot({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new II(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;To("attribute.updateStart",t),t.allocate(i)&&To("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,To("attribute.updateEnd",t,i))}}function OU(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function RU(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Ble={interpolation:class extends V0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=SS(t,i,o)}},spring:class extends V0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=OU(n[o],e[o],t[o],i,r);return s}return OU(n,e,t,i,r)}(s,o,t,i,r);const l=RU(a,t),c=RU(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class jle{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=HV(r)))return;const o=Ble[r.type];if(!o)return void Oi.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(Sn(ot({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const BS={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Vle}=BS;function Hle(n,e){if(!n.transitions)return null;const t={},i=KI(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&YI(n[r],e[r],s)&&(t[r]=!0)}return t}function NU({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=YI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=YI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function YI(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Wle(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function PU(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,NU({oldProps:r,newProps:i,triggerName:t})}function KI(n){const e=n[Vle],t=e&&e.constructor;return t?t._propTypes:{}}function Zle(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function jS(n){let t,e={};return i=>{for(const r in i)if(!Zle(i[r],e[r])){t=n(i),e=i;break}return t}}function Jle(n,e){if(!e)return n;const t=ot(ot({},n),e);if("defines"in e&&(t.defines=ot(ot({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ot({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function XI(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],g=e[11],m=e[12],w=e[13],C=e[14],H=e[15],U=t*a-i*o,de=t*l-r*o,Ae=t*c-s*o,Pe=i*l-r*a,Be=i*c-s*a,et=r*c-s*l,wt=u*w-h*m,vt=u*C-p*m,xt=u*H-g*m,Bt=h*C-p*w,$t=h*H-g*w,gt=p*H-g*C,mt=U*gt-de*$t+Ae*Bt+Pe*xt-Be*vt+et*wt;return mt?(n[0]=(a*gt-l*$t+c*Bt)*(mt=1/mt),n[1]=(r*$t-i*gt-s*Bt)*mt,n[2]=(w*et-C*Be+H*Pe)*mt,n[3]=(p*Be-h*et-g*Pe)*mt,n[4]=(l*xt-o*gt-c*vt)*mt,n[5]=(t*gt-r*xt+s*vt)*mt,n[6]=(C*Ae-m*et-H*de)*mt,n[7]=(u*et-p*Ae+g*de)*mt,n[8]=(o*$t-a*xt+c*wt)*mt,n[9]=(i*xt-t*$t-s*wt)*mt,n[10]=(m*Be-w*Ae+H*U)*mt,n[11]=(h*Ae-u*Be-g*U)*mt,n[12]=(a*vt-o*Bt-l*wt)*mt,n[13]=(t*Bt-i*vt+r*wt)*mt,n[14]=(w*de-m*Pe-C*U)*mt,n[15]=(u*Pe-h*de+p*U)*mt,n):null}function Pf(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],g=e[10],m=e[11],w=e[12],C=e[13],H=e[14],U=e[15],de=t[0],Ae=t[1],Pe=t[2],Be=t[3];return n[0]=de*i+Ae*a+Pe*h+Be*w,n[1]=de*r+Ae*l+Pe*p+Be*C,n[2]=de*s+Ae*c+Pe*g+Be*H,n[3]=de*o+Ae*u+Pe*m+Be*U,n[4]=(de=t[4])*i+(Ae=t[5])*a+(Pe=t[6])*h+(Be=t[7])*w,n[5]=de*r+Ae*l+Pe*p+Be*C,n[6]=de*s+Ae*c+Pe*g+Be*H,n[7]=de*o+Ae*u+Pe*m+Be*U,n[8]=(de=t[8])*i+(Ae=t[9])*a+(Pe=t[10])*h+(Be=t[11])*w,n[9]=de*r+Ae*l+Pe*p+Be*C,n[10]=de*s+Ae*c+Pe*g+Be*H,n[11]=de*o+Ae*u+Pe*m+Be*U,n[12]=(de=t[12])*i+(Ae=t[13])*a+(Pe=t[14])*h+(Be=t[15])*w,n[13]=de*r+Ae*l+Pe*p+Be*C,n[14]=de*s+Ae*c+Pe*g+Be*H,n[15]=de*o+Ae*u+Pe*m+Be*U,n}function VS(n,e,t){var o,a,l,c,u,h,p,g,m,w,C,H,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],p=e[6],g=e[7],m=e[8],w=e[9],C=e[10],H=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=p,n[7]=g,n[8]=m,n[9]=w,n[10]=C,n[11]=H,n[12]=o*i+u*r+m*s+e[12],n[13]=a*i+h*r+w*s+e[13],n[14]=l*i+p*r+C*s+e[14],n[15]=c*i+g*r+H*s+e[15]),n}function US(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function FU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+h*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=h*r-a*i,n[11]=p*r-l*i,n}function kU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+h*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=h*r-a*i,n[7]=p*r-l*i,n}function BU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function zS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}function jU(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return n[0]=u*c+g*-o+h*-l-p*-a,n[1]=h*c+g*-a+p*-o-u*-l,n[2]=p*c+g*-l+u*-a-h*-o,n[3]=e[3],n}!function(){var n=new _a(4);_a!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const VU=[0,0,0,0],xce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Cce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ace=[0,0,0],Tce=[0,0,0],Mce=jS(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=VU,l=VU,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:p}=UU(n,e,t);return p&&(l=n.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=zS([],l,o),s=i||s,o=Pf([],r,s),o=Pf([],o,xce)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),h=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Ace,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const m=n.getDistanceScales(c);switch(t){case Vi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case Vi.LNGLAT:case Vi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case Vi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]]}}return g});function UU(n,e,t=Tce){let r,i=t,s=!0;switch(r=e===Vi.LNGLAT_OFFSETS||e===Vi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Yc.WEB_MERCATOR:(e===Vi.LNGLAT||e===Vi.CARTESIAN)&&(s=!1);break;case Yc.WEB_MERCATOR_AUTO_OFFSET:e===Vi.LNGLAT?i=r:e===Vi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Yc.IDENTITY:i=n.position.map(Math.fround);break;case Yc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class zU extends xS{get ELEMENTS(){return Yu(!1),0}get RANK(){return Yu(!1),0}toString(){let e="[";if(Or.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=ar(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function HS(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function HU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function GU(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function $U(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}!function(){var n=new _a(2);_a!=Float32Array&&(n[0]=0,n[1]=0)}();const WU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Pce=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fce=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Qg={};class qn extends zU{static get IDENTITY(){return Qg.IDENTITY=Qg.IDENTITY||Object.freeze(new qn(WU)),Qg.IDENTITY}static get ZERO(){return Qg.ZERO=Qg.ZERO||Object.freeze(new qn(Pce)),Qg.ZERO}get INDICES(){return Fce}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,h,p,g,m,w,C){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=p,this[12]=g,this[13]=m,this[14]=w,this[15]=C,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,h,p,g,m,w,C){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=u,this[7]=m,this[8]=i,this[9]=a,this[10]=h,this[11]=w,this[12]=r,this[13]=l,this[14]=p,this[15]=C,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(WU)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,w=s*o,C=s*a,H=s*l;n[0]=1-h-m,n[1]=u+H,n[2]=p-C,n[3]=0,n[4]=u-H,n[5]=1-c-m,n[6]=g+w,n[7]=0,n[8]=p+C,n[9]=g-w,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?qn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),u=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,u,h,p,g,m=e[0],w=e[1],C=e[2],H=i[0],U=i[1],de=i[2],Ae=t[0],Pe=t[1],Be=t[2];Math.abs(m-Ae)<Xc&&Math.abs(w-Pe)<Xc&&Math.abs(C-Be)<Xc?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=m-Ae,h=w-Pe,p=C-Be,r=U*(p*=g=1/Math.hypot(u,h,p))-de*(h*=g),s=de*(u*=g)-H*p,o=H*h-U*u,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=h*o-p*s,l=p*r-u*o,c=u*s-h*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*m+s*w+o*C),n[13]=-(a*m+l*w+c*C),n[14]=-(u*m+h*w+p*C),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new qn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],h=n[10],p=n[11],g=n[12],m=n[13],w=n[14],C=n[15];return(e*o-t*s)*(h*C-p*w)-(e*a-i*s)*(u*C-p*m)+(e*l-r*s)*(u*w-h*m)+(t*a-i*o)*(c*C-p*g)-(t*l-r*o)*(c*w-h*g)+(i*l-r*a)*(c*m-u*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return XI(this,this),this.check()}multiplyLeft(e){return Pf(this,e,this),this.check()}multiplyRight(e){return Pf(this,this,e),this.check()}rotateX(e){return FU(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-h*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+h*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return kU(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,u,h,p,g,m,w,C,H,U,de,Ae,Pe,Be,et,wt,vt,xt,Bt,$t,gt,mt,Vt,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<Xc||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],m=e[3],C=e[5],H=e[6],U=e[7],Ae=e[9],Pe=e[10],Be=e[11],xt=r*s*(u=1-c)-o*l,Bt=s*s*u+c,$t=o*s*u+r*l,gt=r*o*u+s*l,mt=s*o*u-r*l,Vt=o*o*u+c,n[0]=(h=e[0])*(et=r*r*u+c)+(w=e[4])*(wt=s*r*u+o*l)+(de=e[8])*(vt=o*r*u-s*l),n[1]=p*et+C*wt+Ae*vt,n[2]=g*et+H*wt+Pe*vt,n[3]=m*et+U*wt+Be*vt,n[4]=h*xt+w*Bt+de*$t,n[5]=p*xt+C*Bt+Ae*$t,n[6]=g*xt+H*Bt+Pe*$t,n[7]=m*xt+U*Bt+Be*$t,n[8]=h*gt+w*mt+de*Vt,n[9]=p*gt+C*mt+Ae*Vt,n[10]=g*gt+H*mt+Pe*Vt,n[11]=m*gt+U*mt+Be*Vt,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?US(this,this,e):US(this,this,[e,e,e]),this.check()}translate(e){return VS(this,this,e),this.check()}transform(e,t){return 4===e.length?(I0(t=zS(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=xI(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return I0(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=FV(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return I0(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return Hg("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return Hg("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return Hg("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Zg(n,e){const t=zS([],e,n);return BU(t,t,1/t[3]),t}function qU(n,e){const t=n%e;return t<0?e+t:t}function YU(n,e,t){return n<e?e:n>t?t:n}const QI=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function Xu(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const pc=Math.PI,KU=pc/4,gc=pc/180,ZI=180/pc,JI=4003e4,GS=85.051129;function $S([n,e]){return Xu(Number.isFinite(n)),Xu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*gc+pc)/(2*pc),512*(pc+Math.log(Math.tan(KU+e*gc*.5)))/(2*pc)]}function Jg([n,e]){const t=n/512*(2*pc)-pc,i=2*(Math.atan(Math.exp(e/512*(2*pc)-pc))-KU);return[t*ZI,i*ZI]}function eO({latitude:n,longitude:e,highPrecision:t=!1}){Xu(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*gc),o=512/360,a=o/s,l=512/JI/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=gc*Math.tan(n*gc)/s,h=512/JI*c,p=h/a*l;i.unitsPerDegree2=[0,o*c/2,h],i.unitsPerMeter2=[p,0,p]}return i}function XU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=eO({longitude:t,latitude:i,highPrecision:!0}),u=$S(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=Jg(u),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],p]:h}function ZU(n){return 2*Math.atan(.5/n)*ZI}function JU(n,e){const[t,i,r=0]=n;return Xu(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Zg(e,[t,i,r,1])}function z0(n,e,t=0){const[i,r,s]=n;if(Xu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Zg(e,[i,r,s,1]);const o=Zg(e,[i,r,0,1]),a=Zg(e,[i,r,1,1]),l=o[2],c=a[2];return GU([],o,a,l===c?0:((t||0)-l)/(c-l))}const ez=Math.PI/180;function tz(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Zg(i,[e,0,1,1]),s=Zg(i,[e,n.height,1,1]),c=Jg(GU([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}const qce=Math.PI/180,Yce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nO=[0,0,0],Xce={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let em=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Yc.WEB_MERCATOR:Yc.WEB_MERCATOR_AUTO_OFFSET:Yc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&D0(t.projectionMatrix,this.projectionMatrix)&&D0(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=JU(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,u=z0([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[h,p,g]=this.unprojectPosition(u);return Number.isFinite(a)?[h,p,g]:Number.isFinite(r)?[h,p,r]:[h,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?$S(t):t}unprojectFlat(t){return this.isGeospatial?Jg(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?eO({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Gg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Gg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Gg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Gg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Gg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Gg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new qn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new qn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Yce,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){Xu(Number.isFinite(n));const e=Math.cos(n*gc);return function(n){return QI(n)}(JI*e)-9}({latitude:s})+Math.log2(c):0);const h=Math.pow(2,this.zoom);this.scale=h,this.distanceScales=this.isGeospatial?eO({latitude:s,longitude:r}):u||Xce,this.focalDistance=c,this.distanceScales.metersPerUnit=new Ao(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new Ao(this.distanceScales.unitsPerMeter),this.position=nO,this.meterOffset=nO,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new qn).multiplyRight(this.viewMatrixUncentered).translate(new Ao(this.center||nO).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new Ao(this.projectPosition([t,i,0]));if(r){const a=new Ao(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*qce,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Pf(t,t,this.projectionMatrix),Pf(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=XI([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];US(i,i,[this.width/2,-this.height/2,1]),VS(i,i,[1,-1,0]),Pf(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=XI([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Oi.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),oz=(()=>{class n extends em{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:u=!1,repeat:h=!1,worldOffset:p=0}=t;let{width:g,height:m,altitude:w=1.5}=t;const C=Math.pow(2,s);g=g||1,m=m||1,w=Math.max(.75,w);const{fov:H,aspect:U,focalDistance:de,near:Ae,far:Pe}=function({width:n,height:e,fovy:t=ZU(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=ZU(i));const a=.5*t*gc,l=function(n){return.5/Math.tan(.5*n*gc)}(t),c=r*gc,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*u+l)*o}}({width:g,height:m,pitch:o,altitude:w,nearZMultiplier:l,farZMultiplier:c});let Be=function({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return VS(o,o,[0,0,-i]),FU(o,o,-e*gc),kU(o,o,t*gc),US(o,o,[r/=n,r,r]),s&&VS(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}({height:m,pitch:o,bearing:a,scale:C,altitude:w});p&&(Be=(new qn).translate([512*p,0,0]).multiplyLeft(Be)),super(Sn(ot({},t),{width:g,height:m,viewMatrix:Be,longitude:r,latitude:i,zoom:s,orthographic:u,fovyRadians:H,aspect:U,focalDistance:de,near:Ae,far:Pe})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=w,this.orthographic=u,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(Sn(ot({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return XU(t,i)}panByPosition(t,i){const r=z0(i,this.pixelUnprojectionMatrix),o=HS([],this.projectFlat(t),HU([],r)),a=HS([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=function(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*ez:Math.atan(.5/n.altitude))>(90-n.pitch)*ez-.01?(l=tz(n,0,e),c=tz(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=function({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,u]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:Xu(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=$S([a,YU(u,-GS,GS)]),p=$S([c,YU(l,-GS,GS)]),g=[Math.max(Math.abs(p[0]-h[0]),i),Math.max(Math.abs(p[1]-h[1]),i)],m=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];Xu(m[0]>0&&m[1]>0);const w=m[0]/g[0],C=m[1]/g[1],Ae=Jg([(p[0]+h[0])/2+(s.right-s.left)/2/w,(p[1]+h[1])/2+(s.bottom-s.top)/2/C]),Pe=Math.min(r,QI(Math.abs(Math.min(w,C))));return Xu(Number.isFinite(Pe)),{longitude:Ae[0],latitude:Ae[1],zoom:Pe}}(ot({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function iO(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof oz){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function az(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=zS([],[o,a,l,1],t)),i){case Vi.LNGLAT:return iO([o,a,l],e,s);case Vi.LNGLAT_OFFSETS:return iO([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Vi.METER_OFFSETS:return iO(XU(r,[o,a,l]),e,s);case Vi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const Jce={10241:9987,10240:9729,10242:33071,10243:33071},rO={},nue={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||G0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>sO(n,e)},accessor:{validate(n,e){const t=WS(n);return"function"===t||t===WS(e.value)},equal:(n,e,t)=>"function"==typeof e||sO(n,e)},array:{validate:(n,e)=>e.optional&&!n||G0(n),equal:(n,e,t)=>t.compare?sO(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof ma)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new ma(t,Sn(ot({},e),{parameters:ot(ot(ot({},Jce),i),n.props.textureParameters)}));return rO[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof ma)||rO[n.id]&&(n.delete(),delete rO[n.id])}(n)}}};function sO(n,e){if(n===e)return!0;if(!G0(n)||!G0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function rue(n,e){switch(WS(e)){case"object":return H0(n,e);case"array":return H0(n,{type:"array",value:e,compare:!1});case"boolean":return H0(n,{type:"boolean",value:e});case"number":return H0(n,{type:"number",value:e});case"function":return H0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function H0(n,e){return"type"in e?ot(ot({name:n},nue[e.type]),e):"value"in e?ot({name:n,type:WS(e.value)},e):{name:n,type:"object",value:e}}function G0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function WS(n){return G0(n)?"array":null===n?"null":typeof n}const{COMPONENT:oO,ASYNC_ORIGINAL:qS,ASYNC_RESOLVED:$0,ASYNC_DEFAULTS:YS}=BS;function sue(){const n=this,e=lz(n.constructor),t=Object.create(e);t[oO]=n,t[qS]={},t[$0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function lz(n){return KS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=lz(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=rue(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(KS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=KS(n,"layerName")||KS(n,"componentName");return e||Oi.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ot(ot({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=uue(o))}n[YS]=t,n[qS]={},Object.defineProperties(n,i)}(o,a);const l=ot(ot({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])cz(this,s)||(this[s]=i);Oi.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function uue(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||UV(e)?this[qS][n]=e:this[$0][n]=e},get(){if(this[$0]){if(n in this[$0])return this[$0][n]||this[YS][n];if(n in this[qS]){const e=this[oO]&&this[oO].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[YS][n]}}return this[YS][n]}}}function cz(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function KS(n,e){return cz(n,e)&&n[e]}function aO(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:hue,ASYNC_RESOLVED:fue,ASYNC_DEFAULTS:pue}=BS,gue=Object.freeze({});class uz{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=gue,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[fue]||{},i=e[hue]||e,r=e[pue]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(UV(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return oi(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var h,c=!0,u=!1;try{for(var g,m,p=aO(t);c=(g=yield p.next()).done,m=yield g.value,!c;c=!0){const C=m,{dataTransform:H}=i.component?i.component.props:{};a=H?H(C,a):a.concat(C),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(C){u=!0,h=C}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(u)throw h}}const w=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;w&&w(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:dz,ASYNC_RESOLVED:hz,ASYNC_DEFAULTS:mue}=BS,_ue={};let yue=0,bue=(()=>{class n{constructor(){this.props=sue.apply(this,arguments),this.id=this.props.id,this.count=yue++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[mue])s in i[hz]?r[s]=i[hz][s]:s in i[dz]&&(r[s]=i[dz][s]);return new this.constructor(ot(ot(ot({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new uz({})}}return n.componentName="Component",n.defaultProps=_ue,n})();class vue extends uz{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const mc=n=>"function"==typeof n,uh=n=>null!==n&&"object"==typeof n,pz=n=>uh(n)&&n.constructor==={}.constructor,wue=n=>n&&"function"==typeof n[Symbol.iterator],Eue=n=>n&&"function"==typeof n[Symbol.asyncIterator],W0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,tm=n=>"undefined"!=typeof Blob&&n instanceof Blob,gz=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||uh(n)&&mc(n.tee)&&mc(n.cancel)&&mc(n.getReader))(n)||(n=>uh(n)&&mc(n.read)&&mc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function Ff(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function lO(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function cO(n){var e,t;let i;return Ff(n,"null loader"),Ff(lO(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=Sn(ot({},n=n[0]),{options:ot(ot({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Qc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},uO=Qc.global||Qc.self||Qc.window||{},Mue="object"!=typeof process||"[object process]"!==String(process)||process.browser,mz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);mz&&parseFloat(mz[1]);const hO={};function Due(n){for(const e in hO)n.startsWith(e)&&(n=n.replace(e,hO[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Iue=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Oue=/^([-\w.]+\/[-\w.+]+)/;function Rue(n){const e=Oue.exec(n);return e?e[1]:n}function _z(n){const e=Iue.exec(n);return e?e[1]:""}const Nue=/\?.*/;function XS(n){if(W0(n)){const e=fO(n.url||"");return{url:e,type:Rue(n.headers.get("content-type")||"")||_z(e)}}return tm(n)?{url:fO(n.name||""),type:n.type||""}:"string"==typeof n?{url:fO(n),type:_z(n)}:{url:"",type:""}}function Pue(n){return W0(n)?n.headers["content-length"]||-1:tm(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function fO(n){return n.replace(Nue,"")}function yz(n){return pO.apply(this,arguments)}function pO(){return(pO=oi(function*(n){if(W0(n))return n;const e={},t=Pue(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=XS(n);r&&(e["content-type"]=r);const s=yield Lue(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Fue(n){return gO.apply(this,arguments)}function gO(){return(gO=oi(function*(n){if(!n.ok){const e=yield kue(n);throw new Error(e)}})).apply(this,arguments)}function kue(n){return mO.apply(this,arguments)}function mO(){return(mO=oi(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Lue(n){return _O.apply(this,arguments)}function _O(){return(_O=oi(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${Bue(n.slice(0,5))}`:null})).apply(this,arguments)}function Bue(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function bz(n,e){return yO.apply(this,arguments)}function yO(){return(yO=oi(function*(n,e){if("string"==typeof n){n=Due(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield yz(n)})).apply(this,arguments)}function Kn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const vz=new oI({id:"loaders.gl"});class jue{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const wz={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Kn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Uue={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function bO(){uO.loaders=uO.loaders||{};const{loaders:n}=uO;return n._state=n._state||{},n._state}const vO=()=>{const n=bO();return n.globalOptions=n.globalOptions||ot({},wz),n.globalOptions};function zue(n,e,t,i){return t=t||[],function(n,e){Sz(n,null,wz,Uue,e);for(const t of e)Sz(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ot({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new jue),Cz(r,vO()),Cz(r,e),r}(e,n,i)}function Ez(n,e){const t=vO(),i=n||t;return"function"==typeof i.fetch?i.fetch:uh(i.fetch)?r=>bz(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:bz}function Sz(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&uh(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)vz.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const h=Gue(a,r);vz.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}function Gue(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function Cz(n,e){for(const t in e)t in e&&(n[t]=pz(e[t])&&pz(n[t])?ot(ot({},n[t]),e[t]):e[t])}function Zc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function que(n,e="3.0.12"){return Zc(n,"no worker provided"),!(!e||!n.version)}const Jc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Yue=Jc.global||Jc.self||Jc.window||{},wO="object"!=typeof process||"[object process]"!==String(process)||process.browser,EO="function"==typeof importScripts,Kue="undefined"!=typeof window&&void 0!==window.orientation,Az="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),SO=(Az&&parseFloat(Az[1]),new Map);function Tz(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function Mz(n,e=!0,t){const i=t||new Set;if(n)if(Dz(n))i.add(n);else if(Dz(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)Mz(n[r],e,i);return void 0===t?Array.from(i):[]}function Dz(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const xO=()=>{};class Iz{static isSupported(){return"undefined"!=typeof Worker}constructor(e){Kn(this,"name",void 0),Kn(this,"source",void 0),Kn(this,"url",void 0),Kn(this,"terminated",!1),Kn(this,"worker",void 0),Kn(this,"onMessage",void 0),Kn(this,"onError",void 0),Kn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Zc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=xO,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=xO,this.onError=xO,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||Mz(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){Zc(n.source&&!n.url||!n.source&&n.url);let e=SO.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?Tz(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),SO.set(n.url,e)),n.source&&(e=Tz(n.source),SO.set(n.source,e))),Zc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class Jue{constructor(e,t){Kn(this,"name",void 0),Kn(this,"workerThread",void 0),Kn(this,"isRunning",void 0),Kn(this,"result",void 0),Kn(this,"_resolve",void 0),Kn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Zc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Zc(this.isRunning),this.isRunning=!1,this._reject(e)}}class ede{constructor(e){Kn(this,"name","unnamed"),Kn(this,"source",void 0),Kn(this,"url",void 0),Kn(this,"maxConcurrency",1),Kn(this,"maxMobileConcurrency",1),Kn(this,"onDebug",()=>{}),Kn(this,"reuseWorkers",!0),Kn(this,"props",{}),Kn(this,"jobQueue",[]),Kn(this,"idleQueue",[]),Kn(this,"count",0),Kn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ot(ot({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return oi(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return oi(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new Jue(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Iz({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Kue?this.maxMobileConcurrency:this.maxConcurrency}}const tde={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Qu{static isSupported(){return Iz.isSupported()}static getWorkerFarm(e={}){return Qu._workerFarm=Qu._workerFarm||new Qu({}),Qu._workerFarm.setProps(e),Qu._workerFarm}constructor(e){Kn(this,"props",void 0),Kn(this,"workerPools",new Map),this.props=ot({},tde),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ot(ot({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new ede({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function ide(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return Zc(r),r}function rde(n,e){return!!Qu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function sde(n,e,t,i,r){return CO.apply(this,arguments)}function CO(){return(CO=oi(function*(n,e,t,i,r){const s=n.id,o=ide(n,t),l=Qu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",ode.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function ode(n,e,t,i){return AO.apply(this,arguments)}function AO(){return(AO=oi(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}Kn(Qu,"_workerFarm",void 0);var Rz=Je(521);function Nz(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return Rz.toArrayBuffer?Rz.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function ude(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function Pz(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function dde(n){return MO.apply(this,arguments)}function MO(){return(MO=oi(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=aO(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return ude(...e)})).apply(this,arguments)}const pde=262144;function Fz(n){this.wrapped=n}function q0(n){return new Fz(n)}function Y0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof Fz;Promise.resolve(u?c.wrapped:c).then(function(h){u?r("return"===o?"return":"next",h):s(l.done?"return":"normal",h)},function(h){r("throw",h)})}catch(h){s("throw",h)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function IO(n){return function(){return new Y0(n.apply(this,arguments))}}function OO(){return(OO=IO(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield q0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function kz(n,e){return Mue?function(n,e){return RO.apply(this,arguments)}(n,e):function(n,e){return NO.apply(this,arguments)}(n,e)}function RO(){return(RO=IO(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield q0(r);if(s)return;yield Nz(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function NO(){return(NO=IO(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=aO(n);t=(o=yield q0(s.next())).done,a=yield q0(o.value),!t;t=!0)yield Nz(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield q0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function vde(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=pde}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(tm(n))return function(n,e){return OO.apply(this,arguments)}(n,e);if(gz(n))return kz(n,e);if(W0(n))return kz(n.body,e);throw new Error("makeIterator")}Y0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Y0.prototype.next=function(n){return this._invoke("next",n)},Y0.prototype.throw=function(n){return this._invoke("throw",n)},Y0.prototype.return=function(n){return this._invoke("return",n)};const PO="Cannot convert supplied data type";function wde(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(PO)}function Ede(n,e,t){return FO.apply(this,arguments)}function FO(){return(FO=oi(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return wde(n,e);if(tm(n)&&(n=yield yz(n)),W0(n)){const r=n;return yield Fue(r),e.binary?yield r.arrayBuffer():yield r.text()}if(gz(n)&&(n=vde(n,t)),wue(n)||Eue(n))return dde(n);throw new Error(PO)})).apply(this,arguments)}function xde(n,e,t=null){if(t)return t;const i=ot({fetch:Ez(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function Cde(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const Lz=()=>{const n=bO();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function Bz(n){const e=Lz();n=Array.isArray(n)?n:[n];for(const t of n){const i=cO(t);e.find(r=>i===r)||e.unshift(i)}}const Tde=/\.([^.]+)$/;function Mde(n){return BO.apply(this,arguments)}function BO(){return(BO=oi(function*(n,e=[],t,i){if(!Vz(n))return null;let r=jz(n,e,Sn(ot({},t),{nothrow:!0}),i);if(r)return r;if(tm(n)&&(r=jz(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(Uz(n));return r})).apply(this,arguments)}function jz(n,e=[],t,i){if(!Vz(n))return null;if(e&&!Array.isArray(e))return cO(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...Lz()),function(n){for(const e of n)cO(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=XS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=jO(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Tde.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||jO(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Pde(e,t))return t}else if(ArrayBuffer.isView(e)){if(zz(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&zz(e,0,t))return t;return null}(e,n),a=a||jO(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(Uz(n));return s}function Vz(n){return!(n instanceof Response&&204===n.status)}function Uz(n){const{url:e,type:t}=XS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?VO(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?VO(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function jO(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Pde(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function zz(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===VO(n,e,i.length);default:return!1}}(n,e,t,r))}function VO(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function QS(n,e,t,i){return UO.apply(this,arguments)}function UO(){return(UO=oi(function*(n,e,t,i){Zc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!lO(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=XS(n),o=Cde(e,i),a=yield Mde(n,o,t);return a?(i=xde({url:r,parse:QS,loaders:o},t=zue(t,a,o,r),i),yield Lde(a,n,t,i)):null})).apply(this,arguments)}function Lde(n,e,t,i){return zO.apply(this,arguments)}function zO(){return(zO=oi(function*(n,e,t,i){if(que(n),e=yield Ede(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(rde(n,t))return yield sde(n,e,t,i,QS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Zc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function K0(n,e,t,i){return HO.apply(this,arguments)}function HO(){return(HO=oi(function*(n,e,t,i){!Array.isArray(e)&&!lO(e)&&(t=e,e=void 0);const r=Ez(t);let s=n;return"string"==typeof n&&(s=yield r(n)),tm(n)&&(s=yield r(n)),yield QS(s,e,t)})).apply(this,arguments)}const Hz=Er(2,24)-1,Hde=Object.freeze([]),Gde=jS(({oldViewport:n,viewport:e})=>n.equals(e));let eu=new Uint8ClampedArray(0);const $de={data:{type:"data",value:Hde,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=Sn(ot({},r),{fetch:Sn(ot({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:K0(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):K0(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Vi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let X0=(()=>{class n extends bue{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=az(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=JU(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ot({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Vi.DEFAULT&&(t=i.isGeospatial?Vi.LNGLAT:Vi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=UU(t,i,r),h=az(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(h,h,t.projectPosition(l||c));return h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Vi.DEFAULT||t===Vi.LNGLAT||t===Vi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){fc(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=Jle(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const u of c)o.invalidateAll(u);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:u}=o.attributes,h=c||u;h&&(l&&h.constant&&(h.constant=!1,o.invalidate(h.id)),!h.value&&!l&&(h.constant=!0,h.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!Gde({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(eu.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>Hz&&Oi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),eu=M0.allocate(eu,i,{size:3,copy:!0,maxCount:Math.max(i,Hz)});const s=Math.floor(eu.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),eu[3*a+0]=o[0],eu[3*a+1]=o[1],eu[3*a+2]=o[2]}t.value=eu.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==eu.buffer&&(r.value=eu.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){To("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();To("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){To("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];$u(this.context.gl,{polygonOffset:l}),hc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&To("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=NU({newProps:n,oldProps:e,propTypes:KI(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&PU(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&PU(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Wle(n,e),transitionsChanged:Hle(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=KI(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new Ple(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){fc(!this.internalState&&!this.state),fc(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new vue({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Oi.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new jle(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){To("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=$de,n})(),Gz=(()=>{class n extends X0{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:C,fetch:H,_subLayerProps:U}=this.props,de={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:C,fetch:H},Ae=U&&U[t.id],Pe=Ae&&Ae.updateTriggers,Be=t.id||"sublayer";if(Ae){const et=this.constructor._propTypes,wt=t.type?t.type._propTypes:{};for(const vt in Ae){const xt=wt[vt]||et[vt];xt&&"accessor"===xt.type&&(Ae[vt]=this.getSubLayerAccessor(Ae[vt]))}}Object.assign(de,t,Ae),de.id="".concat(this.props.id,"-").concat(Be),de.updateTriggers=ot(ot({all:this.props.updateTriggers.all},t.updateTriggers),Pe);for(const et of C){const wt=et.getSubLayerProps.call(this,et);wt&&Object.assign(de,wt,{updateTriggers:Object.assign(de.updateTriggers,wt.updateTriggers)})}return de}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=TI(t,Boolean),this.internalState.subLayers=t),To("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const qde=/([0-9]+\.?[0-9]*)(%|px)/;function ZS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(qde);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function JS(n,e){return n.relative?Math.round(n.position*e):n.position}function Q0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&Q0(i,r)))return!1}return!0}class GO{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:u=1e3,modelMatrix:h=null,viewportInstance:p=null,type:g=em}=e;fc(!p||p instanceof em),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=Sn(ot({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:u,modelMatrix:h}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):Q0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ot({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:JS(this._x,e),y:JS(this._y,t),width:JS(this._width,e),height:JS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ot(ot({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ot(ot(ot({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=ZS(e),this._y=ZS(t),this._width=ZS(i),this._height=ZS(r)}}const Z0=()=>{},$z={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:Z0,onTransitionInterrupt:Z0,onTransitionEnd:Z0};class Yde{constructor(e,t={}){this.ControllerState=e,this.props=ot(ot({},$z),t),this.propsInTransition=null,this.transition=new V0(t.timeline),this.onViewStateChange=t.onViewStateChange||Z0,this.onStateChange=t.onStateChange||Z0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ot(ot({},$z),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ot(ot({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ot(ot({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const Wz=["longitude","latitude","zoom","bearing","pitch"],Xde=["longitude","latitude","zoom"];class qz extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!D0(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];fc(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:Wz,extract:Wz,required:Xde}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=SS(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ot(ot({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,SS(e.around,t.around,i)))}return r}}const dh={transitionDuration:0},Qde={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},tx=n=>1-(1-n)*(1-n),nm_WHEEL=["wheel"],nm_PAN=["panstart","panmove","panend"],nm_PINCH=["pinchstart","pinchmove","pinchend"],nm_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],nm_DOUBLE_TAP=["doubletap"],nm_KEYBOARD=["keydown"];class $O{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Yde(e,Sn(ot({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&Sn(ot({},Qde),{transitionInterpolator:new qz({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(nm_WHEEL,u&&i),this.toggleEvents(nm_PAN,u&&(r||s)),this.toggleEvents(nm_PINCH,u&&(a||l)),this.toggleEvents(nm_TRIPLE_PAN,u&&l),this.toggleEvents(nm_DOUBLE_TAP,u&&o),this.toggleEvents(nm_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ot(ot({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,dh,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,dh,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,Sn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:tx}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,dh,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,Sn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:tx}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,Sn(ot({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,dh,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,dh,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,Sn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:tx}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,dh,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,dh,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,Sn(ot({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:tx}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?Sn(ot({},t),{transitionInterpolator:new qz(Sn(ot({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:dh}}class Yz{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const hh_target=[0,0,0];class nx extends Yz{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=hh_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-(1/0),maxZoom:h=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:C,startZoom:H}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:C,startZoom:H},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(Sn(ot({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ot({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),ja(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new nx(ot(ot(ot({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=ja(r,i,t),e.rotationX=ja(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class Jde extends $O{constructor(e){super(nx,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class ehe extends $O{constructor(e){e.dragMode=e.dragMode||"pan",super(nx,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const the=(new qn).lookAt({eye:[0,0,1]});function nhe({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new qn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class ihe extends em{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(Sn(ot({},e),{longitude:null,position:a,viewMatrix:the.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:nhe({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=HS([],e,HU([],z0(t,this.pixelUnprojectionMatrix)));return{target:HS([],this.center,r)}}}let rhe=(()=>{class n extends GO{constructor(t){super(Sn(ot({},t),{type:ihe}))}get controller(){return this._getControllerProps({type:ehe})}}return n.displayName="OrthographicView",n})();const ix=Math.PI/180;function she({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*ix/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new qn).lookAt({eye:l,up:a});c.rotateX(i*ix),"Z"===t?c.rotateZ(r*ix):c.rotateY(r*ix);const u=Math.pow(2,s)/(n||1);return c.scale(u),c}class ohe extends em{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(Sn(ot({},e),{longitude:null,viewMatrix:she({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=z0([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let ahe=(()=>{class n extends GO{constructor(t={}){const{orbitAxis:i="Z"}=t;super(Sn(ot({},t),{orbitAxis:i,type:ohe}))}get controller(){return this._getControllerProps({type:Jde})}}return n.displayName="OrbitView",n})();const lhe=[255,255,255],che=1;let uhe=0;class Kz{constructor(e={}){const{color:t=lhe}=e,{intensity:i=che}=e;this.id=e.id||"ambient-".concat(uhe++),this.color=t,this.intensity=i,this.type="ambient"}}const dhe=[255,255,255],hhe=1,fhe=[0,0,-1];let phe=0;class Xz{constructor(e={}){const{color:t=dhe}=e,{intensity:i=hhe}=e,{direction:r=fhe}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(phe++),this.color=t,this.intensity=i,this.type="directional",this.direction=new Ao(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class Qz{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ot({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class WO extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ot({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return $u(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){$u(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,u=i&&i[c.id];r(c);const h=this._getDrawLayerParams(c,e);e.view=u;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const m=this._drawLayersInViewport(o,e,h);a.push(m)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=Zz(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let u=0;u<t.length;u++){const h=t[u],p=this._shouldDrawLayer(h,c,r),m={shouldDrawLayer:p,layerRenderIndex:l(h,p)};p&&(m.moduleParameters=this._getModuleParameters(h,s,i,o),m.layerParameters=this.getLayerParameters(h,u)),a[u]=m}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=jg(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;hc(e,{scissorTest:!0,scissor:a},()=>bI(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};$u(e,{viewport:a});for(let c=0;c<t.length;c++){const u=t[c],{shouldDrawLayer:h,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=o[c];if(h&&u.props.pickable&&l.pickableCount++,u.isComposite)l.compositeCount++;else if(h){l.visibleCount++,g.viewport=r;try{u.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(w){u.raiseError(w,"drawing ".concat(u," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:jg(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function Zz(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||Zz(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class yhe extends WO{constructor(e,t){super(e,t),this.shadowMap=new ma(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new zg(e,{format:33189,width:1,height:1}),this.fbo=new Fs(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;hc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=jg(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(Sn(ot({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const vhe=Object.keys(Vi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Vi[n],";")).join(""),whe=Object.keys(Yc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Yc[n],";")).join(""),Ehe="".concat(vhe,"\n").concat(whe,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),She={},qO={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:Ehe,getUniforms:function(n=She){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Vi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Vi.DEFAULT&&(i=n.isGeospatial?Vi.LNGLAT:Vi.CARTESIAN);const o=Mce({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||Cce,o}(n):{}}},The=jS(function({viewport:n,center:e}){return new qn(n.viewProjectionMatrix).invert().transform(e)}),Mhe=jS(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=z0([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new Ao(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new qn).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),Dhe=[0,0,0,1],Ihe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],YO={name:"shadow",dependencies:[qO],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Dhe,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=The({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Mhe({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new Ao(n.viewport.center).negate());e.project_uCoordinateSystem===Vi.LNGLAT&&e.project_uProjectionMode===Yc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Ihe),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Fhe={color:[255,255,255],intensity:1},Jz=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],khe=[0,0,0,200/255];class KO extends Qz{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=khe,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=B0.getDefaultProgramManager(e),YO&&this.programManager.addDefaultModule(YO)),this.dummyShadowMap||(this.dummyShadowMap=new ma(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(YO),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new qn).lookAt({eye:new Ao(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new yhe(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new Kz(Fhe),this.directionalLights.push(new Xz(Jz[0]),new Xz(Jz[1])))}}let Lhe=1,Bhe=1;class e4{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Lhe++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=Bhe++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class jhe{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=K0(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Vhe{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new jhe(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Uhe=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},qO],zhe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Hhe(n){const e=B0.getDefaultProgramManager(n);for(const t of Uhe)e.addDefaultModule(t);for(const t of zhe)e.addShaderHook(t);return e}const Whe=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class qhe{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Vhe({gl:e,protocol:"deck://"}),this.context=Sn(ot({},Whe),{layerManager:this,gl:e,deck:t,programManager:e&&Hhe(e),stats:i||new hI({id:"deck.gl"}),viewport:r||new em({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new e4,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){To("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=TI(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return To("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Oi.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Oi.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Yhe{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=TI(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Q0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Oi.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ot({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=Sn(ot(ot(ot({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let u=r[a.id];a.controller&&!u&&(s=!0),(s||!a.controller)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,l,c,u),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class Xhe extends Yz{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:u=20,minZoom:h=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:w,startRotatePos:C,startBearing:H,startPitch:U,startZoom:de,normalize:Ae}={}){fc(Number.isFinite(s)),fc(Number.isFinite(r)),fc(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:u,minZoom:h,maxPitch:p,minPitch:g,normalize:Ae}),this._state={startPanLngLat:m,startZoomLngLat:w,startRotatePos:C,startBearing:H,startPitch:U,startZoom:de},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(Sn(ot({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(Sn(ot({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ot({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ot(ot(ot({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=ja(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=ja(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=qU(t+180,360)-180),(o<-180||o>180)&&(o=qU(o+180,360)-180);const a=QI(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Jg([0,l])[1];if(i<c)i=c;else{const u=Jg([0,512-l])[1];i>u&&(i=u)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return ja(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=ja(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let u=0;return r>0?Math.abs(l-o)>5&&(u=r/(o-l)*1.2):r<0&&o>5&&(u=1-s/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:c,deltaScaleY:u}}}class Qhe extends $O{constructor(e){e.dragMode=e.dragMode||"pan",super(Xhe,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let Zhe=(()=>{class n extends GO{constructor(t){super(Sn(ot({},t),{type:oz}))}get controller(){return this._getControllerProps({type:Qhe})}}return n.displayName="MapView",n})();const Jhe=new KO;class efe{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!Q0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof KO)||this._internalEffects.push(Jhe)}}class tfe extends WO{}const n4={blendFunc:[1,0,32771,0],blendEquation:32774};class i4 extends WO{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},pass:h="picking",redrawReason:p,pickZ:g}){const m=this.gl;return this.pickZ=g,hc(m,Sn(ot({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},n4),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:h,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:Sn(ot({},n4),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ot(ot({},e.props.parameters),i)}}class ife{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new tfe(e),this.pickLayersPass=new i4(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Fs.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(Sn(ot({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,To("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Fs(this.gl),new Fs(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const rfe={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function sfe({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let u=r*r,h=-1,p=0;for(let g=0;g<c;g++){const m=g+a-i,w=m*m;if(w>u)p+=4*l;else for(let C=0;C<l;C++){if(n[p+3]-1>=0){const U=C+o-t,de=U*U+w;de<=u&&(u=de,h=p)}p+=4}}if(h>=0){const g=n[h+3]-1,m=n.slice(h,h+4),w=e[g];if(w){const C=w.decodePickingColor(m),H=Math.floor(h/4/l);return{pickedColor:m,pickedLayer:w,pickedObjectIndex:C,pickedX:o+(h/4-H*l),pickedY:a+H}}Oi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return rfe}function r4({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,u=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),h=u&&u.unproject([s-u.x,o-u.y],{targetZ:a});return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:h,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function afe(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const h=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==h){if(g!==p){const m=r.find(w=>w.props.id===p);m&&l.unshift(m)}t.layerId=g,t.index=a,t.info=null}}const c=r4(n),u=new Map;return u.set(null,c),l.forEach(h=>{let p=ot({},c);h===o&&(p.color=s,p.index=a,p.picked=!0),p=s4({layer:h,info:p,mode:i}),h===o&&"hover"===i&&(t.info=p),u.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),u}function s4({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class cfe{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new i4(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),h={x:e,y:t,viewport:c,coordinate:u,layer:l};return l?ot(ot({},s),h):Object.assign(h,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Fs(e),Fs.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Fs(e),this.depthFBO.attach({36064:new ma(e,{format:Si(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Oi.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:r4({viewports:i,x:r,y:s})};this._resizeBuffer();const h=jg(this.gl),p=cI(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*h),{width:w,height:C}=this.pickingFBO,H=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:w,deviceHeight:C});let U;const de=[],Ae={};for(let Pe=0;Pe<a;Pe++){const et=sfe({pickedColors:H&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:H,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:H});let wt;if(et.pickedLayer&&c&&this.depthFBO&&(wt=this._drawAndSample({layers:[et.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:et.pickedX,y:et.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),et.pickedColor&&Pe+1<a){const vt=et.pickedColor[3]-1;Ae[vt]=!0,e[vt].disablePickingIndex(et.pickedObjectIndex)}U=afe({pickInfo:et,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:wt,pixelRatio:h});for(const vt of U.values())vt.layer&&de.push(vt);if(!et.pickedColor)break}for(const Pe in Ae)e[Pe].restorePickingColors();return{result:de,emptyInfo:U&&U.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const h=jg(this.gl),p=cI(this.gl,[r,s],!0),g=p.x,m=p.y+p.height,w=cI(this.gl,[r+o,s+a],!0),H=w.y,Ae=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Oi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:H,width:w.x+w.width-g,height:m-H},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Pe=new Map,Be=Number.isFinite(c);for(let et=0;et<Ae.length&&!(Be&&Pe.size>=c);et++){const wt=Ae[et];let vt={color:wt.pickedColor,layer:null,index:wt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:h};vt=s4({layer:wt.pickedLayer,info:vt,mode:l}),Pe.has(vt.object)||Pe.set(vt.object,vt)}return Array.from(Pe.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:u,y:h,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return ES(c,{sourceX:u,sourceY:h,sourceWidth:p,sourceHeight:g,target:m}),m}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const ufe={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class dfe{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,ufe),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function o4(n,e){if(!n)throw new Error(e)}const tu={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},a4=tu.global||tu.self||tu.window,ffe="object"!=typeof process||"[object process]"!==String(process)||process.browser,l4="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:pfe}=(l4&&parseFloat(l4[1]),a4),XO="undefined"!=typeof Image,QO="undefined"!=typeof ImageBitmap,gfe=Boolean(pfe),ZO=!!ffe||gfe;function c4(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function u4(n){switch(c4(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const yfe=/^data:image\/svg\+xml/,bfe=/\.svg((\?|#).*)?$/;function JO(n){return n&&(yfe.test(n)||bfe.test(n))}function vfe(n,e){if(JO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return h4(n,e)}function h4(n,e){if(JO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function f4(n,e,t){return eR.apply(this,arguments)}function eR(){return(eR=oi(function*(n,e,t){const i=vfe(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield wfe(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function wfe(n,e){return tR.apply(this,arguments)}function tR(){return(tR=oi(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const Efe={};let p4=!0;function Sfe(n,e,t){return nR.apply(this,arguments)}function nR(){return(nR=oi(function*(n,e,t){let i;i=JO(t)?yield f4(n,e,t):h4(n,t);const r=e&&e.imagebitmap;return yield xfe(i,r)})).apply(this,arguments)}function xfe(n){return iR.apply(this,arguments)}function iR(){return(iR=oi(function*(n,e=null){if((Cfe(e)||!p4)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),p4=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function Cfe(n){for(const e in n||Efe)return!1;return!0}const nu=!1,J0=!0;function rR(n){const e=eb(n);return function(n){const e=eb(n);return e.byteLength>=24&&2303741511===e.getUint32(0,nu)?{mimeType:"image/png",width:e.getUint32(16,nu),height:e.getUint32(20,nu)}:null}(e)||function(n){const e=eb(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,nu)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,nu);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,nu),width:e.getUint16(s+7,nu)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,nu)}return null}(e)||function(n){const e=eb(n);return e.byteLength>=10&&1195984440===e.getUint32(0,nu)?{mimeType:"image/gif",width:e.getUint16(6,J0),height:e.getUint16(8,J0)}:null}(e)||function(n){const e=eb(n);return e.byteLength>=14&&16973===e.getUint16(0,nu)&&e.getUint32(2,J0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,J0),height:e.getUint32(22,J0)}:null}(e)}function eb(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Ofe(n,e){const{mimeType:t}=rR(n)||{},{_parseImageNode:i}=a4;return o4(i),i(n,t,e)}function sR(){return(sR=oi(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(Nfe(r)){case"imagebitmap":a=yield Sfe(n,e,s);break;case"image":a=yield f4(n,e,s);break;case"data":a=yield Ofe(n,e);break;default:o4(!1)}return"data"===r&&(a=u4(a)),a})).apply(this,arguments)}function Nfe(n){switch(n){case"auto":case"data":return function(){if(QO)return"imagebitmap";if(XO)return"image";if(ZO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return QO||XO||ZO;case"imagebitmap":return QO;case"image":return XO;case"data":return ZO;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const oR={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return sR.apply(this,arguments)},tests:[n=>Boolean(rR(new DataView(n)))],options:{image:{type:"auto",decode:!0}}};var im=Je(761);const Ffe={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},tb="8.5.8",rx=im.CO.deck&&im.CO.deck.VERSION;if(rx&&rx!==tb)throw new Error("deck.gl - multiple versions detected: ".concat(rx," vs ").concat(tb));rx||(Oi.log(1,"deck.gl ".concat(tb))(),im.CO.deck=Object.assign(im.CO.deck||{},{VERSION:tb,version:tb,log:Oi,_registerLoggers:function(n){OI=n}}),Bz([Ffe,[oR,{imagebitmap:{premultiplyAlpha:"none"}}]]));const kfe=im.CO.deck;class sx extends Wu{get[Symbol.toStringTag](){return"Query"}static isSupported(e,t=[]){const i=Si(e),r=SV(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:tn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return sx.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const g4=wS()&&"undefined"!=typeof document;let Wfe=0;class qfe{constructor(e={}){const{onCreateContext:t=(C=>iV(C)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:m=If.get("animation-loop-"+Wfe++)}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(pn.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return tn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=sx.isSupported(this.gl,["timers"])?new sx(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return oi(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return pn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=g4?new Promise((e,t)=>{g4&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?dI(this.props.gl,e):this.onCreateContext(e),!bS(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){$u(n,lI)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(pn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(pn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Fs(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Yfe=Je(524),ox=Je.n(Yfe);const Kfe={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(ox().PointerEventInput),function(n){n.prototype.handler=function(t){let i=Kfe[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(ox().MouseInput);const Jfe=ox().Manager,iu=ox(),epe=iu?[[iu.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[iu.Rotate,{enable:!1}],[iu.Pinch,{enable:!1}],[iu.Swipe,{enable:!1}],[iu.Pan,{threshold:0,enable:!1}],[iu.Press,{enable:!1}],[iu.Tap,{event:"doubletap",taps:2,enable:!1}],[iu.Tap,{event:"anytap",enable:!1}],[iu.Tap,{enable:!1}]]:null,y4={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},tpe={doubletap:["tap"]},npe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},lR={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},ipe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},b4={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},rpe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",rm="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let v4=!1;try{const n={get passive(){return v4=!0,!0}};rm.addEventListener("test",n,n),rm.removeEventListener("test",n,n)}catch(n){}const spe=-1!==rpe.indexOf("firefox"),{WHEEL_EVENTS:ope}=lR,E4=4.000244140625;class cpe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=ope.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!v4&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;rm.WheelEvent&&(spe&&e.deltaMode===rm.WheelEvent.DOM_DELTA_PIXEL&&(t/=rm.devicePixelRatio),e.deltaMode===rm.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%E4==0&&(t=Math.floor(t/E4)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:upe}=lR,S4="pointermove",x4="pointerover",C4="pointerout",A4="pointerleave";class dpe{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=upe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===S4&&(this.enableMoveEvent=t),e===x4&&(this.enableOverEvent=t),e===C4&&(this.enableOutEvent=t),e===A4&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:x4,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:C4,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:A4,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:S4,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:hpe}=lR,T4="keydown";class fpe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=hpe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===T4&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:T4,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const D4="contextmenu";class ppe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===D4&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:D4,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const gpe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},I4={srcElement:"root",priority:0};class Tpe{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},I4,i):I4;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:h}=i[l];if(u(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),h&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=gpe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Mpe={events:null,recognizers:null,recognizerOptions:{},Manager:Jfe,touchAction:"none",tabIndex:0};class Dpe{constructor(e=null,t={}){this.options=Object.assign({},Mpe,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||epe}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(y4).forEach(r=>{const s=this.manager.get(r);s&&y4[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new cpe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new dpe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new fpe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new ppe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=tpe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=b4[e]||e;let c=a.get(l);c||(c=new Tpe(this),a.set(l,c),c.recognizerName=ipe[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(b4[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=npe[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function Lf(){}const O4={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Lf,onResize:Lf,onViewStateChange:Lf,onInteractionStateChange:Lf,onBeforeRender:Lf,onAfterRender:Lf,onLoad:Lf,onError:(n,e)=>Oi.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class lx{constructor(e){e=ot(ot({},O4),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Oi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,im.qs)()&&Oi.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new hI({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&M0.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Oi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Oi.removed("onLayerClick","onClick")(),e.initialViewState&&!Q0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ot({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),fc(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u,autoResizeDrawingBuffer:h}=e;return new qfe({width:t,height:i,useDevicePixels:u,autoResizeDrawingBuffer:h,autoResizeViewport:!1,gl:r,onCreateContext:p=>iV(Sn(ot(ot({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Zhe({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,dI(e,{enable:!0,copyState:!0})),this.tooltip=new dfe(this.canvas),$u(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new e4;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Dpe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Uj)this.eventManager.on(r,this._onEvent);this.viewManager=new Yhe({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new qhe(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new efe,this.deckRenderer=new ife(e),this.deckPicker=new cfe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;$u(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ot({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Oi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=Sn(ot({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=Uj[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=If.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}lx.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(Qz)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},lx.defaultProps=O4,lx.VERSION=kfe.VERSION;const cx={name:"project32",dependencies:[qO],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Npe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},ux=ot({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=Npe){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),R4={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class fh{static get DRAW_MODE(){return R4}constructor(e={}){const{id:t=pa("geometry"),drawMode:i=R4.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ot({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,tn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(tn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return tn(Number.isFinite(i)),i}}const N4=()=>{},jpe={10241:9987,10240:9729,10242:33071,10243:33071};function Vpe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function Upe(n,e,t,i){return t===e.width&&i===e.height?e:(n.canvas.height=i,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.canvas)}function nb(n){return n&&(n.id||n.url)}function P4(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];n[nb(r)]=Sn(ot({},r),{x:s,y:t})}}class $pe{constructor(e,{onUpdate:t=N4,onError:i=N4}){this.gl=e,this.onUpdate=t,this.onError=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?nb(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,data:s,getIcon:o}){e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),o&&(this._getIcon=o),r&&(this._mapping=r),i&&this._updateIconAtlas(i),this._autoPacking&&(s||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(s))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(e){var t;null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=e,this.onUpdate()}_updateAutoPacking(e){const t=Object.values(function(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=TS(n);for(const o of r){s.index++;const a=e(o,s),l=nb(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[l]&&(!t[l]||a.url!==t[l].url)&&(i[l]=Sn(ot({},a),{source:o,sourceIndex:s.index}))}return i}(e,this._getIcon,this._mapping)||{});if(t.length>0){const{mapping:i,xOffset:r,yOffset:s,rowHeight:o,canvasHeight:a}=function({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<n.length;l++){const c=n[l];if(!t[nb(c)]){const{height:h,width:p}=c;i+p+e>o&&(P4(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:c,xOffset:i}),i=i+p+e,s=Math.max(s,h)}}return a.length>0&&P4(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:Vpe(s+r+e)}}({icons:t,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=r,this._yOffset=s,this._canvasHeight=a,this._texture||(this._texture=new ma(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:jpe})),this._texture.height!==this._canvasHeight&&(this._texture=function(n,e,t,i){const r=e.width,s=e.height,o=vV(e,{width:t,height:i});return function(n,e,t={}){const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=t;const{framebuffer:p,deleteFramebuffer:g}=T0(n);tn(p);const{gl:m,handle:w}=p,C=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const H=m.bindFramebuffer(36160,w);tn(e);let U=null;if(e instanceof Of&&(U=e,u=Number.isFinite(u)?u:U.width,h=Number.isFinite(h)?h:U.height,U.bind(0),e=U.target),C)switch(e){case 3553:case 34067:m.copyTexSubImage2D(e,s,a,l,i,r,u,h);break;case 35866:case 32879:Co(m).copyTexSubImage3D(e,s,a,l,c,i,r,u,h)}else m.copyTexImage2D(e,s,o,i,r,u,h,0);U&&U.unbind(),m.bindFramebuffer(36160,H||null),g&&p.delete()}(e,o,{targetY:0,width:r,height:s}),e.delete(),o}(0,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(t)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,K0(i.url,oR,this._loadOptions).then(r=>{const s=nb(i),{x:o,y:a,width:l,height:c}=this._mapping[s],u=Upe(t,r,l,c);this._texture.setSubImageData({data:u,x:o,y:a,width:l,height:c}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const F4=[0,0,0,255],Wpe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:F4},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};let qpe=(()=>{class n extends X0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[cx,ux]})}initializeState(){this.state={iconManager:new $pe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:F4},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:i,changeFlags:r}){super.updateState({props:i,oldProps:t,changeFlags:r});const s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c}=i,{iconManager:u}=this.state;u.setProps({loadOptions:i.loadOptions});let h=!1;if(o||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==i.iconAtlas&&u.setProps({iconAtlas:o,autoPacking:!1}),t.iconMapping!==i.iconMapping&&(u.setProps({iconMapping:a}),h=!0)):u.setProps({autoPacking:!0}),(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.setProps({data:l,getIcon:c}),h&&(s.invalidate("instanceOffsets"),s.invalidate("instanceIconFrames"),s.invalidate("instanceColorModes")),r.extensionsChanged){var g;const{gl:m}=this.context;null===(g=this.state.model)||void 0===g||g.delete(),this.state.model=this._getModel(m),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:i,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:o,billboard:a,alphaCutoff:l}=this.props,{iconManager:c}=this.state,{viewport:u}=this.context,h=c.getTexture();h&&this.state.model.setUniforms(t).setUniforms({iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeScale:i*("pixels"===o?u.metersPerPixel:1),sizeMinPixels:r,sizeMaxPixels:s,billboard:a,alphaCutoff:l}).draw()}_getModel(t){return new Kg(t,Sn(ot({},this.getShaders()),{id:this.props.id,geometry:new fh({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:i}=this.getCurrentLayer().props;i?i(t):Oi.error(t.error)()}getInstanceOffset(t){const i=this.state.iconManager.getIconMapping(t);return[i.width/2-i.anchorX||0,i.height/2-i.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const i=this.state.iconManager.getIconMapping(t);return[i.x||0,i.y||0,i.width||0,i.height||0]}}return n.layerName="IconLayer",n.defaultProps=Wpe,n})();const L4=[],Kpe={getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};let Xpe=(()=>{class n extends qpe{getShaders(){return Sn(ot({},super.getShaders()),{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(i,{index:r,target:s})=>this.encodePickingColor(r,s)}})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;let{outlineColor:s}=i;s!==r.outlineColor&&(s=s.map(o=>o/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!i.sdf&&i.outlineWidth&&Oi.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:i,smoothing:r,outlineWidth:s}=this.props,{outlineColor:o}=this.state;t.uniforms=Sn(ot({},t.uniforms),{buffer:.75,outlineBuffer:s?Math.max(r,.75*(1-s)):-1,gamma:r,sdf:Boolean(i),outlineColor:o}),super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map(i=>super.getInstanceOffset(i)):L4}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map(i=>super.getInstanceIconFrame(i)):L4}}return n.layerName="MultiIconLayer",n.defaultProps=Kpe,n})();var Qpe=Je(2),Zpe=Je.n(Qpe);const ege=[];function tge(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function B4(n,e,t,i){let r=0;for(let s=e;s<t;s++){const o=n[s];let a=null;const l=i&&i[o];l&&(a=l.width),r+=a}return r}function j4(n,e,t,i,r,s){let o=e,a=0;for(let l=e;l<t;l++){const c=B4(n,l,l+1,r);a+c>i&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function rge(n,e,t,i,r=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?j4(n,r,s,t,i,o):function(n,e,t,i,r,s){let o=e,a=e,l=e,c=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(l=u+1),l>a){let h=B4(n,a,l,r);c+h>i&&(o<a&&(s.push(a),o=a,c=0),h>i&&(h=j4(n,a,l,i,r,s),o=s[s.length-1])),a=l,c+=h}}(n,r,s,t,i,o),o}function sge(n,e,t,i,r,s){let o=0,a=0;for(let l=e;l<t;l++){const c=n[l],u=i[c];u?(a||(a=u.height),r[l]=o+u.width/2,o+=u.width):(Oi.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),r[l]=o,o+=32)}s[0]=o,s[1]=a}function V4(n,e,t,i,r){const s=(n=Array.from(n)).length,o=new Array(s),a=new Array(s),l=new Array(s),c=("break-word"===t||"break-all"===t)&&isFinite(i)&&i>0,u=[0,0],h=[];let p=0,g=0,m=0;for(let w=0;w<=s;w++){const C=n[w];if(("\n"===C||w===s)&&(m=w),m>g){const H=c?rge(n,t,i,r,g,m):ege;for(let U=0;U<=H.length;U++){const de=0===U?g:H[U-1],Ae=U<H.length?H[U]:m;sge(n,de,Ae,r,o,h);for(let Pe=de;Pe<Ae;Pe++)a[Pe]=p+h[1]/2,l[Pe]=h[0];p+=h[1]*e,u[0]=Math.max(u[0],h[0])}g=m}"\n"===C&&(o[g]=0,a[g]=0,l[g]=0,g++)}return u[1]=p,{x:o,y:a,rowWidth:l,size:u}}const U4=function(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),z4="Monaco, monospace",dR=new class{constructor(e=5){this.limit=e,this.clear()}clear(){this._cache={},this._order=[]}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}_deleteCache(e){delete this._cache[e]}_deleteOrder(e){const t=this._order.findIndex(i=>i===e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}(3),dge=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function fge(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function X4(n,e,t,i){n.font="".concat(i," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="baseline",n.textAlign="left"}class pge{constructor(){this.props={fontFamily:z4,fontWeight:"normal",characterSet:U4,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){dge.forEach(o=>{o in e&&(this.props[o]=e[o])});const t=this._key;this._key=this._getKey();const i=function(n,e){const t=dR.get(n);if(!t)return e;const i=[];let s=Object.keys(t.mapping);s=new Set(s);let o=e;return o instanceof Array&&(o=new Set(o)),o.forEach(a=>{s.has(a)||i.push(a)}),i}(this._key,this.props.characterSet),r=dR.get(this._key);if(r&&0===i.length)return void(this._key!==t&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,dR.set(this._key,s)}_generateFontAtlas(e,t,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:c,cutoff:u}=this.props;let h=i&&i.data;h||(h=document.createElement("canvas"),h.width=1024);const p=h.getContext("2d");X4(p,r,o,s);const{mapping:g,canvasHeight:m,xOffset:w,yOffset:C}=function({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o,u=0;for(const p of n)if(!s[p]){const g=e(p,u++);c+g+2*i>r&&(c=0,l++),s[p]={x:c+i,y:a+l*(t+2*i)+i,width:g,height:t},c+=g+2*i}const h=t+2*i;return{mapping:s,xOffset:c,yOffset:a+l*h,canvasHeight:tge(a+(l+1)*h)}}(ot({getFontWidth:H=>p.measureText(H).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}));if(h.height!==m){const H=p.getImageData(0,0,h.width,h.height);h.height=m,p.putImageData(H,0,0)}if(X4(p,r,o,s),l){const H=new(Zpe())(o,a,c,u,r,s),U=p.getImageData(0,0,H.size,H.size);for(const de of t)fge(H.draw(de),U),p.putImageData(U,g[de].x-a,g[de].y+a)}else for(const H of t)p.fillText(H,g[H].x,g[H].y+.9*o);return{xOffset:w,yOffset:C,mapping:g,data:h,width:h.width,height:h.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(i," ").concat(r)}}const _ge={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};let yge=(()=>{class n extends X0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[cx,ux]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),r.extensionsChanged){var s;const{gl:o}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(o),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:i}=this.context,{billboard:r,sizeScale:s,sizeUnits:o,sizeMinPixels:a,sizeMaxPixels:l,getLineWidth:c}=this.props;let{padding:u}=this.props;const h="pixels"===o?i.metersPerPixel:1;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:r,stroked:Boolean(c),padding:u,sizeScale:s*h,sizeMinPixels:a,sizeMaxPixels:l}).draw()}_getModel(t){return new Kg(t,Sn(ot({},this.getShaders()),{id:this.props.id,geometry:new fh({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}return n.layerName="TextBackgroundLayer",n.defaultProps=_ge,n})();const Q4={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},Z4={start:1,middle:0,end:-1},J4={top:1,center:0,bottom:-1},hR=[0,0,0,255],vge=["fontSize","buffer","sdf","radius","cutoff"],wge={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:hR},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:U4},fontFamily:z4,fontWeight:"normal",lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:hR},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:hR},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};let Ege=(()=>{class n extends Gz{initializeState(){this.state={styleVersion:0,fontAtlasManager:new pge}}updateState({props:t,oldProps:i,changeFlags:r}){const o=this.state.characterSet;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();const a=o!==this.state.characterSet||this._fontChanged(i,t);a&&this._updateFontAtlas(i,t),(a||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,i){const{fontSettings:r,fontFamily:s,fontWeight:o}=i,{fontAtlasManager:a,characterSet:l}=this.state;a.setProps(Sn(ot(ot({},Q4),r),{characterSet:l,fontFamily:s,fontWeight:o}))}_fontChanged(t,i){if(t.fontFamily!==i.fontFamily||t.fontWeight!==i.fontWeight)return!0;if(t.fontSettings===i.fontSettings)return!1;const r=t.fontSettings||{},s=i.fontSettings||{};return vge.some(o=>r[o]!==s[o])}_updateText(){const{data:t,characterSet:i}=this.props,r=t.attributes&&t.attributes.getText;let a,{getText:s}=this.props,{startIndices:o}=t;const l="auto"===i&&new Set;if(r&&o){const{texts:c,characterCount:u}=function({value:n,length:e,stride:t,offset:i,startIndices:r,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,l=i?i/o:0,c=r[e]||Math.ceil((n.length-l)/a),u=s&&new Set,h=new Array(e);let p=n;if(a>1||l>0){p=new n.constructor(c);for(let g=0;g<c;g++)p[g]=n[g*a+l]}for(let g=0;g<e;g++){const C=p.subarray(r[g],r[g+1]||c);h[g]=String.fromCodePoint.apply(null,C),u&&C.forEach(u.add,u)}if(u)for(const g of u)s.add(String.fromCodePoint(g));return{texts:h,characterCount:c}}(Sn(ot({},ArrayBuffer.isView(r)?{value:r}:r),{length:t.length,startIndices:o,characterSet:l}));a=u,s=(h,{index:p})=>c[p]}else{const{iterable:c,objectInfo:u}=TS(t);o=[0],a=0;for(const h of c){u.index++;const p=Array.from(s(h,u)||"");l&&p.forEach(l.add,l),a+=p.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||i})}getBoundingRect(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{size:[p,g]}=V4(h,l,o,a,r);return[(Z4["function"==typeof c?c(t,i):c]-1)*p/2,(J4["function"==typeof u?u(t,i):u]-1)*g/2,p,g]}getIconOffsets(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{x:p,y:g,rowWidth:m,size:[w,C]}=V4(h,l,o,a,r),H=Z4["function"==typeof c?c(t,i):c],U=J4["function"==typeof u?u(t,i):u],de=p.length,Ae=new Array(2*de);let Pe=0;for(let Be=0;Be<de;Be++)Ae[Pe++]=(H-1)*w/2+(1-H)*(w-m[Be])/2+p[Be],Ae[Pe++]=(U-1)*C/2+g[Be];return Ae}renderLayers(){const{startIndices:t,numInstances:i,getText:r,fontAtlasManager:{scale:s,texture:o,mapping:a},styleVersion:l}=this.state,{data:c,_dataDiff:u,getPosition:h,getColor:p,getSize:g,getAngle:m,getPixelOffset:w,getBackgroundColor:C,getBorderColor:H,getBorderWidth:U,backgroundPadding:de,background:Ae,billboard:Pe,fontSettings:Be,outlineWidth:et,outlineColor:wt,sizeScale:vt,sizeUnits:xt,sizeMinPixels:Bt,sizeMaxPixels:$t,transitions:gt,updateTriggers:mt}=this.props,Vt=this.getSubLayerClass("characters",Xpe),ft=this.getSubLayerClass("background",yge);return[Ae&&new ft({getFillColor:C,getLineColor:H,getLineWidth:U,padding:de,getPosition:h,getSize:g,getAngle:m,getPixelOffset:w,billboard:Pe,sizeScale:vt/this.state.fontAtlasManager.props.fontSize,sizeUnits:xt,sizeMinPixels:Bt,sizeMaxPixels:$t,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getSize:gt.getSize,getFillColor:gt.getBackgroundColor,getLineColor:gt.getBorderColor,getLineWidth:gt.getBorderWidth,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:mt.getPosition,getAngle:mt.getAngle,getSize:mt.getSize,getFillColor:mt.getBackgroundColor,getLineColor:mt.getBorderColor,getLineWidth:mt.getBorderWidth,getPixelOffset:mt.getPixelOffset,getBoundingRect:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c.attributes?{length:c.length,attributes:c.attributes.background||{}}:c,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new Vt({sdf:Be.sdf,smoothing:Number.isFinite(Be.smoothing)?Be.smoothing:Q4.smoothing,outlineWidth:et,outlineColor:wt,iconAtlas:o,iconMapping:a,getPosition:h,getColor:p,getSize:g,getAngle:m,getPixelOffset:w,billboard:Pe,sizeScale:vt*s,sizeUnits:xt,sizeMinPixels:Bt*s,sizeMaxPixels:$t*s,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getColor:gt.getColor,getSize:gt.getSize,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:mt.getText,getPosition:mt.getPosition,getAngle:mt.getAngle,getColor:mt.getColor,getSize:mt.getSize,getPixelOffset:mt.getPixelOffset,getIconOffsets:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c,_dataDiff:u,startIndices:t,numInstances:i,getIconOffsets:this.getIconOffsets.bind(this),getIcon:r})]}}return n.layerName="TextLayer",n.defaultProps=wge,n})();const e5="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Sge={lightSources:{}};function fR({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const pR={name:"lights",vs:e5,fs:e5,getUniforms:function t5(n=Sge){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?fR(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=fR(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=fR(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return t5({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Cge={};const Tge={name:"phong-lighting",dependencies:[pR],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Cge){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},gR=Math.PI/180,dx=new Float32Array(16),r5=new Float32Array(12);function s5(n,e,t){const i=e[0]*gR,r=e[1]*gR,s=e[2]*gR,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),u=Math.cos(i),h=Math.cos(r),p=t[0],g=t[1],m=t[2];n[0]=p*h*u,n[1]=p*l*u,n[2]=p*-a,n[3]=g*(-l*c+h*a*o),n[4]=g*(h*c+l*a*o),n[5]=g*u*o,n[6]=m*(l*o+h*a*c),n[7]=m*(-h*o+l*a*c),n[8]=m*u*c}function o5(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const a5={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,u=Array.isArray(s),h=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:h&&u&&p;const m=n.value;if(n.constant){let w;g?(dx.set(a),w=o5(dx)):(w=r5,s5(w,r,s),w.set(o,9)),n.value=new Float32Array(w)}else{let w=e*n.size;const{iterable:C,objectInfo:H}=TS(i,e,t);for(const U of C){let de;H.index++,g?(dx.set(c?a:a(U,H)),de=o5(dx)):(de=r5,s5(de,h?r:r(U,H),u?s:s(U,H)),de.set(p?o:o(U,H),9)),m[w++]=de[0],m[w++]=de[1],m[w++]=de[2],m[w++]=de[3],m[w++]=de[4],m[w++]=de[5],m[w++]=de[6],m[w++]=de[7],m[w++]=de[8],m[w++]=de[9],m[w++]=de[10],m[w++]=de[11]}}}};function l5(n,e){return e===Vi.CARTESIAN||e===Vi.METER_OFFSETS||e===Vi.DEFAULT&&!n.isGeospatial}function c5(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Oi.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Ige(n,e){if(n.attributes)return c5(n.attributes,e),n instanceof fh?n:new fh(n);if(n.positions||n.POSITION)return c5(n,e),new fh({attributes:n});throw Error("Invalid mesh")}const Oge={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let Rge=(()=>{class n extends X0{getShaders(){const t=!Si(this.context.gl),i={};return EI(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[cx,Tge,ux],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:a5}),this.setState({emptyTexture:new ma(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||l5(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new Kg(this.context.gl,Sn(ot({},this.getShaders()),{id:this.props.id,geometry:Ige(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=Oge,n})();const u5={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[pR]};class sm{constructor(e={}){const{id:t}=e;this.id=t||pa(this.constructor.name),this.display=!0,this.position=new Ao,this.rotation=new Ao,this.scale=new Ao(1,1,1),this.matrix=new qn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return tn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return tn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return tn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){tn(e),t=t||this.matrix;const i=new qn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class ib extends sm{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;pn.assert(t.every(i=>i instanceof sm),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new qn}={}){const i=new qn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof ib?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function d5(n,e){if(n===e){var t=e[1],i=e[2],r=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=i,n[7]=r}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n}function h5(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,p=-u*s+a*l,g=c*s-o*l,m=t*h+i*p+r*g;return m?(n[0]=h*(m=1/m),n[1]=(-u*i+r*c)*m,n[2]=(a*i-r*o)*m,n[3]=p*m,n[4]=(u*t-r*l)*m,n[5]=(-a*t+r*s)*m,n[6]=g*m,n[7]=(-c*t+i*l)*m,n[8]=(o*t-i*s)*m,n):null}function f5(n){var r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8];return n[0]*(c*s-o*l)+n[1]*(-c*r+o*a)+n[2]*(l*r-s*a)}function hx(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=t[0],g=t[1],m=t[2],w=t[3],C=t[4],H=t[5],U=t[6],de=t[7],Ae=t[8];return n[0]=p*i+g*o+m*c,n[1]=p*r+g*a+m*u,n[2]=p*s+g*l+m*h,n[3]=w*i+C*o+H*c,n[4]=w*r+C*a+H*u,n[5]=w*s+C*l+H*h,n[6]=U*i+de*o+Ae*c,n[7]=U*r+de*a+Ae*u,n[8]=U*s+de*l+Ae*h,n}function p5(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=t[0],g=t[1];return n[0]=i,n[1]=r,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=p*i+g*o+c,n[7]=p*r+g*a+u,n[8]=p*s+g*l+h,n}function g5(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=Math.sin(t),g=Math.cos(t);return n[0]=g*i+p*o,n[1]=g*r+p*a,n[2]=g*s+p*l,n[3]=g*o-p*i,n[4]=g*a-p*r,n[5]=g*l-p*s,n[6]=c,n[7]=u,n[8]=h,n}function fx(n,e,t){var i=t[0],r=t[1];return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=r*e[3],n[4]=r*e[4],n[5]=r*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function m5(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,w=s*o,C=s*a,H=s*l;return n[0]=1-h-m,n[3]=u-H,n[6]=p+C,n[1]=u+H,n[4]=1-c-m,n[7]=g-w,n[2]=p-C,n[5]=g+w,n[8]=1-c-h,n}function _5(){var n=new _a(4);return _a!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function y5(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function mR(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function px(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}function b5(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a,n}function v5(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a,n}function w5(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a,n}function E5(n,e){var t=e[0],i=e[1],r=e[2];return n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r)),n}function rb(n,e,t,i){var p,g,m,w,C,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],h=t[3];return(g=r*l+s*c+o*u+a*h)<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>Xc?(p=Math.acos(g),m=Math.sin(p),w=Math.sin((1-i)*p)/m,C=Math.sin(i*p)/m):(w=1-i,C=i),n[0]=w*r+C*l,n[1]=w*s+C*c,n[2]=w*o+C*u,n[3]=w*a+C*h,n}function S5(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;return n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a,n}function x5(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function _R(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}var C5=function(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},yR=BU,bR=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},A5=function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a),n},T5=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},M5=function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r},I5=function(){var n=TV(),e=MV(1,0,0),t=MV(0,1,0);return function(i,r,s){var o=DV(r,s);return o<-.999999?(O0(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&O0(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),mR(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(O0(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();_5(),_5(),function(){var n=new _a(9);_a!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const kge=[0,0,0,1];class vR extends xS{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return _R(this,e),this.check()}identity(){return y5(this),this.check()}fromAxisRotation(e,t){return mR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=ar(e)}get y(){return this[1]}set y(e){this[1]=ar(e)}get z(){return this[2]}set z(e){this[2]=ar(e)}get w(){return this[3]}set w(e){this[3]=ar(e)}len(){return T5(this)}lengthSquared(){return M5(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return bR(this,e)}rotationTo(e,t){return I5(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return C5(this,this,e),this.check()}calculateW(){return E5(this,this),this.check()}conjugate(){return x5(this,this),this.check()}invert(){return S5(this,this),this.check()}lerp(e,t,i){return A5(this,e,t,i),this.check()}multiplyRight(e,t){return Yu(!t),px(this,this,e),this.check()}multiplyLeft(e,t){return Yu(!t),px(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return b5(this,this,e),this.check()}rotateY(e){return v5(this,this,e),this.check()}rotateZ(e){return w5(this,this,e),this.check()}scale(e){return yR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=kge,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return rb(this,e,t,i),this.check()}transformVector4(e,t=e){return jU(t,e,this),I0(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const Lge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Bge={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function O5(n){if(!n._animation){const e=Bge[n.componentType],t=Lge[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const jge=new qn,wR=new vR;class $ge{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:pn.warn(`Bad animation path ${s}`)()}tn(r[s].length===i[c].length);const u=e[c],h=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":h>u&&function(n,e,t,i,r){if("rotation"===e){wR.slerp({start:t,target:i,ratio:r});for(let s=0;s<wR.length;s++)n[e][s]=wR[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-u)/(h-u));break;case"CUBICSPLINE":h>u&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,u=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*u}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:h-u,ratio:(a-u)/(h-u)});break;default:pn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=jge.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class Wge{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:O5(e.accessors[a]),interpolation:l,output:O5(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new $ge({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class qge extends sm{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof Kg?(this.model=e,this._setModelNodeProps(t)):this.model=new Kg(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class Yge{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},EI(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new ma(this.gl,ot({id:e.name||e.id,parameters:ot(ot({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(pn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function R5(n,e){return Si(n)?`#version 300 es\n${e}`:e}const Zge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Jge={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class eme{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Jge,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Wge(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new ib({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new ib({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new qn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new ib({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){pn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new Yge(n,e);pn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(u=>u.buffer));const c=new qge(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[u5],defines:a.defines,parameters:a.parameters,vs:R5(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:R5(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),pn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new hr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new ga({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Zge[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function N5(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Ha(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function P5(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function F5(n,e,t){const i=n.bufferViews[t];Ha(i);const s=e[i.buffer];return Ha(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const k5={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class om{constructor(e,t){Kn(this,"fields",void 0),Kn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new om(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new om(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof om){const o=e;t=o.fields,i=L5(L5(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new om(s,i)}}function L5(n,e){return new Map([...n||new Map,...e||new Map])}let Lr,B5,j5,V5,U5,z5,H5,G5;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Lr||(Lr={}));class ER{static isNull(e){return e&&e.typeId===Lr.Null}static isInt(e){return e&&e.typeId===Lr.Int}static isFloat(e){return e&&e.typeId===Lr.Float}static isBinary(e){return e&&e.typeId===Lr.Binary}static isUtf8(e){return e&&e.typeId===Lr.Utf8}static isBool(e){return e&&e.typeId===Lr.Bool}static isDecimal(e){return e&&e.typeId===Lr.Decimal}static isDate(e){return e&&e.typeId===Lr.Date}static isTime(e){return e&&e.typeId===Lr.Time}static isTimestamp(e){return e&&e.typeId===Lr.Timestamp}static isInterval(e){return e&&e.typeId===Lr.Interval}static isList(e){return e&&e.typeId===Lr.List}static isStruct(e){return e&&e.typeId===Lr.Struct}static isUnion(e){return e&&e.typeId===Lr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Lr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Lr.FixedSizeList}static isMap(e){return e&&e.typeId===Lr.Map}static isDictionary(e){return e&&e.typeId===Lr.Dictionary}get typeId(){return Lr.NONE}compareTo(e){return this===e}}Symbol,Symbol,B5=Symbol.toStringTag;class am extends ER{constructor(e,t){super(),Kn(this,"isSigned",void 0),Kn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Lr.Int}get[B5](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class ume extends am{constructor(){super(!0,8)}}class dme extends am{constructor(){super(!0,16)}}class hme extends am{constructor(){super(!0,32)}}class fme extends am{constructor(){super(!1,8)}}class pme extends am{constructor(){super(!1,16)}}class gme extends am{constructor(){super(!1,32)}}j5=Symbol.toStringTag;class $5 extends ER{constructor(e){super(),Kn(this,"precision",void 0),this.precision=e}get typeId(){return Lr.Float}get[j5](){return"Float"}toString(){return`Float${this.precision}`}}class mme extends $5{constructor(){super(32)}}class _me extends $5{constructor(){super(64)}}Symbol,Symbol,V5=Symbol.toStringTag,U5=Symbol.toStringTag,z5=Symbol.toStringTag,H5=Symbol.toStringTag,G5=Symbol.toStringTag;class yme extends ER{constructor(e,t){super(),Kn(this,"listSize",void 0),Kn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Lr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[G5](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class gx{constructor(e,t,i=!1,r=new Map){Kn(this,"name",void 0),Kn(this,"type",void 0),Kn(this,"nullable",void 0),Kn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new gx(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function W5(n,e,t){const i=t?q5(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new ume;case Uint8Array:return new fme;case Int16Array:return new dme;case Uint16Array:return new pme;case Int32Array:return new hme;case Uint32Array:return new gme;case Float32Array:return new mme;case Float64Array:return new _me;default:throw new Error("array type not supported")}}(e.value);return new gx(n,new yme(e.size,new gx("value",r)),!1,i)}function q5(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const Y5={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Eme={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class xme{constructor(e){Kn(this,"draco",void 0),Kn(this,"decoder",void 0),Kn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const u=a[c],h=a[c+1],p=a[c+2];e=u<e?u:e,t=h<t?h:t,i=p<i?p:i,r=u>r?u:r,s=h>s?h:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),u=function(n,e,t){const i=q5(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=W5(o,n[o],s[o]);r.push(l)}if(t){const o=W5("indices",t);r.push(o)}return new om(r,i)}(l.attributes,a,l.indices);return Sn(ot({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:u})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Eme[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,l,a,u),c=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in Y5)if(this.draco[o]===r)return Y5[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var mx=Je(125);const AR={};function TR(n){return MR.apply(this,arguments)}function MR(){return(MR=oi(function*(n,e=null,t={}){return e&&(n=Dme(n,e,t)),AR[n]=AR[n]||Ime(n),yield AR[n]})).apply(this,arguments)}function Dme(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:wO?t.CDN?(Zc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):EO?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function Ime(n){return DR.apply(this,arguments)}function DR(){return(DR=oi(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():wO?EO?importScripts(n):Ome(yield(yield fetch(n)).text(),n):mx.requireFromFile&&(yield mx.requireFromFile(n))})).apply(this,arguments)}function Ome(n,e){if(!wO)return mx.requireFromString&&mx.requireFromString(n,e);if(EO)return eval.call(Yue,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const Rme="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",Nme="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",Pme="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let sb;function kme(n){return IR.apply(this,arguments)}function IR(){return(IR=oi(function*(n){const e=n.modules||{};return sb=e.draco3d?sb||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):sb||Lme(n),yield sb})).apply(this,arguments)}function Lme(n){return RR.apply(this,arguments)}function RR(){return(RR=oi(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield TR(Rme,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield TR(Nme,"draco",n),yield TR(Pme,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield Bme(e,t)})).apply(this,arguments)}function Bme(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(Sn(ot({},t),{onModuleLoaded:r=>i({draco:r})}))})}const PR=Sn(ot({},k5),{parse:function(n,e){return FR.apply(this,arguments)}});function FR(){return(FR=oi(function*(n,e){const{draco:t}=yield kme(e),i=new xme(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function ab(n,e){return Ff(n>=0),Ff(e>0),n+(e-1)&~(e-1)}function Ume(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+ab(i.byteLength,4)}const K5=["SCALAR","VEC2","VEC3","VEC4"],zme=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Hme=new Map(zme),Gme={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$me={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Wme={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function X5(n){return K5[n-1]||K5[0]}function Q5(n){const e=Hme.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function Z5(n,e){const t=Wme[n.componentType],i=Gme[n.type],s=n.count*i,o=n.count*i*$me[n.componentType];return Ha(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const qme={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class gh{constructor(e){Kn(this,"gltf",void 0),Kn(this,"sourceBuffers",void 0),Kn(this,"byteLength",void 0),this.gltf=e||{json:ot({},qme),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Ha(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=Z5(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Ha(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Ha(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=rR(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Ha(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=ab(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:X5(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:Q5(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=Ume(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const J5="KHR_binary_glTF",lb="KHR_draco_mesh_compression",lm="KHR_lights_punctual",yx="KHR_materials_unlit",bx="KHR_techniques_webgl";function Xme(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=e8(i);e[t]=r}}return e}function e8(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:X5(t),componentType:Q5(e)}}function Jme(n,e,t){return kR.apply(this,arguments)}function kR(){return(kR=oi(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new gh(n),s=[];for(const o of r_e(r))r.getObjectExtension(o,lb)&&s.push(t_e(r,o,e,t));yield Promise.all(s),r.removeExtension(lb)})).apply(this,arguments)}function e_e(n,e={}){const t=new gh(n);for(const i of t.json.meshes||[])n_e(i),t.addRequiredExtension(lb)}function t_e(n,e,t,i){return LR.apply(this,arguments)}function LR(){return(LR=oi(function*(n,e,t,i){const r=n.getObjectExtension(e,lb);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=Pz(s.buffer,s.byteOffset),{parse:a}=i,l=ot({},t);delete l["3d-tiles"];const c=yield a(o,PR,l,i),u=Xme(c.attributes);for(const[h,p]of Object.entries(u))if(h in e.attributes){const m=n.getAccessor(e.attributes[h]);null!=m&&m.min&&null!=m&&m.max&&(p.min=m.min,p.max=m.max)}e.attributes=u,c.indices&&(e.indices=e8(c.indices)),i_e(e)})).apply(this,arguments)}function n_e(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[lb]:{bufferView:c,attributes:l}}}]}}function i_e(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*r_e(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function s_e(n){return BR.apply(this,arguments)}function BR(){return(BR=oi(function*(n){const e=new gh(n),{json:t}=e;e.removeExtension(yx);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,yx)})).apply(this,arguments)}function o_e(n){const e=new gh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,yx,{}),e.addExtension(yx))}function a_e(n){return jR.apply(this,arguments)}function jR(){return(jR=oi(function*(n){const e=new gh(n),{json:t}=e,i=e.getExtension(lm);i&&(e.json.lights=i.lights,e.removeExtension(lm));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,lm);s&&(r.light=s.light),e.removeObjectExtension(r,lm)}})).apply(this,arguments)}function l_e(n){return VR.apply(this,arguments)}function VR(){return(VR=oi(function*(n){const e=new gh(n),{json:t}=e;if(t.lights){const i=e.addExtension(lm);Ha(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,lm,i);delete e.json.lights}})).apply(this,arguments)}function c_e(n){return UR.apply(this,arguments)}function UR(){return(UR=oi(function*(n){const e=new gh(n),{json:t}=e,i=e.getExtension(bx);if(i){const r=d_e(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,bx);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=h_e(s.technique,e)),e.removeObjectExtension(s,bx)}e.removeExtension(bx)}})).apply(this,arguments)}function u_e(n,e){return zR.apply(this,arguments)}function zR(){return(zR=oi(function*(n,e){})).apply(this,arguments)}function d_e(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function h_e(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const t8={KHR_draco_mesh_compression:yt,KHR_materials_unlit:ee,KHR_lights_punctual:Tt,KHR_techniques_webgl:dt};function f_e(n){return HR.apply(this,arguments)}function HR(){return(HR=oi(function*(n,e={},t){for(const r in t8){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield t8[r].decode(n,e,t))}})).apply(this,arguments)}const n8={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},g_e={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class m_e{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new gh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,J5);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(J5)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in n8)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in n8)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=g_e[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function __e(n,e={}){return(new m_e).normalize(n,e)}const y_e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},b_e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Cl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},v_e={magFilter:Cl.TEXTURE_MAG_FILTER,minFilter:Cl.TEXTURE_MIN_FILTER,wrapS:Cl.TEXTURE_WRAP_S,wrapT:Cl.TEXTURE_WRAP_T},w_e={[Cl.TEXTURE_MAG_FILTER]:Cl.LINEAR,[Cl.TEXTURE_MIN_FILTER]:Cl.NEAREST_MIPMAP_LINEAR,[Cl.TEXTURE_WRAP_S]:Cl.REPEAT,[Cl.TEXTURE_WRAP_]:Cl.REPEAT};class x_e{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Ha(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ot({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ot({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ot({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ot({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ot({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ot({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ot({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return b_e[n]}(e.componentType),e.components=function(n){return y_e[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=Z5(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):w_e,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return v_e[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function C_e(n,e){return(new x_e).postProcess(n,e)}const i8=1735152710,cm=!0;function $R(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),ab(i,4)}function WR(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),ab(i,4)}function L_e(n,e){return qR.apply(this,arguments)}function qR(){return(qR=oi(function*(n,e,t=0,i,r){var s,o,a,l;B_e(n,e,t,i),__e(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield j_e(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const h=V_e(n,i,r);c.push(h)}const u=f_e(n,i,r);return c.push(u),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?C_e(n,i):n})).apply(this,arguments)}function B_e(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=i8}=t,s=i.getUint32(e,!1);return s===r||s===i8}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?N5(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?N5(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,cm),a=r.getUint32(t+8,cm);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){Ff(n.header.byteLength>20);const i=e.getUint32(t+0,cm),r=e.getUint32(t+4,cm);return t+=8,Ff(0===r),$R(n,e,t,i),(t+=i)+WR(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return Ff(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,cm),s=e.getUint32(t+4,cm);switch(t+=8,s){case 1313821514:$R(n,e,t,r);break;case 5130562:WR(n,e,t,r);break;case 0:i.strict||$R(n,e,t,r);break;case 1:i.strict||WR(n,e,t,r)}t+=ab(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),Ha("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else Ha(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function j_e(n,e,t){return YR.apply(this,arguments)}function YR(){return(YR=oi(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;Ha(a);const l=P5(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),u=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}}})).apply(this,arguments)}function V_e(n,e,t){return KR.apply(this,arguments)}function KR(){return(KR=oi(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(U_e(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function U_e(n,e,t,i,r){return XR.apply(this,arguments)}function XR(){return(XR=oi(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=P5(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=F5(n.json,n.buffers,e.bufferView);a=Pz(c.buffer,c.byteOffset,c.byteLength)}Ha(a,"glTF image has no data");const l=yield o(a,oR,{},r);n.images[t]=l})).apply(this,arguments)}const um={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return QR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function QR(){return(QR=oi(function*(n,e={},t){(e=ot(ot({},um.options),e)).gltf=ot(ot({},um.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield L_e({},n,i,e,t)})).apply(this,arguments)}function ZR(){return(ZR=oi(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield G_e(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function G_e(n){return JR.apply(this,arguments)}function JR(){return(JR=oi(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const r8=[255,255,255,255],q_e={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:r8},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[um]};let Y_e=(()=>{class n extends X0{getShaders(){const t=[cx,ux];return"pbr"===this.props._lighting&&t.push(u5),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:r8,transition:!0},instanceModelMatrix:a5})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof sm)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new eme(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ot({gltf:l},c),function(n){return ZR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Oi.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof sm?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Oi.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Oi.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Oi.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof sm&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ot({isInstanced:!0,transpileToGLSL100:!Si(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:u}=this.props,h=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(h),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:l5(s,u),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=q_e,n})();class K_e extends fh{constructor(e={}){const{id:t=pa("sphere-geometry")}=e,{indices:i,attributes:r}=function(n){const{nlat:e=10,nlong:t=10}=n;let{radius:i=1}=n;const o=Math.PI-0,c=2*Math.PI-0,u=(e+1)*(t+1);if("number"==typeof i){const H=i;i=(U,de,Ae,Pe,Be)=>H}const h=new Float32Array(3*u),p=new Float32Array(3*u),g=new Float32Array(2*u),w=new(u>65535?Uint32Array:Uint16Array)(e*t*6);for(let H=0;H<=e;H++)for(let U=0;U<=t;U++){const de=U/t,Ae=H/e,Pe=U+H*(t+1),Be=2*Pe,et=3*Pe,wt=c*de,vt=o*Ae,xt=Math.sin(wt),Bt=Math.cos(wt),$t=Math.sin(vt),mt=Bt*$t,Vt=Math.cos(vt),ft=xt*$t,qt=i(mt,Vt,ft,de,Ae);h[et+0]=qt*mt,h[et+1]=qt*Vt,h[et+2]=qt*ft,p[et+0]=mt,p[et+1]=Vt,p[et+2]=ft,g[Be+0]=de,g[Be+1]=1-Ae}const C=t+1;for(let H=0;H<t;H++)for(let U=0;U<e;U++){const de=6*(H*e+U);w[de+0]=U*C+H,w[de+1]=U*C+H+1,w[de+2]=(U+1)*C+H,w[de+3]=(U+1)*C+H,w[de+4]=U*C+H+1,w[de+5]=(U+1)*C+H+1}return{indices:{size:1,value:w},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:p},TEXCOORD_0:{size:2,value:g}}}}(e);super(Sn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}const Q_e={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class s8 extends fh{constructor(e={}){const{id:t=pa("truncated-code-geometry")}=e,{indices:i,attributes:r}=function(n){const{bottomRadius:e=0,topRadius:t=0,height:i=1,nradial:r=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:l=!1}=n,c=(a?2:0)+(l?2:0),u=(r+1)*(s+1+c),h=Math.atan2(e-t,i),p=Math.sin,g=Math.cos,m=Math.PI,w=g(h),C=p(h),H=a?-2:0,U=s+(l?2:0),de=r+1,Ae=new Uint16Array(r*(s+c)*6),Pe=Q_e[o],Be=new Float32Array(3*u),et=new Float32Array(3*u),wt=new Float32Array(2*u);let vt=0,xt=0;for(let Bt=H;Bt<=U;Bt++){let mt,$t=Bt/s,gt=i*$t;Bt<0?(gt=0,$t=1,mt=e):Bt>s?(gt=i,$t=1,mt=t):mt=e+Bt/s*(t-e),(-2===Bt||Bt===s+2)&&(mt=0,$t=0),gt-=i/2;for(let Vt=0;Vt<de;Vt++){const ft=p(Vt*m*2/r),qt=g(Vt*m*2/r);Be[vt+Pe[0]]=ft*mt,Be[vt+Pe[1]]=gt,Be[vt+Pe[2]]=qt*mt,et[vt+Pe[0]]=Bt<0||Bt>s?0:ft*w,et[vt+Pe[1]]=Bt<0?-1:Bt>s?1:C,et[vt+Pe[2]]=Bt<0||Bt>s?0:qt*w,wt[xt+0]=Vt/r,wt[xt+1]=$t,xt+=2,vt+=3}}for(let Bt=0;Bt<s+c;Bt++)for(let $t=0;$t<r;$t++){const gt=6*(Bt*r+$t);Ae[gt+0]=de*(Bt+0)+0+$t,Ae[gt+1]=de*(Bt+0)+1+$t,Ae[gt+2]=de*(Bt+1)+1+$t,Ae[gt+3]=de*(Bt+0)+0+$t,Ae[gt+4]=de*(Bt+1)+1+$t,Ae[gt+5]=de*(Bt+1)+0+$t}return{indices:Ae,attributes:{POSITION:{size:3,value:Be},NORMAL:{size:3,value:et},TEXCOORD_0:{size:2,value:wt}}}}(e);super(Sn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}class J_e extends s8{constructor(e={}){const{id:t=pa("cone-geometry"),radius:i=1,cap:r=!0}=e;super(Sn(ot({},e),{id:t,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:i}))}}class eye extends s8{constructor(e={}){const{id:t=pa("cylinder-geometry"),radius:i=1}=e;super(Sn(ot({},e),{id:t,bottomRadius:i,topRadius:i}))}}const tye=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),nye=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),iye=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),rye=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),sye={POSITION:{size:3,value:new Float32Array(nye)},NORMAL:{size:3,value:new Float32Array(iye)},TEXCOORD_0:{size:2,value:new Float32Array(rye)}};class oye extends fh{constructor(e={}){const{id:t=pa("cube-geometry")}=e;super(Sn(ot({},e),{id:t,indices:{size:1,value:new Uint16Array(tye)},attributes:ot(ot({},sye),e.attributes)}))}}class ru{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new le){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new le){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new ru){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],p=i[6],g=i[7],m=i[8],w=r[0],C=r[1],H=r[2],U=r[3],de=r[4],Ae=r[5],Pe=r[6],Be=r[7],et=r[8];return s[0]=o*w+a*U+l*Pe,s[1]=o*C+a*de+l*Be,s[2]=o*H+a*Ae+l*et,s[3]=c*w+u*U+h*Pe,s[4]=c*C+u*de+h*Be,s[5]=c*H+u*Ae+h*et,s[6]=p*w+g*U+m*Pe,s[7]=p*C+g*de+m*Be,s[8]=p*H+g*Ae+m*et,t}scale(e,t=new ru){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new le){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let u,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){u=4;do{p=4-u,s[p+4*o]+=s[p+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];u=4;do{p=4-u,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--u)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new ru){const r=aye;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,h;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{h=6-c,r[h+6*s]+=r[h+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=h<=s?0:r[h+6*o]-r[h+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=r[h+6*o]-r[h+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{h=6-c,r[h+6*s]=r[h+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(h=r[3+o+6*s],isNaN(h)||h===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,h)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,u=t*a,h=t*l,p=i*a,g=i*l,m=r*l,w=s*o,C=s*a,H=s*l,U=this.elements;return U[0]=1-(p+m),U[1]=u-H,U[2]=h+C,U[3]=u+H,U[4]=1-(c+m),U[5]=g-w,U[6]=h-C,U[7]=g+w,U[8]=1-(c+p),this}transpose(e=new ru){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const aye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class le{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new le(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new le(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new ru([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new le){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new le){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new le){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new le){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new le){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=lye,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=cye;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(o8),o8.almostEquals(e,t)}clone(){return new le(this.x,this.y,this.z)}}le.ZERO=void 0,le.UNIT_X=void 0,le.UNIT_Y=void 0,le.UNIT_Z=void 0,le.ZERO=new le(0,0,0),le.UNIT_X=new le(1,0,0),le.UNIT_Y=new le(0,1,0),le.UNIT_Z=new le(0,0,1);const lye=new le,cye=new le,o8=new le;class gr{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new le,this.upperBound=new le,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,a8),c=a8),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new gr).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=l8;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=l8;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,h=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(h,p)),m=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(h,p));return!(m<0||g>m)}}const a8=new le,l8=[new le,new le,new le,new le,new le,new le,new le,new le];class hs{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new le){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=dye;e.tangents(i,hye),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(Er(e.length(),2)*Er(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new hs){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+o*a+r*c-s*l,t.y=r*u+o*l+s*a-i*c,t.z=s*u+o*c+i*l-r*a,t.w=o*u-i*a-r*l-s*c,t}inverse(e=new hs){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new hs){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=u*c+g*-o+h*-l-p*-a,t.y=h*c+g*-a+p*-o-u*-l,t.z=p*c+g*-l+u*-a-h*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const h=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*h-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"YXZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"ZXY"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"ZYX"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"YZX"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):"XZY"===r&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new hs(this.x,this.y,this.z,this.w)}slerp(e,t,i=new hs){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,m,w,C,l=e.x,c=e.y,u=e.z,h=e.w;return g=r*l+s*c+o*u+a*h,g<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>1e-6?(p=Math.acos(g),m=Math.sin(p),w=Math.sin((1-t)*p)/m,C=Math.sin(t*p)/m):(w=1-t,C=t),i.x=w*r+C*l,i.y=w*s+C*c,i.z=w*o+C*u,i.w=w*a+C*h,i}integrate(e,t,i,r=new hs){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,h=this.w,p=.5*t;return r.x+=p*(s*h+o*u-a*c),r.y+=p*(o*h+a*l-s*u),r.z+=p*(a*h+s*c-o*l),r.w+=p*(-s*l-o*c-a*u),r}}const dye=new le,hye=new le,fye={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let gn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=fye,n})();class Wi{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new le,this.quaternion=new hs,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Wi.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Wi.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new le){return i.vsub(e,r),t.conjugate(u8),u8.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new le){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new le){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new le){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const u8=new hs;class Bf extends gn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:gn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new le;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let u=!1;for(let h=0;h!==i.length;h++)if(i[h].almostEquals(r)||i[h].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new le;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];Bf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new le,o=new le;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const u=new le;let h=-1,p=-Number.MAX_VALUE;for(let m=0;m<i.faces.length;m++){u.copy(i.faceNormals[m]),s.vmult(u,u);const w=u.dot(o);w>p&&(p=w,h=m)}const g=[];for(let m=0;m<i.faces[h].length;m++){const w=i.vertices[i.faces[h][m]],C=new le;C.copy(w),s.vmult(C,C),r.vadd(C,C),g.push(C)}h>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new le,u=new le,h=new le,p=new le,g=new le,m=new le;let w=Number.MAX_VALUE;const C=this;if(C.uniqueAxes)for(let H=0;H!==C.uniqueAxes.length;H++){i.vmult(C.uniqueAxes[H],c);const U=C.testSepAxis(c,e,t,i,r,s);if(!1===U)return!1;U<w&&(w=U,o.copy(c))}else{const H=a?a.length:C.faces.length;for(let U=0;U<H;U++){c.copy(C.faceNormals[a?a[U]:U]),i.vmult(c,c);const Ae=C.testSepAxis(c,e,t,i,r,s);if(!1===Ae)return!1;Ae<w&&(w=Ae,o.copy(c))}}if(e.uniqueAxes)for(let H=0;H!==e.uniqueAxes.length;H++){s.vmult(e.uniqueAxes[H],u);const U=C.testSepAxis(u,e,t,i,r,s);if(!1===U)return!1;U<w&&(w=U,o.copy(u))}else{const H=l?l.length:e.faces.length;for(let U=0;U<H;U++){u.copy(e.faceNormals[l?l[U]:U]),s.vmult(u,u);const Ae=C.testSepAxis(u,e,t,i,r,s);if(!1===Ae)return!1;Ae<w&&(w=Ae,o.copy(u))}}for(let H=0;H!==C.uniqueEdges.length;H++){i.vmult(C.uniqueEdges[H],p);for(let U=0;U!==e.uniqueEdges.length;U++)if(s.vmult(e.uniqueEdges[U],g),p.cross(g,m),!m.almostZero()){m.normalize();const de=C.testSepAxis(m,e,t,i,r,s);if(!1===de)return!1;de<w&&(w=de,o.copy(m))}}return r.vsub(t,h),h.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){Bf.project(this,e,i,r,eN),Bf.project(t,e,s,o,tN);const l=eN[0],c=eN[1],u=tN[0],h=tN[1];if(l<h||u<c)return!1;const p=l-h,g=u-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new le,r=new le;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new le,c=new le,u=new le,h=new le,p=new le,g=new le,m=new le,w=new le,C=this,U=r,de=[];let Ae=-1,Pe=Number.MAX_VALUE;for(let xt=0;xt<C.faces.length;xt++){l.copy(C.faceNormals[xt]),i.vmult(l,l);const Bt=l.dot(e);Bt<Pe&&(Pe=Bt,Ae=xt)}if(Ae<0)return;const Be=C.faces[Ae];Be.connectedFaces=[];for(let xt=0;xt<C.faces.length;xt++)for(let Bt=0;Bt<C.faces[xt].length;Bt++)-1!==Be.indexOf(C.faces[xt][Bt])&&xt!==Ae&&-1===Be.connectedFaces.indexOf(xt)&&Be.connectedFaces.push(xt);const et=Be.length;for(let xt=0;xt<et;xt++){const Bt=C.vertices[Be[xt]];Bt.vsub(C.vertices[Be[(xt+1)%et]],c),u.copy(c),i.vmult(u,u),t.vadd(u,u),h.copy(this.faceNormals[Ae]),i.vmult(h,h),t.vadd(h,h),u.cross(h,p),p.negate(p),g.copy(Bt),i.vmult(g,g),t.vadd(g,g);const gt=Be.connectedFaces[xt];m.copy(this.faceNormals[gt]);const mt=this.getPlaneConstantOfFace(gt);w.copy(m),i.vmult(w,w);const Vt=mt-w.dot(t);for(this.clipFaceAgainstPlane(U,de,w,Vt);U.length;)U.shift();for(;de.length;)U.push(de.shift())}m.copy(this.faceNormals[Ae]);const wt=this.getPlaneConstantOfFace(Ae);w.copy(m),i.vmult(w,w);const vt=wt-w.dot(t);for(let xt=0;xt<U.length;xt++){let Bt=w.dot(U[xt])+vt;if(Bt<=s&&(console.log("clamped: depth="+Bt+" to minDist="+s),Bt=s),Bt<=o){const $t=U[xt];Bt<=1e-6&&a.push({point:$t,normal:w,depth:Bt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let u=0;u<a;u++){if(c=e[u],o=i.dot(c)+r,s<0)if(o<0){const h=new le;h.copy(c),t.push(h)}else{const h=new le;l.lerp(c,s/(s-o),h),t.push(h)}else if(o<0){const h=new le;l.lerp(c,s/(s-o),h),t.push(h),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new le);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new le);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,u,h,p=new le;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const m=p;(void 0===o||m.x<o)&&(o=m.x),(void 0===c||m.x>c)&&(c=m.x),(void 0===a||m.y<a)&&(a=m.y),(void 0===u||m.y>u)&&(u=m.y),(void 0===l||m.z<l)&&(l=m.z),(void 0===h||m.z>h)&&(h=m.z)}i.set(o,a,l),r.set(c,u,h)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new le){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new le;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new le;e.vsub(l,c);const u=a.dot(c),h=new le;s.vsub(l,h);const p=a.dot(h);if(u<0&&p>0||u>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=pye;let l=0,c=0;const u=gye,h=e.vertices;u.setZero(),Wi.vectorToLocalFrame(i,r,t,a),Wi.pointToLocalFrame(i,r,u,u);const p=u.dot(a);c=l=h[0].dot(a);for(let g=1;g<o;g++){const m=h[g].dot(a);m>l&&(l=m),m<c&&(c=m)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const eN=[],tN=[],pye=new le,gye=new le;class wx extends gn{constructor(e){super({type:gn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=le,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new Bf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new le){return wx.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)mh.set(s[o][0],s[o][1],s[o][2]),t.vmult(mh,mh),e.vadd(mh,mh),i(mh.x,mh.y,mh.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;su[0].set(s.x,s.y,s.z),su[1].set(-s.x,s.y,s.z),su[2].set(-s.x,-s.y,s.z),su[3].set(-s.x,-s.y,-s.z),su[4].set(s.x,-s.y,-s.z),su[5].set(s.x,s.y,-s.z),su[6].set(-s.x,s.y,-s.z),su[7].set(s.x,-s.y,s.z);const o=su[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=su[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,u=l.y,h=l.z;c>r.x&&(r.x=c),u>r.y&&(r.y=u),h>r.z&&(r.z=h),c<i.x&&(i.x=c),u<i.y&&(i.y=u),h<i.z&&(i.z=h)}}}const mh=new le,su=[new le,new le,new le,new le,new le,new le,new le,new le];class mn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=mn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new le,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new le,this.previousPosition=new le,this.interpolatedPosition=new le,this.initPosition=new le,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new le,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new le,this.force=new le;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?mn.STATIC:mn.DYNAMIC,typeof e.type==typeof mn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=mn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new le,this.quaternion=new hs,this.initQuaternion=new hs,this.previousQuaternion=new hs,this.interpolatedQuaternion=new hs,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new le,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new le,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new le,this.invInertia=new le,this.invInertiaWorld=new ru,this.invMassSolve=0,this.invInertiaSolve=new le,this.invInertiaWorldSolve=new ru,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new le(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new le(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new gr,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new le,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=mn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===mn.SLEEPING&&this.dispatchEvent(mn.wakeupEvent)}sleep(){this.sleepState=mn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=Er(this.sleepSpeedLimit,2);t===mn.AWAKE&&i<r?(this.sleepState=mn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(mn.sleepyEvent)):t===mn.SLEEPY&&i>r?this.wakeUp():t===mn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(mn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===mn.SLEEPING||this.type===mn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new le){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new le){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new le,s=new hs;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=mye,o=_ye,a=this.quaternion,l=this.aabb,c=yye;for(let u=0;u!==r;u++){const h=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),h.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===u?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=bye,r=vye;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new le){if(this.type!==mn.DYNAMIC)return;this.sleepState===mn.SLEEPING&&this.wakeUp();const i=wye;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new le){if(this.type!==mn.DYNAMIC)return;const i=Eye,r=Sye;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===mn.DYNAMIC&&(this.sleepState===mn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new le){if(this.type!==mn.DYNAMIC)return;this.sleepState===mn.SLEEPING&&this.wakeUp();const i=t,r=xye;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=Cye;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new le){if(this.type!==mn.DYNAMIC)return;const i=Aye,r=Tye;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=Mye;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),wx.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new le;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==mn.DYNAMIC&&this.type!==mn.KINEMATIC||this.sleepState===mn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,h=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const m=h.elements,w=this.angularFactor,C=l.x*w.x,H=l.y*w.y,U=l.z*w.z;s.x+=e*(m[0]*C+m[1]*H+m[2]*U),s.y+=e*(m[3]*C+m[4]*H+m[5]*U),s.z+=e*(m[6]*C+m[7]*H+m[8]*U),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}mn.idCounter=0,mn.COLLIDE_EVENT_NAME="collide",mn.DYNAMIC=1,mn.STATIC=2,mn.KINEMATIC=4,mn.AWAKE=0,mn.SLEEPY=1,mn.SLEEPING=2,mn.wakeupEvent={type:"wakeup"},mn.sleepyEvent={type:"sleepy"},mn.sleepEvent={type:"sleep"};const mye=new le,_ye=new hs,yye=new gr,bye=new ru,vye=new ru,wye=new le,Eye=new le,Sye=new le,xye=new le,Cye=new le,Aye=new le,Tye=new le,Mye=new le;new le,new le;class Ex{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new le,this.rayToWorld=new le,this.hitNormalWorld=new le,this.hitPointWorld=new le,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let d8,h8,f8,p8,g8,m8,_8;d8=gn.types.SPHERE,h8=gn.types.PLANE,f8=gn.types.BOX,p8=gn.types.CYLINDER,g8=gn.types.CONVEXPOLYHEDRON,m8=gn.types.HEIGHTFIELD,_8=gn.types.TRIMESH;class bs{get[d8](){return this._intersectSphere}get[h8](){return this._intersectPlane}get[f8](){return this._intersectBox}get[p8](){return this._intersectConvex}get[g8](){return this._intersectConvex}get[m8](){return this._intersectHeightfield}get[_8](){return this._intersectTrimesh}constructor(e=new le,t=new le){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new le,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=bs.ANY,this.result=new Ex,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||bs.ANY,this.result=t.result||new Ex,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(y8),sN.length=0,e.broadphase.aabbQuery(e,y8,sN),this.intersectBodies(sN),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=Fye,s=kye;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,jf);const i=jf.dot(e);return e.scale(i,xx),xx.vadd(n,xx),t.distanceTo(xx)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new le(0,0,1);t.vmult(c,c);const u=new le;o.vsub(i,u);const h=u.dot(c);if(a.vsub(i,u),h*u.dot(c)>0||o.distanceTo(a)<h)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const m=new le,w=new le,C=new le;o.vsub(i,m);const H=-c.dot(m)/g;l.scale(H,w),o.vadd(w,C),this.reportIntersection(c,C,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=Lye;o.from.copy(this.from),o.to.copy(this.to),Wi.pointToLocalFrame(i,t,o.from,o.from),Wi.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=Bye;let l,c,u,h;l=c=0,u=h=e.data.length-1;const p=new gr;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),u=Math.min(u,a[0]+1),h=Math.min(h,a[1]+1);for(let g=l;g<u;g++)for(let m=c;m<h;m++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,m,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,m,!1),Wi.pointToWorldFrame(i,t,e.pillarOffset,Sx),this._intersectConvex(e.pillarConvex,t,Sx,r,s,b8),this.result.shouldStop)return;e.getConvexTrianglePillar(g,m,!0),Wi.pointToWorldFrame(i,t,e.pillarOffset,Sx),this._intersectConvex(e.pillarConvex,t,Sx,r,s,b8)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=Er(a.x-o.x,2)+Er(a.y-o.y,2)+Er(a.z-o.z,2),u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=Er(o.x-i.x,2)+Er(o.y-i.y,2)+Er(o.z-i.z,2)-Er(l,2),p=Er(u,2)-4*c*h,g=jye,m=Vye;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1);else{const w=(-u-Math.sqrt(p))/(2*c),C=(-u+Math.sqrt(p))/(2*c);if(w>=0&&w<=1&&(o.lerp(a,w,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1)),this.result.shouldStop)return;C>=0&&C<=1&&(o.lerp(a,C,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=Uye,l=v8,c=o&&o.faceList||null,u=e.faces,h=e.vertices,p=e.faceNormals,g=this.direction,m=this.from,C=m.distanceTo(this.to),H=c?c.length:u.length,U=this.result;for(let de=0;!U.shouldStop&&de<H;de++){const Ae=c?c[de]:de,Pe=u[Ae],Be=p[Ae],et=t,wt=i;l.copy(h[Pe[0]]),et.vmult(l,l),l.vadd(wt,l),l.vsub(m,l),et.vmult(Be,a);const vt=g.dot(a);if(Math.abs(vt)<this.precision)continue;const xt=a.dot(l)/vt;if(!(xt<0)){g.scale(xt,ya),ya.vadd(m,ya),_c.copy(h[Pe[0]]),et.vmult(_c,_c),wt.vadd(_c,_c);for(let Bt=1;!U.shouldStop&&Bt<Pe.length-1;Bt++){ou.copy(h[Pe[Bt]]),au.copy(h[Pe[Bt+1]]),et.vmult(ou,ou),et.vmult(au,au),wt.vadd(ou,ou),wt.vadd(au,au);const $t=ya.distanceTo(m);!bs.pointInTriangle(ya,_c,ou,au)&&!bs.pointInTriangle(ya,ou,_c,au)||$t>C||this.reportIntersection(a,ya,s,r,Ae)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=zye,l=Yye,c=Kye,u=v8,h=Hye,p=Gye,g=$ye,m=qye,w=Wye,C=e.indices,H=this.from,U=this.to,de=this.direction;c.position.copy(i),c.quaternion.copy(t),Wi.vectorToLocalFrame(i,t,de,h),Wi.pointToLocalFrame(i,t,H,p),Wi.pointToLocalFrame(i,t,U,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,h),h.normalize();const Ae=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Pe=0,Be=l.length;!this.result.shouldStop&&Pe!==Be;Pe++){const et=l[Pe];e.getNormal(et,a),e.getVertex(C[3*et],_c),_c.vsub(p,u);const wt=h.dot(a),vt=a.dot(u)/wt;if(vt<0)continue;h.scale(vt,ya),ya.vadd(p,ya),e.getVertex(C[3*et+1],ou),e.getVertex(C[3*et+2],au);const xt=ya.distanceSquared(p);!bs.pointInTriangle(ya,ou,_c,au)&&!bs.pointInTriangle(ya,_c,ou,au)||xt>Ae||(Wi.vectorToWorldFrame(t,a,w),Wi.pointToWorldFrame(i,t,ya,m),this.reportIntersection(w,m,s,r,et))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case bs.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case bs.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case bs.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,jf),i.vsub(t,cb),e.vsub(t,oN);const s=jf.dot(jf),o=jf.dot(cb),a=jf.dot(oN),l=cb.dot(cb),c=cb.dot(oN);let u,h;return(u=l*a-o*c)>=0&&(h=s*c-o*a)>=0&&u+h<s*l-o*o}}bs.CLOSEST=1,bs.ANY=2,bs.ALL=4;const y8=new gr,sN=[],cb=new le,oN=new le,Fye=new le,kye=new hs,ya=new le,_c=new le,ou=new le,au=new le,b8={faceList:[0]},Sx=new le,Lye=new bs,Bye=[],jye=new le,Vye=new le,Uye=new le,v8=new le,zye=new le,Hye=new le,Gye=new le,$ye=new le,Wye=new le,qye=new le;new gr;const Yye=[],Kye=new Wi,jf=new le,xx=new le;let F8,k8,L8,B8,j8,V8,U8,z8,H8,G8,$8,W8,q8,Y8,K8,X8,Q8,Z8,J8,e6,t6,n6,i6,r6,s6;new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new bs,new le,new le,new le(1,0,0),new le(0,1,0),new le(0,0,1),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new gr,new le,new gr,new le,new le,new le,new le,new le,new le,new le,new gr,new le,new Wi,new gr;const Nr={sphereSphere:gn.types.SPHERE,spherePlane:gn.types.SPHERE|gn.types.PLANE,boxBox:gn.types.BOX|gn.types.BOX,sphereBox:gn.types.SPHERE|gn.types.BOX,planeBox:gn.types.PLANE|gn.types.BOX,convexConvex:gn.types.CONVEXPOLYHEDRON,sphereConvex:gn.types.SPHERE|gn.types.CONVEXPOLYHEDRON,planeConvex:gn.types.PLANE|gn.types.CONVEXPOLYHEDRON,boxConvex:gn.types.BOX|gn.types.CONVEXPOLYHEDRON,sphereHeightfield:gn.types.SPHERE|gn.types.HEIGHTFIELD,boxHeightfield:gn.types.BOX|gn.types.HEIGHTFIELD,convexHeightfield:gn.types.CONVEXPOLYHEDRON|gn.types.HEIGHTFIELD,sphereParticle:gn.types.PARTICLE|gn.types.SPHERE,planeParticle:gn.types.PLANE|gn.types.PARTICLE,boxParticle:gn.types.BOX|gn.types.PARTICLE,convexParticle:gn.types.PARTICLE|gn.types.CONVEXPOLYHEDRON,cylinderCylinder:gn.types.CYLINDER,sphereCylinder:gn.types.SPHERE|gn.types.CYLINDER,planeCylinder:gn.types.PLANE|gn.types.CYLINDER,boxCylinder:gn.types.BOX|gn.types.CYLINDER,convexCylinder:gn.types.CONVEXPOLYHEDRON|gn.types.CYLINDER,heightfieldCylinder:gn.types.HEIGHTFIELD|gn.types.CYLINDER,particleCylinder:gn.types.PARTICLE|gn.types.CYLINDER,sphereTrimesh:gn.types.SPHERE|gn.types.TRIMESH,planeTrimesh:gn.types.PLANE|gn.types.TRIMESH};F8=Nr.sphereSphere,k8=Nr.spherePlane,L8=Nr.boxBox,B8=Nr.sphereBox,j8=Nr.planeBox,V8=Nr.convexConvex,U8=Nr.sphereConvex,z8=Nr.planeConvex,H8=Nr.boxConvex,G8=Nr.sphereHeightfield,$8=Nr.boxHeightfield,W8=Nr.convexHeightfield,q8=Nr.sphereParticle,Y8=Nr.planeParticle,K8=Nr.boxParticle,X8=Nr.convexParticle,Q8=Nr.cylinderCylinder,Z8=Nr.sphereCylinder,J8=Nr.planeCylinder,e6=Nr.boxCylinder,t6=Nr.convexCylinder,n6=Nr.heightfieldCylinder,i6=Nr.particleCylinder,r6=Nr.sphereTrimesh,s6=Nr.planeTrimesh,new le,new le,new le,new le,new le,new hs,new hs,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new gr,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new hs,new le,new le,new le,new le,new le,new le,new le,new le,new gr,new bs;const Xs=globalThis.performance||{};if(!Xs.now){let n=Date.now();Xs.timing&&Xs.timing.navigationStart&&(n=Xs.timing.navigationStart),Xs.now=()=>Date.now()-n}var Hf=Je(517);class Br extends se{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $;return this._value}next(e){super.next(this._value=e)}}function pm(n,e,t){e||(e=new qn(qn.IDENTITY));const i=new qn(qn.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new qn(qn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new qn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===pm(s,r,t))return!1;return!0}function d6(){Bz([k5,um])}function h6(n,e){var t;const i=null===(t=e.nodes)||void 0===t?void 0:t.find(r=>r.name===n);if(i){let r=!1;for(const s of e.scenes)r||pm(s,new qn(qn.IDENTITY),(o,a)=>o!==i||(o.matrix=a,o.translation=void 0,o.rotation=void 0,o.scale=void 0,r=!0,!1));return e.scene={id:n,name:n,nodes:[i]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function cN(n,e){return ki(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield QS(i,um,{DracoLoader:PR,gltf:{decompressMeshes:!0,postProcess:!0}});return r.nodes||console.log("WARNING: Empty Scene",t,r),h6(n.scenegraphNode,r)})}function Xve(n,e){return ki(this,void 0,void 0,function*(){return h6(n,yield e)})}function uN(n,e,t){if(e&&0!==e.length){let i;switch(t.geometry){case"sphere":i=new K_e;break;case"cone":i=new J_e;break;case"cylinder":i=new eye;break;case"cube":default:i=new oye}return new Rge(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Vi.CARTESIAN,data:e,mesh:i,wireframe:!1,getTransformMatrix:r=>r.transformMatrix,getColor:r=>r.color||[255,255,255,229.5]},t))}}function f6(n,e,t){if(e&&0!==e.length)return new Ege(Object.assign({id:n,pickable:!0,data:e.map(i=>Object.assign(Object.assign({},i),{position:new qn(i.transformMatrix).getTranslation()})),getText:i=>i.text,getPosition:i=>i.position,getColor:i=>i.color},t))}let Zve=(()=>{class n extends Gz{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),d6()}renderLayers(){var t,i;const r=this.state,s={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const l of r.data){const c=null!==(t=l.geometry)&&void 0!==t?t:"cube";l.scenegraph?s.scenegraph.push(l):void 0!==s[c]&&s[c].push(l)}const o={};for(const l of s.scenegraph)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(o,l.scenegraph)&&(o[l.scenegraph]=cN({scenegraph:l.scenegraph},n.gltfCache));const a=[];for(const[l,c]of Object.entries(s))if("scenegraph"===l)for(const u of c)a.push(new Y_e({id:"models-"+u["@id"],opacity:u.zoomBasedOpacity?r.zoomOpacity:void 0!==u.opacity?u.opacity:1,pickable:!u.unpickable,coordinateSystem:Vi.CARTESIAN,data:[u],scenegraph:u.scenegraphNode?Xve(u.scenegraphNode,o[u.scenegraph]):u.scenegraph,_lighting:u._lighting,getTransformMatrix:u.transformMatrix,getColor:null!==(i=u.color)&&void 0!==i?i:[0,255,0,127.5],parameters:{depthMask:!u.zoomBasedOpacity&&(void 0===u.opacity||1===u.opacity)}}));else"text"===l?(a.push(f6("text",c.filter(u=>u.unpickable),{pickable:!1})),a.push(f6("textPickable",c.filter(u=>!u.unpickable),{pickable:!0}))):"wireframe"===l?a.push(uN(l,c,{wireframe:!0,pickable:!1,geometry:l})):(a.push(uN(l,c.filter(u=>u.unpickable),{wireframe:!1,pickable:!1,geometry:l})),a.push(uN(`${l}Pickable`,c.filter(u=>!u.unpickable),{wireframe:!1,pickable:!0,geometry:l})));return r.doCollisions&&function(n){ki(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new qn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new gr({lowerBound:new le(...l.map((u,h)=>Math.min(u,c[h]))),upperBound:new le(...c.map((u,h)=>Math.max(u,l[h])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield K0(o.scenegraph,um,{DracoLoader:PR,decompress:!0,postProcess:!0});for(const l of a.scenes)pm(l,new qn(o.transformMatrix),(c,u)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const h of c.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const p=u.transformAsPoint(h.attributes.POSITION.min,[]),g=u.transformAsPoint(h.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new gr({lowerBound:new le(...p.map((m,w)=>Math.min(m,g[w]))),upperBound:new le(...g.map((m,w)=>Math.max(m,p[w])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(r.data),a.filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function p6(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),p6(t,e);return e}let ewe=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new Zve({}),this.nodeClickSubject=new se,this.nodeHoverStartSubject=new se,this.nodeHoverStopSubject=new se,this.sceneRotationSubject=new Br([0,0]),this.nodeDragStartSubject=new se,this.nodeDragSubject=new se,this.nodeDragEndSubject=new se,this.nodeClick$=this.nodeClickSubject.pipe(Es()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(Es()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(Es()),this.sceneRotation$=this.sceneRotationSubject.pipe(Es()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(Es()),this.nodeDrag$=this.nodeDragSubject.pipe(Es()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(Es());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new rhe({flipY:!1,near:-1e3}):new ahe({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var u;return null!==(u=this.cursor)&&void 0!==u?u:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new KO({ambientLight:new Kz({color:[255,255,255],intensity:10})})]),this.deck=new lx(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return ki(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new qn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return ki(this,void 0,void 0,function*(){d6();const i=yield cN({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)pm(o,e=new qn(e||qn.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new qn(l),geometry:"wireframe",node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new qn(e||qn.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const u of a.mesh.primitives)if(u.attributes.POSITION&&u.attributes.POSITION.min){const h=l.transformAsPoint(u.attributes.POSITION.min,[]),p=l.transformAsPoint(u.attributes.POSITION.max,[]);c.bbox=new gr({lowerBound:new le(...h.map((g,m)=>Math.min(g,p[m]))),upperBound:new le(...p.map((g,m)=>Math.max(g,h[m])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of p6(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,u=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new le(.5,.5,.5)),h=o.center=a.clone().vadd(u);o.transformMatrix=new qn(qn.IDENTITY).translate(h.toArray()).scale(u.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new qn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return or([Hf.ZP],n.prototype,"_onHover",null),or([Hf.ZP],n.prototype,"_onClick",null),or([Hf.ZP],n.prototype,"_onViewStateChange",null),or([Hf.ZP],n.prototype,"_onDragStart",null),or([Hf.ZP],n.prototype,"_onDrag",null),or([Hf.ZP],n.prototype,"_onDragEnd",null),n})();function twe(n,e){return n===e}function nwe(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function Ox(n,e=twe){let t=null,i=null;function r(){return nwe(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const rwe=Ox(function(){const n=gD();if(!n)return!1;const e=n.injector.get(aB,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let dN=(()=>{class n{constructor(){this.bootstrap$=new kg(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const hN=new Ht("INITIAL_STATE_TOKEN");let swe=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const g6=new Ht("Internals.StateContextFactory"),m6=new Ht("Internals.StateFactory");function gb(...n){if(1===n.length){const e=n[0];if(P(e))return Rx(e,null);if(Q(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return Rx(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return Rx(n=1===n.length&&P(n[0])?n[0]:n,null).pipe(me(t=>e(...t)))}return Rx(n,null)}function Rx(n,e){return new I(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=je(n[a]);let c=!1;t.add(l.subscribe({next:u=>{c||(c=!0,o++),r[a]=u},error:u=>t.error(u),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((u,h,p)=>(u[h]=r[p],u),{}):r),t.complete())}}))}})}function Ji(n,e){return function(i){return i.lift(new owe(n,e))}}class owe{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new awe(e,this.predicate,this.thisArg))}}class awe extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function Ga(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(u){let h;s++,!r||a?(a=!1,r=new kg(n,e,i),h=r.subscribe(this),o=u.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):h=r.subscribe(this),this.add(()=>{s--,h.unsubscribe(),h=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const _6=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function Yi(n){return e=>0===n?fS():e.lift(new cwe(n))}class cwe{constructor(e){if(this.total=e,this.total<0)throw new _6}call(e,t){return t.subscribe(new uwe(e,this.total))}}class uwe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function y6(n,e){return e?t=>t.pipe(y6((i,r)=>je(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new dwe(n))}class dwe{constructor(e){this.project=e}call(e,t){return t.subscribe(new hwe(e,this.project))}}class hwe extends ve{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function Nx(n=null){return e=>e.lift(new fwe(n))}class fwe{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new pwe(e,this.defaultValue))}}class pwe extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function yc(n){return function(t){const i=new gwe(n),r=t.lift(i);return i.caught=r}}class gwe{constructor(e){this.selector=e}call(e,t){return t.subscribe(new mwe(e,this.selector,this.caught))}}class mwe extends ve{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new _t(this);this.add(i);const r=N(t,i);r!==i&&this.add(r)}}}function mr(n){return e=>e.lift(new _we(n))}class _we{constructor(e){this.notifier=e}call(e,t){const i=new ywe(e),r=N(this.notifier,new _t(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class ywe extends ve{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function _h(){}function qr(n,e,t){return function(r){return r.lift(new bwe(n,e,t))}}class bwe{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new vwe(e,this.nextOrObserver,this.error,this.complete))}}class vwe extends y{constructor(e,t,i,r){super(e),this._tapNext=_h,this._tapError=_h,this._tapComplete=_h,this._tapError=i||_h,this._tapComplete=r||_h,Y(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||_h,this._tapError=t.error||_h,this._tapComplete=t.complete||_h)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function rd(n,e){return t=>t.lift(new wwe(n,e))}class wwe{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Ewe(e,this.compare,this.keySelector))}}class Ewe extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const $a={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let b6=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return fn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return fn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof fn||console.warn($a.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Oe(fn),Oe($c))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const v6=new Ht("ROOT_STATE_TOKEN"),w6=new Ht("FEATURE_STATE_TOKEN"),E6=new Ht("NGXS_PLUGINS"),S6=new Ht("NG_TEST_MODE"),x6=new Ht("NG_DEV_MODE"),sd="NGXS_META",C6="NGXS_OPTIONS_META",fN="NGXS_SELECTOR_META";let Gf=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=b6}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Swe{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const A6=new Ht("NGXS_EXECUTION_STRATEGY");function $f(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const T6=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},Px=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),pN=n=>n&&"object"==typeof n&&!Array.isArray(n),gN=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(pN(n)&&pN(t))for(const i in t)pN(t[i])?(n[i]||Object.assign(n,{[i]:{}}),gN(n[i],t[i])):Object.assign(n,{[i]:t[i]});return gN(n,...e)};function mN(n){if(!n.hasOwnProperty(sd)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,sd,{value:e})}return mb(n)}function mb(n){return n[sd]}function yN(n){return n[fN]}function M6(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}function D6(n,e){const t=Px(e.currentAppState,n.path),i=Px(e.newAppState,n.path);return new Swe(t,i,!n.isInitialised)}function Owe(...n){return function(n,e,t=Pwe){const i=function(n){return n.reduce((e,t)=>(e[$f(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return Ji(t=>{const i=$f(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function Pwe(){return me(n=>n.action)}function Fx(n){return e=>new I(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let kx=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(A6))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Lwe extends se{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let Lx=(()=>{class n extends Lwe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Bwe=(()=>{class n extends I{constructor(t,i){super(r=>{const s=t.pipe(Fx(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Oe(Lx),Oe(kx))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const I6=n=>(...e)=>n.shift()(...e,(...i)=>I6(n)(...i));let Bx=(()=>{class n extends Br{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),bN=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Oe(n,12),Oe(E6,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),vN=(()=>{class n extends se{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),O6=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(oa),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(Fx(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?dn(this._stateStream.getValue()):gb(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!$f(t))return Fg(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return I6([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(Ga())}getActionResultStream(t){return this._actionResults.pipe(Ji(i=>i.action===t&&"DISPATCHED"!==i.status),Yi(1),Ga())}createDispatchObservable(t){return t.pipe(y6(i=>{switch(i.status){case"SUCCESSFUL":return dn(this._stateStream.getValue());case"ERRORED":return Fg(i.error);default:return qc}})).pipe(Ga())}}return n.\u0275fac=function(t){return new(t||n)(Oe(Wn),Oe(Lx),Oe(vN),Oe(bN),Oe(Bx),Oe(kx))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const R6=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&R6(n[i])}),n};let N6=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Oe(x6),Oe(S6))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),P6=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn($a.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn($a.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Oe(N6),Oe(Gf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),mm=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=R6(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Oe(Bx),Oe(O6),Oe(Gf),Oe(P6))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),jx=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return Px(l,t.path)}function s(l,c){const u=T6(l,t.path,c),h=t.instance;if(h.ngxsOnChanges){const p=D6(t,{currentAppState:l,newAppState:u});h.ngxsOnChanges(p)}return i.setState(u),u}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error($a.PATCHING_ARRAY());if("object"!=typeof n)throw new Error($a.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Oe(mm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Vx{static stateNameErrorMessage(e){return $a.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error($a.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error($a.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=mb(e);if(!t)throw new Error($a.STATE_DECORATOR());return t}}Vx.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let _m=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=Ox(()=>{const c=this;function u(p){const g=c.statePaths[p];return g?M6(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=u(p);return g||((...m)=>(g||(g=u(p)),g?g(...m):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(Vx.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[sd].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[sd];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[sd].name]=t,e),{})}(i),l=[];for(const c of s){const u=a[c],h=o[c],p=u[sd];this.addRuntimeInfoToMeta(p,h);const g={name:c,path:h,isInitialised:!1,actions:p.actions,instance:this._injector.get(u),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,h)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>T6(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Ji(t=>"DISPATCHED"===t.status),B(({action:t})=>this.invokeActions(this._actions,t).pipe(me(()=>({action:t,status:"SUCCESSFUL"})),Nx({action:t,status:"CANCELED"}),yc(i=>dn({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=$f(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let u=o.instance[l.fn](c,i);u instanceof Promise&&(u=je(u)),u instanceof I?(u=u.pipe(Nx({})),l.options.cancelUncompleted&&(u=u.pipe(mr(t.pipe(Owe(i)))))):u=dn({}).pipe(Ga()),s.push(u)}catch(u){s.push(Fg(u))}}}return s.length||s.push(dn({})),gb(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=Vx.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==Px(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Oe(Wn),Oe(Gf),Oe(n,12),Oe(Lx),Oe(vN),Oe(jx),Oe(hN,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),wN=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(Ji(()=>!!i),qr(()=>this.invokeInit(i.states)),B(()=>this.bootstrapper.appBootstrapped$),Ji(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=D6(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(mm),Oe(jx),Oe(dN))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ux_getOptions=n=>n&&n.NGXS_SELECTOR_OPTIONS_META||{};function Vwe(n,e,t){const i=t&&t.containerClass,s=Ox(function(...c){const u=e.apply(i,c);return u instanceof Function?Ox.apply(null,[u]):u});Object.setPrototypeOf(s,e);const o=function(n,e){const t=function(n){return n.hasOwnProperty(fN)||Object.defineProperty(n,fN,{value:{makeRootSelector:null,originalFn:null,containerClass:null,selectorName:null,getSelectorOptions:()=>({})}}),yN(n)}(n);t.originalFn=n;let i=()=>({});e&&(t.containerClass=e.containerClass,t.selectorName=e.selectorName,i=e.getSelectorOptions||i);const r=Object.assign({},t);return t.getSelectorOptions=()=>function(n,e){return Object.assign({},Ux_getOptions(n.containerClass)||{},Ux_getOptions(n.originalFn)||{},n.getSelectorOptions()||{},e)}(r,i()),t}(e,t);return o.makeRootSelector=l=>{const{argumentSelectorFunctions:c,selectorOptions:u}=function(n,e,t=[]){const i=e.getSelectorOptions(),r=n.getSelectorOptions(i);return{selectorOptions:r,argumentSelectorFunctions:function(n=[],e,t){const i=[];return t&&(0===n.length||e.injectContainerState)&&mb(t)&&i.push(t),n&&i.push(...n),i}(t,r,e.containerClass).map(a=>k6(a)(n))}}(l,o,n);return function(p){const g=c.map(m=>m(p));try{return s(...g)}catch(m){if(m instanceof TypeError&&u.suppressErrors)return;throw m}}},s}function k6(n){const e=yN(n)||mb(n);return e&&e.makeRootSelector||(()=>n)}let lu=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(me(i),yc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?dn(void 0):Fg(r)}),rd(),Fx(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(Yi(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(Fx(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return k6(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Oe(Bx),Oe(mm),Oe(Gf),Oe(kx),Oe(_m),Oe(hN,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),_b=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Oe(lu),Oe(Gf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class $we{static get type(){return"@@INIT"}}class Wwe{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const zx=new kg(1);let Ywe=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&La();zx.next(t)}catch(n){zx.next(!1)}finally{zx.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new $we,l)}}return n.\u0275fac=function(t){return new(t||n)(Oe(_m),Oe(mm),Oe(lu),Oe(_b),Oe(v6,8),Oe(wN))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})(),Kwe=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new Wwe(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Oe(lu),Oe(mm),Oe(_m),Oe(w6,8),Oe(wN))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();class Wo{static forRoot(e=[],t={}){return{ngModule:Ywe,providers:[_m,jx,Bwe,Lx,dN,P6,N6,wN,O6,vN,mm,kx,lu,Bx,_b,bN,...e,...Wo.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:Kwe,providers:[_m,bN,...e,{provide:w6,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:S6,useValue:rwe},{provide:x6,useValue:La},{provide:A6,useClass:t.executionStrategy||b6},{provide:v6,useValue:e},{provide:Wo.ROOT_OPTIONS,useValue:t},{provide:Gf,useFactory:Wo.ngxsConfigFactory,deps:[Wo.ROOT_OPTIONS]},{provide:LE,useFactory:Wo.appBootstrapListenerFactory,multi:!0,deps:[dN]},{provide:hN,useFactory:Wo.getInitialState},{provide:g6,useExisting:jx},{provide:m6,useExisting:_m}]}static ngxsConfigFactory(e){return gN(new Gf,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return swe.pop()}}function EN(n,e){return(t,i)=>{if(t.hasOwnProperty("prototype"))throw new Error($a.ACTION_DECORATOR());const s=mN(t.constructor);Array.isArray(n)||(n=[n]);for(const o of n){const a=o.type;s.actions[a]||(s.actions[a]=[]),s.actions[a].push({fn:i,options:e||{},type:a})}}}function L6(n){return i=>{!function(n){zx.subscribe(e=>{e&&(n.\u0275prov||console.warn($a.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=mN(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[C6]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,u="string"==typeof c?c:c&&c.getName()||null;Vx.checkCorrectStateName(u),s.hasOwnProperty(sd)&&(r.actions=Object.assign({},r.actions,(s[sd]||{}).actions)),r.children=a,r.defaults=l,r.name=u})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[C6]=a}}function Hx(n,...e){return function(t,i){const r=i.toString(),s=`__${r}__selector`,o=function(n,e,t=[]){return"string"==typeof(e=e||function(n){const e=n.length-1;return 36===n.charCodeAt(e)?n.slice(0,e):n}(n))?M6(t.length?[e,...t]:e.split("."),_b.config):e}(r,n,e);Object.defineProperties(t,{[s]:{writable:!0,enumerable:!1,configurable:!0},[r]:{enumerable:!0,configurable:!0,get(){return this[s]||(this[s]=function(n){if(!_b.store)throw new Error($a.SELECT_FACTORY_NOT_CONNECTED());return _b.store.select(n)}(o))}}})}}function ym(n){return(e,t,i)=>{if(!i||null===i.value)throw new Error($a.SELECTOR_DECORATOR());const s=i.value,o=Vwe(n,s,{containerClass:e,selectorName:t.toString(),getSelectorOptions:()=>({})}),a={configurable:!0,get:()=>o};return a.originalFn=s,a}}function Al(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}Wo.\u0275fac=function(e){return new(e||Wo)},Wo.\u0275mod=an({type:Wo}),Wo.\u0275inj=Ct({}),Wo.ROOT_OPTIONS=new Ht("ROOT_OPTIONS");const nC=new cc(hS);class oSe{constructor(e){this.total=e}call(e,t){return t.subscribe(new aSe(e,this.total))}}class aSe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}function xi(n){return null!=n&&"false"!=`${n}`}function iC(n){return Array.isArray(n)?n:[n]}function vs(n){return null==n?"":"string"==typeof n?n:`${n}px`}function ad(n){return n instanceof vn?n.nativeElement:n}let qN;try{qN="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){qN=!1}let Tb,qf,YN,er=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Tf(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!qN)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(Oe($c))},n.\u0275prov=We({factory:function(){return new n(Oe($c))},token:n,providedIn:"root"}),n})();function wm(n){return function(){if(null==Tb&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Tb=!0}))}finally{Tb=Tb||!1}return Tb}()?n:!!n.capture}function WH(){if(null==qf){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return qf=!1,qf;if("scrollBehavior"in document.documentElement.style)qf=!0;else{const n=Element.prototype.scrollTo;qf=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return qf}function sC(){let n="undefined"!=typeof document&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Yf(n){return n.composedPath?n.composedPath()[0]:n.target}let nG=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function(n){try{return n.frameElement}catch(e){return null}}(function(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===rG(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=rG(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function(n){return!function(n){return function(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function(n){return function(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||iG(n))}(t)&&!this.isDisabled(t)&&((null==i?void 0:i.ignoreVisibility)||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(Oe(er))},n.\u0275prov=We({factory:function(){return new n(Oe(er))},token:n,providedIn:"root"}),n})();function iG(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function rG(n){if(!iG(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class TSe{constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),t&&(t.removeEventListener("focus",this.endAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);for(let i=0;i<t.length;i++)t[i].hasAttribute(`cdk-focus-${e}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[i]):t[i].hasAttribute(`cdk-focus-region-${e}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[i]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return null==i||i.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let i=0;i<t.length;i++){let r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let i=t.length-1;i>=0;i--){let r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Yi(1)).subscribe(e)}}let sG=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new TSe(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(Oe(nG),Oe(fn),Oe(hn))},n.\u0275prov=We({factory:function(){return new n(Oe(nG),Oe(fn),Oe(hn))},token:n,providedIn:"root"}),n})();"undefined"!=typeof Element&&Element;const lG=new Ht("cdk-input-modality-detector-options"),RSe={ignoreKeys:[18,17,224,91,16]},Em=wm({passive:!0,capture:!0});let uG=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Br(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Yf(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(function(n){return 0===n.offsetX&&0===n.offsetY}(o)?"keyboard":"mouse"),this._mostRecentTarget=Yf(o))},this._onTouchstart=o=>{!function(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(o)?(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Yf(o)):this._modality.next("keyboard")},this._options=Object.assign(Object.assign({},RSe),s),this.modalityDetected=this._modality.pipe(function(n){return e=>e.lift(new oSe(n))}(1)),this.modalityChanged=this.modalityDetected.pipe(rd()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Em),r.addEventListener("mousedown",this._onMousedown,Em),r.addEventListener("touchstart",this._onTouchstart,Em)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,Em),document.removeEventListener("mousedown",this._onMousedown,Em),document.removeEventListener("touchstart",this._onTouchstart,Em))}}return n.\u0275fac=function(t){return new(t||n)(Oe(er),Oe(fn),Oe(hn),Oe(lG,8))},n.\u0275prov=We({factory:function(){return new n(Oe(er),Oe(fn),Oe(hn),Oe(lG,8))},token:n,providedIn:"root"}),n})();const fG=new Ht("cdk-focus-monitor-default-options"),lC=wm({passive:!0,capture:!0});let uu=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new se,this._rootNodeFocusAndBlurListener=a=>{const l=Yf(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=ad(t);if(!this._platform.isBrowser||1!==r.nodeType)return dn(null);const s=function(n){if(function(){if(null==YN){const n="undefined"!=typeof document?document.head:null;YN=!(!n||!n.createShadowRoot&&!n.attachShadow)}return YN}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new se,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=ad(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=ad(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,i,r){r?t.classList.add(i):t.classList.remove(i)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){this._toggleClass(t,"cdk-focused",!!i),this._toggleClass(t,"cdk-touch-focused","touch"===i),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===i),this._toggleClass(t,"cdk-mouse-focused","mouse"===i),this._toggleClass(t,"cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Yf(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,lC),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,lC)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(mr(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,lC),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,lC),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(Oe(fn),Oe(er),Oe(uG),Oe(hn,8),Oe(fG,8))},n.\u0275prov=We({factory:function(){return new n(Oe(fn),Oe(er),Oe(uG),Oe(hn,8),Oe(fG,8))},token:n,providedIn:"root"}),n})();const _G=new Ht("cdk-dir-doc",{providedIn:"root",factory:function(){return Pc(hn)}});let Tl=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new sn,t){const r=t.documentElement?t.documentElement.dir:null,s=(t.body?t.body.dir:null)||r;this.value="ltr"===s||"rtl"===s?s:"ltr"}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(Oe(_G,8))},n.\u0275prov=We({factory:function(){return new n(Oe(_G,8))},token:n,providedIn:"root"}),n})();function cC(...n){return Nt(1)(dn(...n))}function ao(...n){const e=n[n.length-1];return Ce(e)?(n.pop(),t=>cC(n,t,e)):t=>cC(n,t)}function Sm(n,e){return{type:7,name:n,definitions:e,options:{}}}function cd(n,e=null){return{type:4,styles:e,timings:n}}function fs(n){return{type:6,styles:n,offset:null}}function bc(n,e,t){return{type:0,name:n,styles:e,options:t}}function ud(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function wG(n){Promise.resolve(null).then(n)}class xm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){wG(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function SG(){return"undefined"!=typeof window&&void 0!==window.document}function eP(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let rP=(n,e)=>!1,sP=(n,e)=>!1,AG=(n,e,t)=>[];const TG=eP();(TG||"undefined"!=typeof Element)&&(rP=SG()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),sP=(()=>{if(TG||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):sP}})(),AG=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let Kf=null,MG=!1;function oP(n){Kf||(Kf=("undefined"!=typeof document?document.body:null)||{},MG=!!Kf.style&&"WebkitAppearance"in Kf.style);let e=!0;return Kf.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Kf.style,!e&&MG&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Kf.style)),e}const aP=sP,lP=rP,cP=AG;let IG=(()=>{class n{validateStyleProperty(t){return oP(t)}matchesElement(t,i){return aP(t,i)}containsElement(t,i){return lP(t,i)}query(t,i,r){return cP(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new xm(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class uC{}uC.NOOP=new IG;function PG(n,e,t){return t?e+":"+t+";":""}function FG(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=PG(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=PG(0,qSe(t),n.style[t]));n.setAttribute("style",e)}function du(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=pP(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),eP()&&FG(n))}function Qf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=pP(t);n.style[i]=""}),eP()&&FG(n))}const WSe=/-+([a-z0-9])/g;function pP(n){return n.replace(WSe,(...e)=>e[1].toUpperCase())}function qSe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class Tm{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=Tm.initialStylesByElement.get(e);r||Tm.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&du(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(du(this._element,this._initialStyles),this._endStyles&&(du(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(Tm.initialStylesByElement.delete(this._element),this._startStyles&&(Qf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Qf(this._element,this._endStyles),this._endStyles=null),du(this._element,this._initialStyles),this._state=3)}}Tm.initialStylesByElement=new WeakMap;const Il=new Ht("AnimationModuleType");function Nb(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function DP(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?function(n,e=0){return function(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}(t):this.defaultTabIndex}}}let ep;try{ep="undefined"!=typeof Intl}catch(n){ep=!1}function hd(n,e,t,i){return Y(t)&&(i=t,t=void 0),i?hd(n,e,t).pipe(me(r=>P(r)?i(...r):i(r))):new I(r=>{N$(n,e,function(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function N$(n,e,t,i,r){let s;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)N$(n[o],e,t,i,r)}i.add(s)}new class extends cc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends hS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let $Ce=1;const WCe=Promise.resolve(),OC={};function P$(n){return n in OC&&(delete OC[n],!0)}const F$={setImmediate(n){const e=$Ce++;return OC[e]=!0,WCe.then(()=>P$(e)&&n()),e},clearImmediate(n){P$(n)}};new class extends cc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends hS{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=F$.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(F$.clearImmediate(t),e.scheduled=void 0)}});function Mm(n){return!!n&&(n instanceof I||"function"==typeof n.lift&&"function"==typeof n.subscribe)}class QCe{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new ZCe(e,this.durationSelector))}}class ZCe extends ve{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1}_next(e){if(this.value=e,this.hasValue=!0,!this.throttled){let t;try{const{durationSelector:r}=this;t=r(e)}catch(r){return this.destination.error(r)}const i=N(t,new _t(this));!i||i.closed?this.clearThrottle():this.add(this.throttled=i)}}clearThrottle(){const{value:e,hasValue:t,throttled:i}=this;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),t&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function k$(n){return!P(n)&&n-parseFloat(n)+1>=0}function e1e(n){const{index:e,period:t,subscriber:i}=n;if(i.next(e),!i.closed){if(-1===t)return i.complete();n.index=e+1,this.schedule(n,t)}}function RC(n,e=nC){return function(n){return function(t){return t.lift(new QCe(n))}}(()=>function(n=0,e,t){let i=-1;return k$(e)?i=Number(e)<1?1:Number(e):Ce(e)&&(t=e),Ce(t)||(t=nC),new I(r=>{const s=k$(n)?n:+n-t.now();return t.schedule(e1e,s,{index:0,period:i,subscriber:r})})}(n,e))}let B$=(()=>{class n{constructor(){this._listeners=[]}notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return new n},token:n,providedIn:"root"}),n})(),Dm=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new se,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new I(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(RC(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):dn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Ji(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=ad(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>hd(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(Oe(fn),Oe(er),Oe(hn,8))},n.\u0275prov=We({factory:function(){return new n(Oe(fn),Oe(er),Oe(hn,8))},token:n,providedIn:"root"}),n})(),Im=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new se,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(RC(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(Oe(er),Oe(fn),Oe(hn,8))},n.\u0275prov=We({factory:function(){return new n(Oe(er),Oe(fn),Oe(hn,8))},token:n,providedIn:"root"}),n})();class PP{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class PC extends PP{constructor(e,t,i,r){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r}}class Om extends PP{constructor(e,t,i){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class _1e extends PP{constructor(e){super(),this.element=e instanceof vn?e.nativeElement:e}}class FC{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof PC?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof Om?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof _1e?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class y1e extends FC{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context);return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let tp=(()=>{class n extends FC{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new sn,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)(xe(bl),xe(Ns),xe(hn))},n.\u0275dir=Rt({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[xn]}),n})();const W$=WH();class E1e{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=vs(-this._previousScrollPosition.left),e.style.top=vs(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),W$&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),W$&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class S1e{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class q${enable(){}disable(){}attach(){}}function FP(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function Y$(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class x1e{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();FP(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let C1e=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new q$,this.close=o=>new S1e(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new E1e(this._viewportRuler,this._document),this.reposition=o=>new x1e(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(Oe(Dm),Oe(Im),Oe(fn),Oe(hn))},n.\u0275prov=We({factory:function(){return new n(Oe(Dm),Oe(Im),Oe(fn),Oe(hn))},token:n,providedIn:"root"}),n})();class LC{constructor(e){if(this.scrollStrategy=new q$,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class A1e{constructor(e,t,i,r,s){this.offsetX=i,this.offsetY=r,this.panelClass=s,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}}class T1e{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let K$=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({factory:function(){return new n(Oe(hn))},token:n,providedIn:"root"}),n})(),M1e=(()=>{class n extends K${constructor(t){super(t),this._keydownListener=i=>{const r=this._attachedOverlays;for(let s=r.length-1;s>-1;s--)if(r[s]._keydownEvents.observers.length>0){r[s]._keydownEvents.next(i);break}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn))},n.\u0275prov=We({factory:function(){return new n(Oe(hn))},token:n,providedIn:"root"}),n})(),D1e=(()=>{class n extends K${constructor(t,i){super(t),this._platform=i,this._cursorStyleIsSet=!1,this._clickListener=r=>{const s=Yf(r),o=this._attachedOverlays.slice();for(let a=o.length-1;a>-1;a--){const l=o[a];if(!(l._outsidePointerEvents.observers.length<1)&&l.hasAttached()){if(l.overlayElement.contains(s))break;l._outsidePointerEvents.next(r)}}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn),Oe(er))},n.\u0275prov=We({factory:function(){return new n(Oe(hn),Oe(er))},token:n,providedIn:"root"}),n})();const Sh="undefined"!=typeof window?window:{},X$=void 0!==Sh.__karma__&&!!Sh.__karma__||void 0!==Sh.jasmine&&!!Sh.jasmine||void 0!==Sh.jest&&!!Sh.jest||void 0!==Sh.Mocha&&!!Sh.Mocha;let kb=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||X$){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].parentNode.removeChild(r[s])}const i=this._document.createElement("div");i.classList.add(t),X$?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(Oe(hn),Oe(er))},n.\u0275prov=We({factory:function(){return new n(Oe(hn),Oe(er))},token:n,providedIn:"root"}),n})();class I1e{constructor(e,t,i,r,s,o,a,l,c){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._backdropElement=null,this._backdropClick=new se,this._attachments=new se,this._detachments=new se,this._locationChanges=x.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._keydownEvents=new se,this._outsidePointerEvents=new se,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){let t=this._portalOutlet.attach(e);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Yi(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Object.assign(Object.assign({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Object.assign(Object.assign({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=vs(this._config.width),e.height=vs(this._config.height),e.minWidth=vs(this._config.minWidth),e.minHeight=vs(this._config.minHeight),e.maxWidth=vs(this._config.maxWidth),e.maxHeight=vs(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(!e)return;let t,i=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",i),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",i)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(i,500))}_toggleClasses(e,t,i){const r=e.classList;iC(t).forEach(s=>{s&&(i?r.add(s):r.remove(s))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(mr(kn(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}}const Q$="cdk-overlay-connected-position-bounding-box",O1e=/([A-Za-z%]+)$/;class Z${constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new se,this._resizeSubscription=x.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(Q$),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=[];let s;for(let o of this._preferredPositions){let a=this._getOriginPoint(e,o),l=this._getOverlayPoint(a,t,o),c=this._getOverlayFit(l,t,i,o);if(c.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(o,a);this._canFitWithFlexibleDimensions(c,l,i)?r.push({position:o,origin:a,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(a,o)}):(!s||s.overlayFit.visibleArea<c.visibleArea)&&(s={overlayFit:c,overlayPoint:l,originPoint:a,position:o,overlayRect:t})}if(r.length){let o=null,a=-1;for(const l of r){const c=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);c>a&&(a=c,o=l)}return this._isPushed=!1,void this._applyPosition(o.position,o.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(s.position,s.originPoint);this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&np(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Q$),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const e=this._lastPosition||this._preferredPositions[0],t=this._getOriginPoint(this._originRect,e);this._applyPosition(e,t)}}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t){let i,r;if("center"==t.originX)i=e.left+e.width/2;else{const s=this._isRtl()?e.right:e.left,o=this._isRtl()?e.left:e.right;i="start"==t.originX?s:o}return r="center"==t.originY?e.top+e.height/2:"top"==t.originY?e.top:e.bottom,{x:i,y:r}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=e7(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let p=0-a,g=a+s.height-i.height,m=this._subtractOverflows(s.width,0-o,o+s.width-i.width),w=this._subtractOverflows(s.height,p,g),C=m*w;return{visibleArea:C,isCompletelyWithinViewport:s.width*s.height===C,fitsInViewportVertically:w===s.height,fitsInViewportHorizontally:m==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=J$(this._overlayRef.getConfig().minHeight),a=J$(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportHorizontally||null!=a&&a<=s;return(e.fitsInViewportVertically||null!=o&&o<=r)&&c}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=e7(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-i.top-e.y,0),c=Math.max(s.left-i.left-e.x,0);let u=0,h=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,h=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new T1e(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,h,p;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const g=Math.min(i.bottom-e.y+i.top,e.y),m=this._lastBoundingBoxSize.height;s=2*g,o=e.y-g,s>m&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-m/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)p=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)h=e.x,u=i.right-e.x;else{const g=Math.min(i.right-e.x+i.left,e.x),m=this._lastBoundingBoxSize.width;u=2*g,h=e.x-g,u>m&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-m/2)}return{top:o,left:h,bottom:a,right:p,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=vs(i.height),r.top=vs(i.top),r.bottom=vs(i.bottom),r.width=vs(i.width),r.left=vs(i.left),r.right=vs(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=vs(s)),o&&(r.maxWidth=vs(o))}this._lastBoundingBoxSize=i,np(this._boundingBox.style,r)}_resetBoundingBoxStyles(){np(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){np(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();np(i,this._getExactOverlayY(t,e,u)),np(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=vs(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=vs(o.maxWidth):s&&(i.maxWidth="")),np(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i));let o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return s.y-=o,"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=vs(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=vs(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Y$(e,i),isOriginOutsideView:FP(e,i),isOverlayClipped:Y$(t,i),isOverlayOutsideView:FP(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&iC(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof vn)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function np(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function J$(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(O1e);return t&&"px"!==t?null:parseFloat(e)}return n||null}function e7(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}class R1e{constructor(e,t,i,r,s,o,a){this._preferredPositions=[],this._positionStrategy=new Z$(i,r,s,o,a).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(e,t),this.onPositionChange=this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(e){this._overlayRef=e,this._positionStrategy.attach(e),this._direction&&(e.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(e){this._positionStrategy.withScrollableContainers(e)}withFallbackPosition(e,t,i,r){const s=new A1e(e,t,i,r);return this._preferredPositions.push(s),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(e){return this._overlayRef?this._overlayRef.setDirection(e):this._direction=e,this}withOffsetX(e){return this._positionStrategy.withDefaultOffsetX(e),this}withOffsetY(e){return this._positionStrategy.withDefaultOffsetY(e),this}withLockedPosition(e){return this._positionStrategy.withLockedPosition(e),this}withPositions(e){return this._preferredPositions=e.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(e){return this._positionStrategy.setOrigin(e),this}}const t7="cdk-global-overlay-wrapper";class N1e{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(t7),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._justifyContent="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a);e.position=this._cssPosition,e.marginLeft=l?"0":this._leftOffset,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,l?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(t7),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let P1e=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new N1e}connectedTo(t,i,r){return new R1e(i,r,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new Z$(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(Oe(Im),Oe(hn),Oe(er),Oe(kb))},n.\u0275prov=We({factory:function(){return new n(Oe(Im),Oe(hn),Oe(er),Oe(kb))},token:n,providedIn:"root"}),n})(),F1e=0,vc=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,h,p){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=h,this._outsideClickDispatcher=p}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new LC(t);return o.direction=o.direction||this._directionality.value,new I1e(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+F1e++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(ih)),new y1e(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(Oe(C1e),Oe(kb),Oe(bl),Oe(P1e),Oe(M1e),Oe(Wn),Oe(fn),Oe(hn),Oe(Tl),Oe(Pg),Oe(D1e))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function m7(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>me(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}Je(266);class _7 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class VAe extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function y7(n,e,t,i,r=new VAe(n,t,i)){if(!r.closed)return e instanceof I?e.subscribe(r):Me(e)(r)}const b7={};function Yo(...n){let e,t;return Ce(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&P(n[0])&&(n=n[0]),On(n,t).lift(new v7(e))}class v7{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new UAe(e,this.resultSelector))}}class UAe extends _7{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(b7),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(y7(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===b7?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}class rTe{constructor(e){this.callback=e}call(e,t){return t.subscribe(new sTe(e,this.callback))}}class sTe extends y{constructor(e,t){super(e),this.add(new x(t))}}class M7{}class fd{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof fd?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new fd;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof fd?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class oTe{encodeKey(e){return I7(e)}encodeValue(e){return I7(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const lTe=/%(\d[a-f0-9])/gi,cTe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function I7(n){return encodeURIComponent(n).replace(lTe,(e,t)=>{var i;return null!==(i=cTe[t])&&void 0!==i?i:e})}function O7(n){return`${n}`}class xh{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new oTe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new xh({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(O7(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(O7(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class uTe{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function R7(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function N7(n){return"undefined"!=typeof Blob&&n instanceof Blob}function P7(n){return"undefined"!=typeof FormData&&n instanceof FormData}class Lb{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new fd),this.context||(this.context=new uTe),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new xh,this.urlWithParams=t}serializeBody(){return null===this.body?null:R7(this.body)||N7(this.body)||P7(this.body)||function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof xh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||P7(this.body)?null:N7(this.body)?this.body.type||null:R7(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof xh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const h=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((p,g)=>p.set(g,e.setHeaders[g]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((p,g)=>p.set(g,e.setParams[g]),u)),new Lb(i,r,o,{params:u,headers:c,context:h,reportProgress:l,responseType:s,withCredentials:a})}}var ws=(()=>((ws=ws||{})[ws.Sent=0]="Sent",ws[ws.UploadProgress=1]="UploadProgress",ws[ws.ResponseHeader=2]="ResponseHeader",ws[ws.DownloadProgress=3]="DownloadProgress",ws[ws.Response=4]="Response",ws[ws.User=5]="User",ws))();class jC extends class{constructor(e,t=200,i="OK"){this.headers=e.headers||new fd,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}{constructor(e={}){super(e),this.type=ws.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new jC({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function zP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let ip=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Lb)s=t;else{let l,c;l=r.headers instanceof fd?r.headers:new fd(r.headers),r.params&&(c=r.params instanceof xh?r.params:new xh({fromObject:r.params})),s=new Lb(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=dn(s).pipe(function(n,e){return B(n,e,1)}(l=>this.handler.handle(l)));if(t instanceof Lb||"events"===r.observe)return o;const a=o.pipe(Ji(l=>l instanceof jC));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(me(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(me(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new xh).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,zP(r,i))}post(t,i,r={}){return this.request("POST",t,zP(r,i))}put(t,i,r={}){return this.request("PUT",t,zP(r,i))}}return n.\u0275fac=function(t){return new(t||n)(Oe(M7))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const vTe=["*"];function V7(n){return Error(`Unable to find icon with the name "${n}"`)}function U7(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function z7(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class rp{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let VC=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new rp(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(ni.HTML,r);if(!o)throw z7(r);return this._addSvgIconConfig(t,i,new rp("",o,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new rp(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(ni.HTML,i);if(!s)throw z7(i);return this._addSvgIconSetConfig(t,new rp("",s,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(ni.RESOURCE_URL,t);if(!i)throw U7(t);const r=this._cachedIconsByUrl.get(i);return r?dn(UC(r)):this._loadSvgIconFromConfig(new rp(t,null)).pipe(qr(s=>this._cachedIconsByUrl.set(i,s)),me(s=>UC(s)))}getNamedSvgIcon(t,i=""){const r=H7(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):Fg(V7(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?dn(UC(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(me(i=>UC(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?dn(r):gb(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(yc(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(ni.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),dn(null)})))).pipe(me(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw V7(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(qr(i=>t.svgText=i),me(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?dn(null):this._fetchIcon(t).pipe(qr(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString("<svg></svg>");return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString("<svg></svg>"),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){var i;const{url:r,options:s}=t,o=null!==(i=null==s?void 0:s.withCredentials)&&void 0!==i&&i;if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const a=this._sanitizer.sanitize(ni.RESOURCE_URL,r);if(!a)throw U7(r);const l=this._inProgressUrlFetches.get(a);if(l)return l;const c=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(function(n){return e=>e.lift(new rTe(n))}(()=>this._inProgressUrlFetches.delete(a)),Es());return this._inProgressUrlFetches.set(a,c),c}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(H7(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return STe(s)?new rp(s.url,null,s.options):new rp(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(Oe(ip,8),Oe(Mf),Oe(hn,8),Oe(oa))},n.\u0275prov=We({factory:function(){return new n(Oe(ip,8),Oe(Mf),Oe(hn,8),Oe(oa))},token:n,providedIn:"root"}),n})();function UC(n){return n.cloneNode(!0)}function H7(n,e){return n+":"+e}function STe(n){return!(!n.url||!n.options)}const xTe=Nb(class{constructor(n){this._elementRef=n}}),CTe=new Ht("mat-icon-location",{providedIn:"root",factory:function(){const n=Pc(hn),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),G7=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],MTe=G7.map(n=>`[${n}]`).join(", "),DTe=/^url\(['"]?#(.*?)['"]?\)$/;let Pm=(()=>{class n extends xTe{constructor(t,i,r,s,o){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=o,this._inline=!1,this._currentIconFetch=x.EMPTY,r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=xi(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=t.querySelectorAll("style");for(let s=0;s<i.length;s++)i[s].textContent+=" ";const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&t.removeChild(r)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();i!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),i&&t.classList.add(i),this._previousFontSetClass=i),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(MTe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)G7.forEach(o=>{const a=i[s],l=a.getAttribute(o),c=l?l.match(DTe):null;if(c){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Yi(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(xe(vn),xe(VC),Fo("aria-hidden"),xe(CTe),xe(oa))},n.\u0275cmp=cn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,i){2&t&&(ji("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet),vi("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[xn],ngContentSelectors:vTe,decls:1,vars:0,template:function(t,i){1&t&&(ns(),si(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),n})();function VTe(n,e){}class qP{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const UTe={dialogContainer:Sm("dialogContainer",[bc("void, exit",fs({opacity:0,transform:"scale(0.7)"})),bc("enter",fs({transform:"none"})),ud("* => enter",cd("150ms cubic-bezier(0, 0, 0.2, 1)",fs({transform:"none",opacity:1}))),ud("* => void, * => exit",cd("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",fs({opacity:0})))])};let zTe=(()=>{class n extends FC{constructor(t,i,r,s,o,a){super(),this._elementRef=t,this._focusTrapFactory=i,this._changeDetectorRef=r,this._config=o,this._focusMonitor=a,this._animationStateChanged=new sn,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=l=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(l)),this._ariaLabelledBy=o.ariaLabelledBy||null,this._document=s}_initializeWithAttachedContent(){this._setupFocusTrap(),this._capturePreviouslyFocusedElement(),this._focusDialogContainer()}attachComponentPortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||(!this._config.autoFocus||!this._focusTrap.focusInitialElement())&&this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const i=sC(),r=this._elementRef.nativeElement;(!i||i===this._document.body||i===r||r.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(t,this._closeInteractionType),this._closeInteractionType=null):t.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)}_capturePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=sC())}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=sC();return t===i||t.contains(i)}}return n.\u0275fac=function(t){return new(t||n)(xe(vn),xe(sG),xe(Dr),xe(hn,8),xe(qP),xe(uu))},n.\u0275dir=Rt({type:n,viewQuery:function(t,i){if(1&t&&rs(tp,7),2&t){let r;ii(r=ri())&&(i._portalOutlet=r.first)}},features:[xn]}),n})(),HTe=(()=>{class n extends zTe{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:t,totalTime:i}){"enter"===t?(this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:i})):"exit"===t&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:i}))}_onAnimationStart({toState:t,totalTime:i}){"enter"===t?this._animationStateChanged.next({state:"opening",totalTime:i}):("exit"===t||"void"===t)&&this._animationStateChanged.next({state:"closing",totalTime:i})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275cmp=cn({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,i){1&t&&bE("@dialogContainer.start",function(s){return i._onAnimationStart(s)})("@dialogContainer.done",function(s){return i._onAnimationDone(s)}),2&t&&(ku("id",i._id),ji("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledBy)("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),EE("@dialogContainer",i._state))},features:[xn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,i){1&t&&Di(0,VTe,0,0,"ng-template",0)},directives:[tp],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[UTe.dialogContainer]}}),n})(),GTe=0;class zC{constructor(e,t,i="mat-dialog-"+GTe++){this._overlayRef=e,this._containerInstance=t,this.id=i,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new se,this._afterClosed=new se,this._beforeClosed=new se,this._state=0,t._id=i,t._animationStateChanged.pipe(Ji(r=>"opened"===r.state),Yi(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(Ji(r=>"closed"===r.state),Yi(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),e.keydownEvents().pipe(Ji(r=>27===r.keyCode&&!this.disableClose&&!Al(r))).subscribe(r=>{r.preventDefault(),YP(this,"keyboard")}),e.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():YP(this,"mouse")})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Ji(t=>"closing"===t.state),Yi(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(e){let t=this._getPositionStrategy();return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(e="",t=""){return this._overlayRef.updateSize({width:e,height:t}),this._overlayRef.updatePosition(),this}addPanelClass(e){return this._overlayRef.addPanelClass(e),this}removePanelClass(e){return this._overlayRef.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function YP(n,e,t){return void 0!==n._containerInstance&&(n._containerInstance._closeInteractionType=e),n.close(t)}const q7=new Ht("MatDialogData"),$Te=new Ht("mat-dialog-default-options"),Y7=new Ht("mat-dialog-scroll-strategy");let YTe=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._dialogRefConstructor=l,this._dialogContainerType=c,this._dialogDataToken=u,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new se,this._afterOpenedAtThisLevel=new se,this._ariaHiddenElements=new Map,this.afterAllClosed=function(n){return new I(e=>{let t;try{t=n()}catch(r){return void e.error(r)}return(t?je(t):fS()).subscribe(e)})}(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ao(void 0))),this._scrollStrategy=a}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(t,i){(i=function(n,e){return Object.assign(Object.assign({},e),n)}(i,this._defaultOptions||new qP)).id&&this.getDialogById(i.id);const r=this._createOverlay(i),s=this._attachDialogContainer(r,i),o=this._attachDialogContent(t,s,r,i);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(o),o.afterClosed().subscribe(()=>this._removeOpenDialog(o)),this.afterOpened.next(o),s._initializeWithAttachedContent(),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const i=this._getOverlayConfig(t);return this._overlay.create(i)}_getOverlayConfig(t){const i=new LC({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachDialogContainer(t,i){const s=Wn.create({parent:i&&i.viewContainerRef&&i.viewContainerRef.injector||this._injector,providers:[{provide:qP,useValue:i}]}),o=new PC(this._dialogContainerType,i.viewContainerRef,s,i.componentFactoryResolver);return t.attach(o).instance}_attachDialogContent(t,i,r,s){const o=new this._dialogRefConstructor(r,i,s.id);if(t instanceof zo)i.attachTemplatePortal(new Om(t,null,{$implicit:s.data,dialogRef:o}));else{const a=this._createInjector(s,o,i),l=i.attachComponentPortal(new PC(t,s.viewContainerRef,a));o.componentInstance=l.instance}return o.updateSize(s.width,s.height).updatePosition(s.position),o}_createInjector(t,i,r){const s=t&&t.viewContainerRef&&t.viewContainerRef.injector,o=[{provide:this._dialogContainerType,useValue:r},{provide:this._dialogDataToken,useValue:t.data},{provide:this._dialogRefConstructor,useValue:i}];return t.direction&&(!s||!s.get(Tl,null,wn.Optional))&&o.push({provide:Tl,useValue:{value:t.direction,change:dn()}}),Wn.create({parent:s||this._injector,providers:o})}_removeOpenDialog(t){const i=this.openDialogs.indexOf(t);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((r,s)=>{r?s.setAttribute("aria-hidden",r):s.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){let s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}}return n.\u0275fac=function(t){return new(t||n)(xe(vc),xe(Wn),xe(void 0),xe(void 0),xe(kb),xe(void 0),xe(Su),xe(Su),xe(Ht))},n.\u0275dir=Rt({type:n}),n})(),jb=(()=>{class n extends YTe{constructor(t,i,r,s,o,a,l){super(t,i,s,a,l,o,zC,HTe,q7)}}return n.\u0275fac=function(t){return new(t||n)(Oe(vc),Oe(Wn),Oe(Pg,8),Oe($Te,8),Oe(Y7),Oe(n,12),Oe(kb))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),XTe=0,K7=(()=>{class n{constructor(t,i,r){this._dialogRef=t,this._elementRef=i,this._dialog=r,this.id="mat-dialog-title-"+XTe++}ngOnInit(){this._dialogRef||(this._dialogRef=function(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{const t=this._dialogRef._containerInstance;t&&!t._ariaLabelledBy&&(t._ariaLabelledBy=this.id)})}}return n.\u0275fac=function(t){return new(t||n)(xe(zC,8),xe(vn),xe(jb))},n.\u0275dir=Rt({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(t,i){2&t&&ku("id",i.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]}),n})(),X7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Rt({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),n})();const XP=new Ht("CdkAccordion");let JTe=0,tMe=(()=>{class n{constructor(t,i,r){this.accordion=t,this._changeDetectorRef=i,this._expansionDispatcher=r,this._openCloseAllSubscription=x.EMPTY,this.closed=new sn,this.opened=new sn,this.destroyed=new sn,this.expandedChange=new sn,this.id="cdk-accordion-child-"+JTe++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=r.listen((s,o)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===o&&this.id!==s&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(t){t=xi(t),this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){this._disabled=xi(t)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}}return n.\u0275fac=function(t){return new(t||n)(xe(XP,12),xe(Dr),xe(B$))},n.\u0275dir=Rt({type:n,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[Hn([{provide:XP,useValue:void 0}])]}),n})();const iMe=["body"];function rMe(n,e){}const sMe=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],oMe=["mat-expansion-panel-header","*","mat-action-row"];function aMe(n,e){1&n&&bi(0,"span",2),2&n&&rn("@indicatorRotate",ci()._getExpandedState())}const lMe=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],cMe=["mat-panel-title","mat-panel-description","*"],QP=new Ht("MAT_ACCORDION"),Z7="225ms cubic-bezier(0.4,0.0,0.2,1)",J7={indicatorRotate:Sm("indicatorRotate",[bc("collapsed, void",fs({transform:"rotate(0deg)"})),bc("expanded",fs({transform:"rotate(180deg)"})),ud("expanded <=> collapsed, void => collapsed",cd(Z7))]),bodyExpansion:Sm("bodyExpansion",[bc("collapsed, void",fs({height:"0px",visibility:"hidden"})),bc("expanded",fs({height:"*",visibility:"visible"})),ud("expanded <=> collapsed, void => collapsed",cd(Z7))])};let uMe=(()=>{class n{constructor(t){this._template=t}}return n.\u0275fac=function(t){return new(t||n)(xe(zo))},n.\u0275dir=Rt({type:n,selectors:[["ng-template","matExpansionPanelContent",""]]}),n})(),dMe=0;const eW=new Ht("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let tW=(()=>{class n extends tMe{constructor(t,i,r,s,o,a,l){super(t,i,r),this._viewContainerRef=s,this._animationMode=a,this._hideToggle=!1,this.afterExpand=new sn,this.afterCollapse=new sn,this._inputChanges=new se,this._headerId="mat-expansion-panel-header-"+dMe++,this._bodyAnimationDone=new se,this.accordion=t,this._document=o,this._bodyAnimationDone.pipe(rd((c,u)=>c.fromState===u.fromState&&c.toState===u.toState)).subscribe(c=>{"void"!==c.fromState&&("expanded"===c.toState?this.afterExpand.emit():"collapsed"===c.toState&&this.afterCollapse.emit())}),l&&(this.hideToggle=l.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=xi(t)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this.opened.pipe(ao(null),Ji(()=>this.expanded&&!this._portal),Yi(1)).subscribe(()=>{this._portal=new Om(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,i=this._body.nativeElement;return t===i||i.contains(t)}return!1}}return n.\u0275fac=function(t){return new(t||n)(xe(QP,12),xe(Dr),xe(B$),xe(Ns),xe(hn),xe(Il,8),xe(eW,8))},n.\u0275cmp=cn({type:n,selectors:[["mat-expansion-panel"]],contentQueries:function(t,i,r){if(1&t&&function(n,e,t,i){const r=Ei();if(r.firstCreatePass){const s=cs();j3(r,new k3(e,t,i),s.index),function(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}B3(r,jt(),t)}(r,uMe,5),2&t){let s;ii(s=ri())&&(i._lazyContent=s.first)}},viewQuery:function(t,i){if(1&t&&rs(iMe,5),2&t){let r;ii(r=ri())&&(i._body=r.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(t,i){2&t&&vi("mat-expanded",i.expanded)("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-expansion-panel-spacing",i._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[Hn([{provide:QP,useValue:void 0}]),xn,zi],ngContentSelectors:oMe,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(t,i){1&t&&(ns(sMe),si(0),kt(1,"div",0,1),Un("@bodyExpansion.done",function(s){return i._bodyAnimationDone.next(s)}),kt(3,"div",2),si(4,1),Di(5,rMe,0,0,"ng-template",3),Lt(),si(6,2),Lt()),2&t&&(Jt(1),rn("@bodyExpansion",i._getExpandedState())("id",i.id),ji("aria-labelledby",i._headerId),Jt(4),rn("cdkPortalOutlet",i._portal))},directives:[tp],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[J7.bodyExpansion]},changeDetection:0}),n})();class fMe{}const pMe=DP(fMe);let nW=(()=>{class n extends pMe{constructor(t,i,r,s,o,a,l){super(),this.panel=t,this._element=i,this._focusMonitor=r,this._changeDetectorRef=s,this._animationMode=a,this._parentChangeSubscription=x.EMPTY;const c=t.accordion?t.accordion._stateChanges.pipe(Ji(u=>!(!u.hideToggle&&!u.togglePosition))):qc;this.tabIndex=parseInt(l||"")||0,this._parentChangeSubscription=kn(t.opened,t.closed,c,t._inputChanges.pipe(Ji(u=>!!(u.hideToggle||u.disabled||u.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(Ji(()=>t._containsFocus())).subscribe(()=>r.focusVia(i,"program")),o&&(this.expandedHeight=o.expandedHeight,this.collapsedHeight=o.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:Al(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t,i){t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return n.\u0275fac=function(t){return new(t||n)(xe(tW,1),xe(vn),xe(uu),xe(Dr),xe(eW,8),xe(Il,8),Fo("tabindex"))},n.\u0275cmp=cn({type:n,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(t,i){1&t&&Un("click",function(){return i._toggle()})("keydown",function(s){return i._keydown(s)}),2&t&&(ji("id",i.panel._headerId)("tabindex",i.tabIndex)("aria-controls",i._getPanelId())("aria-expanded",i._isExpanded())("aria-disabled",i.panel.disabled),Hy("height",i._getHeaderHeight()),vi("mat-expanded",i._isExpanded())("mat-expansion-toggle-indicator-after","after"===i._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===i._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===i._animationMode))},inputs:{tabIndex:"tabIndex",expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},features:[xn],ngContentSelectors:cMe,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(t,i){1&t&&(ns(lMe),kt(0,"span",0),si(1),si(2,1),si(3,2),Lt(),Di(4,aMe,1,1,"span",1)),2&t&&(Jt(4),rn("ngIf",i._showToggle()))},directives:[ac],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-keyboard-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-program-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:hover:not([aria-disabled=true])::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;border:3px solid;border-radius:4px;content:""}\n'],encapsulation:2,data:{animation:[J7.indicatorRotate]},changeDetection:0}),n})();var iW=Je(478);Object.create(Error.prototype);const bMe=["*"];var GC=(()=>(function(n){n.LineHighlight="line-highlight",n.LineNumbers="line-numbers"}(GC||(GC={})),GC))();class wMe{}const sW=new Ht("SECURITY_CONTEXT");let ZP=(()=>{class n{constructor(t,i,r,s,o){this.platform=t,this.securityContext=i,this.http=r,this.sanitizer=o,this.initialMarkedOptions={renderer:new iW.Renderer},this.options=s}get options(){return this._options}set options(t){this._options=Object.assign(Object.assign({},this.initialMarkedOptions),t)}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}compile(t,i=!1,r=!1,s=this.options){const o=this.trimIndentation(t),a=i?this.decodeHtml(o):o,l=r?this.renderEmoji(a):a,c=iW.parse(l,s);return this.sanitizer.sanitize(this.securityContext,c)||""}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe(me(i=>this.handleExtension(t,i)))}highlight(t){if(Tf(this.platform)&&"undefined"!=typeof Prism){t||(t=document);const i=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(i,r=>r.classList.add("language-none")),Prism.highlightAllUnder(t)}}renderKatex(t,i){if(!Tf(this.platform))return t;if("undefined"==typeof katex||void 0===katex.renderToString)throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");return t.replace(/\$([^\s][^$]*?[^\s])\$/gm,(r,s)=>katex.renderToString(s,i))}decodeHtml(t){if(!Tf(this.platform))return t;const i=document.createElement("textarea");return i.innerHTML=t,i.value}handleExtension(t,i){const r=t?t.split("?")[0].split(".").splice(-1).join():"";return"md"!==r?"```"+r+"\n"+i+"\n```":i}renderEmoji(t){if(!Tf(this.platform))return t;if("undefined"==typeof joypixels||void 0===joypixels.shortnameToUnicode)throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}trimIndentation(t){if(!t)return"";let i;return t.split("\n").map(r=>{let s=i;return r.length>0&&(s=isNaN(s)?r.search(/\S|$/):Math.min(r.search(/\S|$/),s)),isNaN(i)&&(i=s),s?r.substring(s):r}).join("\n")}}return n.\u0275fac=function(t){return new(t||n)(Oe($c),Oe(sW),Oe(ip,8),Oe(wMe,8),Oe(Mf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),oW=(()=>{class n{constructor(t,i){this.element=t,this.markdownService=i,this.error=new sn,this.load=new sn,this.ready=new sn,this._emoji=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}ngOnChanges(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion()}render(t,i=!1){let r=this.markdownService.compile(t,i,this.emoji);r=this.katex?this.markdownService.renderKatex(r,this.katexOptions):r,this.element.nativeElement.innerHTML=r,this.handlePlugins(),this.markdownService.highlight(this.element.nativeElement),this.ready.emit()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe(t=>{this.render(t),this.load.emit(t)},t=>this.error.emit(t))}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,GC.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++){const o=i instanceof Array?i:[i];r.item(s).classList.add(...o)}}setPluginOptions(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++)Object.keys(i).forEach(o=>{const a=i[o];if(a){const l=this.toLispCase(o);r.item(s).setAttribute(l,a.toString())}})}toLispCase(t){const i=t.match(/([A-Z])/g);if(!i)return t;let r=t.toString();for(let s=0,o=i.length;s<o;s++)r=r.replace(new RegExp(i[s]),"-"+i[s].toLowerCase());return"-"===r.slice(0,1)&&(r=r.slice(1)),r}}return n.\u0275fac=function(t){return new(t||n)(xe(vn),xe(ZP))},n.\u0275cmp=cn({type:n,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start"},outputs:{error:"error",load:"load",ready:"ready"},features:[zi],ngContentSelectors:bMe,decls:1,vars:0,template:function(t,i){1&t&&(ns(),si(0))},encapsulation:2}),n})();function aW(n,e,t){return t?aW(n,e).pipe(me(i=>P(i)?t(...i):t(i))):new I(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o);let s;try{s=n(r)}catch(o){return void i.error(o)}if(Y(e))return()=>e(r,s)})}function JP(...n){return e=>{let t;return"function"==typeof n[n.length-1]&&(t=n.pop()),e.lift(new MMe(n,t))}}class MMe{constructor(e,t){this.observables=e,this.project=t}call(e,t){return t.subscribe(new DMe(e,this.observables,this.project))}}class DMe extends _7{constructor(e,t,i){super(e),this.observables=t,this.project=i,this.toRespond=[];const r=t.length;this.values=new Array(r);for(let s=0;s<r;s++)this.toRespond.push(s);for(let s=0;s<r;s++)this.add(y7(this,t[s],void 0,s))}notifyNext(e,t,i){this.values[i]=t;const r=this.toRespond;if(r.length>0){const s=r.indexOf(i);-1!==s&&r.splice(s,1)}}notifyComplete(){}_next(e){if(0===this.toRespond.length){const t=[e,...this.values];this.project?this._tryProject(t):this.destination.next(t)}}_tryProject(e){let t;try{t=this.project.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}class IMe{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new OMe(e,this.accumulator,this.seed,this.hasSeed))}}class OMe extends y{constructor(e,t,i,r){super(e),this.accumulator=t,this._seed=i,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(r){this.destination.error(r)}this.seed=i,this.destination.next(i)}}class PMe{constructor(e){this.predicate=e}call(e,t){return t.subscribe(new FMe(e,this.predicate))}}class FMe extends y{constructor(e,t){super(e),this.predicate=t,this.skipping=!0,this.index=0}_next(e){const t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)}tryCallPredicate(e){try{const t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(t){this.destination.error(t)}}}const kMe=["youtubeContainer"];let uW=(()=>{class n{constructor(t,i){this._ngZone=t,this._youtubeContainer=new se,this._destroyed=new se,this._playerChanges=new Br(void 0),this._videoId=new Br(void 0),this._height=new Br(390),this._width=new Br(640),this._startSeconds=new Br(void 0),this._endSeconds=new Br(void 0),this._suggestedQuality=new Br(void 0),this._playerVars=new Br(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=Tf(i)}get videoId(){return this._videoId.value}set videoId(t){this._videoId.next(t)}get height(){return this._height.value}set height(t){this._height.next(t||390)}get width(){return this._width.value}set width(t){this._width.next(t||640)}set startSeconds(t){this._startSeconds.next(t)}set endSeconds(t){this._endSeconds.next(t)}set suggestedQuality(t){this._suggestedQuality.next(t)}get playerVars(){return this._playerVars.value}set playerVars(t){this._playerVars.next(t)}ngOnInit(){if(!this._isBrowser)return;let t=dn(!0);if(!window.YT||!window.YT.Player){const r=new se;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},t=r.pipe(Yi(1),ao(!1))}const i=function(n,e,t,i,r,s,o){const a=Yo([e,s]).pipe(JP(Yo([i,r])),me(([l,c])=>{const[u,h]=l,[p,g]=c;return u?{videoId:u,playerVars:h,width:p,height:g}:void 0}));return Yo([n,a,dn(o)]).pipe(function(n){return ce(function(...n){let e=null;return"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&P(n[0])&&(n=n[0].slice()),t=>t.lift.call(je([t,...n]),new v7(e))}(n),function(n){return e=>e.lift(new PMe(n))}(([e,t])=>!t),me(([e])=>e))}(t),function(n,e){let t=!1;return arguments.length>=2&&(t=!0),function(r){return r.lift(new IMe(n,e,t))}}(zMe,void 0),rd())}(this._youtubeContainer,this._videoId,t,this._width,this._height,this._playerVars,this._ngZone).pipe(qr(r=>{this._playerChanges.next(r)}),B(e=>e?dW(e)?dn(e):new I(t=>{let i=!1,r=!1;const s=o=>{r=!0,i||(o.target.removeEventListener("onReady",s),t.next(o.target))};return e.addEventListener("onReady",s),()=>{i=!0,r||(r=>{dW(r)||r.destroy()})(e)}}).pipe(Yi(1),ao(void 0)):dn(void 0)),mr(this._destroyed),Ja(new se));i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function(n,e,t){Yo([n,e,t]).subscribe(([i,r,s])=>i&&i.setSize(r,s))}(i,this._width,this._height),function(n,e){Yo([n,e]).subscribe(([t,i])=>t&&i&&t.setPlaybackQuality(i))}(i,this._suggestedQuality),function(n,e,t,i,r,s){const o=Yo([t,i]).pipe(me(([u,h])=>({startSeconds:u,endSeconds:h}))),a=o.pipe(tF(n,u=>!!u&&!function(n){const e=n.getPlayerState();return e!==YT.PlayerState.UNSTARTED&&e!==YT.PlayerState.CUED}(u))),l=e.pipe(tF(n,(u,h)=>!!u&&u.videoId!==h));kn(n.pipe(tF(Yo([e,o]),([u,h],p)=>!(!p||u==p.videoId&&!h.startSeconds&&!h.endSeconds))),l,a).pipe(JP(Yo([n,e,o,r])),me(([u,h])=>h),mr(s)).subscribe(([u,h,p,g])=>{!h||!u||(u.videoId=h,u.cueVideoById(Object.assign({videoId:h,suggestedQuality:g},p)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}createEventsBoundInZone(){return{}}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(t,i){this._player?this._player.seekTo(t,i):this._getPendingState().seek={seconds:t,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(t){this._player?this._player.setVolume(t):this._getPendingState().volume=t}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(t){if(this._player)return this._player.setPlaybackRate(t);this._getPendingState().playbackRate=t}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(t,i){const{playbackState:r,playbackRate:s,volume:o,muted:a,seek:l}=i;switch(r){case YT.PlayerState.PLAYING:t.playVideo();break;case YT.PlayerState.PAUSED:t.pauseVideo();break;case YT.PlayerState.CUED:t.stopVideo()}null!=s&&t.setPlaybackRate(s),null!=o&&t.setVolume(o),null!=a&&(a?t.mute():t.unMute()),null!=l&&t.seekTo(l.seconds,l.allowSeekAhead)}_getLazyEmitter(t){return this._playerChanges.pipe(Ir(i=>i?aW(r=>{i.addEventListener(t,r)},r=>{try{i.removeEventListener&&i.removeEventListener(t,r)}catch(s){}}):dn()),i=>new I(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),mr(this._destroyed))}}return n.\u0275fac=function(t){return new(t||n)(xe(fn),xe($c))},n.\u0275cmp=cn({type:n,selectors:[["youtube-player"]],viewQuery:function(t,i){if(1&t&&rs(kMe,5),2&t){let r;ii(r=ri())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(t,i){1&t&&bi(0,"div",null,0)},encapsulation:2,changeDetection:0}),n})();function zMe(n,[e,t,i]){if(n&&t&&n.playerVars!==t.playerVars)n.destroy();else{if(!t)return void(n&&n.destroy());if(n)return n}const r=i.runOutsideAngular(()=>new YT.Player(e,t));return r.videoId=t.videoId,r.playerVars=t.playerVars,r}function dW(n){return"getPlayerStatus"in n}function tF(n,e){return ce(JP(n),Ji(([t,i])=>e(i,t)),me(([t])=>t))}let ZMe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Rt({type:n,selectors:[["","mat-card-sm-image",""],["","matCardImageSmall",""]],hostAttrs:[1,"mat-card-sm-image"]}),n})();function Ub(n){return!0===n}function Ka(n){return null==n}function Xa(n){return!Ka(n)}function nF(n){return Boolean(n)}function gW(n){return Ka(n)?n:JSON.parse(JSON.stringify(n))}const WC=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&WC(n[o])}),n};function mW(n){return Xa(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const bW="NGXS_DATA_META",rF="NGXS_META",vW="NGXS_ARGUMENT_REGISTRY_META";let wW=(()=>{class n{constructor(t){this.sequence$=new Br(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Oe(lu,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function zb(n){return n[bW]}let Qa=(()=>{class n{constructor(t,i,r){n.store=t.get(lu),n.ngZone=t.get(fn),n.factory=i,n.context=r,n.computed=t.get(wW)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Oe(Wn),Oe(m6),Oe(g6))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class ps{constructor(){ps.statesCachedMeta.clear()}static createStateContext(e){return Qa.context.createStateContext(e)}static ensureMappedState(e){if(Ka(Qa.factory)||Ka(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Xa(e.name)?ps.statesCachedMeta.get(e.name):null)||ps.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=zb(ps.getStateClassByInstance(e)))&&void 0!==t?t:null;if(Ka(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=ps.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);Xa(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=ps.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=Xa(e.name)?null===(t=Qa.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return Xa(i)&&Xa(e.name)&&ps.statesCachedMeta.set(e.name,i),i}}ps.statesCachedMeta=new Map,ps.\u0275fac=function(e){return new(e||ps)},ps.\u0275prov=We({token:ps,factory:ps.\u0275fac}),new kg(1);class bDe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Xa(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function EW(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function SW(n){var e;const t=EW(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=gW(void 0===t.defaults?{}:t.defaults);if(i.length){if(mW(s))return function(n,e){return e.reduce((t,i)=>{const r=EW(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=SW(i),t},null!=n?n:{})}(s,i);throw new bDe(s)}return s}function CW(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function AW(){var n,e;return null!==(e=null===(n=null==Qa?void 0:Qa.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function SDe(n){let e=!1;return Mm(n)&&(e=!0),e}function sF(n){return n[vW]}class xDe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class CDe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(nF(this.argumentMap.has(e))||nF(this.payloadMap.has(e)))throw new xDe(e,t)}}function ODe(n){return{enumerable:!0,configurable:!0,get(){const e=zb(n),t=ps.ensureMappedState(e.stateMeta);return ps.createStateContext(t)}}}function TW(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(mW(i))for(;null!==i;){if(Ub(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return Ka(CW(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),CW(n)}(this),o=null==s?void 0:s.get(i);if(Ub(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(Ka(o)||o.sequenceId!==AW()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:AW(),isObservable:SDe(l)}),l}return o.value},t}}const LDe={cancelUncompleted:!0,insideZone:!1};function oF(n=LDe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=ps.getRepositoryByInstance(a),u=c.operations;let h=u[s];const p=c.stateMeta,g=sF(r);if(Ka(h)){const U=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),de=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)Xa(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):Xa(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:p.path,methodName:s,argumentsNames:U,argumentRegistry:g});h=u[s]={type:de,options:{cancelUncompleted:n.cancelUncompleted}},p.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}ps.ensureMappedState(p).instance[h.type]=()=>{var U;return Ub(n.insideZone)?null===(U=Qa.ngZone)||void 0===U||U.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),Mm(l)?dn(null).pipe(me(()=>l)):l};const C=ps.createAction(h,o,g),H=Qa.store.dispatch(C);return Mm(l)?function(n,e){return gb([n,e]).pipe(me(t=>t.pop()))}(H,l):l},i}}function MW(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return Ka(sF(t))&&Object.defineProperties(t,{[vW]:{enumerable:!0,configurable:!0,value:new CDe}}),sF(t)})(e,t).createPayloadType(r,t,i)}}function jDe(){return n=>{const e=function(n){if(function(n){return!nF(n)}(n.hasOwnProperty(rF))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,rF,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[rF]}(n)}(n);if(Ka(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=zb(n))&&void 0!==e?e:null;return(Ka(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,bW,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),zb(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>gW(t)},context:ODe(n)})}(n,e,SW(n)),function(n){var e,t;const i=zb(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(Xa(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Xa(this[s]))return this[s];if(Ka(Qa.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=Qa.store.select(n).pipe(me(o=>La()?WC(o):o),Ga({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let UDe=(()=>{class n{constructor(){this.browserStorageEvents$=new se,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),zDe=(()=>{class n extends UDe{get snapshot(){return function(n){return La()?WC(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>La()?WC(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),or([TW(),uc("design:type",Object),uc("design:paramtypes",[])],n.prototype,"snapshot",null),or([oF(),Dj(0,MW("patchValue")),uc("design:type",Function),uc("design:paramtypes",[Object]),uc("design:returntype",void 0)],n.prototype,"patchState",null),or([oF(),Dj(0,MW("stateValue")),uc("design:type",Function),uc("design:paramtypes",[Object]),uc("design:returntype",void 0)],n.prototype,"setState",null),or([oF(),uc("design:type",Function),uc("design:paramtypes",[]),uc("design:returntype",void 0)],n.prototype,"reset",null),n})();const Vm=new Ht("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),DF=new Ht("ngx-window",{providedIn:"root",factory:()=>function(n){return Tf(n)?window:null}(Pc($c))}),tRe=new Ht("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Pc(DF))}),IF=new Ht("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Pc(DF),Pc(tRe))});let OF=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){(this.settings.enableTracing||La())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o){try{const a=new Map;i&&a.set("event_category",i),r&&a.set("event_label",r),s&&a.set("value",s),void 0!==o&&a.set("interaction",o);const l=this.toKeyValue(a);l?this.gtag("event",t,l):this.gtag("event",t)}catch(a){this.throw(a)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,l])=>o.set(a,l)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(Oe(Vm),Oe(hn),Oe(IF))},n.\u0275prov=We({factory:function(){return new n(Oe(Vm),Oe(hn),Oe(IF))},token:n,providedIn:"root"}),n})();new Ht("ngx-google-analytics-routing-settings",{factory:()=>({})}),new Ht("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"});class L9 extends Error{constructor(){super(...arguments),this.message="NgxsDispatchPluginModule is not imported"}}function ERe(){throw new L9}function SRe(){throw new L9}function PF(n,e,t){e.run(()=>n.dispatch(t))}function ARe(n,e,t,i){return yg(t)?function(n,e,t){return t.then(i=>(PF(n,e,i),i))}(n,e,t):Mm(t)?function(n,e,t,i){return null!==i&&(t=t.pipe(mr(i.cancelUncompleted$))),t.subscribe({next:r=>PF(n,e,r)}),t}(n,e,t,i):(PF(n,e,t),t)}class TRe{constructor(){this.cancelUncompleted$=new se}cancelPreviousAction(){this.cancelUncompleted$.next()}}const FF="\u0275fac",B9=Symbol("InjectorInstance"),j9=Symbol("FactoryHasBeenDecorated");function V9(n,e){const t=n[B9];return t?t.get(e):null}const IRe={cancelUncompleted:!1};function U9(n=IRe){return(e,t,i)=>{let r;const s=function(n){return n?new TRe:null}(n.cancelUncompleted);function o(){null!==s&&s.cancelPreviousAction();const a=V9(this,lu)||ERe(),l=V9(this,fn)||SRe(),c=r.apply(this,arguments);return l.runOutsideAngular(()=>ARe(a,l,c,s))}"function"==typeof(null==i?void 0:i.value)?(r=i.value,i.value=o):Object.defineProperty(e,t,{set:a=>r=a,get:()=>o}),function(n){if(j9 in n.constructor.prototype)return;const e=n.constructor;"function"==typeof e[FF]&&function(n){const e=n[FF];if("function"!=typeof e)return;const t=n.\u0275prov||n.\u0275pipe||n.\u0275cmp||n.\u0275dir,i=()=>{const r=e();return r[B9]=xe(Nu),r};t&&(t.factory=i),Object.defineProperty(n,FF,{get:()=>i})}(e),n.constructor.prototype[j9]=!0}(e)}}const rNe=["bodyCanvas"];let sNe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new sn,this.nodeDrag=new sn,this.nodeClick=new sn,this.nodeHoverStart=new sn,this.nodeHoverStop=new sn,this.initialized=new sn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return ki(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new ewe({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=cn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&rs(rNe,5,vn),2&t){let r;ii(r=ri())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Ql(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&bi(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),oNe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[ss]]}),n})();function CNe(n,e){if(1&n&&(kt(0,"div",16),bi(1,"youtube-player",17),Lt()),2&n){const t=ci(3);Jt(1),vE("videoId",t.videoID)}}function ANe(n,e){if(1&n&&(kt(0,"mat-expansion-panel",11),kt(1,"mat-expansion-panel-header"),kt(2,"h2",12),$i(3),Lt(),Lt(),kt(4,"div",13),bi(5,"markdown",14),Di(6,CNe,2,1,"div",15),Lt(),Lt()),2&n){const t=ci(),i=t.index,r=t.$implicit;rn("expanded",0===i),Jt(3),da(r.title),Jt(2),vi("first",0===i),rn("data",r.content),Jt(1),rn("ngIf",0===i)}}function TNe(n,e){if(1&n&&(kt(0,"div",9),Di(1,ANe,7,6,"mat-expansion-panel",10),Lt()),2&n){const t=e.$implicit;Jt(1),rn("ngIf",t)}}new Ht("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name)).filter(n=>!0!==n.disabled);let J9=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.documentationContents=i.content||[],this.infoTitle=i.title||"",this.videoID=i.videoID}ngOnInit(){const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t)}close(){var t;null===(t=document.getElementsByClassName("modal-animated")[0])||void 0===t||t.classList.add("modal-animate-fade-out"),setTimeout(()=>{this.dialogRef.close()},250)}}return n.\u0275fac=function(t){return new(t||n)(xe(zC),xe(q7))},n.\u0275cmp=cn({type:n,selectors:[["ccf-info-dialog"]],decls:11,vars:2,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"header"],["mat-dialog-title","",1,"title"],[1,"close"],[1,"material-icons","close-icon",3,"click"],[1,"mat-typography","dialog-content"],["class","panel",4,"ngFor","ngForOf"],[1,"panel"],[3,"expanded",4,"ngIf"],[3,"expanded"],[1,"no-header-margin"],[1,"top-padding"],[1,"variable-binding",3,"data"],["class","video-player",4,"ngIf"],[1,"video-player"],[3,"videoId"]],template:function(t,i){1&t&&(kt(0,"div",0),kt(1,"div",1),kt(2,"div",2),kt(3,"div",3),kt(4,"h2",4),$i(5),Lt(),kt(6,"div",5),kt(7,"mat-icon",6),Un("click",function(){return i.close()}),$i(8,"clear"),Lt(),Lt(),Lt(),kt(9,"mat-dialog-content",7),Di(10,TNe,2,1,"div",8),Lt(),Lt(),Lt(),Lt()),2&t&&(Jt(5),da(i.infoTitle),Jt(5),rn("ngForOf",i.documentationContents))},directives:[K7,Pm,X7,Af,ac,tW,nW,oW,uW],styles:[".mat-dialog-container{padding:0}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:3rem;text-align:left}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:3rem;margin-bottom:2.25rem;position:relative}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5rem;margin-bottom:1rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;height:3rem;width:3rem;line-height:3rem;text-align:center;transition:.6s}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;margin:0 auto;line-height:3rem;height:3rem;justify-self:center;display:flex}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.5rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{margin-bottom:1.5rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .no-header-margin[_ngcontent-%COMP%]{font-weight:300;margin-bottom:0}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]{display:flex}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]   markdown[_ngcontent-%COMP%]     ul{margin-top:0;padding-left:1.5rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{height:50rem;min-height:10rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]{font-weight:300;display:flex}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding.first[_ngcontent-%COMP%]{padding-right:1rem;width:73%}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     ul{margin:0}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     img{margin-left:1rem;float:right}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]{position:relative;width:50%}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]     iframe{width:100%;height:100%}"]}),n})(),eq=(()=>{class n{constructor(t){this.http=t,this.panelContent=new Br({content:[],infoTitle:"",videoID:""})}updateData(t,i,r){this.http.get(t,{responseType:"text"}).subscribe(s=>{const o={content:this.parseMarkdown(s),infoTitle:r,videoID:i};this.panelContent.next(o)})}parseMarkdown(t){const i=[],r=t.split("# ");for(const s of r)if(s.length){const o=s.includes("\n\n")?"\n\n":"\r\n\r\n",a=s.split(o);i.push({title:a[0],content:a.splice(1).join(o)})}return i}}return n.\u0275fac=function(t){return new(t||n)(Oe(ip))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),DNe=(()=>{class n{constructor(){this.clsName="ccf-call-to-action",this.callToActionClicked=new sn,this.closeClicked=new sn}close(){this.closeClicked.emit()}onDialogButtonClick(){this.callToActionClicked.emit()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=cn({type:n,selectors:[["ccf-call-to-action"]],hostVars:2,hostBindings:function(t,i){2&t&&Ql(i.clsName)},inputs:{infoTitle:"infoTitle",imageUrl:"imageUrl",message:"message",callToAction:"callToAction"},outputs:{callToActionClicked:"callToActionClicked",closeClicked:"closeClicked"},decls:13,vars:4,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"first-row"],["mat-dialog-title","",1,"title"],[1,"cta-mat-icon","material-icons","close-icon",3,"click"],["mat-card-sm-image","","alt","preview","layout-fill","",1,"cta-image",3,"src"],[1,"mat-typography","dialog-content"],[1,"message"],["mat-button","",1,"mat-button",3,"text","click"]],template:function(t,i){1&t&&(kt(0,"div",0),kt(1,"div",1),kt(2,"div",2),kt(3,"div",3),kt(4,"p",4),$i(5),Lt(),kt(6,"mat-icon",5),Un("click",function(){return i.close()}),$i(7,"clear"),Lt(),Lt(),bi(8,"img",6),kt(9,"mat-dialog-content",7),kt(10,"div",8),$i(11),Lt(),kt(12,"a",9),Un("click",function(){return i.onDialogButtonClick()}),Lt(),Lt(),Lt(),Lt(),Lt()),2&t&&(Jt(5),da(i.infoTitle),Jt(3),rn("src",i.imageUrl,nf),Jt(3),ec(" ",i.message,""),Jt(1),rn("text",i.callToAction))},directives:[K7,Pm,ZMe,X7],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:block;align-content:center;padding-left:1.6rem;padding-right:1.6rem;border-radius:.25rem}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]{border-radius:.25rem;padding:.6rem;transition:.6s}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]   .ccf-info-button[_ngcontent-%COMP%]{cursor:pointer;transition:color .6s;font-size:1.2rem;vertical-align:sub}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]{display:flex;width:100%;line-height:.9rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:7rem;padding-left:.2rem;font-size:.875rem;padding-top:.75rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .cta-mat-icon[_ngcontent-%COMP%]{height:30%;line-height:3.4rem}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{padding:.5rem}[_nghost-%COMP%]   .cta-image[_ngcontent-%COMP%]{align-self:center;-o-object-fit:cover;object-fit:cover;width:100%;border-radius:.25rem}[_nghost-%COMP%]   .mat-button[_ngcontent-%COMP%]{background-color:#444a65;font-size:.75rem;position:relative;margin-bottom:1rem;width:100%;height:2rem;color:#fff}"],changeDetection:0}),n})(),Jb=(()=>{let n=class extends zDe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(Ji(n=>null!=n),Ga(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(m7(...t),rd(),Ga(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(m7(...t),rd(),Ga(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),or([TW()],n.prototype,"config$",null),n=or([jDe(),L6({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}(),new se;let jF=(()=>{class n{}return n.type="[CallToAction] Learn More",n})(),VF=(()=>{class n{}return n.type="[CallToAction] Open Dialog",n})(),UF=(()=>{class n{}return n.type="[CallToAction] Close Dialog",n})();var zF;class va{get length(){var e,t;return null!==(t=null===(e=va.storage)||void 0===e?void 0:e.length)&&void 0!==t?t:0}key(e){var t,i;return null!==(i=null===(t=va.storage)||void 0===t?void 0:t.key(e))&&void 0!==i?i:null}getItem(e,t){var i,r,s;return null!==(s=null!==(r=null===(i=va.storage)||void 0===i?void 0:i.getItem(e))&&void 0!==r?r:t)&&void 0!==s?s:null}setItem(e,t){var i;try{return null===(i=va.storage)||void 0===i||i.setItem(e,t),!0}catch(r){return!1}}removeItem(e){var t;null===(t=va.storage)||void 0===t||t.removeItem(e)}clear(){var e;null===(e=va.storage)||void 0===e||e.clear()}}va.storage=(()=>{let n;try{n=window.localStorage;const e="__storage_test__";return n.setItem(e,e),n.removeItem(e),n}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&n&&0!==n.length?n:void 0}})(),va.\u0275fac=function(e){return new(e||va)},va.\u0275prov=We({token:va,factory:va.\u0275fac,providedIn:"root"});const iq="callToActionPopupShown";let Do=zF=class{constructor(e,t,i,r,s){this.dialog=e,this.ga=t,this.storage=i,this.infoService=r,this.http=s}static ctaDatePassed(e,t=Date.now){return+t()>+new Date(e)}ngxsOnInit(e){const{expirationDate:t,popupShown:i}=e.getState(),r=this.storage.getItem(iq,`${i}`),s=zF.ctaDatePassed(t);"true"!==r&&!s&&e.dispatch(new VF)}getDialogData(){return this.http.get("assets/docs/SPATIAL_SEARCH_README.md",{responseType:"text"}).pipe(me(e=>this.infoService.parseMarkdown(e)))}launchLearnMore(e){this.dialog.open(J9,{autoFocus:!1,panelClass:"modal-animated",width:"72rem",data:{title:"Spatial Search",content:e,videoID:"N2JUogY-DQw"}})}learnMore(e){return this.dialog.closeAll(),this.ga.event("open_learn_more","call_to_action"),this.getDialogData().pipe(qr(t=>this.launchLearnMore(t)))}open(e){this.dialog.open(kNe,{autoFocus:!1,panelClass:"modal-animated",width:"30.75rem",height:"36.688rem"}),this.ga.event("open","call_to_action"),this.storage.setItem(iq,"true"),e.patchState({popupShown:!0})}close(e){this.dialog.closeAll(),this.ga.event("close","call_to_action")}};Do.\u0275fac=function(e){return new(e||Do)(Oe(jb),Oe(OF),Oe(va),Oe(eq),Oe(ip))},Do.\u0275prov=We({token:Do,factory:Do.\u0275fac}),or([EN(jF)],Do.prototype,"learnMore",null),or([EN(VF)],Do.prototype,"open",null),or([EN(UF)],Do.prototype,"close",null),Do=zF=or([L6({name:"callToAction",defaults:{title:"New to the Exploration User Interface",message:"Spatial Search has arrived!",callToAction:"Learn More",imageUrl:"assets/images/spatial_search.png",expirationDate:"Dec 1, 2022",popupShown:!1}})],Do);let f1=(()=>{class n{static title(t){return t.title}static message(t){return t.message}static callToAction(t){return t.callToAction}static imageUrl(t){return t.imageUrl}static expirationDate(t){return t.expirationDate}static popupShown(t){return t.popupShown}}return or([ym([Do])],n,"title",null),or([ym([Do])],n,"message",null),or([ym([Do])],n,"callToAction",null),or([ym([Do])],n,"imageUrl",null),or([ym([Do])],n,"expirationDate",null),or([ym([Do])],n,"popupShown",null),n})(),kNe=(()=>{class n{constructor(){this.close=()=>new UF,this.learnMore=()=>new jF}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=cn({type:n,selectors:[["ccf-call-to-action-behavior"]],decls:5,vars:12,consts:[[3,"infoTitle","message","callToAction","imageUrl","callToActionClicked","closeClicked"]],template:function(t,i){1&t&&(kt(0,"ccf-call-to-action",0),Un("callToActionClicked",function(){return i.learnMore()})("closeClicked",function(){return i.close()}),ju(1,"async"),ju(2,"async"),ju(3,"async"),ju(4,"async"),Lt()),2&t&&rn("infoTitle",Vu(1,4,i.title$))("message",Vu(2,6,i.message$))("callToAction",Vu(3,8,i.callToAction$))("imageUrl",Vu(4,10,i.imageUrl$))},directives:[DNe],pipes:[m0],styles:[""],changeDetection:0}),or([Hx(f1.title)],n.prototype,"title$",void 0),or([Hx(f1.message)],n.prototype,"message$",void 0),or([Hx(f1.callToAction)],n.prototype,"callToAction$",void 0),or([Hx(f1.imageUrl)],n.prototype,"imageUrl$",void 0),or([U9()],n.prototype,"close",void 0),or([U9()],n.prototype,"learnMore",void 0),n})();const rq="http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity",UNe=[173,255,47,229.5];var En=Je(440),WNe=Je(698),qNe=Je(445),YNe=Je.n(qNe),_r=Je(815),ev=Je(609);const Ni=En.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},En.DataFactory),Um=(Ni("rdf"),Ni("rdf")("type"),{x:Ni("rdfs"),label:Ni("rdfs")("label"),comment:Ni("rdfs")("comment"),isDefinedBy:Ni("rdfs")("isDefinedBy"),seeAlso:Ni("rdfs")("seeAlso")}),co_label=(Ni("entity"),Ni("entity")("id"),Um.label),co_description=Um.comment,co_link=Um.seeAlso,co_providerName=(Ni("entity")("sex"),Ni("entity")("age"),Ni("entity")("bmi"),En.DataFactory.literal("Male"),En.DataFactory.literal("Female"),Ni("entity")("consortium_name"),Ni("entity")("provider_name")),co_donor=(Ni("entity")("provider_uuid"),Ni("entity")("has_donor")),co_sections=Ni("entity")("has_tissue_section"),co_datasets=Ni("entity")("has_dataset"),co_sampleType=Ni("entity")("sample_type"),co_sectionCount=(En.DataFactory.literal("Tissue Block"),En.DataFactory.literal("Tissue Section"),En.DataFactory.literal("Non-standard"),Ni("entity")("section_count")),co_sectionSize=Ni("entity")("section_size"),co_sectionUnits=Ni("entity")("section_units"),co_sectionNumber=Ni("entity")("section_number"),co_spatialEntity=Ni("entity")("has_spatial_entity"),co_technology=(Ni("entity")("has_ontology_term"),Ni("entity")("has_cell_type_term"),Ni("entity")("technology")),co_thumbnail=Ni("entity")("has_thumbnail"),An=Ni("ccf"),md={x:An,ontologyNode:{label:An("ccf_preferred_label"),parent:An("ccf_part_of"),children:An("ccf_part_of"),rui_rank:An("ccf_rui_rank"),synonymLabels:En.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:An("ccf_part_of"),ct_is_a:An("ct_is_a"),located_in:An("located_in"),characterizes:An("characterizes")},spatial:{Female:An("VHFemale"),Male:An("VHMale"),BothSexes:An("VHBothSexes"),FemaleOrgans:An("VHFemaleOrgans"),MaleOrgans:An("VHMaleOrgans")},SpatialObjectReference:An("SpatialObjectReference"),SpatialEntity:An("SpatialEntity"),SpatialPlacement:An("SpatialPlacement"),spatialObjectReference:{file:An("has_object_file"),file_format:An("has_object_file_format"),file_subpath:An("has_object_file_subpath")},extractionSet:{label:Um.label,rui_rank:An("ccf_rui_rank")},spatialEntity:{label:Um.label,comment:Um.comment,creator:Ni("dc")("creator"),creator_first_name:An("creator_first_name"),creator_last_name:An("creator_last_name"),creator_orcid:An("creator_orcid"),creation_date:An("creation_date"),updated_date:An("updated_date"),ccf_annotations:An("ccf_annotation"),representation_of:An("ccf_representation_of"),reference_organ:An("anatomical_structure_of"),extraction_set_for:An("extraction_set_for"),extraction_set:An("extraction_site_for"),sex:An("has_sex"),side:An("has_side"),rui_rank:An("ccf_rui_rank"),slice_thickness:An("ccf_slice_thickness"),slice_count:An("ccf_slice_count"),x_dimension:An("has_x_dimension"),y_dimension:An("has_y_dimension"),z_dimension:An("has_z_dimension"),dimension_units:An("has_dimension_units"),object:An("has_object_reference")},spatialPlacement:{source:An("has_placement_source"),target:An("has_placement_target"),placement_date:An("has_placement_date"),x_scaling:An("has_x_scaling"),y_scaling:An("has_y_scaling"),z_scaling:An("has_z_scaling"),scaling_units:An("has_scaling_units"),x_rotation:An("has_x_rotation"),y_rotation:An("has_y_rotation"),z_rotation:An("has_z_rotation"),w_rotation:An("has_theta_rotation"),rotation_order:An("has_rotation_order"),rotation_units:An("has_rotation_units"),x_translation:An("has_x_translation"),y_translation:An("has_y_translation"),z_translation:An("has_z_translation"),translation_units:An("has_translation_units")}},ui={x:Ni("uberon"),body:Ni("uberon")("0013702")},QNe={x:Ni("cl"),cell:Ni("cl")("0000000")},tv={x:Ni("fma")},sq=(Ni("lmha"),{body:ui.body,cell:QNe.cell,respiratory_system:ui.x("0001004"),colon:ui.x("0001155"),left_lung:ui.x("0002168"),right_lung:ui.x("0002167"),left_bronchus:ui.x("0002178"),right_bronchus:ui.x("0002177"),kidney:ui.x("0002113"),ureter:ui.x("0000056"),eye:ui.x("0000970"),fallopian_tube:ui.x("0003889"),knee:ui.x("0001465"),ovary:ui.x("0000992"),trachea:ui.x("0003126"),aorta:ui.x("0000947"),blood:ui.x("0000178"),bone_marrow:ui.x("0002371"),male_reproductive_system:ui.x("0000079"),lymph_node:ui.x("0000029"),blood_vasculature:ui.x("0004537"),brain:ui.x("0000955"),eye_left:ui.x("0004548"),eye_right:tv.x("54449"),fallopian_tube_left:ui.x("0001303"),fallopian_tube_right:ui.x("0001302"),heart:ui.x("0000948"),kidney_left:ui.x("0004538"),kidney_right:ui.x("0004539"),knee_left:tv.x("24978"),knee_right:tv.x("24977"),large_intestine:ui.x("0000059"),liver:ui.x("0002107"),lungs:ui.x("0002048"),mesenteric_lymph_node:ui.x("0002509"),ovary_left:tv.x("7214"),ovary_right:tv.x("7213"),pancreas:ui.x("0001264"),pelvis:ui.x("0001270"),prostate_gland:ui.x("0002367"),skin:ui.x("0002097"),small_intestine:ui.x("0002108"),spleen:ui.x("0002106"),thymus:ui.x("0002370"),ureter_left:ui.x("0001223"),ureter_right:ui.x("0001222"),urinary_bladder:ui.x("0001255"),uterus:ui.x("0000995")});function HF(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}HF(md.spatialObjectReference),HF(md.spatialEntity),HF(md.spatialPlacement),new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]);const Gm=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Pr=(Math,Math,{});function hPe(n,{precision:e=Pr.precision||4}={}){return n=function(n){return Math.round(n/Pr.EPSILON)*Pr.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function Ah(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function iv(n,e,t){const i=Pr.EPSILON;t&&(Pr.EPSILON=t);try{if(n===e)return!0;if(Ah(n)&&Ah(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!iv(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Pr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Pr.EPSILON=i}}function wc(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}Pr.EPSILON=1e-12,Pr.debug=!1,Pr.precision=4,Pr.printTypes=!1,Pr.printDegrees=!1,Pr.printRowMajor=!0;class $F extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return wc(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:Ah(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Pr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+hPe(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!iv(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Pr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function uo(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function uq(n,e,t=""){if(Pr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}const dq={};function WF(n,e){dq[n]||(dq[n]=!0,console.warn("".concat(n," has been removed in version ").concat(e,", see upgrade guide for more information")))}class vPe extends $F{get ELEMENTS(){return wc(!1),0}copy(e){return wc(!1),this}get x(){return this[0]}set x(e){this[0]=uo(e)}get y(){return this[1]}set y(e){this[1]=uo(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return uo(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return uo(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return wc(e>=0&&e<this.ELEMENTS,"index is out of range"),uo(this[e])}setComponent(e,t){return wc(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const qF=[0,0,0],hq={};class Pn extends vPe{static get ZERO(){return hq.ZERO=hq.ZERO||Object.freeze(new Pn(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&Ah(e)?this.copy(e):(Pr.debug&&(uo(e),uo(t),uo(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Pr.debug&&(uo(e.x),uo(e.y),uo(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=uo(e)}angle(e){return PV(this,e)}cross(e){return O0(this,this,e),this.check()}rotateX({radians:e,origin:t=qF}){return OV(this,this,t,e),this.check()}rotateY({radians:e,origin:t=qF}){return RV(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=qF}){return NV(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return xI(this,this,e),this.check()}transformAsVector(e){return function(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o}(this,this,e),this.check()}transformByMatrix3(e){return CS(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return IV(this,this,e),this.check()}}new Pn,new Pn;const rv=new Pn,gq=new Pn;class YF{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new Pn,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=rv.from(t),this.center=(new Pn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new YF(this.center,this.radius)}union(e){const t=this.center,i=this.radius,s=e.radius,o=rv.copy(e.center).subtract(t),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const l=.5*(i+a+s);return gq.copy(o).scale((-i+l)/a).add(t),this.center.copy(gq),this.radius=l,this}expand(e){const t=(e=rv.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(n,e){var s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(e[0],e[1],e[2]),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,c,u),n}(rv,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=(e=rv.from(e)).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const i=this.radius,s=e.normal.dot(this.center)+e.distance;return s<-i?Gm.OUTSIDE:s<i?Gm.INTERSECTING:Gm.INSIDE}}class CPe extends $F{get ELEMENTS(){return wc(!1),0}get RANK(){return wc(!1),0}toString(){let e="[";if(Pr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=uo(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}const mq=Object.freeze([1,0,0,0,1,0,0,0,1]),APe=Object.freeze([0,0,0,0,0,0,0,0,0]),TPe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),$m={};class Xo extends CPe{static get IDENTITY(){return $m.IDENTITY=$m.IDENTITY||Object.freeze(new Xo(mq)),$m.IDENTITY}static get ZERO(){return $m.ZERO=$m.ZERO||Object.freeze(new Xo(APe)),$m.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return TPe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return f5(this)}identity(){return this.copy(mq)}fromQuaternion(e){return m5(this,e),this.check()}transpose(){return d5(this,this),this.check()}invert(){return h5(this,this),this.check()}multiplyLeft(e){return hx(this,e,this),this.check()}multiplyRight(e){return hx(this,this,e),this.check()}rotate(e){return g5(this,this,e),this.check()}scale(e){return Array.isArray(e)?fx(this,this,e):fx(this,this,[e,e,e]),this.check()}translate(e){return p5(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=$U(t||[-0,-0],e,this);break;case 3:t=CS(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return uq(t,e.length),t}transformVector(e,t){return WF("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return WF("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return WF("Matrix3.transformVector"),this.transform(e,t)}}const MPe=[0,0,0,1];class _q extends $F{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return _R(this,e),this.check()}identity(){return y5(this),this.check()}fromAxisRotation(e,t){return mR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=uo(e)}get y(){return this[1]}set y(e){this[1]=uo(e)}get z(){return this[2]}set z(e){this[2]=uo(e)}get w(){return this[3]}set w(e){this[3]=uo(e)}len(){return T5(this)}lengthSquared(){return M5(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return bR(this,e)}rotationTo(e,t){return I5(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return C5(this,this,e),this.check()}calculateW(){return E5(this,this),this.check()}conjugate(){return x5(this,this),this.check()}invert(){return S5(this,this),this.check()}lerp(e,t,i){return A5(this,e,t,i),this.check()}multiplyRight(e,t){return wc(!t),px(this,this,e),this.check()}multiplyLeft(e,t){return wc(!t),px(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return b5(this,this,e),this.check()}rotateY(e){return v5(this,this,e),this.check()}rotateZ(e){return w5(this,this,e),this.check()}scale(e){return yR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=MPe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return rb(this,e,t,i),this.check()}transformVector4(e,t=e){return jU(t,e,this),uq(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const DPe=new Pn,IPe=new Pn,m1=new Pn,_1=new Pn,y1=new Pn,OPe=new Pn,RPe=new Pn;class KF{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new Pn).from(e),this.halfAxes=new Xo(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Pn(e).len(),new Pn(t).len(),new Pn(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Pn(e).normalize(),s=new Pn(t).normalize(),o=new Pn(i).normalize();return(new _q).fromMatrix3(new Xo([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,t,i){const r=new _q(i),s=(new Xo).fromQuaternion(r);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=(new Pn).from(e),this.halfAxes=s,this}clone(){return new KF(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new YF){const t=this.halfAxes,i=t.getColumn(0,m1),r=t.getColumn(1,_1),s=t.getColumn(2,y1),o=DPe.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,l=Math.abs(s*r[0]+o*r[1]+a*r[2])+Math.abs(s*r[3]+o*r[4]+a*r[5])+Math.abs(s*r[6]+o*r[7]+a*r[8]),c=i.dot(t)+e.distance;return c<=-l?Gm.OUTSIDE:c>=l?Gm.INSIDE:Gm.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=IPe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,m1),s=i.getColumn(1,_1),o=i.getColumn(2,y1),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let h,u=0;return h=Math.abs(t.dot(r))-a,h>0&&(u+=h*h),h=Math.abs(t.dot(s))-l,h>0&&(u+=h*h),h=Math.abs(t.dot(o))-c,h>0&&(u+=h*h),u}computePlaneDistances(e,t,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,m1),c=a.getColumn(1,_1),u=a.getColumn(2,y1),h=OPe.copy(l).add(c).add(u).add(o),p=RPe.copy(h).subtract(e);let g=t.dot(p);return r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).add(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,m1);t.transformAsPoint(e);const i=this.halfAxes.getColumn(1,_1);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,y1);return r.transformAsPoint(e),this.halfAxes=new Xo([...t,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const yq=new Pn,bq=new Pn;class XF{constructor(e=[0,0,1],t=0){this.normal=new Pn,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return wc(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=yq.from(e),this.normal.from(t).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,r){return this.normal.set(e,t,i),wc(iv(this.normal.len(),1)),this.distance=r,this}clone(e){return new XF(this.normal,this.distance)}equals(e){return iv(this.distance,e.distance)&&iv(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=bq.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=yq.from(e);const i=this.getPointDistance(e),r=bq.copy(this.normal).scale(i);return e.subtract(r).to(t)}}function EFe(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[md.ontologyNode.label.id]:"label",[t]:"parent",[md.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of function*(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,En.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,ev.fromRdf)(s.object):s.object.id;yield[r,o]}}(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}new Pn([1,0,0]),new Pn([0,1,0]),new Pn([0,0,1]),new Pn,new Pn,new XF(new Pn(1,0,0),0),new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,Math,new Xo,new Xo,new Xo,new Xo,new Xo,new Pn,new Pn,new Pn,new Pn,new Pn,new Xo,new Xo,new Xo,(0,_r.memoize)(function(n){const e=function(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,En.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=EFe(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}(n,sq.body.id,"body",md.asctb.part_of.id);return e.nodes[sq.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0001987","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0002240","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e},()=>"");const w1={[co_label.id]:"label",[co_description.id]:"description",[co_link.id]:"link"};Object.assign(Object.assign({},w1),{[co_providerName.id]:"providerName"}),Object.assign(Object.assign({},w1),{[co_technology.id]:"technology",[co_thumbnail.id]:"thumbnail"}),Object.assign(Object.assign({},w1),{[co_sampleType.id]:"sampleType",[co_sectionNumber.id]:"sectionNumber",[co_datasets.id]:"datasets"}),Object.assign(Object.assign({},w1),{[co_sampleType.id]:"sampleType",[co_sectionCount.id]:"sectionCount",[co_sectionSize.id]:"sectionSize",[co_sectionUnits.id]:"sectionUnits",[co_donor.id]:"donor",[co_spatialEntity.id]:"spatialEntityId",[co_sections.id]:"sections",[co_datasets.id]:"datasets"});const Tq={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};function gu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let r2;function Ec(){return r2||(r2=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),gu(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),r2}function Mq(n,e=Ec()){return e("readonly",t=>gu(t.get(n)))}const E1="Unknown Euler angle order",qm=.99999;class tr extends xS{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return tr.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(e){return tr.RotationOrders[e]}get ELEMENTS(){return 4}constructor(e=0,t=0,i=0,r=tr.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,t,i,r)}fromQuaternion(e){const[t,i,r,s]=e,o=i*i,a=-2*(o+r*r)+1,l=2*(t*i+s*r);let c=-2*(t*r-s*i);c=c>1?1:c,c=c<-1?-1:c;const p=Math.atan2(2*(i*r+s*t),-2*(t*t+o)+1),g=Math.asin(c),m=Math.atan2(l,a);return new tr(p,g,m,tr.RollPitchYaw)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,t=0,i=0,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return function(n){return n>=0&&n<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}toArray4(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=ar(e)}get y(){return this[1]}set y(e){this[1]=ar(e)}get z(){return this[2]}set z(e){this[2]=ar(e)}get alpha(){return this[0]}set alpha(e){this[0]=ar(e)}get beta(){return this[1]}set beta(e){this[1]=ar(e)}get gamma(){return this[2]}set gamma(e){this[2]=ar(e)}get phi(){return this[0]}set phi(e){this[0]=ar(e)}get theta(){return this[1]}set theta(e){this[1]=ar(e)}get psi(){return this[2]}set psi(e){this[2]=ar(e)}get roll(){return this[0]}set roll(e){this[0]=ar(e)}get pitch(){return this[1]}set pitch(e){this[1]=ar(e)}get yaw(){return this[2]}set yaw(e){this[2]=ar(e)}get order(){return this[3]}set order(e){this[3]=function(n){if(n<0&&n>=6)throw new Error(E1);return n}(e)}fromVector3(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}fromArray(e,t=0){return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,t,i){return this.set(e,t,i,tr.ZYX)}fromRotationMatrix(e,t=tr.DefaultOrder){return this._fromRotationMatrix(e,t),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new vR;switch(this[4]){case tr.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case tr.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case tr.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case tr.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case tr.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case tr.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(E1)}}_fromRotationMatrix(e,t=tr.DefaultOrder){const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],p=i[10];switch(t=t||this[3]){case tr.XYZ:this[1]=Math.asin(ja(o,-1,1)),Math.abs(o)<qm?(this[0]=Math.atan2(-c,p),this[2]=Math.atan2(-s,r)):(this[0]=Math.atan2(h,l),this[2]=0);break;case tr.YXZ:this[0]=Math.asin(-ja(c,-1,1)),Math.abs(c)<qm?(this[1]=Math.atan2(o,p),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-u,r),this[2]=0);break;case tr.ZXY:this[0]=Math.asin(ja(h,-1,1)),Math.abs(h)<qm?(this[1]=Math.atan2(-u,p),this[2]=Math.atan2(-s,l)):(this[1]=0,this[2]=Math.atan2(a,r));break;case tr.ZYX:this[1]=Math.asin(-ja(u,-1,1)),Math.abs(u)<qm?(this[0]=Math.atan2(h,p),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-s,l));break;case tr.YZX:this[2]=Math.asin(ja(a,-1,1)),Math.abs(a)<qm?(this[0]=Math.atan2(-c,l),this[1]=Math.atan2(-u,r)):(this[0]=0,this[1]=Math.atan2(o,p));break;case tr.XZY:this[2]=Math.asin(-ja(s,-1,1)),Math.abs(s)<qm?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-c,p),this[1]=0);break;default:throw new Error(E1)}return this[3]=t,this}_getRotationMatrix(e){const t=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=this.x,r=this.y,s=this.z,o=Math.cos(i),a=Math.cos(r),l=Math.cos(s),c=Math.sin(i),u=Math.sin(r),h=Math.sin(s);switch(this[3]){case tr.XYZ:{const p=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=-a*h,t[8]=u,t[1]=g+m*u,t[5]=p-w*u,t[9]=-c*a,t[2]=w-p*u,t[6]=m+g*u,t[10]=o*a;break}case tr.YXZ:{const p=a*l,g=a*h,m=u*l,w=u*h;t[0]=p+w*c,t[4]=m*c-g,t[8]=o*u,t[1]=o*h,t[5]=o*l,t[9]=-c,t[2]=g*c-m,t[6]=w+p*c,t[10]=o*a;break}case tr.ZXY:{const p=a*l,g=a*h,m=u*l,w=u*h;t[0]=p-w*c,t[4]=-o*h,t[8]=m+g*c,t[1]=g+m*c,t[5]=o*l,t[9]=w-p*c,t[2]=-o*u,t[6]=c,t[10]=o*a;break}case tr.ZYX:{const p=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=m*u-g,t[8]=p*u+w,t[1]=a*h,t[5]=w*u+p,t[9]=g*u-m,t[2]=-u,t[6]=c*a,t[10]=o*a;break}case tr.YZX:{const p=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=w-p*h,t[8]=m*h+g,t[1]=h,t[5]=o*l,t[9]=-c*l,t[2]=-u*l,t[6]=g*h+m,t[10]=p-w*h;break}case tr.XZY:{const p=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=-h,t[8]=u*l,t[1]=p*h+w,t[5]=o*l,t[9]=g*h-m,t[2]=m*h-g,t[6]=c*l,t[10]=w*h+p;break}default:throw new Error(E1)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}toQuaternion(){const e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),s=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new vR(e*r*s-t*i*o,e*i*o+t*r*s,t*i*s-e*r*o,e*i*s+t*r*o)}}const Dq=Object.freeze([1,0,0,0,1,0,0,0,1]),LFe=Object.freeze([0,0,0,0,0,0,0,0,0]),BFe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Ym={};class av extends zU{static get IDENTITY(){return Ym.IDENTITY=Ym.IDENTITY||Object.freeze(new av(Dq)),Ym.IDENTITY}static get ZERO(){return Ym.ZERO=Ym.ZERO||Object.freeze(new av(LFe)),Ym.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return BFe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return f5(this)}identity(){return this.copy(Dq)}fromQuaternion(e){return m5(this,e),this.check()}transpose(){return d5(this,this),this.check()}invert(){return h5(this,this),this.check()}multiplyLeft(e){return hx(this,e,this),this.check()}multiplyRight(e){return hx(this,this,e),this.check()}rotate(e){return g5(this,this,e),this.check()}scale(e){return Array.isArray(e)?fx(this,this,e):fx(this,this,[e,e,e]),this.check()}translate(e){return p5(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=$U(t||[-0,-0],e,this);break;case 3:t=CS(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return I0(t,e.length),t}transformVector(e,t){return Hg("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return Hg("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return Hg("Matrix3.transformVector"),this.transform(e,t)}}var S1,jFe=new Uint8Array(16);function VFe(){if(!S1&&!(S1="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return S1(jFe)}const UFe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,HFe=function(n){return"string"==typeof n&&UFe.test(n)};for(var ho=[],o2=0;o2<256;++o2)ho.push((o2+256).toString(16).substr(1));const qFe=function(n,e,t){var i=(n=n||{}).random||(n.rng||VFe)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(ho[n[e+0]]+ho[n[e+1]]+ho[n[e+2]]+ho[n[e+3]]+"-"+ho[n[e+4]]+ho[n[e+5]]+"-"+ho[n[e+6]]+ho[n[e+7]]+"-"+ho[n[e+8]]+ho[n[e+9]]+"-"+ho[n[e+10]]+ho[n[e+11]]+ho[n[e+12]]+ho[n[e+13]]+ho[n[e+14]]+ho[n[e+15]]).toLowerCase();if(!HFe(t))throw TypeError("Stringified UUID is invalid");return t}(i)};function*a2(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,En.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,ev.fromRdf)(s.object):s.object.id;yield[r,o]}}function dp(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,En.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,ev.fromRdf)(a.object):a.object.id;r[o]=l}return r}const Pi=En.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},En.DataFactory),Iq={x:Pi("rdf"),type:Pi("rdf")("type")},Km={x:Pi("rdfs"),label:Pi("rdfs")("label"),comment:Pi("rdfs")("comment"),isDefinedBy:Pi("rdfs")("isDefinedBy"),seeAlso:Pi("rdfs")("seeAlso")},yi={x:Pi("entity"),id:Pi("entity")("id"),label:Km.label,description:Km.comment,link:Km.seeAlso,sex:Pi("entity")("sex"),age:Pi("entity")("age"),bmi:Pi("entity")("bmi"),Male:En.DataFactory.literal("Male"),Female:En.DataFactory.literal("Female"),consortiumName:Pi("entity")("consortium_name"),providerName:Pi("entity")("provider_name"),providerUUID:Pi("entity")("provider_uuid"),donor:Pi("entity")("has_donor"),sections:Pi("entity")("has_tissue_section"),datasets:Pi("entity")("has_dataset"),sampleType:Pi("entity")("sample_type"),TissueBlock:En.DataFactory.literal("Tissue Block"),TissueSection:En.DataFactory.literal("Tissue Section"),NonStandard:En.DataFactory.literal("Non-standard"),sectionCount:Pi("entity")("section_count"),sectionSize:Pi("entity")("section_size"),sectionUnits:Pi("entity")("section_units"),sectionNumber:Pi("entity")("section_number"),spatialEntity:Pi("entity")("has_spatial_entity"),ontologyTerms:Pi("entity")("has_ontology_term"),cellTypeTerms:Pi("entity")("has_cell_type_term"),technology:Pi("entity")("technology"),thumbnail:Pi("entity")("has_thumbnail")},Tn=Pi("ccf"),Li={x:Tn,ontologyNode:{label:Tn("ccf_preferred_label"),parent:Tn("ccf_part_of"),children:Tn("ccf_part_of"),rui_rank:Tn("ccf_rui_rank"),synonymLabels:En.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:Tn("ccf_part_of"),ct_is_a:Tn("ct_is_a"),located_in:Tn("located_in"),characterizes:Tn("characterizes")},spatial:{Female:Tn("VHFemale"),Male:Tn("VHMale"),BothSexes:Tn("VHBothSexes"),FemaleOrgans:Tn("VHFemaleOrgans"),MaleOrgans:Tn("VHMaleOrgans")},SpatialObjectReference:Tn("SpatialObjectReference"),SpatialEntity:Tn("SpatialEntity"),SpatialPlacement:Tn("SpatialPlacement"),spatialObjectReference:{file:Tn("has_object_file"),file_format:Tn("has_object_file_format"),file_subpath:Tn("has_object_file_subpath")},extractionSet:{label:Km.label,rui_rank:Tn("ccf_rui_rank")},spatialEntity:{label:Km.label,comment:Km.comment,creator:Pi("dc")("creator"),creator_first_name:Tn("creator_first_name"),creator_last_name:Tn("creator_last_name"),creator_orcid:Tn("creator_orcid"),creation_date:Tn("creation_date"),updated_date:Tn("updated_date"),ccf_annotations:Tn("ccf_annotation"),representation_of:Tn("ccf_representation_of"),reference_organ:Tn("anatomical_structure_of"),extraction_set_for:Tn("extraction_set_for"),extraction_set:Tn("extraction_site_for"),sex:Tn("has_sex"),side:Tn("has_side"),rui_rank:Tn("ccf_rui_rank"),slice_thickness:Tn("ccf_slice_thickness"),slice_count:Tn("ccf_slice_count"),x_dimension:Tn("has_x_dimension"),y_dimension:Tn("has_y_dimension"),z_dimension:Tn("has_z_dimension"),dimension_units:Tn("has_dimension_units"),object:Tn("has_object_reference")},spatialPlacement:{source:Tn("has_placement_source"),target:Tn("has_placement_target"),placement_date:Tn("has_placement_date"),x_scaling:Tn("has_x_scaling"),y_scaling:Tn("has_y_scaling"),z_scaling:Tn("has_z_scaling"),scaling_units:Tn("has_scaling_units"),x_rotation:Tn("has_x_rotation"),y_rotation:Tn("has_y_rotation"),z_rotation:Tn("has_z_rotation"),w_rotation:Tn("has_theta_rotation"),rotation_order:Tn("has_rotation_order"),rotation_units:Tn("has_rotation_units"),x_translation:Tn("has_x_translation"),y_translation:Tn("has_y_translation"),z_translation:Tn("has_z_translation"),translation_units:Tn("has_translation_units")}},di={x:Pi("uberon"),body:Pi("uberon")("0013702")},KFe={x:Pi("cl"),cell:Pi("cl")("0000000")},lv={x:Pi("fma")},bd=(Pi("lmha"),{body:di.body,cell:KFe.cell,respiratory_system:di.x("0001004"),colon:di.x("0001155"),left_lung:di.x("0002168"),right_lung:di.x("0002167"),left_bronchus:di.x("0002178"),right_bronchus:di.x("0002177"),kidney:di.x("0002113"),ureter:di.x("0000056"),eye:di.x("0000970"),fallopian_tube:di.x("0003889"),knee:di.x("0001465"),ovary:di.x("0000992"),trachea:di.x("0003126"),aorta:di.x("0000947"),blood:di.x("0000178"),bone_marrow:di.x("0002371"),male_reproductive_system:di.x("0000079"),lymph_node:di.x("0000029"),blood_vasculature:di.x("0004537"),brain:di.x("0000955"),eye_left:di.x("0004548"),eye_right:lv.x("54449"),fallopian_tube_left:di.x("0001303"),fallopian_tube_right:di.x("0001302"),heart:di.x("0000948"),kidney_left:di.x("0004538"),kidney_right:di.x("0004539"),knee_left:lv.x("24978"),knee_right:lv.x("24977"),large_intestine:di.x("0000059"),liver:di.x("0002107"),lungs:di.x("0002048"),mesenteric_lymph_node:di.x("0002509"),ovary_left:lv.x("7214"),ovary_right:lv.x("7213"),pancreas:di.x("0001264"),pelvis:di.x("0001270"),prostate_gland:di.x("0002367"),skin:di.x("0002097"),small_intestine:di.x("0002108"),spleen:di.x("0002106"),thymus:di.x("0002370"),ureter_left:di.x("0001223"),ureter_right:di.x("0001222"),urinary_bladder:di.x("0001255"),uterus:di.x("0000995")});function l2(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const x1={spatialObjectReference:l2(Li.spatialObjectReference),spatialEntity:l2(Li.spatialEntity),spatialPlacement:l2(Li.spatialPlacement)};function Oq(n,e){const t=dp(n,e,"ExtractionSet",x1.spatialEntity);return t.extractionSites=(0,_r.sortBy)(n.getSubjects(Li.spatialEntity.extraction_set,e,null).map(i=>hp(n,i.id)),["rui_rank"]),t}function hp(n,e){const t=dp(n,e,"SpatialEntity",x1.spatialEntity);return t.object&&(t.object=function(n,e){return dp(n,e,"SpatialObjectReference",x1.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,Li.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,yi.spatialEntity,e,null),t}function e2e(n,e){const t=dp(n,e,"SpatialPlacement",x1.spatialPlacement);return t.source&&(t.source=hp(n,t.source)),t.target&&(t.target=hp(n,t.target)),t}function Rq(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(CV),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class Nq{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new WNe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},Iq.type,Li.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},Iq.type,Li.SpatialEntity,null);const t={};for(const i of(0,En.readQuads)(e,null,Li.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,En.readQuads)(e,null,Li.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new qn(qn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new qn(qn.IDENTITY),s=YNe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&Rq(r,e2e(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}getSpatialPlacement(e,t){const i=this.graph.hasNode(e["@id"])?e["@id"]:void 0,r=(0,_r.get)(e,"placement[0]",(0,_r.get)(e,"placement",void 0));let s;if(r&&this.graph.hasNode(r.target)?(s=this.getTransformationMatrix(r.target,t),s&&(s=Rq(s,r))):i&&(s=this.getTransformationMatrix(i,t)),s){const o=(new tr).fromRotationMatrix(s,tr.XYZ),a=s.getTranslation().map(u=>1e3*u),l=o.toVector3().map(Ise),c=s.getScale().map(u=>u<1&&u>.999999?1:u);return{"@context":"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld","@id":`http://purl.org/ccf/1.5/${qFe()}_placement`,"@type":"SpatialPlacement",source:e["@id"],target:t,placement_date:(new Date).toISOString().split("T")[0],x_scaling:c[0],y_scaling:c[1],z_scaling:c[2],scaling_units:"ratio",x_rotation:l[0],y_rotation:l[1],z_rotation:l[2],rotation_order:"XYZ",rotation_units:"degree",x_translation:a[0],y_translation:a[1],z_translation:a[2],translation_units:"millimeter"}}}}class Pq{constructor(e){this.db=e}getSpatialEntity(e){return hp(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,_r.sortBy)(n.getSubjects(Li.spatialEntity.extraction_set_for,e,null).map(t=>Oq(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return Oq(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,_r.sortBy)(n.getSubjects(Li.spatialEntity.reference_organ,e,null).map(t=>hp(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(hp(n,t.subject.id))},null,Li.spatialEntity.reference_organ,null,null),(0,_r.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=Li.spatial.Male.id;break;case"Female":t=Li.spatial.Female.id;break;case"Both":default:t=Li.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(Li.x("VHRightKidney").id),t,{color:[0,0,255,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Li.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Li.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Li.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Li.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],geometry:"wireframe"})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=void 0!==(null==t?void 0:t.sex)&&"both"!==(null===(i=null==t?void 0:t.sex)||void 0===i?void 0:i.toLowerCase()),o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),u=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(h=>this.getSceneNode(h,a,{color:[255,255,255,229.5]}));return[c].concat(u).filter(h=>void 0!==h)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(l)u=new qn(qn.IDENTITY).rotateX(CV(90)).multiplyLeft(u);else{let h;switch(e.dimension_units){case"centimeter":h=.01;break;case"millimeter":h=.001;break;case"meter":default:h=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*h/2);u.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:u,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const C1="https://entity.api.hubmapconsortium.org/entities/",Fq=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),n2e={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},Xm={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},kq={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class s2e{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],u=(this.data.ancestors||[]).find(Be=>"Donor"===Be.entity_type);this.donor=this.getDonor(u,i);const h=this.getRuiLocation(e,this.donor);h?this.rui_location=h:this.bad=!0,Xm[e.group_uuid]||(Xm[e.group_uuid]=e.group_name);const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=Xm[e.group_uuid]||e.group_name,m=e.created_by_user_displayname;this["@id"]=C1+e.uuid,this.label=`Registered ${p}, ${m}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const w={},C=[];this.sections=C;const H=[];this.datasets=H;for(const Be of c.filter(et=>"Sample"===et.entity_type)){const et=this.getSection(Be,e,i);w[Be.submission_id]=et,C.push(et),et.section_number=null!==(s=et.section_number)&&void 0!==s?s:C.length}for(const Be of c)if("Dataset"===Be.entity_type){const et=this.getDataset(Be,t,i,r),wt=(0,_r.get)(Be,["ingest_metadata","metadata","tissue_id"]);w[wt]?null===(o=w[wt].datasets)||void 0===o||o.push(et):H.push(et)}const U=null!=h?h:{},de=`${U.x_dimension} x ${U.y_dimension} x ${U.z_dimension} ${U.dimension_units}`;this.section_count=U.slice_count||C.length;const Ae=parseFloat((U.slice_thickness||(U.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Ae;const Pe=U.dimension_units||"millimeter";this.section_units=Pe,this.description=`${de}, ${Ae} ${Pe}, ${e.specimen_type}, ${this.section_count} Sections`,C.forEach((Be,et)=>{Be.description=`${U.x_dimension} x ${U.y_dimension} x ${Ae} ${Pe}, ${Ae} ${Pe}, ${Be.description}`,Be.section_number=et+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":C1+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${Xm[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=Xm[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,_r.get)(e,["ingest_metadata","metadata","assay_type"],"")],u=c.join("|").toLowerCase();let h,p="assets/icons/ico-unknown.svg";return-1!==u.indexOf("10x")?(h="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==u.indexOf("af")?(h="AF",p="assets/icons/ico-spatial-af.svg"):-1!==u.indexOf("codex")?(h="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==u.indexOf("imc")?(h="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==u.indexOf("lc")&&-1===u.indexOf("af")?(h="LC",p="assets/icons/ico-bulk-lc.svg"):h=-1!==u.indexOf("maldi")?"MALDI":-1!==u.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":C1+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:h,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,_r.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>Fq.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(Fq.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=n2e[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,_r.toNumber)(s[1]));for(const p of(0,_r.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,_r.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,_r.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),u=Xm[e.group_uuid]||e.group_name;return{"@id":C1+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${u}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:u,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;let r,s=e.rui_location;if(s&&("string"==typeof s&&(s=JSON.parse(s)),s.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):s["@id"]&&(r=s)),r){const o=null!==(i=(0,_r.get)(r,["placement","target"]))&&void 0!==i?i:"";o.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")?(0,_r.set)(r,["placement","target"],o.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")):("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===o||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===o)&&(0,_r.set)(r,["placement","target"],"Male"===t.sex?o.replace("#VH","#VHM")+"_Patch":o.replace("#VH","#VHF")+"_Patch")}return r}getTissueBlock(){return(0,_r.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const a2e=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],l2e={exists:{field:"rui_location"}};function Lq(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:l2e,_source:{includes:a2e}})}function c2(n,e){return ki(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function Bq(n,e,t,i,r="",s=""){return ki(this,void 0,void 0,function*(){let o;if("static"===e?o=yield c2(n):"search-api"===e&&(o=yield function(n,e,t){return ki(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=Lq(0,50,t),o=yield c2(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let h=50;h<a;h+=50)l.push(c2(n,{method:"POST",headers:r,body:Lq(h,50,t)}));const c=yield Promise.all(l);if(c.some(h=>!h))return;const u=c.map(h=>h.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...u)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,_r.get)(n,"hits.hits",[]).map(c=>(0,_r.get)(c,"_source",{})).map(c=>new s2e(c,e,t,i).toJsonLd());for(const c of a){const u=c["@id"];o[u]?o[u].samples.push(c.samples[0]):o[u]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":kq},c)))),{"@context":kq,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function cv(n,e,t){const i=new Set;for(const r of e)for(const s of(0,En.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}const p2e={[Li.spatialEntity.x_dimension.id]:"x",[Li.spatialEntity.y_dimension.id]:"y",[Li.spatialEntity.z_dimension.id]:"z"};function m2e(n,e,t,i){const r=e.getTransformationMatrix(t,i);let s;if(r){const o=function(n,e){const t=dp(n,e,"Dimensions",p2e);return[t.x,t.y,t.z]}(n,t),a=r.getTranslation(),l=(new tr).fromRotationMatrix(r,tr.XYZ),c=new av(av.IDENTITY).fromQuaternion(l.toQuaternion()).scale(o.map(u=>u/1e3/1e3));s=new KF(a,c)}return s}function _2e(n,e,t,i){const{x:r,y:s,z:o,radius:a,target:l}=i,c=new Set,u=a/1e3*(a/1e3);for(const h of t){const p=m2e(n,e,h,l);p&&p.distanceSquaredTo([r,s,o].map(m=>m/1e3))<u&&c.add(h)}return c}function A1(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,En.readQuads)(n,c,yi.donor,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function u2(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,En.readQuads)(n,c,yi.spatialEntity,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function uv(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function jq(n,e,t){const i=new Set;for(const r of t){const s=En.DataFactory.namedNode(r);n.forSubjects(uv(e,i),Li.spatialEntity.ccf_annotations,s,null)}return i}function Vq(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,En.readQuads)(e,i,yi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,En.readQuads)(e,r,Li.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function R2e(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[Li.ontologyNode.label.id]:"label",[t]:"parent",[Li.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of a2(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function Uq(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,En.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=R2e(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}const zq=(0,_r.memoize)(function(n){const e=Uq(n,bd.body.id,"body",Li.asctb.part_of.id);return e.nodes[bd.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0001987","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0002240","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e},()=>""),T1={[yi.label.id]:"label",[yi.description.id]:"description",[yi.link.id]:"link"},F2e=Object.assign(Object.assign({},T1),{[yi.providerName.id]:"providerName"}),k2e=Object.assign(Object.assign({},T1),{[yi.technology.id]:"technology",[yi.thumbnail.id]:"thumbnail"}),L2e=Object.assign(Object.assign({},T1),{[yi.sampleType.id]:"sampleType",[yi.sectionNumber.id]:"sectionNumber",[yi.datasets.id]:"datasets"}),B2e=Object.assign(Object.assign({},T1),{[yi.sampleType.id]:"sampleType",[yi.sectionCount.id]:"sectionCount",[yi.sectionSize.id]:"sectionSize",[yi.sectionUnits.id]:"sectionUnits",[yi.donor.id]:"donor",[yi.spatialEntity.id]:"spatialEntityId",[yi.sections.id]:"sections",[yi.datasets.id]:"datasets"});function j2e(n,e){return dp(n,e,"Donor",F2e)}function Hq(n,e){return dp(n,e,"Dataset",k2e)}function V2e(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of a2(n,e,L2e))if("datasets"===i){const s=Hq(n,r);t[i].push(s)}else t[i]=r;return t}class z2e{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>ki(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const G2e={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class $2e{constructor(e=G2e){this.options=e,this.store=new En.Store(void 0,{factory:En.DataFactory}),this.graph=new Nq(this),this.scene=new Pq(this)}connect(e,t=!1){return ki(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return ki(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield Mq(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=Ec()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),gu(t.transaction)))}([i,t]).catch(()=>{}):s=yield Mq(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=Ec()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),gu(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return ki(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,En.deserializeN3Store)(s,En.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,En.deserializeN3Store)(o,En.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(Bq(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return ki(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>ki(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,En.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,En.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,En.addRdfXmlToStore)(r,i):yield(0,En.addJsonLdToStore)(r,i):yield(0,En.addJsonLdToStore)(r,i)}))),this})}synchronize(){return ki(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),function(n){var e,t,i;const r=zq(n),s=new Map;for(const{subject:o,object:a}of(0,En.readQuads)(n,null,Li.spatialEntity.representation_of,null,null)){const l=new Set([a.id]);let c=null===(e=r.nodes[a.id])||void 0===e?void 0:e.parent;for(;c&&!l.has(c);)l.add(c),c=null===(t=r.nodes[c])||void 0===t?void 0:t.parent;s.set(o.id,[...l].map(u=>En.DataFactory.namedNode(u)))}for(const{object:o}of(0,En.readQuads)(n,null,yi.spatialEntity,null,null))for(const{subject:a}of(0,En.readQuads)(n,null,Li.spatialPlacement.source,o,null))for(const{object:l}of(0,En.readQuads)(n,a,Li.spatialPlacement.target,null,null))for(const c of null!==(i=s.get(l.id))&&void 0!==i?i:[])n.addQuad(En.DataFactory.namedNode(o.id),Li.spatialEntity.ccf_annotations,c)}(this.store),this})}serialize(){return(0,En.serializeN3Store)(this.store)}deserialize(e){return ki(this,void 0,void 0,function*(){this.store=(0,En.deserializeN3Store)(e,En.DataFactory),this.graph=new Nq(this),this.scene=new Pq(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e,t){var i,r,s,o,a,l,c;let u=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),yi.spatialEntity,null,null),e}(n);if(u.size>0&&(u=function(n,e,t=!0){const i=new Set;if(n.forSubjects(uv(e,i),yi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,u)),u.size>0&&("Male"===t.sex||"Female"===t.sex)){const h=t.sex;u=A1(n,u,p=>function(n,e,t){const i=new Set;return n.forSubjects(uv(e,i),yi.sex,yi[t],null),i}(n,p,h))}if(u.size>0&&(null===(i=t.tmc)||void 0===i?void 0:i.length)>0&&(u=A1(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=En.DataFactory.literal(r);n.forSubjects(uv(e,i),yi.providerName,s,null)}return i}(n,h,t.tmc))),u.size>0&&(null===(r=t.technologies)||void 0===r?void 0:r.length)>0&&(u=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const u of e)for(const h of(0,En.readQuads)(n,u,yi.sections,null,null))a.add(h.object.id);for(const u of a)for(const h of(0,En.readQuads)(n,u,yi.datasets,null,null))o.add(h.object.id),s.has(h.object.id)?null===(i=s.get(h.object.id))||void 0===i||i.push(u):s.set(h.object.id,[u]);const l=t(o),c=new Set;for(const u of l)for(const h of null!==(r=s.get(u))&&void 0!==r?r:[])c.add(h);return c}(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=En.DataFactory.literal(r);n.forSubjects(uv(e,i),yi.technology,s,null)}return i}(n,h,t.technologies))),u.size>0&&(null===(s=t.spatialSearches)||void 0===s?void 0:s.length)>0&&(u=u2(n,u,h=>function(n,e,t,i){const r=new Set;for(const s of i)_2e(n,e,t,s).forEach(a=>r.add(a));return r}(n,e,h,t.spatialSearches))),u.size>0&&(null===(o=t.ontologyTerms)||void 0===o?void 0:o.length)>0){const h=t.ontologyTerms;-1===h.indexOf(bd.body.id)&&(u=u2(n,u,p=>jq(n,p,h)))}if(u.size>0&&(null===(a=t.cellTypeTerms)||void 0===a?void 0:a.length)>0){const h=t.cellTypeTerms;-1===h.indexOf(bd.cell.id)&&(u=u2(n,u,p=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,Li.asctb.located_in,null),r===bd.cell.id&&i.add(bd.body.id);return jq(n,e,[...i])}(n,p,h)))}if(u.size>0&&2===(null===(l=t.ageRange)||void 0===l?void 0:l.length)&&(0,_r.isFinite)(t.ageRange[0])&&(0,_r.isFinite)(t.ageRange[1])){const h=Math.max(...t.ageRange),p=Math.min(...t.ageRange);1===p&&110===h||(u=A1(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,En.readQuads)(n,s,yi.age,null,null)){const a=(0,ev.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,p,h)))}if(u.size>0&&2===(null===(c=t.bmiRange)||void 0===c?void 0:c.length)&&(0,_r.isFinite)(t.bmiRange[0])&&(0,_r.isFinite)(t.bmiRange[1])){const h=Math.max(...t.bmiRange),p=Math.min(...t.bmiRange);13===p&&83===h||(u=A1(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,En.readQuads)(n,s,yi.bmi,null,null)){const a=(0,ev.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,p,h)))}return u}(this.store,this.graph,e)}get(e){return this.store.getQuads(En.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(En.DataFactory.namedNode(e),yi.spatialEntity,null);if(t.length>0)return hp(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return ki(this,void 0,void 0,function*(){return this.status||(this.status=new z2e(this)),this.status.toJson()})}getDatasetTechnologyNames(){return ki(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,En.readQuads)(n,null,yi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return ki(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,En.readQuads)(n,null,yi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return ki(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of a2(n,e,B2e))if("sections"===i){const s=V2e(n,r);t[i].push(s)}else if("datasets"===i){const s=Hq(n,r);t[i].push(s)}else t[i]="donor"===i?j2e(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return ki(this,void 0,void 0,function*(){return function(n,e){const t=cv(e,n,yi.donor.id),i=cv(e,t,yi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,En.readQuads)(e,l,yi.spatialEntity,null,null))r.add(c.subject.id);const s=cv(e,r,yi.sections.id),o=new Set([...cv(e,r,yi.datasets.id),...cv(e,s,yi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return ki(this,void 0,void 0,function*(){return function(n,e){const t={};return Vq(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return ki(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=Vq(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,En.readQuads)(e,null,Li.asctb.located_in,a,null)){const u=c.subject.id;if(s.has(u)){const h=s.get(u);l.forEach(p=>h.add(p))}else s.set(u,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[bd.cell.id]=null!==(i=null===(t=r.get(bd.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return ki(this,void 0,void 0,function*(){return zq(this.store)})}getCellTypeTreeModel(){return ki(this,void 0,void 0,function*(){return function(n){return Uq(n,bd.cell.id,"cell",Li.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return ki(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return ki(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return ki(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}getSpatialPlacement(e,t){return ki(this,void 0,void 0,function*(){return this.graph.getSpatialPlacement(e,t)})}}function K2e(n,e){return n===e}let X2e=(()=>{class n{constructor(t,i){this.locator=t,this.globalConfig=i,this.subscriptions=new x,this.dataSource=i.getOption("data").pipe(me(r=>Object.assign(Object.assign({},Tq),{dataSources:r})),Ji(r=>Object.keys(r).length>0),me(r=>r),rd(K2e),Ir(r=>function(n,e){return new I(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?je(r):qc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDataSource(),s=>this.connectDataSource(s.source,r))),Ga(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(t){return this.dataSource.pipe(Ir(i=>i.getTissueBlockResults(t)),Yi(1))}getAggregateResults(t){return this.dataSource.pipe(Ir(i=>i.getAggregateResults(t)),Yi(1))}getOntologyTermOccurences(t){return this.dataSource.pipe(Ir(i=>i.getOntologyTermOccurences(t)),Yi(1))}getCellTypeTermOccurences(t){return this.dataSource.pipe(Ir(i=>i.getCellTypeTermOccurences(t)),Yi(1))}getOntologyTreeModel(){return this.dataSource.pipe(Ir(t=>t.getOntologyTreeModel()),Yi(1))}getCellTypeTreeModel(){return this.dataSource.pipe(Ir(t=>t.getCellTypeTreeModel()),Yi(1))}getReferenceOrgans(){return this.dataSource.pipe(Ir(t=>t.getReferenceOrgans()),Yi(1))}getScene(t){return this.dataSource.pipe(Ir(i=>i.getScene(t)),Yi(1))}getOrganScene(t,i){return this.dataSource.pipe(Ir(r=>r.getReferenceOrganScene(t,i)),Yi(1))}createDataSource(){return{source:new $2e,unsubscribe:()=>{}}}connectDataSource(t,i){return ki(this,void 0,void 0,function*(){const r=(new Date).getTime();return yield t.connect(i,!1),v0.production||(console.info(`Loaded CCF database in ${((new Date).getTime()-r)/1e3}s`),console.log(t)),t})}}return n.\u0275fac=function(t){return new(t||n)(Oe(Cf),Oe(Jb))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Q2e=(()=>{class n{constructor(t,i){this.configState=t,this.source=i,this.data$=this.configState.getOption("data"),this.zoomToID$=this.configState.getOption("zoomToID").pipe(me(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.highlightID$=this.configState.getOption("highlightID").pipe(me(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.referenceOrgans$=this.source.getReferenceOrgans(),this.scene$=Yo([this.data$,this.referenceOrgans$,this.source.dataSource]).pipe(Ir(([r,s,o])=>this.chooseScene(r,s))),this.organs$=this.configState.getOption("data").pipe(me(r=>this.selectOrgans(r)),Ga(1)),this.filteredOrgans$=Yo([this.organs$,this.referenceOrgans$]).pipe(me(([r,s])=>this.getNeededReferenceOrgans(s,r)),Ga(1)),this.filteredScene$=Yo([this.scene$,this.organs$,this.referenceOrgans$]).pipe(me(([r,s,o])=>this.filterSceneNodes(r,s,o)),function(n,e){const t=n.pipe(ao(""));return i=>Yo([i,t]).pipe(me(([r,s])=>r.map(o=>function(n,e,t){return n.entityId!==e?n:Object.assign(Object.assign({},n),{color:t})}(o,s,e))))}(this.highlightID$,UNe),function(n){const e=n.pipe(ao(""));return t=>Yo([t,e]).pipe(me(([i,r])=>i.map(s=>function(n,e){return n.entityId!==e?n:Object.assign(Object.assign({},n),{zoomToOnLoad:!0})}(s,r))))}(this.zoomToID$),Ga(1))}chooseScene(t,i){var r;const s=null!==(r=null==t?void 0:t.map(a=>{const l=a[rq];return null==l?void 0:l.placement.target}))&&void 0!==r?r:[];if(new Set(s).size>1)return this.source.getScene();if(i){const a=i.find(l=>l["@id"]===s[0]);if(a)return this.source.getOrganScene(a.representation_of,{ontologyTerms:[a.reference_organ],sex:a.sex})}return dn([])}selectOrgans(t){const r=(null!=t?t:[]).map(s=>s[rq].placement.target);return new Set(r)}filterSceneNodes(t,i,r){const s=this.getNeededReferenceOrgans(r,i),o=this.getNeededSkins(s),a=new Set([...i,...o]);return t.filter(c=>!c.reference_organ||a.has(c.reference_organ))}getNeededReferenceOrgans(t,i){return t.filter(r=>{var s;return i.has(null!==(s=r.reference_organ)&&void 0!==s?s:"")})}getNeededSkins(t){if(1===t.length)return[];const i=new Set;return t.forEach(r=>{"Female"===r.sex?i.add("http://purl.org/ccf/latest/ccf.owl#VHFSkin"):"Male"===r.sex&&i.add("http://purl.org/ccf/latest/ccf.owl#VHMSkin")}),[...i]}}return n.\u0275fac=function(t){return new(t||n)(Oe(Jb),Oe(X2e))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Z2e=["bodyUI"];let J2e=(()=>{class n{constructor(t,i,r){this.configState=t,this.sceneSource=i,this.cdr=r,this.onMouseEnter=new sn,this.onMouseLeave=new sn,this.onClick=new sn,this.data$=this.configState.getOption("data"),this.organs$=this.sceneSource.filteredOrgans$,this.scene$=this.sceneSource.filteredScene$.pipe(qr(s=>this.reset()))}reset(){var t,i;return ki(this,void 0,void 0,function*(){const{bodyUI:r}=this;yield new Promise(a=>setTimeout(a,200));const s=yield this.organs$.pipe(Yi(1)).toPromise(),o=null!==(i=!!(null===(t=r.scene)||void 0===t?void 0:t.find(a=>a.zoomToOnLoad)))&&void 0!==i&&i;if(r.rotation=0,r.rotationX=0,!o)if(1===s.length){const{x_dimension:a,y_dimension:l,z_dimension:c}=s[0];r.bounds={x:1.25*a/1e3,y:1.25*l/1e3,z:1.25*c/1e3},r.target=[a/1e3/2,l/1e3/2,c/1e3/2]}else r.bounds={x:2.2,y:2,z:.4},r.target=[0,0,0];this.cdr.detectChanges()})}}return n.\u0275fac=function(t){return new(t||n)(xe(Jb),xe(Q2e),xe(Dr))},n.\u0275cmp=cn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&rs(Z2e,7),2&t){let r;ii(r=ri())&&(i.bodyUI=r.first)}},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},decls:3,vars:4,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","nodeHoverStart","nodeHoverStop"],["bodyUI",""]],template:function(t,i){1&t&&(kt(0,"ccf-body-ui",0,1),Un("nodeClick",function(s){return i.onClick.emit(s)})("nodeHoverStart",function(s){return i.onMouseEnter.emit(s)})("nodeHoverStop",function(s){return i.onMouseLeave.emit(s)}),ju(2,"async"),Lt()),2&t&&rn("scene",Vu(2,2,i.scene$))("interactive",!0)},directives:[sNe],pipes:[m0],styles:[".body-ui[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),n})();function eke(n,e){if(1&n){const t=jt();kt(0,"ccf-root",1),Un("onMouseEnter",function(r){return Cr(t),ci().onMouseEnter.emit(r)})("onMouseLeave",function(r){return Cr(t),ci().onMouseLeave.emit(r)})("onClick",function(r){return Cr(t),ci().onClick.emit(r)}),Lt()}}function tke(n){return n.map(e=>({"@id":`http://purl.org/ccf/1.5/entity/${e.id}`,"@type":"http://purl.org/ccf/latest/ccf-entity.owl#Sample","http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity":e.rui_location}))}let nke=(()=>{class n extends Rie{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},v0.dbOptions),globalThis.dbOptions),parse:{data:tke}}),this.onMouseEnter=new sn,this.onMouseLeave=new sn,this.onClick=new sn}}return n.\u0275fac=function(t){return new(t||n)(xe(Jb),xe(Dr))},n.\u0275cmp=cn({type:n,selectors:[["ccf-root-wc"]],inputs:{data:"data",highlightID:"highlightID",zoomToID:"zoomToID"},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},features:[xn],decls:1,vars:1,consts:[[3,"onMouseEnter","onMouseLeave","onClick",4,"ngIf"],[3,"onMouseEnter","onMouseLeave","onClick"]],template:function(t,i){1&t&&Di(0,eke,1,0,"ccf-root",0),2&t&&rn("ngIf",i.initialized)},directives:[ac,J2e],encapsulation:2,changeDetection:0}),n})(),ike=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[ps,Qa,wW,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Oe(ps,2),Oe(Qa,2))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();const O1=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class oke{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=$f(this.action),i=function(n){return O1(n.getHours(),2)+":"+O1(n.getMinutes(),2)+":"+O1(n.getSeconds(),2)+"."+O1(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class ake{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const Gq=new Ht("NGXS_LOGGER_PLUGIN_OPTIONS");let lke=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new ake(this._options),this._store=this._store||this._injector.get(lu);const s=new oke(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(qr(o=>{s.completed(o)}),yc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Oe(Gq),Oe(Wn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const $q=new Ht("LOGGER_USER_OPTIONS");function cke(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let uke=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:E6,useClass:lke,multi:!0},{provide:$q,useValue:t},{provide:Gq,useFactory:cke,deps:[$q]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({}),n})();const dke=[Jb];let hke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({imports:[[ike.forRoot(),Wo.forRoot(dke,{developmentMode:!v0.production}),uke.forRoot({disabled:v0.production})]]}),n})(),fke=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(bl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new Aie(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends Mie{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,u){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(nke,{injector:this.injector});customElements.define("ccf-body-ui-wc",t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(Wn))},n.\u0275mod=an({type:n}),n.\u0275inj=Ct({providers:[],imports:[[JD,hke,oNe]]}),n})();v0.production&&function(){if(hB)throw new Error("Cannot enable prod mode after platform setup.");dB=!1}(),Kne().bootstrapModule(fke).catch(n=>console.error(n))},52:Ut=>{function it(yt,ee,Tt,dt,Y,Se,he){try{var W=yt[Se](he),j=W.value}catch(P){return void Tt(P)}W.done?ee(j):Promise.resolve(j).then(dt,Y)}Ut.exports=function(yt){return function(){var ee=this,Tt=arguments;return new Promise(function(dt,Y){var Se=yt.apply(ee,Tt);function he(j){it(Se,dt,Y,he,W,"next",j)}function W(j){it(Se,dt,Y,he,W,"throw",j)}he(void 0)})}},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},948:Ut=>{Ut.exports=function(Je){return Je&&Je.__esModule?Je:{default:Je}},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},321:Ut=>{function it(Je){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Ut.exports=it=function(ee){return typeof ee},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0):(Ut.exports=it=function(ee){return ee&&"function"==typeof Symbol&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0),it(Je)}Ut.exports=it,Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},380:Ut=>{function it(Je){return Promise.resolve().then(()=>{var yt=new Error("Cannot find module '"+Je+"'");throw yt.code="MODULE_NOT_FOUND",yt})}it.keys=()=>[],it.resolve=it,it.id=380,Ut.exports=it},521:()=>{},125:()=>{},307:()=>{}},Ut=>{Ut(Ut.s=970)}]);