var JFe=Object.defineProperty,e2e=Object.defineProperties,t2e=Object.getOwnPropertyDescriptors,S1=Object.getOwnPropertySymbols,Oq=Object.prototype.hasOwnProperty,Rq=Object.prototype.propertyIsEnumerable,Er=Math.pow,Pq=(Ut,it,et)=>it in Ut?JFe(Ut,it,{enumerable:!0,configurable:!0,writable:!0,value:et}):Ut[it]=et,ot=(Ut,it)=>{for(var et in it||(it={}))Oq.call(it,et)&&Pq(Ut,et,it[et]);if(S1)for(var et of S1(it))Rq.call(it,et)&&Pq(Ut,et,it[et]);return Ut},Sn=(Ut,it)=>e2e(Ut,t2e(it)),Nq=(Ut,it)=>{var et={};for(var yt in Ut)Oq.call(Ut,yt)&&it.indexOf(yt)<0&&(et[yt]=Ut[yt]);if(null!=Ut&&S1)for(var yt of S1(Ut))it.indexOf(yt)<0&&Rq.call(Ut,yt)&&(et[yt]=Ut[yt]);return et};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{1440:(Ut,it,et)=>{var yt=et(1052).default;Ut.exports=function Y(Se,he,W){function j(H,w){if(!he[H]){if(!Se[H]){if(k)return k(H,!0);var R=new Error("Cannot find module '"+H+"'");throw R.code="MODULE_NOT_FOUND",R}var T=he[H]={exports:{}};Se[H][0].call(T.exports,function(b){return j(Se[H][1][b]||b)},T,T.exports,Y,Se,he,W)}return he[H].exports}for(var k=void 0,Q=0;Q<W.length;Q++)j(W[Q]);return j}({1:[function(Y,Se,he){var W,j;W=this,j=function(W,j,k,Q,H){"use strict";function A(Me,Ue,qe,ke){return new(qe||(qe=Promise))(function(G,pe){function de(pt){try{_t(ke.next(pt))}catch(we){pe(we)}}function je(pt){try{_t(ke.throw(pt))}catch(we){pe(we)}}function _t(pt){pt.done?G(pt.value):function(G){return G instanceof qe?G:new qe(function(pe){pe(G)})}(pt.value).then(de,je)}_t((ke=ke.apply(Me,Ue||[])).next())})}function z(Me,Ue){var ke,q,G,pe,qe={label:0,sent:function(){if(1&G[0])throw G[1];return G[1]},trys:[],ops:[]};return pe={next:de(0),throw:de(1),return:de(2)},"function"==typeof Symbol&&(pe[Symbol.iterator]=function(){return this}),pe;function de(_t){return function(pt){return function(_t){if(ke)throw new TypeError("Generator is already executing.");for(;qe;)try{if(ke=1,q&&(G=2&_t[0]?q.return:_t[0]?q.throw||((G=q.return)&&G.call(q),0):q.next)&&!(G=G.call(q,_t[1])).done)return G;switch(q=0,G&&(_t=[2&_t[0],G.value]),_t[0]){case 0:case 1:G=_t;break;case 4:return qe.label++,{value:_t[1],done:!1};case 5:qe.label++,q=_t[1],_t=[0];continue;case 7:_t=qe.ops.pop(),qe.trys.pop();continue;default:if(!(G=(G=qe.trys).length>0&&G[G.length-1])&&(6===_t[0]||2===_t[0])){qe=0;continue}if(3===_t[0]&&(!G||_t[1]>G[0]&&_t[1]<G[3])){qe.label=_t[1];break}if(6===_t[0]&&qe.label<G[1]){qe.label=G[1],G=_t;break}if(G&&qe.label<G[2]){qe.label=G[2],qe.ops.push(_t);break}G[2]&&qe.ops.pop(),qe.trys.pop();continue}_t=Ue.call(Me,qe)}catch(pt){_t=[6,pt],q=0}finally{ke=G=0}if(5&_t[0])throw _t[1];return{value:_t[0]?_t[1]:void 0,done:!0}}([_t,pt])}}}function Qe(Me){var Ue=Me.length,qe=0;return new H.Readable({objectMode:!0,read:function(){this.push(qe<Ue?Me[qe++]:null)}})}W.addJsonLdToStore=function(Me,Ue){return A(this,void 0,void 0,function(){var qe,ke,q;return z(this,function(G){switch(G.label){case 0:return"string"!=typeof Me?[3,4]:[4,fetch(Me,{redirect:"follow"})];case 1:return(ke=G.sent()).ok?[4,ke.json()]:[3,3];case 2:qe=G.sent(),G.label=3;case 3:return[3,5];case 4:qe=Me,G.label=5;case 5:return qe?[4,j.toRDF(qe)]:[3,7];case 6:q=G.sent(),Ue.import(Qe(q)),G.label=7;case 7:return[2,Ue]}})})},W.addN3ToStore=function(Me,Ue){return A(this,void 0,void 0,function(){var qe,ke,q;return z(this,function(G){switch(G.label){case 0:return"string"==typeof Me&&(null==Me?void 0:Me.startsWith("http"))?[4,fetch(Me,{redirect:"follow"})]:[3,4];case 1:return(ke=G.sent()).ok?[4,ke.text()]:[3,3];case 2:qe=G.sent(),G.label=3;case 3:return[3,5];case 4:qe=Me,G.label=5;case 5:return qe&&(q=new k.Parser({format:"n3"}).parse(qe),Ue.import(Qe(q))),[2,Ue]}})})},W.addRdfXmlToStore=function(Me,Ue){return A(this,void 0,void 0,function(){var qe,ke,q,G;return z(this,function(pe){switch(pe.label){case 0:return"string"==typeof Me&&(null==Me?void 0:Me.startsWith("http"))?[4,fetch(Me,{redirect:"follow"})]:[3,4];case 1:return(ke=pe.sent()).ok?[4,ke.text()]:[3,3];case 2:qe=pe.sent(),pe.label=3;case 3:return[3,5];case 4:qe=Me,pe.label=5;case 5:return qe?(q=new Q.RdfXmlParser({dataFactory:k.DataFactory,strict:!0}),G=new Promise(function(de){q.once("end",function(){return de(Ue)})}),Ue.import(q),q.write(qe),q.end(),[2,G]):[2,Ue]}})})},W.arrayToStream=Qe,W.deserializeN3Store=function(Me,Ue){var qe=JSON.parse(Me),ke=new k.Store;return Object.assign(ke,qe,{_factory:null!=Ue?Ue:k.DataFactory}),ke},W.readQuads=function(Me,Ue,qe,ke,q){return Me.readQuads(Ue,qe,ke,q)},W.serializeN3Store=function(Me){var Ue=Object.assign({},Me);return delete Ue._factory,JSON.stringify(Ue)},W.streamToArray=function(Me){return new Promise(function(Ue,qe){var ke=[];Me.on("data",function(q){ke.push(q)}).once("end",function(){Ue(ke)}).once("error",function(q){qe(q)})})},Object.keys(k).forEach(function(Me){"default"!==Me&&!W.hasOwnProperty(Me)&&Object.defineProperty(W,Me,{enumerable:!0,get:function(){return k[Me]}})}),Object.defineProperty(W,"__esModule",{value:!0})},"object"==typeof he&&void 0!==Se?j(he,Y("jsonld"),Y("n3"),Y("rdfxml-streaming-parser"),Y("readable-stream")):j((W="undefined"!=typeof globalThis?globalThis:W||self).tripleStoreUtils={},W.jsonld,W.n3,W.rdfxmlStreamingParser,W.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(Y,Se,he){"use strict";he.byteLength=function(z){var P=C(z),ue=P[1];return 3*(P[0]+ue)/4-ue},he.toByteArray=function(z){var P,$,X=C(z),ue=X[0],I=X[1],O=new k(function(z,P,X){return 3*(P+X)/4-X}(0,ue,I)),K=0,E=I>0?ue-4:ue;for($=0;$<E;$+=4)P=j[z.charCodeAt($)]<<18|j[z.charCodeAt($+1)]<<12|j[z.charCodeAt($+2)]<<6|j[z.charCodeAt($+3)],O[K++]=P>>16&255,O[K++]=P>>8&255,O[K++]=255&P;return 2===I&&(P=j[z.charCodeAt($)]<<2|j[z.charCodeAt($+1)]>>4,O[K++]=255&P),1===I&&(P=j[z.charCodeAt($)]<<10|j[z.charCodeAt($+1)]<<4|j[z.charCodeAt($+2)]>>2,O[K++]=P>>8&255,O[K++]=255&P),O},he.fromByteArray=function(z){for(var P,X=z.length,ue=X%3,I=[],O=16383,K=0,E=X-ue;K<E;K+=O)I.push(S(z,K,K+O>E?E:K+O));return 1===ue?I.push(W[(P=z[X-1])>>2]+W[P<<4&63]+"=="):2===ue&&I.push(W[(P=(z[X-2]<<8)+z[X-1])>>10]+W[P>>4&63]+W[P<<2&63]+"="),I.join("")};for(var W=[],j=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H=0,w=Q.length;H<w;++H)W[H]=Q[H],j[Q.charCodeAt(H)]=H;function C(z){var P=z.length;if(P%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var X=z.indexOf("=");return-1===X&&(X=P),[X,X===P?0:4-X%4]}function y(z){return W[z>>18&63]+W[z>>12&63]+W[z>>6&63]+W[63&z]}function S(z,P,X){for(var I=[],O=P;O<X;O+=3)I.push(y((z[O]<<16&16711680)+(z[O+1]<<8&65280)+(255&z[O+2])));return I.join("")}j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63},{}],3:[function(Y,Se,he){},{}],4:[function(Y,Se,he){var W=Y("buffer"),j=W.Buffer;function k(H,w){for(var C in H)w[C]=H[C]}function Q(H,w,C){return j(H,w,C)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Se.exports=W:(k(W,he),he.Buffer=Q),k(j,Q),Q.from=function(H,w,C){if("number"==typeof H)throw new TypeError("Argument must not be a number");return j(H,w,C)},Q.alloc=function(H,w,C){if("number"!=typeof H)throw new TypeError("Argument must be a number");var R=j(H);return void 0!==w?"string"==typeof C?R.fill(w,C):R.fill(w):R.fill(0),R},Q.allocUnsafe=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return j(H)},Q.allocUnsafeSlow=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return W.SlowBuffer(H)}},{buffer:6}],5:[function(Y,Se,he){"use strict";var W=Y("safe-buffer").Buffer,j=W.isEncoding||function(I){switch((I=""+I)&&I.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function H(I){var O;switch(this.encoding=function(I){var O=function(I){if(!I)return"utf8";for(var O;;)switch(I){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return I;default:if(O)return;I=(""+I).toLowerCase(),O=!0}}(I);if("string"!=typeof O&&(W.isEncoding===j||!j(I)))throw new Error("Unknown encoding: "+I);return O||I}(I),this.encoding){case"utf16le":this.text=S,this.end=A,O=4;break;case"utf8":this.fillLast=T,O=4;break;case"base64":this.text=z,this.end=P,O=3;break;default:return this.write=X,void(this.end=ue)}this.lastNeed=0,this.lastTotal=0,this.lastChar=W.allocUnsafe(O)}function w(I){return I<=127?0:I>>5==6?2:I>>4==14?3:I>>3==30?4:I>>6==2?-1:-2}function T(I){var O=this.lastTotal-this.lastNeed,K=function(I,O,K){if(128!=(192&O[0]))return I.lastNeed=0,"\ufffd";if(I.lastNeed>1&&O.length>1){if(128!=(192&O[1]))return I.lastNeed=1,"\ufffd";if(I.lastNeed>2&&O.length>2&&128!=(192&O[2]))return I.lastNeed=2,"\ufffd"}}(this,I);return void 0!==K?K:this.lastNeed<=I.length?(I.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(I.copy(this.lastChar,O,0,I.length),void(this.lastNeed-=I.length))}function S(I,O){if((I.length-O)%2==0){var K=I.toString("utf16le",O);if(K){var E=K.charCodeAt(K.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1],K.slice(0,-1)}return K}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=I[I.length-1],I.toString("utf16le",O,I.length-1)}function A(I){var O=I&&I.length?this.write(I):"";return this.lastNeed?O+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):O}function z(I,O){var K=(I.length-O)%3;return 0===K?I.toString("base64",O):(this.lastNeed=3-K,this.lastTotal=3,1===K?this.lastChar[0]=I[I.length-1]:(this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1]),I.toString("base64",O,I.length-K))}function P(I){var O=I&&I.length?this.write(I):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function X(I){return I.toString(this.encoding)}function ue(I){return I&&I.length?this.write(I):""}he.StringDecoder=H,H.prototype.write=function(I){if(0===I.length)return"";var O,K;if(this.lastNeed){if(void 0===(O=this.fillLast(I)))return"";K=this.lastNeed,this.lastNeed=0}else K=0;return K<I.length?O?O+this.text(I,K):this.text(I,K):O||""},H.prototype.end=function(I){var O=I&&I.length?this.write(I):"";return this.lastNeed?O+"\ufffd":O},H.prototype.text=function(I,O){var K=function(I,O,K){var E=O.length-1;if(E<K)return 0;var $=w(O[E]);return $>=0?($>0&&(I.lastNeed=$-1),$):--E<K||-2===$?0:($=w(O[E]))>=0?($>0&&(I.lastNeed=$-2),$):--E<K||-2===$?0:($=w(O[E]))>=0?($>0&&(2===$?$=0:I.lastNeed=$-3),$):0}(this,I,O);if(!this.lastNeed)return I.toString("utf8",O);this.lastTotal=K;var E=I.length-(K-this.lastNeed);return I.copy(this.lastChar,0,E),I.toString("utf8",O,E)},H.prototype.fillLast=function(I){if(this.lastNeed<=I.length)return I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,I.length),this.lastNeed-=I.length}},{"safe-buffer":4}],6:[function(Y,Se,he){(function(W){(function(){"use strict";var j=Y("base64-js"),k=Y("ieee754");he.Buffer=C,he.SlowBuffer=function(B){return+B!=B&&(B=0),C.alloc(+B)},he.INSPECT_MAX_BYTES=50;var Q=2147483647;function w(B){if(B>Q)throw new RangeError('The value "'+B+'" is invalid for option "size"');var N=new Uint8Array(B);return N.__proto__=C.prototype,N}function C(B,N,V){if("number"==typeof B){if("string"==typeof N)throw new TypeError('The "string" argument must be of type string. Received type number');return y(B)}return R(B,N,V)}function R(B,N,V){if("string"==typeof B)return function(B,N){if(("string"!=typeof N||""===N)&&(N="utf8"),!C.isEncoding(N))throw new TypeError("Unknown encoding: "+N);var V=0|I(B,N),Re=w(V),Ze=Re.write(B,N);return Ze!==V&&(Re=Re.slice(0,Ze)),Re}(B,N);if(ArrayBuffer.isView(B))return A(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(pt(B,ArrayBuffer)||B&&pt(B.buffer,ArrayBuffer))return function(B,N,V){if(N<0||B.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<N+(V||0))throw new RangeError('"length" is outside of buffer bounds');var Re;return(Re=void 0===N&&void 0===V?new Uint8Array(B):void 0===V?new Uint8Array(B,N):new Uint8Array(B,N,V)).__proto__=C.prototype,Re}(B,N,V);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var Re=B.valueOf&&B.valueOf();if(null!=Re&&Re!==B)return C.from(Re,N,V);var Ze=function(B){if(C.isBuffer(B)){var N=0|X(B.length),V=w(N);return 0===V.length||B.copy(V,0,0,N),V}return void 0!==B.length?"number"!=typeof B.length||we(B.length)?w(0):A(B):"Buffer"===B.type&&Array.isArray(B.data)?A(B.data):void 0}(B);if(Ze)return Ze;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return C.from(B[Symbol.toPrimitive]("string"),N,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function T(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function y(B){return T(B),w(B<0?0:0|X(B))}function A(B){for(var N=B.length<0?0:0|X(B.length),V=w(N),Re=0;Re<N;Re+=1)V[Re]=255&B[Re];return V}function X(B){if(B>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return 0|B}function I(B,N){if(C.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||pt(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var V=B.length,Re=arguments.length>2&&!0===arguments[2];if(!Re&&0===V)return 0;for(var Ze=!1;;)switch(N){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return G(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*V;case"hex":return V>>>1;case"base64":return je(B).length;default:if(Ze)return Re?-1:G(B).length;N=(""+N).toLowerCase(),Ze=!0}}function O(B,N,V){var Re=!1;if((void 0===N||N<0)&&(N=0),N>this.length||((void 0===V||V>this.length)&&(V=this.length),V<=0)||(V>>>=0)<=(N>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return tt(this,N,V);case"utf8":case"utf-8":return ye(this,N,V);case"ascii":return st(this,N,V);case"latin1":case"binary":return Qe(this,N,V);case"base64":return ne(this,N,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Xe(this,N,V);default:if(Re)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),Re=!0}}function K(B,N,V){var Re=B[N];B[N]=B[V],B[V]=Re}function E(B,N,V,Re,Ze){if(0===B.length)return-1;if("string"==typeof V?(Re=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),we(V=+V)&&(V=Ze?0:B.length-1),V<0&&(V=B.length+V),V>=B.length){if(Ze)return-1;V=B.length-1}else if(V<0){if(!Ze)return-1;V=0}if("string"==typeof N&&(N=C.from(N,Re)),C.isBuffer(N))return 0===N.length?-1:$(B,N,V,Re,Ze);if("number"==typeof N)return N&=255,"function"==typeof Uint8Array.prototype.indexOf?Ze?Uint8Array.prototype.indexOf.call(B,N,V):Uint8Array.prototype.lastIndexOf.call(B,N,V):$(B,[N],V,Re,Ze);throw new TypeError("val must be string, number or Buffer")}function $(B,N,V,Re,Ze){var Yn,Tt=1,kt=B.length,In=N.length;if(void 0!==Re&&("ucs2"===(Re=String(Re).toLowerCase())||"ucs-2"===Re||"utf16le"===Re||"utf-16le"===Re)){if(B.length<2||N.length<2)return-1;Tt=2,kt/=2,In/=2,V/=2}function Nn(Ls,fs){return 1===Tt?Ls[fs]:Ls.readUInt16BE(fs*Tt)}if(Ze){var Mi=-1;for(Yn=V;Yn<kt;Yn++)if(Nn(B,Yn)===Nn(N,-1===Mi?0:Yn-Mi)){if(-1===Mi&&(Mi=Yn),Yn-Mi+1===In)return Mi*Tt}else-1!==Mi&&(Yn-=Yn-Mi),Mi=-1}else for(V+In>kt&&(V=kt-In),Yn=V;Yn>=0;Yn--){for(var xi=!0,Xr=0;Xr<In;Xr++)if(Nn(B,Yn+Xr)!==Nn(N,Xr)){xi=!1;break}if(xi)return Yn}return-1}function Z(B,N,V,Re){V=Number(V)||0;var Ze=B.length-V;Re?(Re=Number(Re))>Ze&&(Re=Ze):Re=Ze;var Tt=N.length;Re>Tt/2&&(Re=Tt/2);for(var kt=0;kt<Re;++kt){var In=parseInt(N.substr(2*kt,2),16);if(we(In))return kt;B[V+kt]=In}return kt}function ae(B,N,V,Re){return _t(G(N,B.length-V),B,V,Re)}function oe(B,N,V,Re){return _t(function(B){for(var N=[],V=0;V<B.length;++V)N.push(255&B.charCodeAt(V));return N}(N),B,V,Re)}function te(B,N,V,Re){return oe(B,N,V,Re)}function Te(B,N,V,Re){return _t(je(N),B,V,Re)}function me(B,N,V,Re){return _t(function(B,N){for(var V,Re,Tt=[],kt=0;kt<B.length&&!((N-=2)<0);++kt)Re=(V=B.charCodeAt(kt))>>8,Tt.push(V%256),Tt.push(Re);return Tt}(N,B.length-V),B,V,Re)}function ne(B,N,V){return j.fromByteArray(0===N&&V===B.length?B:B.slice(N,V))}function ye(B,N,V){V=Math.min(B.length,V);for(var Re=[],Ze=N;Ze<V;){var Nn,Yn,Mi,xi,Tt=B[Ze],kt=null,In=Tt>239?4:Tt>223?3:Tt>191?2:1;if(Ze+In<=V)switch(In){case 1:Tt<128&&(kt=Tt);break;case 2:128==(192&(Nn=B[Ze+1]))&&(xi=(31&Tt)<<6|63&Nn)>127&&(kt=xi);break;case 3:Yn=B[Ze+2],128==(192&(Nn=B[Ze+1]))&&128==(192&Yn)&&(xi=(15&Tt)<<12|(63&Nn)<<6|63&Yn)>2047&&(xi<55296||xi>57343)&&(kt=xi);break;case 4:Yn=B[Ze+2],Mi=B[Ze+3],128==(192&(Nn=B[Ze+1]))&&128==(192&Yn)&&128==(192&Mi)&&(xi=(15&Tt)<<18|(63&Nn)<<12|(63&Yn)<<6|63&Mi)>65535&&xi<1114112&&(kt=xi)}null===kt?(kt=65533,In=1):kt>65535&&(Re.push((kt-=65536)>>>10&1023|55296),kt=56320|1023&kt),Re.push(kt),Ze+=In}return function(B){var N=B.length;if(N<=4096)return String.fromCharCode.apply(String,B);for(var V="",Re=0;Re<N;)V+=String.fromCharCode.apply(String,B.slice(Re,Re+=4096));return V}(Re)}he.kMaxLength=Q,!(C.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(N){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(C.prototype,"parent",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.buffer}}),Object.defineProperty(C.prototype,"offset",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&C[Symbol.species]===C&&Object.defineProperty(C,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),C.poolSize=8192,C.from=function(B,N,V){return R(B,N,V)},C.prototype.__proto__=Uint8Array.prototype,C.__proto__=Uint8Array,C.alloc=function(B,N,V){return function(B,N,V){return T(B),B<=0?w(B):void 0!==N?"string"==typeof V?w(B).fill(N,V):w(B).fill(N):w(B)}(B,N,V)},C.allocUnsafe=function(B){return y(B)},C.allocUnsafeSlow=function(B){return y(B)},C.isBuffer=function(N){return null!=N&&!0===N._isBuffer&&N!==C.prototype},C.compare=function(N,V){if(pt(N,Uint8Array)&&(N=C.from(N,N.offset,N.byteLength)),pt(V,Uint8Array)&&(V=C.from(V,V.offset,V.byteLength)),!C.isBuffer(N)||!C.isBuffer(V))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===V)return 0;for(var Re=N.length,Ze=V.length,Tt=0,kt=Math.min(Re,Ze);Tt<kt;++Tt)if(N[Tt]!==V[Tt]){Re=N[Tt],Ze=V[Tt];break}return Re<Ze?-1:Ze<Re?1:0},C.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},C.concat=function(N,V){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(0===N.length)return C.alloc(0);var Re;if(void 0===V)for(V=0,Re=0;Re<N.length;++Re)V+=N[Re].length;var Ze=C.allocUnsafe(V),Tt=0;for(Re=0;Re<N.length;++Re){var kt=N[Re];if(pt(kt,Uint8Array)&&(kt=C.from(kt)),!C.isBuffer(kt))throw new TypeError('"list" argument must be an Array of Buffers');kt.copy(Ze,Tt),Tt+=kt.length}return Ze},C.byteLength=I,C.prototype._isBuffer=!0,C.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var V=0;V<N;V+=2)K(this,V,V+1);return this},C.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var V=0;V<N;V+=4)K(this,V,V+3),K(this,V+1,V+2);return this},C.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var V=0;V<N;V+=8)K(this,V,V+7),K(this,V+1,V+6),K(this,V+2,V+5),K(this,V+3,V+4);return this},C.prototype.toLocaleString=C.prototype.toString=function(){var N=this.length;return 0===N?"":0===arguments.length?ye(this,0,N):O.apply(this,arguments)},C.prototype.equals=function(N){if(!C.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||0===C.compare(this,N)},C.prototype.inspect=function(){var N="",V=he.INSPECT_MAX_BYTES;return N=this.toString("hex",0,V).replace(/(.{2})/g,"$1 ").trim(),this.length>V&&(N+=" ... "),"<Buffer "+N+">"},C.prototype.compare=function(N,V,Re,Ze,Tt){if(pt(N,Uint8Array)&&(N=C.from(N,N.offset,N.byteLength)),!C.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(void 0===V&&(V=0),void 0===Re&&(Re=N?N.length:0),void 0===Ze&&(Ze=0),void 0===Tt&&(Tt=this.length),V<0||Re>N.length||Ze<0||Tt>this.length)throw new RangeError("out of range index");if(Ze>=Tt&&V>=Re)return 0;if(Ze>=Tt)return-1;if(V>=Re)return 1;if(this===N)return 0;for(var kt=(Tt>>>=0)-(Ze>>>=0),In=(Re>>>=0)-(V>>>=0),Nn=Math.min(kt,In),Yn=this.slice(Ze,Tt),Mi=N.slice(V,Re),xi=0;xi<Nn;++xi)if(Yn[xi]!==Mi[xi]){kt=Yn[xi],In=Mi[xi];break}return kt<In?-1:In<kt?1:0},C.prototype.includes=function(N,V,Re){return-1!==this.indexOf(N,V,Re)},C.prototype.indexOf=function(N,V,Re){return E(this,N,V,Re,!0)},C.prototype.lastIndexOf=function(N,V,Re){return E(this,N,V,Re,!1)},C.prototype.write=function(N,V,Re,Ze){if(void 0===V)Ze="utf8",Re=this.length,V=0;else if(void 0===Re&&"string"==typeof V)Ze=V,Re=this.length,V=0;else{if(!isFinite(V))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");V>>>=0,isFinite(Re)?(Re>>>=0,void 0===Ze&&(Ze="utf8")):(Ze=Re,Re=void 0)}var Tt=this.length-V;if((void 0===Re||Re>Tt)&&(Re=Tt),N.length>0&&(Re<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ze||(Ze="utf8");for(var kt=!1;;)switch(Ze){case"hex":return Z(this,N,V,Re);case"utf8":case"utf-8":return ae(this,N,V,Re);case"ascii":return oe(this,N,V,Re);case"latin1":case"binary":return te(this,N,V,Re);case"base64":return Te(this,N,V,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,N,V,Re);default:if(kt)throw new TypeError("Unknown encoding: "+Ze);Ze=(""+Ze).toLowerCase(),kt=!0}},C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function st(B,N,V){var Re="";V=Math.min(B.length,V);for(var Ze=N;Ze<V;++Ze)Re+=String.fromCharCode(127&B[Ze]);return Re}function Qe(B,N,V){var Re="";V=Math.min(B.length,V);for(var Ze=N;Ze<V;++Ze)Re+=String.fromCharCode(B[Ze]);return Re}function tt(B,N,V){var Re=B.length;(!N||N<0)&&(N=0),(!V||V<0||V>Re)&&(V=Re);for(var Ze="",Tt=N;Tt<V;++Tt)Ze+=q(B[Tt]);return Ze}function Xe(B,N,V){for(var Re=B.slice(N,V),Ze="",Tt=0;Tt<Re.length;Tt+=2)Ze+=String.fromCharCode(Re[Tt]+256*Re[Tt+1]);return Ze}function ze(B,N,V){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+N>V)throw new RangeError("Trying to access beyond buffer length")}function Le(B,N,V,Re,Ze,Tt){if(!C.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>Ze||N<Tt)throw new RangeError('"value" argument is out of bounds');if(V+Re>B.length)throw new RangeError("Index out of range")}function Ke(B,N,V,Re,Ze,Tt){if(V+Re>B.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function Me(B,N,V,Re,Ze){return N=+N,V>>>=0,Ze||Ke(B,0,V,4),k.write(B,N,V,Re,23,4),V+4}function Ue(B,N,V,Re,Ze){return N=+N,V>>>=0,Ze||Ke(B,0,V,8),k.write(B,N,V,Re,52,8),V+8}C.prototype.slice=function(N,V){var Re=this.length;(N=~~N)<0?(N+=Re)<0&&(N=0):N>Re&&(N=Re),(V=void 0===V?Re:~~V)<0?(V+=Re)<0&&(V=0):V>Re&&(V=Re),V<N&&(V=N);var Ze=this.subarray(N,V);return Ze.__proto__=C.prototype,Ze},C.prototype.readUIntLE=function(N,V,Re){N>>>=0,V>>>=0,Re||ze(N,V,this.length);for(var Ze=this[N],Tt=1,kt=0;++kt<V&&(Tt*=256);)Ze+=this[N+kt]*Tt;return Ze},C.prototype.readUIntBE=function(N,V,Re){N>>>=0,V>>>=0,Re||ze(N,V,this.length);for(var Ze=this[N+--V],Tt=1;V>0&&(Tt*=256);)Ze+=this[N+--V]*Tt;return Ze},C.prototype.readUInt8=function(N,V){return N>>>=0,V||ze(N,1,this.length),this[N]},C.prototype.readUInt16LE=function(N,V){return N>>>=0,V||ze(N,2,this.length),this[N]|this[N+1]<<8},C.prototype.readUInt16BE=function(N,V){return N>>>=0,V||ze(N,2,this.length),this[N]<<8|this[N+1]},C.prototype.readUInt32LE=function(N,V){return N>>>=0,V||ze(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},C.prototype.readUInt32BE=function(N,V){return N>>>=0,V||ze(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},C.prototype.readIntLE=function(N,V,Re){N>>>=0,V>>>=0,Re||ze(N,V,this.length);for(var Ze=this[N],Tt=1,kt=0;++kt<V&&(Tt*=256);)Ze+=this[N+kt]*Tt;return Ze>=(Tt*=128)&&(Ze-=Math.pow(2,8*V)),Ze},C.prototype.readIntBE=function(N,V,Re){N>>>=0,V>>>=0,Re||ze(N,V,this.length);for(var Ze=V,Tt=1,kt=this[N+--Ze];Ze>0&&(Tt*=256);)kt+=this[N+--Ze]*Tt;return kt>=(Tt*=128)&&(kt-=Math.pow(2,8*V)),kt},C.prototype.readInt8=function(N,V){return N>>>=0,V||ze(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},C.prototype.readInt16LE=function(N,V){N>>>=0,V||ze(N,2,this.length);var Re=this[N]|this[N+1]<<8;return 32768&Re?4294901760|Re:Re},C.prototype.readInt16BE=function(N,V){N>>>=0,V||ze(N,2,this.length);var Re=this[N+1]|this[N]<<8;return 32768&Re?4294901760|Re:Re},C.prototype.readInt32LE=function(N,V){return N>>>=0,V||ze(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},C.prototype.readInt32BE=function(N,V){return N>>>=0,V||ze(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},C.prototype.readFloatLE=function(N,V){return N>>>=0,V||ze(N,4,this.length),k.read(this,N,!0,23,4)},C.prototype.readFloatBE=function(N,V){return N>>>=0,V||ze(N,4,this.length),k.read(this,N,!1,23,4)},C.prototype.readDoubleLE=function(N,V){return N>>>=0,V||ze(N,8,this.length),k.read(this,N,!0,52,8)},C.prototype.readDoubleBE=function(N,V){return N>>>=0,V||ze(N,8,this.length),k.read(this,N,!1,52,8)},C.prototype.writeUIntLE=function(N,V,Re,Ze){N=+N,V>>>=0,Re>>>=0,Ze||Le(this,N,V,Re,Math.pow(2,8*Re)-1,0);var kt=1,In=0;for(this[V]=255&N;++In<Re&&(kt*=256);)this[V+In]=N/kt&255;return V+Re},C.prototype.writeUIntBE=function(N,V,Re,Ze){N=+N,V>>>=0,Re>>>=0,Ze||Le(this,N,V,Re,Math.pow(2,8*Re)-1,0);var kt=Re-1,In=1;for(this[V+kt]=255&N;--kt>=0&&(In*=256);)this[V+kt]=N/In&255;return V+Re},C.prototype.writeUInt8=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,1,255,0),this[V]=255&N,V+1},C.prototype.writeUInt16LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,65535,0),this[V]=255&N,this[V+1]=N>>>8,V+2},C.prototype.writeUInt16BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,65535,0),this[V]=N>>>8,this[V+1]=255&N,V+2},C.prototype.writeUInt32LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,4294967295,0),this[V+3]=N>>>24,this[V+2]=N>>>16,this[V+1]=N>>>8,this[V]=255&N,V+4},C.prototype.writeUInt32BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,4294967295,0),this[V]=N>>>24,this[V+1]=N>>>16,this[V+2]=N>>>8,this[V+3]=255&N,V+4},C.prototype.writeIntLE=function(N,V,Re,Ze){if(N=+N,V>>>=0,!Ze){var Tt=Math.pow(2,8*Re-1);Le(this,N,V,Re,Tt-1,-Tt)}var kt=0,In=1,Nn=0;for(this[V]=255&N;++kt<Re&&(In*=256);)N<0&&0===Nn&&0!==this[V+kt-1]&&(Nn=1),this[V+kt]=(N/In>>0)-Nn&255;return V+Re},C.prototype.writeIntBE=function(N,V,Re,Ze){if(N=+N,V>>>=0,!Ze){var Tt=Math.pow(2,8*Re-1);Le(this,N,V,Re,Tt-1,-Tt)}var kt=Re-1,In=1,Nn=0;for(this[V+kt]=255&N;--kt>=0&&(In*=256);)N<0&&0===Nn&&0!==this[V+kt+1]&&(Nn=1),this[V+kt]=(N/In>>0)-Nn&255;return V+Re},C.prototype.writeInt8=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,1,127,-128),N<0&&(N=255+N+1),this[V]=255&N,V+1},C.prototype.writeInt16LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,32767,-32768),this[V]=255&N,this[V+1]=N>>>8,V+2},C.prototype.writeInt16BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,2,32767,-32768),this[V]=N>>>8,this[V+1]=255&N,V+2},C.prototype.writeInt32LE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,2147483647,-2147483648),this[V]=255&N,this[V+1]=N>>>8,this[V+2]=N>>>16,this[V+3]=N>>>24,V+4},C.prototype.writeInt32BE=function(N,V,Re){return N=+N,V>>>=0,Re||Le(this,N,V,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[V]=N>>>24,this[V+1]=N>>>16,this[V+2]=N>>>8,this[V+3]=255&N,V+4},C.prototype.writeFloatLE=function(N,V,Re){return Me(this,N,V,!0,Re)},C.prototype.writeFloatBE=function(N,V,Re){return Me(this,N,V,!1,Re)},C.prototype.writeDoubleLE=function(N,V,Re){return Ue(this,N,V,!0,Re)},C.prototype.writeDoubleBE=function(N,V,Re){return Ue(this,N,V,!1,Re)},C.prototype.copy=function(N,V,Re,Ze){if(!C.isBuffer(N))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!Ze&&0!==Ze&&(Ze=this.length),V>=N.length&&(V=N.length),V||(V=0),Ze>0&&Ze<Re&&(Ze=Re),Ze===Re||0===N.length||0===this.length)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(Ze<0)throw new RangeError("sourceEnd out of bounds");Ze>this.length&&(Ze=this.length),N.length-V<Ze-Re&&(Ze=N.length-V+Re);var Tt=Ze-Re;if(this===N&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(V,Re,Ze);else if(this===N&&Re<V&&V<Ze)for(var kt=Tt-1;kt>=0;--kt)N[kt+V]=this[kt+Re];else Uint8Array.prototype.set.call(N,this.subarray(Re,Ze),V);return Tt},C.prototype.fill=function(N,V,Re,Ze){if("string"==typeof N){if("string"==typeof V?(Ze=V,V=0,Re=this.length):"string"==typeof Re&&(Ze=Re,Re=this.length),void 0!==Ze&&"string"!=typeof Ze)throw new TypeError("encoding must be a string");if("string"==typeof Ze&&!C.isEncoding(Ze))throw new TypeError("Unknown encoding: "+Ze);if(1===N.length){var Tt=N.charCodeAt(0);("utf8"===Ze&&Tt<128||"latin1"===Ze)&&(N=Tt)}}else"number"==typeof N&&(N&=255);if(V<0||this.length<V||this.length<Re)throw new RangeError("Out of range index");if(Re<=V)return this;var kt;if(V>>>=0,Re=void 0===Re?this.length:Re>>>0,N||(N=0),"number"==typeof N)for(kt=V;kt<Re;++kt)this[kt]=N;else{var In=C.isBuffer(N)?N:C.from(N,Ze),Nn=In.length;if(0===Nn)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(kt=0;kt<Re-V;++kt)this[kt+V]=In[kt%Nn]}return this};var qe=/[^+/0-9A-Za-z-_]/g;function q(B){return B<16?"0"+B.toString(16):B.toString(16)}function G(B,N){N=N||1/0;for(var V,Re=B.length,Ze=null,Tt=[],kt=0;kt<Re;++kt){if((V=B.charCodeAt(kt))>55295&&V<57344){if(!Ze){if(V>56319){(N-=3)>-1&&Tt.push(239,191,189);continue}if(kt+1===Re){(N-=3)>-1&&Tt.push(239,191,189);continue}Ze=V;continue}if(V<56320){(N-=3)>-1&&Tt.push(239,191,189),Ze=V;continue}V=65536+(Ze-55296<<10|V-56320)}else Ze&&(N-=3)>-1&&Tt.push(239,191,189);if(Ze=null,V<128){if((N-=1)<0)break;Tt.push(V)}else if(V<2048){if((N-=2)<0)break;Tt.push(V>>6|192,63&V|128)}else if(V<65536){if((N-=3)<0)break;Tt.push(V>>12|224,V>>6&63|128,63&V|128)}else{if(!(V<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;Tt.push(V>>18|240,V>>12&63|128,V>>6&63|128,63&V|128)}}return Tt}function je(B){return j.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(qe,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(B))}function _t(B,N,V,Re){for(var Ze=0;Ze<Re&&!(Ze+V>=N.length||Ze>=B.length);++Ze)N[Ze+V]=B[Ze];return Ze}function pt(B,N){return B instanceof N||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===N.name}function we(B){return B!=B}}).call(this)}).call(this,Y("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(Y,Se,he){"use strict";Se.exports=function W(j){return null===j||"object"!=typeof j||null!=j.toJSON?JSON.stringify(j):Array.isArray(j)?"["+j.reduce((k,Q,H)=>k+(0===H?"":",")+W(void 0===Q||"symbol"==typeof Q?null:Q),"")+"]":"{"+Object.keys(j).sort().reduce((k,Q,H)=>void 0===j[Q]||"symbol"==typeof j[Q]?k:k+(0===k.length?"":",")+W(Q)+":"+W(j[Q]),"")+"}"}},{}],8:[function(Y,Se,he){"use strict";var k,W="object"==typeof Reflect?Reflect:null,j=W&&"function"==typeof W.apply?W.apply:function($,Z,ae){return Function.prototype.apply.call($,Z,ae)};k=W&&"function"==typeof W.ownKeys?W.ownKeys:Object.getOwnPropertySymbols?function($){return Object.getOwnPropertyNames($).concat(Object.getOwnPropertySymbols($))}:function($){return Object.getOwnPropertyNames($)};var H=Number.isNaN||function($){return $!=$};function w(){w.init.call(this)}Se.exports=w,Se.exports.once=function(E,$){return new Promise(function(Z,ae){function oe(Te){E.removeListener($,te),ae(Te)}function te(){"function"==typeof E.removeListener&&E.removeListener("error",oe),Z([].slice.call(arguments))}K(E,$,te,{once:!0}),"error"!==$&&function(E,$,Z){"function"==typeof E.on&&K(E,"error",$,Z)}(E,oe,{once:!0})})},w.EventEmitter=w,w.prototype._events=void 0,w.prototype._eventsCount=0,w.prototype._maxListeners=void 0;var C=10;function R(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function T(E){return void 0===E._maxListeners?w.defaultMaxListeners:E._maxListeners}function b(E,$,Z,ae){var oe,te,Te;if(R(Z),void 0===(te=E._events)?(te=E._events=Object.create(null),E._eventsCount=0):(void 0!==te.newListener&&(E.emit("newListener",$,Z.listener?Z.listener:Z),te=E._events),Te=te[$]),void 0===Te)Te=te[$]=Z,++E._eventsCount;else if("function"==typeof Te?Te=te[$]=ae?[Z,Te]:[Te,Z]:ae?Te.unshift(Z):Te.push(Z),(oe=T(E))>0&&Te.length>oe&&!Te.warned){Te.warned=!0;var me=new Error("Possible EventEmitter memory leak detected. "+Te.length+" "+String($)+" listeners added. Use emitter.setMaxListeners() to increase limit");me.name="MaxListenersExceededWarning",me.emitter=E,me.type=$,me.count=Te.length,function(E){console&&console.warn&&console.warn(E)}(me)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function S(E,$,Z){var ae={fired:!1,wrapFn:void 0,target:E,type:$,listener:Z},oe=y.bind(ae);return oe.listener=Z,ae.wrapFn=oe,oe}function A(E,$,Z){var ae=E._events;if(void 0===ae)return[];var oe=ae[$];return void 0===oe?[]:"function"==typeof oe?Z?[oe.listener||oe]:[oe]:Z?function(E){for(var $=new Array(E.length),Z=0;Z<$.length;++Z)$[Z]=E[Z].listener||E[Z];return $}(oe):P(oe,oe.length)}function z(E){var $=this._events;if(void 0!==$){var Z=$[E];if("function"==typeof Z)return 1;if(void 0!==Z)return Z.length}return 0}function P(E,$){for(var Z=new Array($),ae=0;ae<$;++ae)Z[ae]=E[ae];return Z}function K(E,$,Z,ae){if("function"==typeof E.on)ae.once?E.once($,Z):E.on($,Z);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener($,function oe(te){ae.once&&E.removeEventListener($,oe),Z(te)})}}Object.defineProperty(w,"defaultMaxListeners",{enumerable:!0,get:function(){return C},set:function(E){if("number"!=typeof E||E<0||H(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");C=E}}),w.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},w.prototype.setMaxListeners=function($){if("number"!=typeof $||$<0||H($))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+$+".");return this._maxListeners=$,this},w.prototype.getMaxListeners=function(){return T(this)},w.prototype.emit=function($){for(var Z=[],ae=1;ae<arguments.length;ae++)Z.push(arguments[ae]);var oe="error"===$,te=this._events;if(void 0!==te)oe=oe&&void 0===te.error;else if(!oe)return!1;if(oe){var Te;if(Z.length>0&&(Te=Z[0]),Te instanceof Error)throw Te;var me=new Error("Unhandled error."+(Te?" ("+Te.message+")":""));throw me.context=Te,me}var ne=te[$];if(void 0===ne)return!1;if("function"==typeof ne)j(ne,this,Z);else{var ye=ne.length,Oe=P(ne,ye);for(ae=0;ae<ye;++ae)j(Oe[ae],this,Z)}return!0},w.prototype.on=w.prototype.addListener=function($,Z){return b(this,$,Z,!1)},w.prototype.prependListener=function($,Z){return b(this,$,Z,!0)},w.prototype.once=function($,Z){return R(Z),this.on($,S(this,$,Z)),this},w.prototype.prependOnceListener=function($,Z){return R(Z),this.prependListener($,S(this,$,Z)),this},w.prototype.off=w.prototype.removeListener=function($,Z){var ae,oe,te,Te,me;if(R(Z),void 0===(oe=this._events))return this;if(void 0===(ae=oe[$]))return this;if(ae===Z||ae.listener===Z)0==--this._eventsCount?this._events=Object.create(null):(delete oe[$],oe.removeListener&&this.emit("removeListener",$,ae.listener||Z));else if("function"!=typeof ae){for(te=-1,Te=ae.length-1;Te>=0;Te--)if(ae[Te]===Z||ae[Te].listener===Z){me=ae[Te].listener,te=Te;break}if(te<0)return this;0===te?ae.shift():function(E,$){for(;$+1<E.length;$++)E[$]=E[$+1];E.pop()}(ae,te),1===ae.length&&(oe[$]=ae[0]),void 0!==oe.removeListener&&this.emit("removeListener",$,me||Z)}return this},w.prototype.removeAllListeners=function($){var Z,ae,oe;if(void 0===(ae=this._events))return this;if(void 0===ae.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ae[$]&&(0==--this._eventsCount?this._events=Object.create(null):delete ae[$]),this;if(0===arguments.length){var Te,te=Object.keys(ae);for(oe=0;oe<te.length;++oe)"removeListener"!==(Te=te[oe])&&this.removeAllListeners(Te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Z=ae[$]))this.removeListener($,Z);else if(void 0!==Z)for(oe=Z.length-1;oe>=0;oe--)this.removeListener($,Z[oe]);return this},w.prototype.listeners=function($){return A(this,$,!0)},w.prototype.rawListeners=function($){return A(this,$,!1)},w.listenerCount=function(E,$){return"function"==typeof E.listenerCount?E.listenerCount($):z.call(E,$)},w.prototype.listenerCount=z,w.prototype.eventNames=function(){return this._eventsCount>0?k(this._events):[]}},{}],9:[function(Y,Se,he){he.read=function(W,j,k,Q,H){var w,C,R=8*H-Q-1,T=(1<<R)-1,b=T>>1,y=-7,S=k?H-1:0,A=k?-1:1,z=W[j+S];for(S+=A,w=z&(1<<-y)-1,z>>=-y,y+=R;y>0;w=256*w+W[j+S],S+=A,y-=8);for(C=w&(1<<-y)-1,w>>=-y,y+=Q;y>0;C=256*C+W[j+S],S+=A,y-=8);if(0===w)w=1-b;else{if(w===T)return C?NaN:1/0*(z?-1:1);C+=Math.pow(2,Q),w-=b}return(z?-1:1)*C*Math.pow(2,w-Q)},he.write=function(W,j,k,Q,H,w){var C,R,T,b=8*w-H-1,y=(1<<b)-1,S=y>>1,A=23===H?Math.pow(2,-24)-Math.pow(2,-77):0,z=Q?0:w-1,P=Q?1:-1,X=j<0||0===j&&1/j<0?1:0;for(j=Math.abs(j),isNaN(j)||j===1/0?(R=isNaN(j)?1:0,C=y):(C=Math.floor(Math.log(j)/Math.LN2),j*(T=Math.pow(2,-C))<1&&(C--,T*=2),(j+=C+S>=1?A/T:A*Math.pow(2,1-S))*T>=2&&(C++,T/=2),C+S>=y?(R=0,C=y):C+S>=1?(R=(j*T-1)*Math.pow(2,H),C+=S):(R=j*Math.pow(2,S-1)*Math.pow(2,H),C=0));H>=8;W[k+z]=255&R,z+=P,R/=256,H-=8);for(C=C<<H|R,b+=H;b>0;W[k+z]=255&C,z+=P,C/=256,b-=8);W[k+z-P]|=128*X}},{}],10:[function(Y,Se,he){Se.exports="function"==typeof Object.create?function(j,k){k&&(j.super_=k,j.prototype=Object.create(k.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}))}:function(j,k){if(k){j.super_=k;var Q=function(){};Q.prototype=k.prototype,j.prototype=new Q,j.prototype.constructor=j}}},{}],11:[function(Y,Se,he){"use strict";const{isArray:W,isObject:j,isString:k}=Y("./types"),{asArray:Q}=Y("./util"),{prependBase:H}=Y("./url"),w=Y("./JsonLdError"),C=Y("./ResolvedContext");function T(y){throw new w("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function b({context:y,base:S}){if(!y)return;const A=y["@context"];if(k(A))y["@context"]=H(S,A);else if(W(A))for(let z=0;z<A.length;++z){const P=A[z];k(P)?A[z]=H(S,P):j(P)&&b({context:{"@context":P},base:S})}else if(j(A))for(const z in A)b({context:A[z],base:S})}Se.exports=class{constructor({sharedCache:S}){this.perOpCache=new Map,this.sharedCache=S}resolve({activeCtx:S,context:A,documentLoader:z,base:P,cycles:X=new Set}){var ue=this;return yt(function*(){A&&j(A)&&A["@context"]&&(A=A["@context"]),A=Q(A);const I=[];for(const O of A){if(k(O)){let $=ue._get(O);$||($=yield ue._resolveRemoteContext({activeCtx:S,url:O,documentLoader:z,base:P,cycles:X})),W($)?I.push(...$):I.push($);continue}if(null===O){I.push(new C({document:null}));continue}j(O)||T(A);const K=JSON.stringify(O);let E=ue._get(K);E||(E=new C({document:O}),ue._cacheResolvedContext({key:K,resolved:E,tag:"static"})),I.push(E)}return I})()}_get(S){let A=this.perOpCache.get(S);if(!A){const z=this.sharedCache.get(S);z&&(A=z.get("static"),A&&this.perOpCache.set(S,A))}return A}_cacheResolvedContext({key:S,resolved:A,tag:z}){if(this.perOpCache.set(S,A),void 0!==z){let P=this.sharedCache.get(S);P||(P=new Map,this.sharedCache.set(S,P)),P.set(z,A)}return A}_resolveRemoteContext({activeCtx:S,url:A,documentLoader:z,base:P,cycles:X}){var ue=this;return yt(function*(){A=H(P,A);const{context:I,remoteDoc:O}=yield ue._fetchContext({activeCtx:S,url:A,documentLoader:z,cycles:X});b({context:I,base:P=O.documentUrl||A});const K=yield ue.resolve({activeCtx:S,context:I,documentLoader:z,base:P,cycles:X});return ue._cacheResolvedContext({key:A,resolved:K,tag:O.tag}),K})()}_fetchContext({activeCtx:S,url:A,documentLoader:z,cycles:P}){return yt(function*(){if(P.size>10)throw new w("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"loading remote context failed":"context overflow",max:10});if(P.has(A))throw new w("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"recursive context inclusion":"context overflow",url:A});let X,ue;P.add(A);try{ue=yield z(A),X=ue.document||null,k(X)&&(X=JSON.parse(X))}catch(I){throw new w("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:A,cause:I})}if(!j(X))throw new w("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:A});return X="@context"in X?{"@context":X["@context"]}:{"@context":{}},ue.contextUrl&&(W(X["@context"])||(X["@context"]=[X["@context"]]),X["@context"].push(ue.contextUrl)),{context:X,remoteDoc:ue}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(Y,Se,he){"use strict";Se.exports=class extends Error{constructor(j="An unspecified JSON-LD error occurred.",k="jsonld.Error",Q={}){super(j),this.name=k,this.message=j,this.details=Q}}},{}],13:[function(Y,Se,he){"use strict";Se.exports=W=>{class j{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(j,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(j.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:j}),j.compact=function(k,Q){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):W.compact(k,Q)},j.expand=function(k){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):W.expand(k)},j.flatten=function(k){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):W.flatten(k)},j}},{}],14:[function(Y,Se,he){"use strict";Se.exports=Y("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(Y,Se,he){"use strict";Se.exports=class{constructor(){this._requests={}}wrapLoader(j){const k=this;return k._loader=j,function(){return k.add.apply(k,arguments)}}add(j){var k=this;return yt(function*(){let Q=k._requests[j];if(Q)return Promise.resolve(Q);Q=k._requests[j]=k._loader(j);try{return yield Q}finally{delete k._requests[j]}})()}}},{}],16:[function(Y,Se,he){"use strict";const W=Y("lru-cache");Se.exports=class{constructor({document:Q}){this.document=Q,this.cache=new W({max:10})}getProcessed(Q){return this.cache.get(Q)}setProcessed(Q,H){this.cache.set(Q,H)}}},{"lru-cache":33}],17:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:k,isString:Q,isUndefined:H}=Y("./types"),{isList:w,isValue:C,isGraph:R,isSimpleGraph:T,isSubjectReference:b}=Y("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:A,process:z,processingMode:P}=Y("./context"),{removeBase:X,prependBase:ue}=Y("./url"),{addValue:I,asArray:O,compareShortestLeast:K}=Y("./util"),E={};function Z(ae,oe,te){if("@nest"!==y(ae,oe,{vocab:!0},te))throw new W("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Se.exports=E,E.compact=function(){var ae=yt(function*({activeCtx:oe,activeProperty:te=null,element:Te,options:me={},compactionMap:ne=(()=>{})}){if(j(Te)){let Oe=[];for(let $e=0;$e<Te.length;++$e){let st=yield E.compact({activeCtx:oe,activeProperty:te,element:Te[$e],options:me,compactionMap:ne});null===st&&(st=yield ne({unmappedValue:Te[$e],activeCtx:oe,activeProperty:te,parent:Te,index:$e,options:me}),void 0===st)||Oe.push(st)}return me.compactArrays&&1===Oe.length&&0===(S(oe,te,"@container")||[]).length&&(Oe=Oe[0]),Oe}const ye=S(oe,te,"@context");if(H(ye)||(oe=yield z({activeCtx:oe,localCtx:ye,propagate:!0,overrideProtected:!0,options:me})),k(Te)){if(me.link&&"@id"in Te&&me.link.hasOwnProperty(Te["@id"])){const Le=me.link[Te["@id"]];for(let Ke=0;Ke<Le.length;++Ke)if(Le[Ke].expanded===Te)return Le[Ke].compacted}if(C(Te)||b(Te)){const Le=E.compactValue({activeCtx:oe,activeProperty:te,value:Te,options:me});return me.link&&b(Te)&&(me.link.hasOwnProperty(Te["@id"])||(me.link[Te["@id"]]=[]),me.link[Te["@id"]].push({expanded:Te,compacted:Le})),Le}if(w(Te)&&(S(oe,te,"@container")||[]).includes("@list"))return E.compact({activeCtx:oe,activeProperty:te,element:Te["@list"],options:me,compactionMap:ne});const Oe="@reverse"===te,$e={},st=oe;!C(Te)&&!b(Te)&&(oe=oe.revertToPreviousContext());const Qe=S(st,te,"@context");H(Qe)||(oe=yield z({activeCtx:oe,localCtx:Qe,propagate:!0,overrideProtected:!0,options:me})),me.link&&"@id"in Te&&(me.link.hasOwnProperty(Te["@id"])||(me.link[Te["@id"]]=[]),me.link[Te["@id"]].push({expanded:Te,compacted:$e}));let tt=Te["@type"]||[];tt.length>1&&(tt=Array.from(tt).sort());const Xe=oe;for(const Le of tt){const Ke=E.compactIri({activeCtx:Xe,iri:Le,relativeTo:{vocab:!0}}),Me=S(st,Ke,"@context");H(Me)||(oe=yield z({activeCtx:oe,localCtx:Me,options:me,propagate:!1}))}const ze=Object.keys(Te).sort();for(const Le of ze){const Ke=Te[Le];if("@id"!==Le)if("@type"!==Le)if("@reverse"!==Le)if("@preserve"!==Le)if("@index"!==Le)if("@graph"!==Le&&"@list"!==Le&&"@included"!==Le&&A(Le)){const Me=E.compactIri({activeCtx:oe,iri:Le,relativeTo:{vocab:!0}});I($e,Me,Ke)}else{if(!j(Ke))throw new W("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ke.length){const Me=E.compactIri({activeCtx:oe,iri:Le,value:Ke,relativeTo:{vocab:!0},reverse:Oe}),Ue=oe.mappings.has(Me)?oe.mappings.get(Me)["@nest"]:null;let qe=$e;Ue&&(Z(oe,Ue,me),k($e[Ue])||($e[Ue]={}),qe=$e[Ue]),I(qe,Me,Ke,{propertyIsArray:!0})}for(const Me of Ke){const Ue=E.compactIri({activeCtx:oe,iri:Le,value:Me,relativeTo:{vocab:!0},reverse:Oe}),qe=oe.mappings.has(Ue)?oe.mappings.get(Ue)["@nest"]:null;let ke=$e;qe&&(Z(oe,qe,me),k($e[qe])||($e[qe]={}),ke=$e[qe]);const q=S(oe,Ue,"@container")||[],G=R(Me),pe=w(Me);let de;pe?de=Me["@list"]:G&&(de=Me["@graph"]);let je=yield E.compact({activeCtx:oe,activeProperty:Ue,element:pe||G?de:Me,options:me,compactionMap:ne});if(pe){if(j(je)||(je=[je]),q.includes("@list")){I(ke,Ue,je,{valueIsArray:!0,allowDuplicate:!0});continue}je={[E.compactIri({activeCtx:oe,iri:"@list",relativeTo:{vocab:!0}})]:je},"@index"in Me&&(je[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Me["@index"])}if(G)if(q.includes("@graph")&&(q.includes("@id")||q.includes("@index")&&T(Me))){let _t;ke.hasOwnProperty(Ue)?_t=ke[Ue]:ke[Ue]=_t={};const pt=(q.includes("@id")?Me["@id"]:Me["@index"])||E.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}});I(_t,pt,je,{propertyIsArray:!me.compactArrays||q.includes("@set")})}else q.includes("@graph")&&T(Me)?(j(je)&&je.length>1&&(je={"@included":je}),I(ke,Ue,je,{propertyIsArray:!me.compactArrays||q.includes("@set")})):(j(je)&&1===je.length&&me.compactArrays&&(je=je[0]),je={[E.compactIri({activeCtx:oe,iri:"@graph",relativeTo:{vocab:!0}})]:je},"@id"in Me&&(je[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Me["@id"]),"@index"in Me&&(je[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Me["@index"]),I(ke,Ue,je,{propertyIsArray:!me.compactArrays||q.includes("@set")}));else if(q.includes("@language")||q.includes("@index")||q.includes("@id")||q.includes("@type")){let _t,pt;if(ke.hasOwnProperty(Ue)?_t=ke[Ue]:ke[Ue]=_t={},q.includes("@language"))C(je)&&(je=je["@value"]),pt=Me["@language"];else if(q.includes("@index")){const we=S(oe,Ue,"@index")||"@index",B=E.compactIri({activeCtx:oe,iri:we,relativeTo:{vocab:!0}});if("@index"===we)pt=Me["@index"],delete je[B];else{let N;if([pt,...N]=O(je[we]||[]),Q(pt))switch(N.length){case 0:delete je[we];break;case 1:je[we]=N[0];break;default:je[we]=N}else pt=null}}else if(q.includes("@id")){const we=E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}});pt=je[we],delete je[we]}else if(q.includes("@type")){const we=E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}});let B;switch([pt,...B]=O(je[we]||[]),B.length){case 0:delete je[we];break;case 1:je[we]=B[0];break;default:je[we]=B}1===Object.keys(je).length&&"@id"in Me&&(je=yield E.compact({activeCtx:oe,activeProperty:Ue,element:{"@id":Me["@id"]},options:me,compactionMap:ne}))}pt||(pt=E.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}})),I(_t,pt,je,{propertyIsArray:q.includes("@set")})}else{const _t=!me.compactArrays||q.includes("@set")||q.includes("@list")||j(je)&&0===je.length||"@list"===Le||"@graph"===Le;I(ke,Ue,je,{propertyIsArray:_t})}}}else{if((S(oe,te,"@container")||[]).includes("@index"))continue;const Ue=E.compactIri({activeCtx:oe,iri:Le,relativeTo:{vocab:!0}});I($e,Ue,Ke)}else{const Me=yield E.compact({activeCtx:oe,activeProperty:te,element:Ke,options:me,compactionMap:ne});j(Me)&&0===Me.length||I($e,Le,Me)}else{const Me=yield E.compact({activeCtx:oe,activeProperty:"@reverse",element:Ke,options:me,compactionMap:ne});for(const Ue in Me)if(oe.mappings.has(Ue)&&oe.mappings.get(Ue).reverse){const qe=Me[Ue],q=(S(oe,Ue,"@container")||[]).includes("@set")||!me.compactArrays;I($e,Ue,qe,{propertyIsArray:q}),delete Me[Ue]}if(Object.keys(Me).length>0){const Ue=E.compactIri({activeCtx:oe,iri:Le,relativeTo:{vocab:!0}});I($e,Ue,Me)}}else{let Me=O(Ke).map(G=>E.compactIri({activeCtx:st,iri:G,relativeTo:{vocab:!0}}));1===Me.length&&(Me=Me[0]);const Ue=E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}}),q=(S(oe,Ue,"@container")||[]).includes("@set")&&P(oe,1.1)||j(Me)&&0===Ke.length;I($e,Ue,Me,{propertyIsArray:q})}else{let Me=O(Ke).map(qe=>E.compactIri({activeCtx:oe,iri:qe,relativeTo:{vocab:!1},base:me.base}));1===Me.length&&(Me=Me[0]),$e[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Me}}return $e}return Te});return function(oe){return ae.apply(this,arguments)}}(),E.compactIri=({activeCtx:ae,iri:oe,value:te=null,relativeTo:Te={vocab:!1},reverse:me=!1,base:ne=null})=>{if(null===oe)return oe;ae.isPropertyTermScoped&&ae.previousContext&&(ae=ae.previousContext);const ye=ae.getInverse();if(A(oe)&&oe in ye&&"@none"in ye[oe]&&"@type"in ye[oe]["@none"]&&"@none"in ye[oe]["@none"]["@type"])return ye[oe]["@none"]["@type"]["@none"];if(Te.vocab&&oe in ye){const tt=ae["@language"]||"@none",Xe=[];k(te)&&"@index"in te&&!("@graph"in te)&&Xe.push("@index","@index@set"),k(te)&&"@preserve"in te&&(te=te["@preserve"][0]),R(te)?("@index"in te&&Xe.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te&&Xe.push("@graph@id","@graph@id@set"),Xe.push("@graph","@graph@set","@set"),"@index"in te||Xe.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te||Xe.push("@graph@id","@graph@id@set")):k(te)&&!C(te)&&Xe.push("@id","@id@set","@type","@set@type");let ze="@language",Le="@null";if(me)ze="@type",Le="@reverse",Xe.push("@set");else if(w(te)){"@index"in te||Xe.push("@list");const Me=te["@list"];if(0===Me.length)ze="@any",Le="@none";else{let Ue=0===Me.length?tt:null,qe=null;for(let ke=0;ke<Me.length;++ke){const q=Me[ke];let G="@none",pe="@none";if(C(q)?"@direction"in q?G=`${(q["@language"]||"").toLowerCase()}_${q["@direction"]}`:"@language"in q?G=q["@language"].toLowerCase():"@type"in q?pe=q["@type"]:G="@null":pe="@id",null===Ue?Ue=G:G!==Ue&&C(q)&&(Ue="@none"),null===qe?qe=pe:pe!==qe&&(qe="@none"),"@none"===Ue&&"@none"===qe)break}Ue=Ue||"@none",qe=qe||"@none","@none"!==qe?(ze="@type",Le=qe):Le=Ue}}else{if(C(te))if("@language"in te&&!("@index"in te)){Xe.push("@language","@language@set"),Le=te["@language"];const Me=te["@direction"];Me&&(Le=`${Le}_${Me}`)}else"@direction"in te&&!("@index"in te)?Le=`_${te["@direction"]}`:"@type"in te&&(ze="@type",Le=te["@type"]);else ze="@type",Le="@id";Xe.push("@set")}Xe.push("@none"),k(te)&&!("@index"in te)&&Xe.push("@index","@index@set"),C(te)&&1===Object.keys(te).length&&Xe.push("@language","@language@set");const Ke=function(ae,oe,te,Te,me,ne){null===ne&&(ne="@null");const ye=[];if(("@id"===ne||"@reverse"===ne)&&k(te)&&"@id"in te){"@reverse"===ne&&ye.push("@reverse");const $e=E.compactIri({activeCtx:ae,iri:te["@id"],relativeTo:{vocab:!0}});ae.mappings.has($e)&&ae.mappings.get($e)&&ae.mappings.get($e)["@id"]===te["@id"]?ye.push.apply(ye,["@vocab","@id"]):ye.push.apply(ye,["@id","@vocab"])}else{ye.push(ne);const $e=ye.find(st=>st.includes("_"));$e&&ye.push($e.replace(/^[^_]+_/,"_"))}ye.push("@none");const Oe=ae.inverse[oe];for(const $e of Te){if(!($e in Oe))continue;const st=Oe[$e][me];for(const Qe of ye)if(Qe in st)return st[Qe]}return null}(ae,oe,te,Xe,ze,Le);if(null!==Ke)return Ke}if(Te.vocab&&"@vocab"in ae){const tt=ae["@vocab"];if(0===oe.indexOf(tt)&&oe!==tt){const Xe=oe.substr(tt.length);if(!ae.mappings.has(Xe))return Xe}}let Oe=null;const $e=[];let st=ae.fastCurieMap;const Qe=oe.length-1;for(let tt=0;tt<Qe&&oe[tt]in st;++tt)st=st[oe[tt]],""in st&&$e.push(st[""][0]);for(let tt=$e.length-1;tt>=0;--tt){const Xe=$e[tt],ze=Xe.terms;for(const Le of ze){const Ke=Le+":"+oe.substr(Xe.iri.length);ae.mappings.get(Le)._prefix&&(!ae.mappings.has(Ke)||null===te&&ae.mappings.get(Ke)["@id"]===oe)&&(null===Oe||K(Ke,Oe)<0)&&(Oe=Ke)}}if(null!==Oe)return Oe;for(const[tt,Xe]of ae.mappings)if(Xe&&Xe._prefix&&oe.startsWith(tt+":"))throw new W(`Absolute IRI "${oe}" confused with prefix "${tt}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:ae});return Te.vocab?oe:"@base"in ae?ae["@base"]?X(ue(ne,ae["@base"]),oe):oe:X(ne,oe)},E.compactValue=({activeCtx:ae,activeProperty:oe,value:te,options:Te})=>{if(C(te)){const Oe=S(ae,oe,"@type"),$e=S(ae,oe,"@language"),st=S(ae,oe,"@direction"),Qe=S(ae,oe,"@container")||[],tt="@index"in te&&!Qe.includes("@index");if(!tt&&"@none"!==Oe&&(te["@type"]===Oe||"@language"in te&&te["@language"]===$e&&"@direction"in te&&te["@direction"]===st||"@language"in te&&te["@language"]===$e||"@direction"in te&&te["@direction"]===st))return te["@value"];const Xe=Object.keys(te).length,ze=1===Xe||2===Xe&&"@index"in te&&!tt,Le="@language"in ae,Ke=Q(te["@value"]),Me=ae.mappings.has(oe)&&null===ae.mappings.get(oe)["@language"];if(ze&&"@none"!==Oe&&(!Le||!Ke||Me))return te["@value"];const Ue={};return tt&&(Ue[E.compactIri({activeCtx:ae,iri:"@index",relativeTo:{vocab:!0}})]=te["@index"]),"@type"in te?Ue[E.compactIri({activeCtx:ae,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:ae,iri:te["@type"],relativeTo:{vocab:!0}}):"@language"in te&&(Ue[E.compactIri({activeCtx:ae,iri:"@language",relativeTo:{vocab:!0}})]=te["@language"]),"@direction"in te&&(Ue[E.compactIri({activeCtx:ae,iri:"@direction",relativeTo:{vocab:!0}})]=te["@direction"]),Ue[E.compactIri({activeCtx:ae,iri:"@value",relativeTo:{vocab:!0}})]=te["@value"],Ue}const me=y(ae,oe,{vocab:!0},Te),ne=S(ae,oe,"@type"),ye=E.compactIri({activeCtx:ae,iri:te["@id"],relativeTo:{vocab:"@vocab"===ne},base:Te.base});return"@id"===ne||"@vocab"===ne||"@graph"===me?ye:{[E.compactIri({activeCtx:ae,iri:"@id",relativeTo:{vocab:!0}})]:ye}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(Y,Se,he){"use strict";const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#";Se.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:W,RDF_LIST:W+"List",RDF_FIRST:W+"first",RDF_REST:W+"rest",RDF_NIL:W+"nil",RDF_TYPE:W+"type",RDF_PLAIN_LITERAL:W+"PlainLiteral",RDF_XML_LITERAL:W+"XMLLiteral",RDF_JSON_LITERAL:W+"JSON",RDF_OBJECT:W+"object",RDF_LANGSTRING:W+"langString",XSD:j,XSD_BOOLEAN:j+"boolean",XSD_DOUBLE:j+"double",XSD_INTEGER:j+"integer",XSD_STRING:j+"string"}},{}],19:[function(Y,Se,he){"use strict";const W=Y("./util"),j=Y("./JsonLdError"),{isArray:k,isObject:Q,isString:H,isUndefined:w}=Y("./types"),{isAbsolute:C,isRelative:R,prependBase:T}=Y("./url"),{asArray:b,compareShortestLeast:y}=Y("./util"),S=new Map,z=/^@[a-zA-Z]+$/,P={};function X(I,O,K,E,$,Z){if(null===O||!H(O)||P.isKeyword(O))return O;if(O.match(z))return null;if(E&&E.hasOwnProperty(O)&&!0!==$.get(O)&&P.createTermDefinition({activeCtx:I,localCtx:E,term:O,defined:$,options:Z}),(K=K||{}).vocab){const oe=I.mappings.get(O);if(null===oe)return null;if(Q(oe)&&"@id"in oe)return oe["@id"]}const ae=O.indexOf(":");if(ae>0){const oe=O.substr(0,ae),te=O.substr(ae+1);if("_"===oe||0===te.indexOf("//"))return O;E&&E.hasOwnProperty(oe)&&P.createTermDefinition({activeCtx:I,localCtx:E,term:oe,defined:$,options:Z});const Te=I.mappings.get(oe);if(Te&&Te._prefix)return Te["@id"]+te;if(C(O))return O}if(K.vocab&&"@vocab"in I)return I["@vocab"]+O;if(K.base&&"@base"in I){if(I["@base"])return T(T(Z.base,I["@base"]),O)}else if(K.base)return T(Z.base,O);return O}function ue(I,O){if(!I||"object"!=typeof I||!O||"object"!=typeof O)return I===O;const K=Array.isArray(I);if(K!==Array.isArray(O))return!1;if(K){if(I.length!==O.length)return!1;for(let Z=0;Z<I.length;++Z)if(!ue(I[Z],O[Z]))return!1;return!0}const E=Object.keys(I),$=Object.keys(O);if(E.length!==$.length)return!1;for(const Z in I){let ae=I[Z],oe=O[Z];if("@container"===Z&&Array.isArray(ae)&&Array.isArray(oe)&&(ae=ae.slice().sort(),oe=oe.slice().sort()),!ue(ae,oe))return!1}return!0}Se.exports=P,P.process=function(){var I=yt(function*({activeCtx:O,localCtx:K,options:E,propagate:$=!0,overrideProtected:Z=!1,cycles:ae=new Set}){if(Q(K)&&"@context"in K&&k(K["@context"])&&(K=K["@context"]),0===b(K).length)return O;const te=yield E.contextResolver.resolve({activeCtx:O,context:K,documentLoader:E.documentLoader,base:E.base});Q(te[0].document)&&"boolean"==typeof te[0].document["@propagate"]&&($=te[0].document["@propagate"]);let Te=O;!$&&!Te.previousContext&&(Te=Te.clone(),Te.previousContext=O);for(const me of te){let{document:ne}=me;if(O=Te,null===ne){if(!Z&&0!==Object.keys(O.protected).length){const $e=E&&E.protectedMode||"error";if("error"===$e)throw new j("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===$e){console.warn("WARNING: invalid context nullification");const st=me.getProcessed(O);if(st){Te=O=st;continue}const Qe=O;Te=O=P.getInitialContext(E).clone();for(const[tt,Xe]of Object.entries(Qe.protected))Xe&&(O.mappings[tt]=W.clone(Qe.mappings[tt]));O.protected=W.clone(Qe.protected),me.setProcessed(Qe,Te);continue}throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:K,protectedMode:$e})}Te=O=P.getInitialContext(E).clone();continue}const ye=me.getProcessed(O);if(ye){Te=O=ye;continue}if(Q(ne)&&"@context"in ne&&(ne=ne["@context"]),!Q(ne))throw new j("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ne});Te=Te.clone();const Oe=new Map;if("@version"in ne){if(1.1!==ne["@version"])throw new j("Unsupported JSON-LD version: "+ne["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:ne});if(O.processingMode&&"json-ld-1.0"===O.processingMode)throw new j("@version: "+ne["@version"]+" not compatible with "+O.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:ne});Te.processingMode="json-ld-1.1",Te["@version"]=ne["@version"],Oe.set("@version",!0)}if(Te.processingMode=Te.processingMode||O.processingMode,"@base"in ne){let $e=ne["@base"];if(null!==$e&&!C($e)){if(!R($e))throw new j('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:ne});$e=T(Te["@base"],$e)}Te["@base"]=$e,Oe.set("@base",!0)}if("@vocab"in ne){const $e=ne["@vocab"];if(null===$e)delete Te["@vocab"];else{if(!H($e))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});if(!C($e)&&P.processingMode(Te,1))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});Te["@vocab"]=X(Te,$e,{vocab:!0,base:!0},void 0,void 0,E)}Oe.set("@vocab",!0)}if("@language"in ne){const $e=ne["@language"];if(null===$e)delete Te["@language"];else{if(!H($e))throw new j('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:ne});Te["@language"]=$e.toLowerCase()}Oe.set("@language",!0)}if("@direction"in ne){const $e=ne["@direction"];if("json-ld-1.0"===O.processingMode)throw new j("Invalid JSON-LD syntax; @direction not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:ne});if(null===$e)delete Te["@direction"];else{if("ltr"!==$e&&"rtl"!==$e)throw new j('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:ne});Te["@direction"]=$e}Oe.set("@direction",!0)}if("@propagate"in ne){const $e=ne["@propagate"];if("json-ld-1.0"===O.processingMode)throw new j("Invalid JSON-LD syntax; @propagate not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if("boolean"!=typeof $e)throw new j("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:K});Oe.set("@propagate",!0)}if("@import"in ne){const $e=ne["@import"];if("json-ld-1.0"===O.processingMode)throw new j("Invalid JSON-LD syntax; @import not compatible with "+O.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if(!H($e))throw new j("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:K});const st=yield E.contextResolver.resolve({activeCtx:O,context:$e,documentLoader:E.documentLoader,base:E.base});if(1!==st.length)throw new j("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:K});const Qe=st[0].getProcessed(O);if(Qe)ne=Qe;else{const tt=st[0].document;if("@import"in tt)throw new j("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:K});for(const Xe in tt)ne.hasOwnProperty(Xe)||(ne[Xe]=tt[Xe]);st[0].setProcessed(O,ne)}Oe.set("@import",!0)}Oe.set("@protected",ne["@protected"]||!1);for(const $e in ne)if(P.createTermDefinition({activeCtx:Te,localCtx:ne,term:$e,defined:Oe,options:E,overrideProtected:Z}),Q(ne[$e])&&"@context"in ne[$e]){const st=ne[$e]["@context"];let Qe=!0;if(H(st)){const tt=T(E.base,st);ae.has(tt)?Qe=!1:ae.add(tt)}if(Qe)try{yield P.process({activeCtx:Te.clone(),localCtx:ne[$e]["@context"],overrideProtected:!0,options:E,cycles:ae})}catch(tt){throw new j("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:ne[$e]["@context"],term:$e})}}me.setProcessed(O,Te)}return Te});return function(O){return I.apply(this,arguments)}}(),P.createTermDefinition=({activeCtx:I,localCtx:O,term:K,defined:E,options:$,overrideProtected:Z=!1})=>{if(E.has(K)){if(E.get(K))return;throw new j("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:O,term:K})}let ae;if(E.set(K,!1),O.hasOwnProperty(K)&&(ae=O[K]),"@type"===K&&Q(ae)&&"@set"===(ae["@container"]||"@set")&&P.processingMode(I,1.1)){const Oe=["@container","@id","@protected"],$e=Object.keys(ae);if(0===$e.length||$e.some(st=>!Oe.includes(st)))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:O,term:K})}else{if(P.isKeyword(K))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:O,term:K});if(K.match(z))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:K});if(""===K)throw new j("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:O})}const oe=I.mappings.get(K);I.mappings.has(K)&&I.mappings.delete(K);let te=!1;if((H(ae)||null===ae)&&(te=!0,ae={"@id":ae}),!Q(ae))throw new j("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:O});const Te={};I.mappings.set(K,Te),Te.reverse=!1;const me=["@container","@id","@language","@reverse","@type"];P.processingMode(I,1.1)&&me.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Oe in ae)if(!me.includes(Oe))throw new j("Invalid JSON-LD syntax; a term definition must not contain "+Oe,"jsonld.SyntaxError",{code:"invalid term definition",context:O});const ne=K.indexOf(":");if(Te._termHasColon=ne>0,"@reverse"in ae){if("@id"in ae)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});if("@nest"in ae)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});const Oe=ae["@reverse"];if(!H(Oe))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(!P.isKeyword(Oe)&&Oe.match(z))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Oe}),void(oe?I.mappings.set(K,oe):I.mappings.delete(K));const $e=X(I,Oe,{vocab:!0,base:!1},O,E,$);if(!C($e))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});Te["@id"]=$e,Te.reverse=!0}else if("@id"in ae){let Oe=ae["@id"];if(Oe&&!H(Oe))throw new j("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(null===Oe)Te["@id"]=null;else{if(!P.isKeyword(Oe)&&Oe.match(z))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Oe}),void(oe?I.mappings.set(K,oe):I.mappings.delete(K));if(Oe!==K){if(Oe=X(I,Oe,{vocab:!0,base:!1},O,E,$),!C(Oe)&&!P.isKeyword(Oe))throw new j("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});if(K.match(/(?::[^:])|\//)&&X(I,K,{vocab:!0,base:!1},O,new Map(E).set(K,!0),$)!==Oe)throw new j("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O});Te["@id"]=Oe,Te._prefix=te&&!Te._termHasColon&&Oe.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Te))if(Te._termHasColon){const Oe=K.substr(0,ne);if(O.hasOwnProperty(Oe)&&P.createTermDefinition({activeCtx:I,localCtx:O,term:Oe,defined:E,options:$}),I.mappings.has(Oe)){const $e=K.substr(ne+1);Te["@id"]=I.mappings.get(Oe)["@id"]+$e}else Te["@id"]=K}else if("@type"===K)Te["@id"]=K;else{if(!("@vocab"in I))throw new j("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:O,term:K});Te["@id"]=I["@vocab"]+K}if((!0===ae["@protected"]||!0===E.get("@protected")&&!1!==ae["@protected"])&&(I.protected[K]=!0,Te.protected=!0),E.set(K,!0),"@type"in ae){let Oe=ae["@type"];if(!H(Oe))throw new j("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:O});if("@json"===Oe||"@none"===Oe){if(P.processingMode(I,1))throw new j(`Invalid JSON-LD syntax; an @context @type value must not be "${Oe}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:O})}else if("@id"!==Oe&&"@vocab"!==Oe){if(Oe=X(I,Oe,{vocab:!0,base:!1},O,E,$),!C(Oe))throw new j("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:O});if(0===Oe.indexOf("_:"))throw new j("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:O})}Te["@type"]=Oe}if("@container"in ae){const Oe=H(ae["@container"])?[ae["@container"]]:ae["@container"]||[],$e=["@list","@set","@index","@language"];let st=!0;const Qe=Oe.includes("@set");if(P.processingMode(I,1.1)){if($e.push("@graph","@id","@type"),Oe.includes("@list")){if(1!==Oe.length)throw new j("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:O})}else if(Oe.includes("@graph")){if(Oe.some(tt=>"@graph"!==tt&&"@id"!==tt&&"@index"!==tt&&"@set"!==tt))throw new j("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:O})}else st&=Oe.length<=(Qe?2:1);if(Oe.includes("@type")&&(Te["@type"]=Te["@type"]||"@id",!["@id","@vocab"].includes(Te["@type"])))throw new j("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:O})}else st&=!k(ae["@container"]),st&=Oe.length<=1;if(st&=Oe.every(tt=>$e.includes(tt)),st&=!(Qe&&Oe.includes("@list")),!st)throw new j("Invalid JSON-LD syntax; @context @container value must be one of the following: "+$e.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:O});if(Te.reverse&&!Oe.every(tt=>["@index","@set"].includes(tt)))throw new j("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:O});Te["@container"]=Oe}if("@index"in ae){if(!("@container"in ae)||!Te["@container"].includes("@index"))throw new j(`Invalid JSON-LD syntax; @index without @index in @container: "${ae["@index"]}" on term "${K}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:O});if(!H(ae["@index"])||0===ae["@index"].indexOf("@"))throw new j(`Invalid JSON-LD syntax; @index must expand to an IRI: "${ae["@index"]}" on term "${K}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:O});Te["@index"]=ae["@index"]}if("@context"in ae&&(Te["@context"]=ae["@context"]),"@language"in ae&&!("@type"in ae)){let Oe=ae["@language"];if(null!==Oe&&!H(Oe))throw new j("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:O});null!==Oe&&(Oe=Oe.toLowerCase()),Te["@language"]=Oe}if("@prefix"in ae){if(K.match(/:|\//))throw new j("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:O});if(P.isKeyword(Te["@id"]))throw new j("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:O});if("boolean"!=typeof ae["@prefix"])throw new j("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:O});Te._prefix=!0===ae["@prefix"]}if("@direction"in ae){const Oe=ae["@direction"];if(null!==Oe&&"ltr"!==Oe&&"rtl"!==Oe)throw new j('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:O});Te["@direction"]=Oe}if("@nest"in ae){const Oe=ae["@nest"];if(!H(Oe)||"@nest"!==Oe&&0===Oe.indexOf("@"))throw new j("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:O});Te["@nest"]=Oe}const ye=Te["@id"];if("@context"===ye||"@preserve"===ye)throw new j("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:O});if(oe&&oe.protected&&!Z&&(I.protected[K]=!0,Te.protected=!0,!ue(oe,Te))){const Oe=$&&$.protectedMode||"error";if("error"===Oe)throw new j(`Invalid JSON-LD syntax; tried to redefine "${K}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:O,term:K});if("warn"===Oe)return void console.warn("WARNING: protected term redefinition",{term:K});throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:O,term:K,protectedMode:Oe})}},P.expandIri=(I,O,K,E)=>X(I,O,K,void 0,void 0,E),P.getInitialContext=I=>{const O=JSON.stringify({processingMode:I.processingMode}),K=S.get(O);if(K)return K;const E={processingMode:I.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Te=this;if(Te.inverse)return Te.inverse;const me=Te.inverse={},ne=Te.fastCurieMap={},ye={},Oe=(Te["@language"]||"@none").toLowerCase(),$e=Te["@direction"],st=Te.mappings,Qe=[...st.keys()].sort(y);for(const tt of Qe){const Xe=st.get(tt);if(null===Xe)continue;let ze=Xe["@container"]||"@none";if(ze=[].concat(ze).sort().join(""),null===Xe["@id"])continue;const Le=b(Xe["@id"]);for(const Ke of Le){let Me=me[Ke];const Ue=P.isKeyword(Ke);if(Me)!Ue&&!Xe._termHasColon&&ye[Ke].push(tt);else if(me[Ke]=Me={},!Ue&&!Xe._termHasColon){ye[Ke]=[tt];const qe={iri:Ke,terms:ye[Ke]};Ke[0]in ne?ne[Ke[0]].push(qe):ne[Ke[0]]=[qe]}if(Me[ze]||(Me[ze]={"@language":{},"@type":{},"@any":{}}),Me=Me[ze],ae(tt,Me["@any"],"@none"),Xe.reverse)ae(tt,Me["@type"],"@reverse");else if("@none"===Xe["@type"])ae(tt,Me["@any"],"@none"),ae(tt,Me["@language"],"@none"),ae(tt,Me["@type"],"@none");else if("@type"in Xe)ae(tt,Me["@type"],Xe["@type"]);else if("@language"in Xe&&"@direction"in Xe){const qe=Xe["@language"],ke=Xe["@direction"];ae(tt,Me["@language"],qe&&ke?`${qe}_${ke}`.toLowerCase():qe?qe.toLowerCase():ke?`_${ke}`:"@null")}else"@language"in Xe?ae(tt,Me["@language"],(Xe["@language"]||"@null").toLowerCase()):"@direction"in Xe?ae(tt,Me["@language"],Xe["@direction"]?`_${Xe["@direction"]}`:"@none"):$e?(ae(tt,Me["@language"],`_${$e}`),ae(tt,Me["@language"],"@none"),ae(tt,Me["@type"],"@none")):(ae(tt,Me["@language"],Oe),ae(tt,Me["@language"],"@none"),ae(tt,Me["@type"],"@none"))}}for(const tt in ne)Z(ne,tt,1);return me},clone:function(){const Te={};return Te.mappings=W.clone(this.mappings),Te.clone=this.clone,Te.inverse=null,Te.getInverse=this.getInverse,Te.protected=W.clone(this.protected),this.previousContext&&(Te.previousContext=this.previousContext.clone()),Te.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Te["@base"]=this["@base"]),"@language"in this&&(Te["@language"]=this["@language"]),"@vocab"in this&&(Te["@vocab"]=this["@vocab"]),Te},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===S.size&&S.clear(),S.set(O,E),E;function Z(Te,me,ne){const ye=Te[me],Oe=Te[me]={};let $e,st;for(const Qe of ye)$e=Qe.iri,st=ne>=$e.length?"":$e[ne],st in Oe?Oe[st].push(Qe):Oe[st]=[Qe];for(const Qe in Oe)""!==Qe&&Z(Oe,Qe,ne+1)}function ae(Te,me,ne){me.hasOwnProperty(ne)||(me[ne]=Te)}},P.getContextValue=(I,O,K)=>{if(null===O)return"@context"===K?void 0:null;if(I.mappings.has(O)){const E=I.mappings.get(O);if(w(K))return E;if(E.hasOwnProperty(K))return E[K]}return"@language"===K&&K in I||"@direction"===K&&K in I?I[K]:"@context"!==K?null:void 0},P.processingMode=(I,O)=>O.toString()>="1.1"?!I.processingMode||I.processingMode>="json-ld-"+O.toString():"json-ld-1.0"===I.processingMode,P.isKeyword=I=>{if(!H(I)||"@"!==I[0])return!1;switch(I){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(Y,Se,he){"use strict";const{parseLinkHeader:W,buildHeaders:j}=Y("../util"),{LINK_HEADER_CONTEXT:k}=Y("../constants"),Q=Y("../JsonLdError"),H=Y("../RequestQueue"),{prependBase:w}=Y("../url"),C=/(^|(\r\n))link:/i;function R(T,b,y){const S=new(T=T||XMLHttpRequest);return new Promise((A,z)=>{S.onload=()=>A(S),S.onerror=P=>z(P),S.open("GET",b,!0);for(const P in y)S.setRequestHeader(P,y[P]);S.send()})}Se.exports=({secure:T,headers:b={},xhr:y}={headers:{}})=>{return b=j(b),(new H).wrapLoader(A);function A(P){return z.apply(this,arguments)}function z(){return(z=yt(function*(P){if(0!==P.indexOf("http:")&&0!==P.indexOf("https:"))throw new Q('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:P});if(T&&0!==P.indexOf("https"))throw new Q('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:P});let X;try{X=yield R(y,P,b)}catch(E){throw new Q("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:P,cause:E})}if(X.status>=400)throw new Q("URL could not be dereferenced: "+X.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:P,httpStatusCode:X.status});let ue={contextUrl:null,documentUrl:P,document:X.response},I=null;const O=X.getResponseHeader("Content-Type");let K;if(C.test(X.getAllResponseHeaders())&&(K=X.getResponseHeader("Link")),K&&"application/ld+json"!==O){const E=W(K),$=E[k];if(Array.isArray($))throw new Q("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:P});$&&(ue.contextUrl=$.target),I=E.alternate,I&&"application/ld+json"==I.type&&!(O||"").match(/^application\/(\w*\+)?json$/)&&(ue=yield A(w(P,I.target)))}return ue})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:k,isEmptyObject:Q,isString:H,isUndefined:w}=Y("./types"),{isList:C,isValue:R,isGraph:T,isSubject:b}=Y("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:A,process:z,processingMode:P}=Y("./context"),{isAbsolute:X}=Y("./url"),{addValue:ue,asArray:I,getValues:O,validateTypeValue:K}=Y("./util"),E={};Se.exports=E;const $=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Z(ne){return ae.apply(this,arguments)}function ae(){return(ae=yt(function*({activeCtx:ne,activeProperty:ye,expandedActiveProperty:Oe,element:$e,expandedParent:st,options:Qe={},insideList:tt,typeKey:Xe,typeScopedContext:ze,expansionMap:Le}){const Ke=Object.keys($e).sort(),Me=[];let Ue;const qe=$e[Xe]&&"@json"===y(ne,j($e[Xe])?$e[Xe][0]:$e[Xe],{vocab:!0},Qe);for(const ke of Ke){let G,q=$e[ke];if("@context"===ke)continue;let pe=y(ne,ke,{vocab:!0},Qe);if((null===pe||!X(pe)&&!A(pe))&&(pe=Le({unmappedProperty:ke,activeCtx:ne,activeProperty:ye,parent:$e,options:Qe,insideList:tt,value:q,expandedParent:st}),void 0===pe))continue;if(A(pe)){if("@reverse"===Oe)throw new W("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:q});if(pe in st&&"@included"!==pe&&"@type"!==pe)throw new W("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:pe})}if("@id"===pe){if(!H(q)){if(!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(k(q)){if(!Q(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}else{if(!j(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(!q.every(pt=>H(pt)))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}}ue(st,"@id",I(q).map(pt=>H(pt)?y(ne,pt,{base:!0},Qe):pt),{propertyIsArray:Qe.isFrame});continue}if("@type"===pe){k(q)&&(q=Object.fromEntries(Object.entries(q).map(([pt,we])=>[y(ze,pt,{vocab:!0}),I(we).map(B=>y(ze,B,{base:!0,vocab:!0}))]))),K(q,Qe.isFrame),ue(st,"@type",I(q).map(pt=>H(pt)?y(ze,pt,{base:!0,vocab:!0},Qe):pt),{propertyIsArray:Qe.isFrame});continue}if("@included"===pe&&P(ne,1.1)){const pt=I(yield E.expand({activeCtx:ne,activeProperty:ye,element:q,options:Qe,expansionMap:Le}));if(!pt.every(we=>b(we)))throw new W("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:q});ue(st,"@included",pt,{propertyIsArray:!0});continue}if("@graph"===pe&&!k(q)&&!j(q))throw new W('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:q});if("@value"===pe){Ue=q,qe&&P(ne,1.1)?st["@value"]=q:ue(st,"@value",q,{propertyIsArray:Qe.isFrame});continue}if("@language"===pe){if(null===q)continue;if(!H(q)&&!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:q});q=I(q).map(pt=>H(pt)?pt.toLowerCase():pt);for(const pt of q)H(pt)&&!pt.match($)&&console.warn(`@language must be valid BCP47: ${pt}`);ue(st,"@language",q,{propertyIsArray:Qe.isFrame});continue}if("@direction"===pe){if(!H(q)&&!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:q});q=I(q);for(const pt of q)if(H(pt)&&"ltr"!==pt&&"rtl"!==pt)throw new W('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:q});ue(st,"@direction",q,{propertyIsArray:Qe.isFrame});continue}if("@index"===pe){if(!H(q))throw new W('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:q});ue(st,"@index",q);continue}if("@reverse"===pe){if(!k(q))throw new W('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:q});if(G=yield E.expand({activeCtx:ne,activeProperty:"@reverse",element:q,options:Qe,expansionMap:Le}),"@reverse"in G)for(const we in G["@reverse"])ue(st,we,G["@reverse"][we],{propertyIsArray:!0});let pt=st["@reverse"]||null;for(const we in G){if("@reverse"===we)continue;null===pt&&(pt=st["@reverse"]={}),ue(pt,we,[],{propertyIsArray:!0});const B=G[we];for(let N=0;N<B.length;++N){const V=B[N];if(R(V)||C(V))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ue(pt,we,V,{propertyIsArray:!0})}}continue}if("@nest"===pe){Me.push(ke);continue}let de=ne;const je=S(ne,ke,"@context");w(je)||(de=yield z({activeCtx:ne,localCtx:je,propagate:!0,overrideProtected:!0,options:Qe}));const _t=S(de,ke,"@container")||[];if(_t.includes("@language")&&k(q))G=te(de,q,S(de,ke,"@direction"),Qe);else if(_t.includes("@index")&&k(q)){const pt=_t.includes("@graph"),we=S(de,ke,"@index")||"@index",B="@index"!==we&&y(ne,we,{vocab:!0},Qe);G=yield Te({activeCtx:de,options:Qe,activeProperty:ke,value:q,expansionMap:Le,asGraph:pt,indexKey:we,propertyIndex:B})}else if(_t.includes("@id")&&k(q)){const pt=_t.includes("@graph");G=yield Te({activeCtx:de,options:Qe,activeProperty:ke,value:q,expansionMap:Le,asGraph:pt,indexKey:"@id"})}else if(_t.includes("@type")&&k(q))G=yield Te({activeCtx:de.revertToPreviousContext(),options:Qe,activeProperty:ke,value:q,expansionMap:Le,asGraph:!1,indexKey:"@type"});else{const pt="@list"===pe;if(pt||"@set"===pe){let we=ye;pt&&"@graph"===Oe&&(we=null),G=yield E.expand({activeCtx:de,activeProperty:we,element:q,options:Qe,insideList:pt,expansionMap:Le})}else G="@json"===S(ne,ke,"@type")?{"@type":"@json","@value":q}:yield E.expand({activeCtx:de,activeProperty:ke,element:q,options:Qe,insideList:!1,expansionMap:Le})}if(null!==G||"@value"===pe||(G=Le({unmappedValue:q,expandedProperty:pe,activeCtx:de,activeProperty:ye,parent:$e,options:Qe,insideList:tt,key:ke,expandedParent:st}),void 0!==G)){if("@list"!==pe&&!C(G)&&_t.includes("@list")&&(G={"@list":I(G)}),_t.includes("@graph")&&!_t.some(pt=>"@id"===pt||"@index"===pt)&&(G=I(G).map(pt=>({"@graph":I(pt)}))),de.mappings.has(ke)&&de.mappings.get(ke).reverse){const pt=st["@reverse"]=st["@reverse"]||{};G=I(G);for(let we=0;we<G.length;++we){const B=G[we];if(R(B)||C(B))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ue(pt,pe,B,{propertyIsArray:!0})}continue}ue(st,pe,G,{propertyIsArray:!0})}}if("@value"in st&&("@json"!==st["@type"]||!P(ne,1.1))&&(k(Ue)||j(Ue))&&!Qe.isFrame)throw new W('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Ue});for(const ke of Me){const q=j($e[ke])?$e[ke]:[$e[ke]];for(const G of q){if(!k(G)||Object.keys(G).some(pe=>"@value"===y(ne,pe,{vocab:!0},Qe)))throw new W("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:G});yield Z({activeCtx:ne,activeProperty:ye,expandedActiveProperty:Oe,element:G,expandedParent:st,options:Qe,insideList:tt,typeScopedContext:ze,typeKey:Xe,expansionMap:Le})}}})).apply(this,arguments)}function oe({activeCtx:ne,activeProperty:ye,value:Oe,options:$e}){if(null==Oe)return null;const st=y(ne,ye,{vocab:!0},$e);if("@id"===st)return y(ne,Oe,{base:!0},$e);if("@type"===st)return y(ne,Oe,{vocab:!0,base:!0},$e);const Qe=S(ne,ye,"@type");if(("@id"===Qe||"@graph"===st)&&H(Oe))return{"@id":y(ne,Oe,{base:!0},$e)};if("@vocab"===Qe&&H(Oe))return{"@id":y(ne,Oe,{vocab:!0,base:!0},$e)};if(A(st))return Oe;const tt={};if(Qe&&!["@id","@vocab","@none"].includes(Qe))tt["@type"]=Qe;else if(H(Oe)){const Xe=S(ne,ye,"@language");null!==Xe&&(tt["@language"]=Xe);const ze=S(ne,ye,"@direction");null!==ze&&(tt["@direction"]=ze)}return["boolean","number","string"].includes(typeof Oe)||(Oe=Oe.toString()),tt["@value"]=Oe,tt}function te(ne,ye,Oe,$e){const st=[],Qe=Object.keys(ye).sort();for(const tt of Qe){const Xe=y(ne,tt,{vocab:!0},$e);let ze=ye[tt];j(ze)||(ze=[ze]);for(const Le of ze){if(null===Le)continue;if(!H(Le))throw new W("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:ye});const Ke={"@value":Le};"@none"!==Xe&&(Ke["@language"]=tt.toLowerCase()),Oe&&(Ke["@direction"]=Oe),st.push(Ke)}}return st}function Te(ne){return me.apply(this,arguments)}function me(){return(me=yt(function*({activeCtx:ne,options:ye,activeProperty:Oe,value:$e,expansionMap:st,asGraph:Qe,indexKey:tt,propertyIndex:Xe}){const ze=[],Le=Object.keys($e).sort(),Ke="@type"===tt;for(let Me of Le){if(Ke){const ke=S(ne,Me,"@context");w(ke)||(ne=yield z({activeCtx:ne,localCtx:ke,propagate:!1,options:ye}))}let qe,Ue=$e[Me];j(Ue)||(Ue=[Ue]),Ue=yield E.expand({activeCtx:ne,activeProperty:Oe,element:Ue,options:ye,insideList:!1,insideIndex:!0,expansionMap:st}),qe=Xe?"@none"===Me?"@none":oe({activeCtx:ne,activeProperty:tt,value:Me,options:ye}):y(ne,Me,{vocab:!0},ye),"@id"===tt?Me=y(ne,Me,{base:!0},ye):Ke&&(Me=qe);for(let ke of Ue){if(Qe&&!T(ke)&&(ke={"@graph":[ke]}),"@type"===tt)"@none"===qe||(ke["@type"]=ke["@type"]?[Me].concat(ke["@type"]):[Me]);else{if(R(ke)&&!["@language","@type","@index"].includes(tt))throw new W(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${tt}".`,"jsonld.SyntaxError",{code:"invalid value object",value:ke});Xe?"@none"!==qe&&ue(ke,Xe,qe,{propertyIsArray:!0,prependValue:!0}):"@none"!==qe&&!(tt in ke)&&(ke[tt]=Me)}ze.push(ke)}}return ze})).apply(this,arguments)}E.expand=function(){var ne=yt(function*({activeCtx:ye,activeProperty:Oe=null,element:$e,options:st={},insideList:Qe=!1,insideIndex:tt=!1,typeScopedContext:Xe=null,expansionMap:ze=(()=>{})}){if(null==$e)return null;if("@default"===Oe&&(st=Object.assign({},st,{isFrame:!1})),!j($e)&&!k($e)){if(!Qe&&(null===Oe||"@graph"===y(ye,Oe,{vocab:!0},st))){const G=yield ze({unmappedValue:$e,activeCtx:ye,activeProperty:Oe,options:st,insideList:Qe});return void 0===G?null:G}return oe({activeCtx:ye,activeProperty:Oe,value:$e,options:st})}if(j($e)){let G=[];const pe=S(ye,Oe,"@container")||[];Qe=Qe||pe.includes("@list");for(let de=0;de<$e.length;++de){let je=yield E.expand({activeCtx:ye,activeProperty:Oe,element:$e[de],options:st,expansionMap:ze,insideIndex:tt,typeScopedContext:Xe});Qe&&j(je)&&(je={"@list":je}),(null!==je||(je=yield ze({unmappedValue:$e[de],activeCtx:ye,activeProperty:Oe,parent:$e,index:de,options:st,expandedParent:G,insideList:Qe}),void 0!==je))&&(j(je)?G=G.concat(je):G.push(je))}return G}const Le=y(ye,Oe,{vocab:!0},st),Ke=S(ye,Oe,"@context");Xe=Xe||(ye.previousContext?ye:null);let Me=Object.keys($e).sort(),Ue=!tt;if(Ue&&Xe&&Me.length<=2&&!Me.includes("@context"))for(const G of Me){const pe=y(Xe,G,{vocab:!0},st);if("@value"===pe){Ue=!1,ye=Xe;break}if("@id"===pe&&1===Me.length){Ue=!1;break}}Ue&&(ye=ye.revertToPreviousContext()),w(Ke)||(ye=yield z({activeCtx:ye,localCtx:Ke,propagate:!0,overrideProtected:!0,options:st})),"@context"in $e&&(ye=yield z({activeCtx:ye,localCtx:$e["@context"],options:st})),Xe=ye;let qe=null;for(const G of Me)if("@type"===y(ye,G,{vocab:!0},st)){qe=qe||G;const de=$e[G],je=Array.isArray(de)?de.length>1?de.slice().sort():de:[de];for(const _t of je){const pt=S(Xe,_t,"@context");w(pt)||(ye=yield z({activeCtx:ye,localCtx:pt,options:st,propagate:!1}))}}let ke={};yield Z({activeCtx:ye,activeProperty:Oe,expandedActiveProperty:Le,element:$e,expandedParent:ke,options:st,insideList:Qe,typeKey:qe,typeScopedContext:Xe,expansionMap:ze}),Me=Object.keys(ke);let q=Me.length;if("@value"in ke){if("@type"in ke&&("@language"in ke||"@direction"in ke))throw new W('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:ke});let G=q-1;if("@type"in ke&&(G-=1),"@index"in ke&&(G-=1),"@language"in ke&&(G-=1),"@direction"in ke&&(G-=1),0!==G)throw new W('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:ke});const pe=null===ke["@value"]?[]:I(ke["@value"]),de=O(ke,"@type");if(!P(ye,1.1)||!de.includes("@json")||1!==de.length)if(0===pe.length){const je=yield ze({unmappedValue:ke,activeCtx:ye,activeProperty:Oe,element:$e,options:st,insideList:Qe});ke=void 0!==je?je:null}else{if(!pe.every(je=>H(je)||Q(je))&&"@language"in ke)throw new W("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:ke});if(!de.every(je=>X(je)&&!(H(je)&&0===je.indexOf("_:"))||Q(je)))throw new W('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:ke})}}else if("@type"in ke&&!j(ke["@type"]))ke["@type"]=[ke["@type"]];else if("@set"in ke||"@list"in ke){if(q>1&&(2!==q||!("@index"in ke)))throw new W('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:ke});"@set"in ke&&(ke=ke["@set"],Me=Object.keys(ke),q=Me.length)}else if(1===q&&"@language"in ke){const G=yield ze(ke,{unmappedValue:ke,activeCtx:ye,activeProperty:Oe,element:$e,options:st,insideList:Qe});ke=void 0!==G?G:null}if(k(ke)&&!st.keepFreeFloatingNodes&&!Qe&&(null===Oe||"@graph"===Le)&&(0===q||"@value"in ke||"@list"in ke||1===q&&"@id"in ke)){const G=yield ze({unmappedValue:ke,activeCtx:ye,activeProperty:Oe,element:$e,options:st,insideList:Qe});ke=void 0!==G?G:null}return ke});return function(ye){return ne.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(Y,Se,he){"use strict";const{isSubjectReference:W}=Y("./graphTypes"),{createMergedNodeMap:j}=Y("./nodeMap"),k={};Se.exports=k,k.flatten=Q=>{const H=j(Q),w=[],C=Object.keys(H).sort();for(let R=0;R<C.length;++R){const T=H[C[R]];W(T)||w.push(T)}return w}},{"./graphTypes":25,"./nodeMap":27}],23:[function(Y,Se,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),k=Y("./types"),Q=Y("./util"),H=Y("./url"),w=Y("./JsonLdError"),{createNodeMap:C,mergeNodeMapGraphs:R}=Y("./nodeMap"),T={};function b(E){const $={};for(const Z in E)void 0!==E[Z]&&($["@"+Z]=[E[Z]]);return[$]}function y(E,$,Z){for(let ae=Z.length-1;ae>=0;--ae){const oe=Z[ae];if(oe.graph===$&&oe.subject["@id"]===E["@id"])return!0}return!1}function S(E,$,Z){const ae="@"+Z;let oe=ae in E?E[ae][0]:$[Z];if("embed"===Z)if(!0===oe)oe="@once";else if(!1===oe)oe="@never";else if("@always"!==oe&&"@never"!==oe&&"@link"!==oe&&"@first"!==oe&&"@last"!==oe&&"@once"!==oe)throw new w("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return oe}function A(E){if(!k.isArray(E)||1!==E.length||!k.isObject(E[0]))throw new w("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const $ of Q.asArray(E[0]["@id"]))if(!k.isObject($)&&!H.isAbsolute($)||k.isString($)&&0===$.indexOf("_:"))throw new w("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const $ of Q.asArray(E[0]["@type"]))if(!k.isObject($)&&!H.isAbsolute($)||k.isString($)&&0===$.indexOf("_:"))throw new w("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function P(E,$,Z,ae){let oe=!0,te=!1;for(const Te in Z){let me=!1;const ne=Q.getValues($,Te),ye=0===Q.getValues(Z,Te).length;if("@id"===Te){if(k.isEmptyObject(Z["@id"][0]||{})?me=!0:Z["@id"].length>=0&&(me=Z["@id"].includes(ne[0])),!ae.requireAll)return me}else if("@type"===Te){if(oe=!1,ye){if(ne.length>0)return!1;me=!0}else if(1===Z["@type"].length&&k.isEmptyObject(Z["@type"][0]))me=ne.length>0;else for(const Oe of Z["@type"])me=!(!k.isObject(Oe)||!("@default"in Oe))||me||ne.some($e=>$e===Oe);if(!ae.requireAll)return me}else{if(W(Te))continue;{const Oe=Q.getValues(Z,Te)[0];let $e=!1;if(Oe&&(A([Oe]),$e="@default"in Oe),oe=!1,0===ne.length&&$e)continue;if(ne.length>0&&ye)return!1;if(void 0===Oe){if(ne.length>0)return!1;me=!0}else if(j.isList(Oe)){const st=Oe["@list"][0];if(j.isList(ne[0])){const Qe=ne[0]["@list"];j.isValue(st)?me=Qe.some(tt=>K(st,tt)):(j.isSubject(st)||j.isSubjectReference(st))&&(me=Qe.some(tt=>O(E,st,tt,ae)))}}else me=j.isValue(Oe)?ne.some(st=>K(Oe,st)):j.isSubjectReference(Oe)?ne.some(st=>O(E,Oe,st,ae)):!!k.isObject(Oe)&&ne.length>0}}if(!me&&ae.requireAll)return!1;te=te||me}return oe||te}function X(E,$){const Z=E.uniqueEmbeds[E.graph],ae=Z[$],oe=ae.parent,te=ae.property,Te={"@id":$};if(k.isArray(oe)){for(let ne=0;ne<oe.length;++ne)if(Q.compareValues(oe[ne],Te)){oe[ne]=Te;break}}else{const ne=k.isArray(oe[te]);Q.removeValue(oe,te,Te,{propertyIsArray:ne}),Q.addValue(oe,te,Te,{propertyIsArray:ne})}const me=ne=>{const ye=Object.keys(Z);for(const Oe of ye)Oe in Z&&k.isObject(Z[Oe].parent)&&Z[Oe].parent["@id"]===ne&&(delete Z[Oe],me(Oe))};me($)}function ue(E,$){if(k.isArray(E))return E.map(Z=>ue(Z,$));if(k.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(j.isValue(E))return E;if(j.isList(E))return E["@list"]=ue(E["@list"],$),E;if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const ae=$.link[Z].indexOf(E);if(-1!==ae)return $.link[Z][ae];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)"@id"===Z&&$.bnodesToClear.includes(E[Z])?delete E["@id"]:E[Z]=ue(E[Z],$)}return E}function I(E,$,Z){k.isObject(E)?Q.addValue(E,$,Z,{propertyIsArray:!0}):E.push(Z)}function O(E,$,Z,ae){if(!("@id"in Z))return!1;const oe=E.subjects[Z["@id"]];return oe&&P(E,oe,$,ae)}function K(E,$){const Z=$["@value"],ae=$["@type"],oe=$["@language"],te=E["@value"]?k.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],Te=E["@type"]?k.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],me=E["@language"]?k.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===te.length&&0===Te.length&&0===me.length||!(!te.includes(Z)&&!k.isEmptyObject(te[0])||!(!ae&&0===Te.length||Te.includes(ae)||ae&&k.isEmptyObject(Te[0]))||!(!oe&&0===me.length||me.includes(oe)||oe&&k.isEmptyObject(me[0])))}Se.exports=T,T.frameMergedOrDefault=(E,$,Z)=>{const ae={options:Z,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},oe=new Q.IdentifierIssuer("_:b");C(E,ae.graphMap,"@default",oe),Z.merged&&(ae.graphMap["@merged"]=R(ae.graphMap),ae.graph="@merged"),ae.subjects=ae.graphMap[ae.graph];const te=[];return T.frame(ae,Object.keys(ae.subjects).sort(),$,te),Z.pruneBlankNodeIdentifiers&&(Z.bnodesToClear=Object.keys(ae.bnodeMap).filter(Te=>1===ae.bnodeMap[Te].length)),Z.link={},ue(te,Z)},T.frame=(E,$,Z,ae,oe=null)=>{A(Z);const te=E.options,Te={embed:S(Z=Z[0],te,"embed"),explicit:S(Z,te,"explicit"),requireAll:S(Z,te,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const me=E.link[E.graph],ne=function(E,$,Z,ae){const oe={};for(const te of $){const Te=E.graphMap[E.graph][te];P(E,Te,Z,ae)&&(oe[te]=Te)}return oe}(E,$,Z,Te),ye=Object.keys(ne).sort();for(const Oe of ye){const $e=ne[Oe];if(null===oe?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===Te.embed&&Oe in me){I(ae,oe,me[Oe]);continue}const st={"@id":Oe};if(0===Oe.indexOf("_:")&&Q.addValue(E.bnodeMap,Oe,st,{propertyIsArray:!0}),me[Oe]=st,("@first"===Te.embed||"@last"===Te.embed)&&E.is11)throw new w("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Z});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Oe)){if(E.embedded&&("@never"===Te.embed||y($e,E.graph,E.subjectStack))){I(ae,oe,st);continue}if(E.embedded&&("@first"==Te.embed||"@once"==Te.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Oe)){I(ae,oe,st);continue}if("@last"===Te.embed&&Oe in E.uniqueEmbeds[E.graph]&&X(E,Oe),E.uniqueEmbeds[E.graph][Oe]={parent:ae,property:oe},E.subjectStack.push({subject:$e,graph:E.graph}),Oe in E.graphMap){let Qe=!1,tt=null;"@graph"in Z?(tt=Z["@graph"][0],Qe=!("@merged"===Oe||"@default"===Oe),k.isObject(tt)||(tt={})):(Qe="@merged"!==E.graph,tt={}),Qe&&T.frame(Sn(ot({},E),{graph:Oe,embedded:!1}),Object.keys(E.graphMap[Oe]).sort(),[tt],st,"@graph")}"@included"in Z&&T.frame(Sn(ot({},E),{embedded:!1}),$,Z["@included"],st,"@included");for(const Qe of Object.keys($e).sort())if(W(Qe)){if(st[Qe]=Q.clone($e[Qe]),"@type"===Qe)for(const tt of $e["@type"])0===tt.indexOf("_:")&&Q.addValue(E.bnodeMap,tt,st,{propertyIsArray:!0})}else if(!Te.explicit||Qe in Z)for(const tt of $e[Qe]){const Xe=Qe in Z?Z[Qe]:b(Te);if(j.isList(tt)){const ze=Z[Qe]&&Z[Qe][0]&&Z[Qe][0]["@list"]?Z[Qe][0]["@list"]:b(Te),Le={"@list":[]};I(st,Qe,Le);const Ke=tt["@list"];for(const Me of Ke)j.isSubjectReference(Me)?T.frame(Sn(ot({},E),{embedded:!0}),[Me["@id"]],ze,Le,"@list"):I(Le,"@list",Q.clone(Me))}else j.isSubjectReference(tt)?T.frame(Sn(ot({},E),{embedded:!0}),[tt["@id"]],Xe,st,Qe):K(Xe[0],tt)&&I(st,Qe,Q.clone(tt))}for(const Qe of Object.keys(Z).sort()){if("@type"===Qe){if(!k.isObject(Z[Qe][0])||!("@default"in Z[Qe][0]))continue}else if(W(Qe))continue;const tt=Z[Qe][0]||{};if(!S(tt,te,"omitDefault")&&!(Qe in st)){let ze="@null";"@default"in tt&&(ze=Q.clone(tt["@default"])),k.isArray(ze)||(ze=[ze]),st[Qe]=[{"@preserve":ze}]}}for(const Qe of Object.keys(Z["@reverse"]||{}).sort()){const tt=Z["@reverse"][Qe];for(const Xe of Object.keys(E.subjects))Q.getValues(E.subjects[Xe],Qe).some(Le=>Le["@id"]===Oe)&&(st["@reverse"]=st["@reverse"]||{},Q.addValue(st["@reverse"],Qe,[],{propertyIsArray:!0}),T.frame(Sn(ot({},E),{embedded:!0}),[Xe],tt,st["@reverse"][Qe],oe))}I(ae,oe,st),E.subjectStack.pop()}}},T.cleanupNull=(E,$)=>{if(k.isArray(E))return E.map(ae=>T.cleanupNull(ae,$)).filter(ae=>ae);if("@null"===E)return null;if(k.isObject(E)){if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const ae=$.link[Z].indexOf(E);if(-1!==ae)return $.link[Z][ae];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)E[Z]=T.cleanupNull(E[Z],$)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),j=Y("./graphTypes"),k=Y("./types"),Q=Y("./util"),{RDF_LIST:H,RDF_FIRST:w,RDF_REST:C,RDF_NIL:R,RDF_TYPE:T,RDF_JSON_LITERAL:b,XSD_BOOLEAN:y,XSD_DOUBLE:S,XSD_INTEGER:A,XSD_STRING:z}=Y("./constants"),P=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,X={};function ue(I,O,K){if(I.termType.endsWith("Node"))return{"@id":I.value};const E={"@value":I.value};if(I.language)E["@language"]=I.language;else{let $=I.datatype.value;if($||($=z),$===b){$="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(Z){throw new W("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:Z})}}if(O){if($===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(k.isNumeric(E["@value"]))if($===A){const Z=parseInt(E["@value"],10);Z.toFixed(0)===E["@value"]&&(E["@value"]=Z)}else $===S&&(E["@value"]=parseFloat(E["@value"]));[y,A,S,z].includes($)||(E["@type"]=$)}else if("i18n-datatype"===K&&$.startsWith("https://www.w3.org/ns/i18n#")){const[,Z,ae]=$.split(/[#_]/);Z.length>0&&(E["@language"]=Z,Z.match(P)||console.warn(`@language must be valid BCP47: ${Z}`)),E["@direction"]=ae}else $!==z&&(E["@type"]=$)}return E}Se.exports=X,X.fromRDF=function(){var I=yt(function*(O,{useRdfType:K=!1,useNativeTypes:E=!1,rdfDirection:$=null}){const Z={},ae={"@default":Z},oe={};for(const me of O){const ne="DefaultGraph"===me.graph.termType?"@default":me.graph.value;ne in ae||(ae[ne]={}),"@default"!==ne&&!(ne in Z)&&(Z[ne]={"@id":ne});const ye=ae[ne],Oe=me.subject.value,$e=me.predicate.value,st=me.object;Oe in ye||(ye[Oe]={"@id":Oe});const Qe=ye[Oe],tt=st.termType.endsWith("Node");if(tt&&!(st.value in ye)&&(ye[st.value]={"@id":st.value}),$e===T&&!K&&tt){Q.addValue(Qe,"@type",st.value,{propertyIsArray:!0});continue}const Xe=ue(st,E,$);if(Q.addValue(Qe,$e,Xe,{propertyIsArray:!0}),tt)if(st.value===R){const ze=ye[st.value];"usages"in ze||(ze.usages=[]),ze.usages.push({node:Qe,property:$e,value:Xe})}else oe[st.value]=!(st.value in oe)&&{node:Qe,property:$e,value:Xe}}for(const me in ae){const ne=ae[me];if(!(R in ne))continue;const ye=ne[R];if(ye.usages){for(let Oe of ye.usages){let $e=Oe.node,st=Oe.property,Qe=Oe.value;const tt=[],Xe=[];let ze=Object.keys($e).length;for(;st===C&&k.isObject(oe[$e["@id"]])&&k.isArray($e[w])&&1===$e[w].length&&k.isArray($e[C])&&1===$e[C].length&&(3===ze||4===ze&&k.isArray($e["@type"])&&1===$e["@type"].length&&$e["@type"][0]===H)&&(tt.push($e[w][0]),Xe.push($e["@id"]),Oe=oe[$e["@id"]],$e=Oe.node,st=Oe.property,Qe=Oe.value,ze=Object.keys($e).length,j.isBlankNode($e)););delete Qe["@id"],Qe["@list"]=tt.reverse();for(const Le of Xe)delete ne[Le]}delete ye.usages}}const te=[],Te=Object.keys(Z).sort();for(const me of Te){const ne=Z[me];if(me in ae){const ye=ne["@graph"]=[],Oe=ae[me],$e=Object.keys(Oe).sort();for(const st of $e){const Qe=Oe[st];j.isSubjectReference(Qe)||ye.push(Qe)}}j.isSubjectReference(ne)||te.push(ne)}return te});return function(O,K){return I.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(Y,Se,he){"use strict";const W=Y("./types"),j={};Se.exports=j,j.isSubject=k=>!(!W.isObject(k)||"@value"in k||"@set"in k||"@list"in k)&&(Object.keys(k).length>1||!("@id"in k)),j.isSubjectReference=k=>W.isObject(k)&&1===Object.keys(k).length&&"@id"in k,j.isValue=k=>W.isObject(k)&&"@value"in k,j.isList=k=>W.isObject(k)&&"@list"in k,j.isGraph=k=>W.isObject(k)&&"@graph"in k&&1===Object.keys(k).filter(Q=>"@id"!==Q&&"@index"!==Q).length,j.isSimpleGraph=k=>j.isGraph(k)&&!("@id"in k),j.isBlankNode=k=>!!W.isObject(k)&&("@id"in k?0===k["@id"].indexOf("_:"):0===Object.keys(k).length||!("@value"in k||"@set"in k||"@list"in k))},{"./types":30}],26:[function(Y,Se,he){const W=Y("rdf-canonize"),j=Y("./platform"),k=Y("./util"),Q=Y("./ContextResolver"),H=k.IdentifierIssuer,w=Y("./JsonLdError"),C=Y("lru-cache"),R=Y("./NQuads"),{expand:T}=Y("./expand"),{flatten:b}=Y("./flatten"),{fromRDF:y}=Y("./fromRdf"),{toRDF:S}=Y("./toRdf"),{frameMergedOrDefault:A,cleanupNull:z}=Y("./frame"),{isArray:P,isObject:X,isString:ue}=Y("./types"),{isSubjectReference:I}=Y("./graphTypes"),{expandIri:O,getInitialContext:K,process:E,processingMode:$}=Y("./context"),{compact:Z,compactIri:ae}=Y("./compact"),{createNodeMap:oe,createMergedNodeMap:te,mergeNodeMaps:Te}=Y("./nodeMap"),me=function(ye){const Oe={},st=new C({max:100});function Qe(tt,Le){var Ke=Le,{documentLoader:Xe=ye.documentLoader}=Ke,ze=Nq(Ke,["documentLoader"]);return Object.assign({},{documentLoader:Xe},ze,tt)}return ye.compact=function(){var tt=yt(function*(Xe,ze,Le){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===ze)throw new w("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Xe)return null;let Ke;(Le=Qe(Le,{base:ue(Xe)?Xe:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new H("_:b"),contextResolver:new Q({sharedCache:st})})).link&&(Le.skipExpansion=!0),Le.compactToRelative||delete Le.base,Ke=Le.skipExpansion?Xe:yield ye.expand(Xe,Le);const Me=yield ye.processContext(K(Le),ze,Le);let Ue=yield Z({activeCtx:Me,element:Ke,options:Le,compactionMap:Le.compactionMap});Le.compactArrays&&!Le.graph&&P(Ue)?1===Ue.length?Ue=Ue[0]:0===Ue.length&&(Ue={}):Le.graph&&X(Ue)&&(Ue=[Ue]),X(ze)&&"@context"in ze&&(ze=ze["@context"]),ze=k.clone(ze),P(ze)||(ze=[ze]);const qe=ze;ze=[];for(let q=0;q<qe.length;++q)(!X(qe[q])||Object.keys(qe[q]).length>0)&&ze.push(qe[q]);const ke=ze.length>0;if(1===ze.length&&(ze=ze[0]),P(Ue)){const q=ae({activeCtx:Me,iri:"@graph",relativeTo:{vocab:!0}}),G=Ue;Ue={},ke&&(Ue["@context"]=ze),Ue[q]=G}else if(X(Ue)&&ke){const q=Ue;Ue={"@context":ze};for(const G in q)Ue[G]=q[G]}return Ue});return function(Xe,ze,Le){return tt.apply(this,arguments)}}(),ye.expand=function(){var tt=yt(function*(Xe,ze){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(ze=Qe(ze,{keepFreeFloatingNodes:!1,contextResolver:new Q({sharedCache:st})})).expansionMap&&(ze.expansionMap=void 0);const Le={},Ke=[];if("expandContext"in ze){const ke=k.clone(ze.expandContext);Le.expandContext=X(ke)&&"@context"in ke?ke:{"@context":ke},Ke.push(Le.expandContext)}let Me;if(ue(Xe)){const ke=yield ye.get(Xe,ze);Me=ke.documentUrl,Le.input=ke.document,ke.contextUrl&&(Le.remoteContext={"@context":ke.contextUrl},Ke.push(Le.remoteContext))}else Le.input=k.clone(Xe);"base"in ze||(ze.base=Me||"");let Ue=K(ze);for(const ke of Ke)Ue=yield E({activeCtx:Ue,localCtx:ke,options:ze});let qe=yield T({activeCtx:Ue,element:Le.input,options:ze,expansionMap:ze.expansionMap});return X(qe)&&"@graph"in qe&&1===Object.keys(qe).length?qe=qe["@graph"]:null===qe&&(qe=[]),P(qe)||(qe=[qe]),qe});return function(Xe,ze){return tt.apply(this,arguments)}}(),ye.flatten=function(){var tt=yt(function*(Xe,ze,Le){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");ze="function"==typeof ze?null:ze||null,Le=Qe(Le,{base:ue(Xe)?Xe:"",contextResolver:new Q({sharedCache:st})});const Ke=yield ye.expand(Xe,Le),Me=b(Ke);return null===ze?Me:(Le.graph=!0,Le.skipExpansion=!0,yield ye.compact(Me,ze,Le))});return function(Xe,ze,Le){return tt.apply(this,arguments)}}(),ye.frame=function(){var tt=yt(function*(Xe,ze,Le){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Le=Qe(Le,{base:ue(Xe)?Xe:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new Q({sharedCache:st})}),ue(ze)){const de=yield ye.get(ze,Le);if(ze=de.document,de.contextUrl){let je=ze["@context"];je?P(je)?je.push(de.contextUrl):je=[je,de.contextUrl]:je=de.contextUrl,ze["@context"]=je}}const Ke=ze&&ze["@context"]||{},Me=yield ye.processContext(K(Le),Ke,Le);Le.hasOwnProperty("omitGraph")||(Le.omitGraph=$(Me,1.1)),Le.hasOwnProperty("pruneBlankNodeIdentifiers")||(Le.pruneBlankNodeIdentifiers=$(Me,1.1));const Ue=yield ye.expand(Xe,Le),qe=ot({},Le);qe.isFrame=!0,qe.keepFreeFloatingNodes=!0;const ke=yield ye.expand(ze,qe),q=Object.keys(ze).map(de=>O(Me,de,{vocab:!0}));qe.merged=!q.includes("@graph"),qe.is11=$(Me,1.1);const G=A(Ue,ke,qe);qe.graph=!Le.omitGraph,qe.skipExpansion=!0,qe.link={},qe.framing=!0;let pe=yield ye.compact(G,Ke,qe);return qe.link={},pe=z(pe,qe),pe});return function(Xe,ze,Le){return tt.apply(this,arguments)}}(),ye.link=function(){var tt=yt(function*(Xe,ze,Le){const Ke={};return ze&&(Ke["@context"]=ze),Ke["@embed"]="@link",ye.frame(Xe,Ke,Le)});return function(Xe,ze,Le){return tt.apply(this,arguments)}}(),ye.normalize=ye.canonize=function(){var tt=yt(function*(Xe,ze){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(ze=Qe(ze,{base:ue(Xe)?Xe:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new Q({sharedCache:st})}))){if("application/n-quads"!==ze.inputFormat&&"application/nquads"!==ze.inputFormat)throw new w("Unknown canonicalization input format.","jsonld.CanonizeError");const Me=R.parse(Xe);return W.canonize(Me,ze)}const Le=ot({},ze);delete Le.format,Le.produceGeneralizedRdf=!1;const Ke=yield ye.toRDF(Xe,Le);return W.canonize(Ke,ze)});return function(Xe,ze){return tt.apply(this,arguments)}}(),ye.fromRDF=function(){var tt=yt(function*(Xe,ze){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");ze=Qe(ze,{format:ue(Xe)?"application/n-quads":void 0});const{format:Le}=ze;let{rdfParser:Ke}=ze;if(Le){if(Ke=Ke||Oe[Le],!Ke)throw new w("Unknown input format.","jsonld.UnknownFormat",{format:Le})}else Ke=()=>Xe;const Me=yield Ke(Xe);return y(Me,ze)});return function(Xe,ze){return tt.apply(this,arguments)}}(),ye.toRDF=function(){var tt=yt(function*(Xe,ze){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Le;Le=(ze=Qe(ze,{base:ue(Xe)?Xe:"",skipExpansion:!1,contextResolver:new Q({sharedCache:st})})).skipExpansion?Xe:yield ye.expand(Xe,ze);const Ke=S(Le,ze);if(ze.format){if("application/n-quads"===ze.format||"application/nquads"===ze.format)return R.serialize(Ke);throw new w("Unknown output format.","jsonld.UnknownFormat",{format:ze.format})}return Ke});return function(Xe,ze){return tt.apply(this,arguments)}}(),ye.createNodeMap=function(){var tt=yt(function*(Xe,ze){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");ze=Qe(ze,{base:ue(Xe)?Xe:"",contextResolver:new Q({sharedCache:st})});const Le=yield ye.expand(Xe,ze);return te(Le,ze)});return function(Xe,ze){return tt.apply(this,arguments)}}(),ye.merge=function(){var tt=yt(function*(Xe,ze,Le){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!P(Xe))throw new TypeError('Could not merge, "docs" must be an array.');ze="function"==typeof ze?null:ze||null,Le=Qe(Le,{contextResolver:new Q({sharedCache:st})});const Ke=yield Promise.all(Xe.map(de=>{const je=ot({},Le);return ye.expand(de,je)}));let Me=!0;"mergeNodes"in Le&&(Me=Le.mergeNodes);const Ue=Le.issuer||new H("_:b"),qe={"@default":{}};for(let de=0;de<Ke.length;++de){const je=k.relabelBlankNodes(Ke[de],{issuer:new H("_:b"+de+"-")}),_t=Me||0===de?qe:{"@default":{}};if(oe(je,_t,"@default",Ue),_t!==qe)for(const pt in _t){const we=_t[pt];if(!(pt in qe)){qe[pt]=we;continue}const B=qe[pt];for(const N in we)N in B||(B[N]=we[N])}}const ke=Te(qe),q=[],G=Object.keys(ke).sort();for(let de=0;de<G.length;++de){const je=ke[G[de]];I(je)||q.push(je)}return null===ze?q:(Le.graph=!0,Le.skipExpansion=!0,yield ye.compact(q,ze,Le))});return function(Xe,ze,Le){return tt.apply(this,arguments)}}(),Object.defineProperty(ye,"documentLoader",{get:()=>ye._documentLoader,set:tt=>ye._documentLoader=tt}),ye.documentLoader=function(){var tt=yt(function*(Xe){throw new w("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Xe})});return function(Xe){return tt.apply(this,arguments)}}(),ye.get=function(){var tt=yt(function*(Xe,ze){let Le;Le="function"==typeof ze.documentLoader?ze.documentLoader:ye.documentLoader;const Ke=yield Le(Xe);try{if(!Ke.document)throw new w("No remote document found at the given URL.","jsonld.NullRemoteDocument");ue(Ke.document)&&(Ke.document=JSON.parse(Ke.document))}catch(Me){throw new w("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Me,remoteDoc:Ke})}return Ke});return function(Xe,ze){return tt.apply(this,arguments)}}(),ye.processContext=function(){var tt=yt(function*(Xe,ze,Le){return Le=Qe(Le,{base:"",contextResolver:new Q({sharedCache:st})}),null===ze?K(Le):(ze=k.clone(ze),X(ze)&&"@context"in ze||(ze={"@context":ze}),E({activeCtx:Xe,localCtx:ze,options:Le}))});return function(Xe,ze,Le){return tt.apply(this,arguments)}}(),ye.getContextValue=Y("./context").getContextValue,ye.documentLoaders={},ye.useDocumentLoader=function(tt){if(!(tt in ye.documentLoaders))throw new w('Unknown document loader type: "'+tt+'"',"jsonld.UnknownDocumentLoader",{type:tt});ye.documentLoader=ye.documentLoaders[tt].apply(ye,Array.prototype.slice.call(arguments,1))},ye.registerRDFParser=function(tt,Xe){Oe[tt]=Xe},ye.unregisterRDFParser=function(tt){delete Oe[tt]},ye.registerRDFParser("application/n-quads",R.parse),ye.registerRDFParser("application/nquads",R.parse),ye.url=Y("./url"),ye.util=k,Object.assign(ye,k),ye.promises=ye,ye.RequestQueue=Y("./RequestQueue"),ye.JsonLdProcessor=Y("./JsonLdProcessor")(ye),j.setupGlobals(ye),j.setupDocumentLoaders(ye),ye},ne=function(){return me(function(){return ne()})};me(ne),Se.exports=ne},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(Y,Se,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),k=Y("./types"),Q=Y("./util"),H=Y("./JsonLdError"),w={};Se.exports=w,w.createMergedNodeMap=(C,R)=>{const T=(R=R||{}).issuer||new Q.IdentifierIssuer("_:b"),b={"@default":{}};return w.createNodeMap(C,b,"@default",T),w.mergeNodeMaps(b)},w.createNodeMap=(C,R,T,b,y,S)=>{if(k.isArray(C)){for(const X of C)w.createNodeMap(X,R,T,b,void 0,S);return}if(!k.isObject(C))return void(S&&S.push(C));if(j.isValue(C)){if("@type"in C){let X=C["@type"];0===X.indexOf("_:")&&(C["@type"]=X=b.getId(X))}return void(S&&S.push(C))}if(S&&j.isList(C)){const X=[];return w.createNodeMap(C["@list"],R,T,b,y,X),void S.push({"@list":X})}if("@type"in C){const X=C["@type"];for(const ue of X)0===ue.indexOf("_:")&&b.getId(ue)}k.isUndefined(y)&&(y=j.isBlankNode(C)?b.getId(C["@id"]):C["@id"]),S&&S.push({"@id":y});const A=R[T],z=A[y]=A[y]||{};z["@id"]=y;const P=Object.keys(C).sort();for(let X of P){if("@id"===X)continue;if("@reverse"===X){const I={"@id":y},O=C["@reverse"];for(const K in O){const E=O[K];for(const $ of E){let Z=$["@id"];j.isBlankNode($)&&(Z=b.getId(Z)),w.createNodeMap($,R,T,b,Z),Q.addValue(A[Z],K,I,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===X){y in R||(R[y]={}),w.createNodeMap(C[X],R,y,b);continue}if("@included"===X){w.createNodeMap(C[X],R,T,b);continue}if("@type"!==X&&W(X)){if("@index"===X&&X in z&&(C[X]!==z[X]||C[X]["@id"]!==z[X]["@id"]))throw new H("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:z});z[X]=C[X];continue}const ue=C[X];if(0===X.indexOf("_:")&&(X=b.getId(X)),0!==ue.length)for(let I of ue)if("@type"===X&&(I=0===I.indexOf("_:")?b.getId(I):I),j.isSubject(I)||j.isSubjectReference(I)){if("@id"in I&&!I["@id"])continue;const O=j.isBlankNode(I)?b.getId(I["@id"]):I["@id"];Q.addValue(z,X,{"@id":O},{propertyIsArray:!0,allowDuplicate:!1}),w.createNodeMap(I,R,T,b,O)}else if(j.isValue(I))Q.addValue(z,X,I,{propertyIsArray:!0,allowDuplicate:!1});else if(j.isList(I)){const O=[];w.createNodeMap(I["@list"],R,T,b,y,O),I={"@list":O},Q.addValue(z,X,I,{propertyIsArray:!0,allowDuplicate:!1})}else w.createNodeMap(I,R,T,b,y),Q.addValue(z,X,I,{propertyIsArray:!0,allowDuplicate:!1});else Q.addValue(z,X,[],{propertyIsArray:!0})}},w.mergeNodeMapGraphs=C=>{const R={};for(const T of Object.keys(C).sort())for(const b of Object.keys(C[T]).sort()){const y=C[T][b];b in R||(R[b]={"@id":b});const S=R[b];for(const A of Object.keys(y).sort())if(W(A)&&"@type"!==A)S[A]=Q.clone(y[A]);else for(const z of y[A])Q.addValue(S,A,Q.clone(z),{propertyIsArray:!0,allowDuplicate:!1})}return R},w.mergeNodeMaps=C=>{const R=C["@default"],T=Object.keys(C).sort();for(const b of T){if("@default"===b)continue;const y=C[b];let S=R[b];S?"@graph"in S||(S["@graph"]=[]):R[b]=S={"@id":b,"@graph":[]};const A=S["@graph"];for(const z of Object.keys(y).sort()){const P=y[z];j.isSubjectReference(P)||A.push(P)}}return R}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(Y,Se,he){"use strict";const W=Y("./documentLoaders/xhr"),j={};Se.exports=j,j.setupDocumentLoaders=function(k){"undefined"!=typeof XMLHttpRequest&&(k.documentLoaders.xhr=W,k.useDocumentLoader("xhr"))},j.setupGlobals=function(k){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:k.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(Y,Se,he){"use strict";const{createNodeMap:W}=Y("./nodeMap"),{isKeyword:j}=Y("./context"),k=Y("./graphTypes"),Q=Y("canonicalize"),H=Y("./types"),w=Y("./util"),{RDF_FIRST:C,RDF_REST:R,RDF_NIL:T,RDF_TYPE:b,RDF_JSON_LITERAL:y,RDF_LANGSTRING:S,XSD_BOOLEAN:A,XSD_DOUBLE:z,XSD_INTEGER:P,XSD_STRING:X}=Y("./constants"),{isAbsolute:ue}=Y("./url"),I={};function O($,Z,ae,oe,te){const Te=Object.keys(Z).sort();for(const me of Te){const ne=Z[me],ye=Object.keys(ne).sort();for(let Oe of ye){const $e=ne[Oe];if("@type"===Oe)Oe=b;else if(j(Oe))continue;for(const st of $e){const Qe={termType:me.startsWith("_:")?"BlankNode":"NamedNode",value:me};if(!ue(me))continue;const tt={termType:Oe.startsWith("_:")?"BlankNode":"NamedNode",value:Oe};if(!ue(Oe)||"BlankNode"===tt.termType&&!te.produceGeneralizedRdf)continue;const Xe=E(st,oe,$,ae,te.rdfDirection);Xe&&$.push({subject:Qe,predicate:tt,object:Xe,graph:ae})}}}}function E($,Z,ae,oe,te){const Te={};if(k.isValue($)){Te.termType="Literal",Te.value=void 0,Te.datatype={termType:"NamedNode"};let me=$["@value"];const ne=$["@type"]||null;"@json"===ne?(Te.value=Q(me),Te.datatype.value=y):H.isBoolean(me)?(Te.value=me.toString(),Te.datatype.value=ne||A):H.isDouble(me)||ne===z?(H.isDouble(me)||(me=parseFloat(me)),Te.value=me.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Te.datatype.value=ne||z):H.isNumber(me)?(Te.value=me.toFixed(0),Te.datatype.value=ne||P):"i18n-datatype"===te&&"@direction"in $?(Te.datatype.value="https://www.w3.org/ns/i18n#"+($["@language"]||"")+`_${$["@direction"]}`,Te.value=me):"@language"in $?(Te.value=me,Te.datatype.value=ne||S,Te.language=$["@language"]):(Te.value=me,Te.datatype.value=ne||X)}else if(k.isList($)){const me=function($,Z,ae,oe,te){const Te={termType:"NamedNode",value:C},me={termType:"NamedNode",value:R},ne={termType:"NamedNode",value:T},ye=$.pop(),Oe=ye?{termType:"BlankNode",value:Z.getId()}:ne;let $e=Oe;for(const st of $){const Qe=E(st,Z,ae,oe,te),tt={termType:"BlankNode",value:Z.getId()};ae.push({subject:$e,predicate:Te,object:Qe,graph:oe}),ae.push({subject:$e,predicate:me,object:tt,graph:oe}),$e=tt}if(ye){const st=E(ye,Z,ae,oe,te);ae.push({subject:$e,predicate:Te,object:st,graph:oe}),ae.push({subject:$e,predicate:me,object:ne,graph:oe})}return Oe}($["@list"],Z,ae,oe,te);Te.termType=me.termType,Te.value=me.value}else{const me=H.isObject($)?$["@id"]:$;Te.termType=me.startsWith("_:")?"BlankNode":"NamedNode",Te.value=me}return"NamedNode"!==Te.termType||ue(Te.value)?Te:null}Se.exports=I,I.toRDF=($,Z)=>{const ae=new w.IdentifierIssuer("_:b"),oe={"@default":{}};W($,oe,"@default",ae);const te=[],Te=Object.keys(oe).sort();for(const me of Te){let ne;if("@default"===me)ne={termType:"DefaultGraph",value:""};else{if(!ue(me))continue;ne=me.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},ne.value=me}O(te,oe[me],ne,ae,Z)}return te}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(Y,Se,he){"use strict";const W={};Se.exports=W,W.isArray=Array.isArray,W.isBoolean=j=>"boolean"==typeof j||"[object Boolean]"===Object.prototype.toString.call(j),W.isDouble=j=>W.isNumber(j)&&(-1!==String(j).indexOf(".")||Math.abs(j)>=1e21),W.isEmptyObject=j=>W.isObject(j)&&0===Object.keys(j).length,W.isNumber=j=>"number"==typeof j||"[object Number]"===Object.prototype.toString.call(j),W.isNumeric=j=>!isNaN(parseFloat(j))&&isFinite(j),W.isObject=j=>"[object Object]"===Object.prototype.toString.call(j),W.isString=j=>"string"==typeof j||"[object String]"===Object.prototype.toString.call(j),W.isUndefined=j=>void 0===j},{}],31:[function(Y,Se,he){"use strict";const W=Y("./types"),j={};Se.exports=j,j.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},j.parse=(Q,H)=>{const w={},C=j.parsers[H||"full"],R=C.regex.exec(Q);let T=C.keys.length;for(;T--;)w[C.keys[T]]=void 0===R[T]?null:R[T];return("https"===w.scheme&&"443"===w.port||"http"===w.scheme&&"80"===w.port)&&(w.href=w.href.replace(":"+w.port,""),w.authority=w.authority.replace(":"+w.port,""),w.port=null),w.normalizedPath=j.removeDotSegments(w.path),w},j.prependBase=(Q,H)=>{if(null===Q||j.isAbsolute(H))return H;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));const w=j.parse(H),C={protocol:Q.protocol||""};if(null!==w.authority)C.authority=w.authority,C.path=w.path,C.query=w.query;else if(C.authority=Q.authority,""===w.path)C.path=Q.path,C.query=null!==w.query?w.query:Q.query;else{if(0===w.path.indexOf("/"))C.path=w.path;else{let T=Q.path;T=T.substr(0,T.lastIndexOf("/")+1),(T.length>0||Q.authority)&&"/"!==T.substr(-1)&&(T+="/"),T+=w.path,C.path=T}C.query=w.query}""!==w.path&&(C.path=j.removeDotSegments(C.path));let R=C.protocol;return null!==C.authority&&(R+="//"+C.authority),R+=C.path,null!==C.query&&(R+="?"+C.query),null!==w.fragment&&(R+="#"+w.fragment),""===R&&(R="./"),R},j.removeBase=(Q,H)=>{if(null===Q)return H;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));let w="";if(""!==Q.href?w+=(Q.protocol||"")+"//"+(Q.authority||""):H.indexOf("//")&&(w+="//"),0!==H.indexOf(w))return H;const C=j.parse(H.substr(w.length)),R=Q.normalizedPath.split("/"),T=C.normalizedPath.split("/"),b=C.fragment||C.query?0:1;for(;R.length>0&&T.length>b&&R[0]===T[0];)R.shift(),T.shift();let y="";if(R.length>0){R.pop();for(let S=0;S<R.length;++S)y+="../"}return y+=T.join("/"),null!==C.query&&(y+="?"+C.query),null!==C.fragment&&(y+="#"+C.fragment),""===y&&(y="./"),y},j.removeDotSegments=Q=>{if(0===Q.length)return"";const H=Q.split("/"),w=[];for(;H.length>0;){const C=H.shift(),R=0===H.length;"."!==C?".."!==C?w.push(C):(w.pop(),R&&w.push("")):R&&w.push("")}return"/"===Q[0]&&w.length>0&&""!==w[0]&&w.unshift(""),1===w.length&&""===w[0]?"/":w.join("/")};const k=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;j.isAbsolute=Q=>W.isString(Q)&&k.test(Q),j.isRelative=Q=>W.isString(Q)},{"./types":30}],32:[function(Y,Se,he){"use strict";const W=Y("./graphTypes"),j=Y("./types"),k=Y("rdf-canonize").IdentifierIssuer,Q=Y("./JsonLdError"),H=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,w=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,C=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,R_headers={accept:"application/ld+json, application/json"},T={};function b(y,S){if(j.isArray(S))for(let A=0;A<S.length;++A)S[A]=b(y,S[A]);else if(W.isList(S))S["@list"]=b(y,S["@list"]);else if(j.isObject(S)){W.isBlankNode(S)&&(S["@id"]=y.getId(S["@id"]));const A=Object.keys(S).sort();for(let z=0;z<A.length;++z){const P=A[z];"@id"!==P&&(S[P]=b(y,S[P]))}}return S}Se.exports=T,T.IdentifierIssuer=k,T.clone=function(y){if(y&&"object"==typeof y){let S;if(j.isArray(y)){S=[];for(let A=0;A<y.length;++A)S[A]=T.clone(y[A])}else if(y instanceof Map){S=new Map;for(const[A,z]of y)S.set(A,T.clone(z))}else if(y instanceof Set){S=new Set;for(const A of y)S.add(T.clone(A))}else if(j.isObject(y)){S={};for(const A in y)S[A]=T.clone(y[A])}else S=y.toString();return S}return y},T.asArray=function(y){return Array.isArray(y)?y:[y]},T.buildHeaders=(y={})=>{if(Object.keys(y).some(A=>"accept"===A.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+R_headers.accept+'" is supported.');return Object.assign({Accept:R_headers.accept},y)},T.parseLinkHeader=y=>{const S={},A=y.match(H);for(let z=0;z<A.length;++z){let P=A[z].match(w);if(!P)continue;const X={target:P[1]},ue=P[2];for(;P=C.exec(ue);)X[P[1]]=void 0===P[2]?P[3]:P[2];const I=X.rel||"";Array.isArray(S[I])?S[I].push(X):S[I]=S.hasOwnProperty(I)?[S[I],X]:X}return S},T.validateTypeValue=(y,S)=>{if(!(j.isString(y)||j.isArray(y)&&y.every(A=>j.isString(A)))){if(S&&j.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&T.asArray(y["@default"]).every(A=>j.isString(A)))return}throw new Q('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},T.hasProperty=(y,S)=>{if(y.hasOwnProperty(S)){const A=y[S];return!j.isArray(A)||A.length>0}return!1},T.hasValue=(y,S,A)=>{if(T.hasProperty(y,S)){let z=y[S];const P=W.isList(z);if(j.isArray(z)||P){P&&(z=z["@list"]);for(let X=0;X<z.length;++X)if(T.compareValues(A,z[X]))return!0}else if(!j.isArray(A))return T.compareValues(A,z)}return!1},T.addValue=(y,S,A,z)=>{if("propertyIsArray"in(z=z||{})||(z.propertyIsArray=!1),"valueIsArray"in z||(z.valueIsArray=!1),"allowDuplicate"in z||(z.allowDuplicate=!0),"prependValue"in z||(z.prependValue=!1),z.valueIsArray)y[S]=A;else if(j.isArray(A)){0===A.length&&z.propertyIsArray&&!y.hasOwnProperty(S)&&(y[S]=[]),z.prependValue&&(A=A.concat(y[S]),y[S]=[]);for(let P=0;P<A.length;++P)T.addValue(y,S,A[P],z)}else if(y.hasOwnProperty(S)){const P=!z.allowDuplicate&&T.hasValue(y,S,A);!j.isArray(y[S])&&(!P||z.propertyIsArray)&&(y[S]=[y[S]]),P||(z.prependValue?y[S].unshift(A):y[S].push(A))}else y[S]=z.propertyIsArray?[A]:A},T.getValues=(y,S)=>[].concat(y[S]||[]),T.removeProperty=(y,S)=>{delete y[S]},T.removeValue=(y,S,A,z)=>{"propertyIsArray"in(z=z||{})||(z.propertyIsArray=!1);const P=T.getValues(y,S).filter(X=>!T.compareValues(X,A));0===P.length?T.removeProperty(y,S):y[S]=1!==P.length||z.propertyIsArray?P:P[0]},T.relabelBlankNodes=(y,S)=>b((S=S||{}).issuer||new k("_:b"),y),T.compareValues=(y,S)=>!!(y===S||W.isValue(y)&&W.isValue(S)&&y["@value"]===S["@value"]&&y["@type"]===S["@type"]&&y["@language"]===S["@language"]&&y["@index"]===S["@index"])||!!(j.isObject(y)&&"@id"in y&&j.isObject(S)&&"@id"in S)&&y["@id"]===S["@id"],T.compareShortestLeast=(y,S)=>y.length<S.length?-1:S.length<y.length?1:y===S?0:y<S?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(Y,Se,he){"use strict";const W=Y("yallist"),j=Symbol("max"),k=Symbol("length"),Q=Symbol("lengthCalculator"),H=Symbol("allowStale"),w=Symbol("maxAge"),C=Symbol("dispose"),R=Symbol("noDisposeOnSet"),T=Symbol("lruList"),b=Symbol("cache"),y=Symbol("updateAgeOnGet"),S=()=>1;const z=(K,E,$)=>{const Z=K[b].get(E);if(Z){const ae=Z.value;if(P(K,ae)){if(ue(K,Z),!K[H])return}else $&&(K[y]&&(Z.value.now=Date.now()),K[T].unshiftNode(Z));return ae.value}},P=(K,E)=>{if(!E||!E.maxAge&&!K[w])return!1;const $=Date.now()-E.now;return E.maxAge?$>E.maxAge:K[w]&&$>K[w]},X=K=>{if(K[k]>K[j])for(let E=K[T].tail;K[k]>K[j]&&null!==E;){const $=E.prev;ue(K,E),E=$}},ue=(K,E)=>{if(E){const $=E.value;K[C]&&K[C]($.key,$.value),K[k]-=$.length,K[b].delete($.key),K[T].removeNode(E)}};class I{constructor(E,$,Z,ae,oe){this.key=E,this.value=$,this.length=Z,this.now=ae,this.maxAge=oe||0}}const O=(K,E,$,Z)=>{let ae=$.value;P(K,ae)&&(ue(K,$),K[H]||(ae=void 0)),ae&&E.call(Z,ae.value,ae.key,K)};Se.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[j]=E.max||1/0;const Z=E.length||S;if(this[Q]="function"!=typeof Z?S:Z,this[H]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[w]=E.maxAge||0,this[C]=E.dispose,this[R]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[j]=E||1/0,X(this)}get max(){return this[j]}set allowStale(E){this[H]=!!E}get allowStale(){return this[H]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[w]=E,X(this)}get maxAge(){return this[w]}set lengthCalculator(E){"function"!=typeof E&&(E=S),E!==this[Q]&&(this[Q]=E,this[k]=0,this[T].forEach($=>{$.length=this[Q]($.value,$.key),this[k]+=$.length})),X(this)}get lengthCalculator(){return this[Q]}get length(){return this[k]}get itemCount(){return this[T].length}rforEach(E,$){$=$||this;for(let Z=this[T].tail;null!==Z;){const ae=Z.prev;O(this,E,Z,$),Z=ae}}forEach(E,$){$=$||this;for(let Z=this[T].head;null!==Z;){const ae=Z.next;O(this,E,Z,$),Z=ae}}keys(){return this[T].toArray().map(E=>E.key)}values(){return this[T].toArray().map(E=>E.value)}reset(){this[C]&&this[T]&&this[T].length&&this[T].forEach(E=>this[C](E.key,E.value)),this[b]=new Map,this[T]=new W,this[k]=0}dump(){return this[T].map(E=>!P(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[T]}set(E,$,Z){if((Z=Z||this[w])&&"number"!=typeof Z)throw new TypeError("maxAge must be a number");const ae=Z?Date.now():0,oe=this[Q]($,E);if(this[b].has(E)){if(oe>this[j])return ue(this,this[b].get(E)),!1;const me=this[b].get(E).value;return this[C]&&(this[R]||this[C](E,me.value)),me.now=ae,me.maxAge=Z,me.value=$,this[k]+=oe-me.length,me.length=oe,this.get(E),X(this),!0}const te=new I(E,$,oe,ae,Z);return te.length>this[j]?(this[C]&&this[C](E,$),!1):(this[k]+=te.length,this[T].unshift(te),this[b].set(E,this[T].head),X(this),!0)}has(E){if(!this[b].has(E))return!1;const $=this[b].get(E).value;return!P(this,$)}get(E){return z(this,E,!0)}peek(E){return z(this,E,!1)}pop(){const E=this[T].tail;return E?(ue(this,E),E.value):null}del(E){ue(this,this[b].get(E))}load(E){this.reset();const $=Date.now();for(let Z=E.length-1;Z>=0;Z--){const ae=E[Z],oe=ae.e||0;if(0===oe)this.set(ae.k,ae.v);else{const te=oe-$;te>0&&this.set(ae.k,ae.v,te)}}}prune(){this[b].forEach((E,$)=>z(this,$,!1))}}},{yallist:92}],34:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#",k="http://www.w3.org/2000/10/swap/";he.default={xsd:{decimal:`${j}decimal`,boolean:`${j}boolean`,double:`${j}double`,integer:`${j}integer`,string:`${j}string`},rdf:{type:`${W}type`,nil:`${W}nil`,first:`${W}first`,rest:`${W}rest`,langString:`${W}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${k}reify#forSome`,forAll:`${k}reify#forAll`},log:{implies:`${k}log#implies`}}},{}],35:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=he.Variable=he.Triple=he.Term=he.Quad=he.NamedNode=he.Literal=he.DefaultGraph=he.BlankNode=void 0,he.escapeQuotes=E,he.termFromId=function I(ne,ye){if(ye=ye||b,!ne)return ye.defaultGraph();switch(ne[0]){case"?":return ye.variable(ne.substr(1));case"_":return ye.blankNode(ne.substr(2));case'"':if(ye===b)return new z(ne);if('"'===ne[ne.length-1])return ye.literal(ne.substr(1,ne.length-2));const Oe=ne.lastIndexOf('"',ne.length-1);return ye.literal(ne.substr(1,Oe-1),"@"===ne[Oe+1]?ne.substr(Oe+2):ye.namedNode(ne.substr(Oe+3)));case"<":const $e=T.exec(ne);return ye.quad(I($($e[1]),ye),I($($e[2]),ye),I($($e[3]),ye),$e[4]&&I($($e[4]),ye));default:return ye.namedNode(ne)}},he.termToId=function O(ne){if("string"==typeof ne)return ne;if(ne instanceof S&&"Quad"!==ne.termType)return ne.id;if(!ne)return w.id;switch(ne.termType){case"NamedNode":return ne.value;case"BlankNode":return`_:${ne.value}`;case"Variable":return`?${ne.value}`;case"DefaultGraph":return"";case"Literal":return`"${ne.value}"${ne.language?`@${ne.language}`:ne.datatype&&ne.datatype.value!==H.string?`^^${ne.datatype.value}`:""}`;case"Quad":return`<<${E(O(ne.subject))} ${E(O(ne.predicate))} ${E(O(ne.object))}${(0,j.isDefaultGraph)(ne.graph)?"":` ${O(ne.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${ne.termType}`)}},he.unescapeQuotes=$;var ne,W=(ne=Y("./IRIs"))&&ne.__esModule?ne:{default:ne},j=Y("./N3Util");const{rdf:Q,xsd:H}=W.default;let w,C=0;const R=/^"(.*".*)(?="[^"]*$)/,T=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,b={namedNode:function(ne){return new A(ne)},blankNode:function(ne){return new P(ne||"n3-"+C++)},variable:function(ne){return new X(ne)},literal:function(ne,ye){if("string"==typeof ye)return new z(`"${ne}"@${ye.toLowerCase()}`);let Oe=ye?ye.value:"";return""===Oe&&("boolean"==typeof ne?Oe=H.boolean:"number"==typeof ne&&(Number.isFinite(ne)?Oe=Number.isInteger(ne)?H.integer:H.double:(Oe=H.double,Number.isNaN(ne)||(ne=ne>0?"INF":"-INF")))),new z(""===Oe||Oe===H.string?`"${ne}"`:`"${ne}"^^${Oe}`)},defaultGraph:function(){return w},quad:me,triple:me};he.default=b;class S{constructor(ye){this.id=ye}get value(){return this.id}equals(ye){return ye instanceof S?this.id===ye.id:!!ye&&this.termType===ye.termType&&this.value===ye.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}he.Term=S;class A extends S{get termType(){return"NamedNode"}}he.NamedNode=A;class z extends S{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const ye=this.id;let Oe=ye.lastIndexOf('"')+1;return Oe<ye.length&&"@"===ye[Oe++]?ye.substr(Oe).toLowerCase():""}get datatype(){return new A(this.datatypeString)}get datatypeString(){const ye=this.id,Oe=ye.lastIndexOf('"')+1,$e=Oe<ye.length?ye[Oe]:"";return"^"===$e?ye.substr(Oe+2):"@"!==$e?H.string:Q.langString}equals(ye){return ye instanceof z?this.id===ye.id:!!ye&&!!ye.datatype&&this.termType===ye.termType&&this.value===ye.value&&this.language===ye.language&&this.datatype.value===ye.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}he.Literal=z;class P extends S{constructor(ye){super(`_:${ye}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}he.BlankNode=P;class X extends S{constructor(ye){super(`?${ye}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}he.Variable=X;class ue extends S{constructor(){return super(""),w||this}get termType(){return"DefaultGraph"}equals(ye){return this===ye||!!ye&&this.termType===ye.termType}}he.DefaultGraph=ue,w=new ue;class K extends S{constructor(ye,Oe,$e,st){super(""),this._subject=ye,this._predicate=Oe,this._object=$e,this._graph=st||w}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(ye){return!!ye&&this._subject.equals(ye.subject)&&this._predicate.equals(ye.predicate)&&this._object.equals(ye.object)&&this._graph.equals(ye.graph)}}function E(ne){return ne.replace(R,(ye,Oe)=>`"${Oe.replace(/"/g,'""')}`)}function $(ne){return ne.replace(R,(ye,Oe)=>`"${Oe.replace(/""/g,'"')}`)}function me(ne,ye,Oe,$e){return new K(ne,ye,Oe,$e)}he.Triple=he.Quad=K},{"./IRIs":34,"./N3Util":41}],36:[function(Y,Se,he){(function(W){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var j=Q(Y("./IRIs")),k=Q(Y("queue-microtask"));function Q(S){return S&&S.__esModule?S:{default:S}}const{xsd:H}=j.default,w=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,C={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},R=/[\x00-\x20<>\\"\{\}\|\^\`]/,T={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},b=/$0^/;he.default=class{constructor(A){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(A=A||{}).lineMode){this._n3Mode=!1;for(const z in this)!(z in T)&&this[z]instanceof RegExp&&(this[z]=b)}else this._n3Mode=!1!==A.n3;this._comments=!!A.comments,this._literalClosingPos=0}_tokenizeToEnd(A,z){let P=this._input,X=P.length;for(;;){let O,K;for(;O=this._newline.exec(P);)this._comments&&(K=this._comment.exec(O[0]))&&ue("comment",K[1],"",this._line,O[0].length),P=P.substr(O[0].length,P.length),X=P.length,this._line++;if(!O&&(O=this._whitespace.exec(P))&&(P=P.substr(O[0].length,P.length)),this._endOfFile.test(P))return z&&(this._comments&&(K=this._comment.exec(P))&&ue("comment",K[1],"",this._line,P.length),P=null,ue("eof","","",this._line,0)),this._input=P;const E=this._line,$=P[0];let Z="",ae="",oe="",te=null,Te=0,me=!1;switch($){case"^":if(P.length<3)break;if("^"!==P[1]){this._n3Mode&&(Te=1,Z="^");break}if(this._previousMarker="^^",P=P.substr(2),"<"!==P[0]){me=!0;break}case"<":if(te=this._unescapedIri.exec(P))Z="IRI",ae=te[1];else if(te=this._iri.exec(P)){if(ae=this._unescape(te[1]),null===ae||R.test(ae))return I(this);Z="IRI"}else P.length>1&&"<"===P[1]?(Z="<<",Te=2):this._n3Mode&&P.length>1&&"="===P[1]&&(Z="inverse",Te=2,ae=">");break;case">":P.length>1&&">"===P[1]&&(Z=">>",Te=2);break;case"_":((te=this._blank.exec(P))||z&&(te=this._blank.exec(`${P} `)))&&(Z="blank",oe="_",ae=te[1]);break;case'"':if(te=this._simpleQuotedString.exec(P))ae=te[1];else if(({value:ae,matchLength:Te}=this._parseLiteral(P)),null===ae)return I(this);(null!==te||0!==Te)&&(Z="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(te=this._simpleApostropheString.exec(P))ae=te[1];else if(({value:ae,matchLength:Te}=this._parseLiteral(P)),null===ae)return I(this);(null!==te||0!==Te)&&(Z="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(te=this._variable.exec(P))&&(Z="var",ae=te[0]);break;case"@":"literal"===this._previousMarker&&(te=this._langcode.exec(P))?(Z="langcode",ae=te[1]):(te=this._keyword.exec(P))&&(Z=te[0]);break;case".":if(1===P.length?z:P[1]<"0"||P[1]>"9"){Z=".",Te=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(te=this._number.exec(P)||z&&(te=this._number.exec(`${P} `)))&&(Z="literal",ae=te[0],oe="string"==typeof te[1]?H.double:"string"==typeof te[2]?H.decimal:H.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(te=this._sparqlKeyword.exec(P))?Z=te[0].toUpperCase():me=!0;break;case"f":case"t":(te=this._boolean.exec(P))?(Z="literal",ae=te[0],oe=H.boolean):me=!0;break;case"a":(te=this._shortPredicates.exec(P))?(Z="abbreviation",ae="a"):me=!0;break;case"=":this._n3Mode&&P.length>1&&(Z="abbreviation",">"!==P[1]?(Te=1,ae="="):(Te=2,ae=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(Te=1,Z=$);break;default:me=!0}if(me&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(te=this._prefix.exec(P))?((te=this._prefixed.exec(P))||z&&(te=this._prefixed.exec(`${P} `)))&&(Z="prefixed",oe=te[1]||"",ae=this._unescape(te[2])):(Z="prefix",ae=te[1]||"")),"^^"===this._previousMarker)switch(Z){case"prefixed":Z="type";break;case"IRI":Z="typeIRI";break;default:Z=""}if(!Z)return z||!/^'''|^"""/.test(P)&&/\n|\r/.test(P)?I(this):this._input=P;const ne=Te||te[0].length,ye=ue(Z,ae,oe,E,ne);this.previousToken=ye,this._previousMarker=Z,P=P.substr(ne,P.length)}function ue(O,K,E,$,Z){const ae=P?X-P.length:X,te={type:O,value:K,prefix:E,line:$,start:ae,end:ae+Z};return A(null,te),te}function I(O){A(O._syntaxError(/^\S*/.exec(P)[0]))}}_unescape(A){let z=!1;const P=A.replace(w,(X,ue,I,O)=>{if("string"==typeof ue)return String.fromCharCode(Number.parseInt(ue,16));if("string"==typeof I){let K=Number.parseInt(I,16);return K<=65535?String.fromCharCode(Number.parseInt(I,16)):String.fromCharCode(55296+((K-=65536)>>10),56320+(1023&K))}return O in C?C[O]:(z=!0,"")});return z?null:P}_parseLiteral(A){if(A.length>=3){const z=A.match(/^(?:"""|"|'''|'|)/)[0],P=z.length;let X=Math.max(this._literalClosingPos,P);for(;(X=A.indexOf(z,X))>0;){let ue=0;for(;"\\"===A[X-ue-1];)ue++;if(ue%2==0){const I=A.substring(P,X),O=I.split(/\r\n|\r|\n/).length-1,K=X+P;if(1===P&&0!==O||3===P&&this._lineMode)break;return this._line+=O,{value:this._unescape(I),matchLength:K}}X++}this._literalClosingPos=A.length-P+1}return{value:"",matchLength:0}}_syntaxError(A){this._input=null;const z=new Error(`Unexpected "${A}" on line ${this._line}.`);return z.context={token:void 0,line:this._line,previousToken:this.previousToken},z}_readStartingBom(A){return A.startsWith("\ufeff")?A.substr(1):A}tokenize(A,z){if(this._line=1,"string"==typeof A){if(this._input=this._readStartingBom(A),"function"!=typeof z){const P=[];let X;if(this._tokenizeToEnd((ue,I)=>ue?X=ue:P.push(I),!0),X)throw X;return P}(0,k.default)(()=>this._tokenizeToEnd(z,!0))}else this._pendingBuffer=null,"function"==typeof A.setEncoding&&A.setEncoding("utf8"),A.on("data",P=>{null!==this._input&&0!==P.length&&(this._pendingBuffer&&(P=W.concat([this._pendingBuffer,P]),this._pendingBuffer=null),128&P[P.length-1]?this._pendingBuffer=P:(void 0===this._input?this._input=this._readStartingBom("string"==typeof P?P:P.toString()):this._input+=P,this._tokenizeToEnd(z,!1)))}),A.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(z,!0)}),A.on("error",z)}}}).call(this)}).call(this,Y("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var W=Q(Y("./N3Lexer")),j=Q(Y("./N3DataFactory")),k=Q(Y("./IRIs"));function Q(T){return T&&T.__esModule?T:{default:T}}let H=0;class w{constructor(b){this._contextStack=[],this._graph=null,this._setBase((b=b||{}).baseIRI),b.factory&&R(this,b.factory);const y="string"==typeof b.format?b.format.match(/\w*$/)[0].toLowerCase():"",S=/turtle/.test(y),A=/trig/.test(y),z=/triple/.test(y),P=/quad/.test(y),X=this._n3Mode=/n3/.test(y),ue=z||P;(this._supportsNamedGraphs=!(S||X))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(S||A||z||X),this._supportsRDFStar=""===y||/star|\*$/.test(y),ue&&(this._resolveRelativeIRI=I=>null),this._blankNodePrefix="string"!=typeof b.blankNodePrefix?"":b.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=b.lexer||new W.default({lineMode:ue,n3:X}),this._explicitQuantifiers=!!b.explicitQuantifiers}static _resetBlankNodePrefix(){H=0}_setBase(b){if(b){const y=b.indexOf("#");y>=0&&(b=b.substr(0,y)),this._base=b,this._basePath=b.indexOf("/")<0?b:b.replace(/[^\/?]*(?:\?.*)?$/,""),b=b.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=b[0],this._baseScheme=b[1]}else this._base="",this._basePath=""}_saveContext(b,y,S,A,z){const P=this._n3Mode;this._contextStack.push({subject:S,predicate:A,object:z,graph:y,type:b,inverse:!!P&&this._inversePredicate,blankPrefix:P?this._prefixes._:"",quantified:P?this._quantified:null}),P&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const b=this._contextStack.pop(),y=this._n3Mode;this._subject=b.subject,this._predicate=b.predicate,this._object=b.object,this._graph=b.graph,y&&(this._inversePredicate=b.inverse,this._prefixes._=b.blankPrefix,this._quantified=b.quantified)}_readInTopContext(b){switch(b.type){case"eof":return null!==this._graph?this._error("Unclosed graph",b):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(b)}}_readEntity(b,y){let S;switch(b.type){case"IRI":case"typeIRI":const A=this._resolveIRI(b.value);if(null===A)return this._error("Invalid IRI",b);S=this._namedNode(A);break;case"type":case"prefixed":const z=this._prefixes[b.prefix];if(void 0===z)return this._error(`Undefined prefix "${b.prefix}:"`,b);S=this._namedNode(z+b.value);break;case"blank":S=this._blankNode(this._prefixes[b.prefix]+b.value);break;case"var":S=this._variable(b.value.substr(1));break;default:return this._error(`Expected entity but got ${b.type}`,b)}return!y&&this._n3Mode&&S.id in this._quantified&&(S=this._quantified[S.id]),S}_readSubject(b){switch(this._predicate=null,b.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",b);case"}":return this._readPunctuation(b);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',b);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',b);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",b);if(0===b.prefix.length)return this._literalValue=b.value,this._completeSubjectLiteral;this._subject=this._literal(b.value,this._namedNode(b.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._subject=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(b){const y=b.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[b.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,b):(this._subject=null,"]"===y?this._readBlankNodeTail(b):this._readPunctuation(b));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",b);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",b);default:if(void 0===(this._predicate=this._readEntity(b)))return}return this._readObject}_readObject(b){switch(b.type){case"literal":if(0===b.prefix.length)return this._literalValue=b.value,this._readDataTypeOrLang;this._object=this._literal(b.value,this._namedNode(b.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._object=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(b){return"{"===b.type?this._readGraph(b):this._readPredicate(b)}_readGraph(b){return"{"!==b.type?this._error(`Expected graph but got ${b.type}`,b):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(b){return"]"===b.type?(this._subject=null,this._readBlankNodeTail(b)):(this._predicate=null,this._readPredicate(b))}_readBlankNodeTail(b){if("]"!==b.type)return this._readBlankNodePunctuation(b);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(b){switch(b.type){case".":case"}":return this._subject=null,this._readPunctuation(b);default:return this._readPredicate(b)}}_readListItem(b){let y=null,S=null,A=this._readListItem;const z=this._subject,P=this._contextStack,X=P[P.length-1];switch(b.type){case"[":this._saveContext("blank",this._graph,S=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),A=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,S=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==P.length&&"list"===P[P.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(A=this._readPredicate,this._subject===this.RDF_NIL)return A}else if(A=this._getContextEndReader(),this._object===this.RDF_NIL)return A;S=this.RDF_NIL;break;case"literal":0===b.prefix.length?(this._literalValue=b.value,A=this._readListItemDataTypeOrLang):(y=this._literal(b.value,this._namedNode(b.prefix)),A=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);default:if(void 0===(y=this._readEntity(b)))return}if(null===S&&(this._subject=S=this._blankNode()),null===z?null===X.predicate?X.subject=S:X.object=S:this._emit(z,this.RDF_REST,S,this._graph),null!==y){if(this._n3Mode&&("IRI"===b.type||"prefixed"===b.type))return this._saveContext("item",this._graph,S,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(S,this.RDF_FIRST,y,this._graph)}return A}_readDataTypeOrLang(b){return this._completeObjectLiteral(b,!1)}_readListItemDataTypeOrLang(b){return this._completeObjectLiteral(b,!0)}_completeLiteral(b){let y=this._literal(this._literalValue);switch(b.type){case"type":case"typeIRI":const S=this._readEntity(b);if(void 0===S)return;y=this._literal(this._literalValue,S),b=null;break;case"langcode":y=this._literal(this._literalValue,b.value),b=null}return{token:b,literal:y}}_completeSubjectLiteral(b){return this._subject=this._completeLiteral(b).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(b,y){const S=this._completeLiteral(b);if(S)return this._object=S.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===S.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(S.token))}_readFormulaTail(b){return"}"!==b.type?this._readPunctuation(b):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(b){let y,S=this._graph;const A=this._subject,z=this._inversePredicate;switch(b.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",b);if(this._n3Mode)return this._readFormulaTail(b);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,z&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(S=this._readEntity(b))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}if(null!==A){const P=this._predicate,X=this._object;z?this._emit(X,P,A,S):this._emit(A,P,X,S)}return y}_readBlankNodePunctuation(b){let y;switch(b.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(b){return"."!==b.type?this._error("Expected dot to follow quad",b):this._readInTopContext}_readPrefix(b){return"prefix"!==b.type?this._error("Expected prefix to follow @prefix",b):(this._prefix=b.value,this._readPrefixIRI)}_readPrefixIRI(b){if("IRI"!==b.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,b);const y=this._readEntity(b);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(b){const y="IRI"===b.type&&this._resolveIRI(b.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",b)}_readNamedGraphLabel(b){switch(b.type){case"IRI":case"blank":case"prefixed":return this._readSubject(b),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",b)}}_readNamedGraphBlankLabel(b){return"]"!==b.type?this._error("Invalid graph label",b):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(b){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(b)):"."!==b.type?this._error("Expected declaration to end with a dot",b):this._readInTopContext}_readQuantifierList(b){let y;switch(b.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(b,!0)))break;default:return this._error(`Unexpected ${b.type}`,b)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(b){return","===b.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(b))}_getPathReader(b){return this._afterPath=b,this._readPath}_readPath(b){switch(b.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,S=y.length&&y[y.length-1];if(S&&"item"===S.type){const A=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,A,this._graph)}return this._afterPath(b)}}_readForwardPath(b){let y,S;const A=this._blankNode();if(void 0!==(S=this._readEntity(b)))return null===this._predicate?(y=this._subject,this._subject=A):(y=this._object,this._object=A),this._emit(y,S,A,this._graph),this._readPath}_readBackwardPath(b){const y=this._blankNode();let S,A;if(void 0!==(S=this._readEntity(b)))return null===this._predicate?(A=this._subject,this._subject=y):(A=this._object,this._object=y),this._emit(y,S,A,this._graph),this._readPath}_readRDFStarTailOrGraph(b){return">>"!==b.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(b))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,b):this._readRDFStarTail(b)}_readRDFStarTail(b){if(">>"!==b.type)return this._error(`Expected >> but got ${b.type}`,b);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const b=this._contextStack;if(!b.length)return this._readPunctuation;switch(b[b.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(b,y,S,A){this._callback(null,this._quad(b,y,S,A||this.DEFAULTGRAPH))}_error(b,y){const S=new Error(`${b} on line ${y.line}.`);S.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(S),this._callback=C}_resolveIRI(b){return/^[a-z][a-z0-9+.-]*:/i.test(b)?b:this._resolveRelativeIRI(b)}_resolveRelativeIRI(b){if(!b.length)return this._base;switch(b[0]){case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return/^[^/:]*:/.test(b)?null:this._removeDotSegments(this._basePath+b)}}_removeDotSegments(b){if(!/(^|\/)\.\.?($|[/#?])/.test(b))return b;const y=b.length;let S="",A=-1,z=-1,P=0,X="/";for(;A<y;){switch(X){case":":if(z<0&&"/"===b[++A]&&"/"===b[++A])for(;(z=A+1)<y&&"/"!==b[z];)A=z;break;case"?":case"#":A=y;break;case"/":if("."===b[A+1])switch(X=b[1+ ++A],X){case"/":S+=b.substring(P,A-1),P=A+1;break;case void 0:case"?":case"#":return S+b.substring(P,A)+b.substr(A+1);case".":if(X=b[1+ ++A],void 0===X||"/"===X||"?"===X||"#"===X){if(S+=b.substring(P,A-2),(P=S.lastIndexOf("/"))>=z&&(S=S.substr(0,P)),"/"!==X)return`${S}/${b.substr(A+1)}`;P=A+1}}}X=b[++A]}return S+b.substring(P)}parse(b,y,S){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${H++}_`,this._prefixCallback=S||C,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const A=[];let z;if(this._callback=(P,X)=>{P?z=P:X&&A.push(X)},this._lexer.tokenize(b).every(P=>this._readCallback=this._readCallback(P)),z)throw z;return A}this._callback=y,this._lexer.tokenize(b,(A,z)=>{null!==A?(this._callback(A),this._callback=C):this._readCallback&&(this._readCallback=this._readCallback(z))})}}function C(){}function R(T,b){const y=b.namedNode;T._namedNode=y,T._blankNode=b.blankNode,T._literal=b.literal,T._variable=b.variable,T._quad=b.quad,T.DEFAULTGRAPH=b.defaultGraph(),T.RDF_FIRST=y(k.default.rdf.first),T.RDF_REST=y(k.default.rdf.rest),T.RDF_NIL=y(k.default.rdf.nil),T.N3_FORALL=y(k.default.r.forAll),T.N3_FORSOME=y(k.default.r.forSome),T.ABBREVIATIONS={a:y(k.default.rdf.type),"=":y(k.default.owl.sameAs),">":y(k.default.log.implies)},T.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}he.default=w,R(w.prototype,j.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var b,W=function(b,y){if(!y&&b&&b.__esModule)return b;if(null===b||"object"!=typeof b&&"function"!=typeof b)return{default:b};var S=H(y);if(S&&S.has(b))return S.get(b);var A={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in b)if("default"!==P&&Object.prototype.hasOwnProperty.call(b,P)){var X=z?Object.getOwnPropertyDescriptor(b,P):null;X&&(X.get||X.set)?Object.defineProperty(A,P,X):A[P]=b[P]}return A.default=b,S&&S.set(b,A),A}(Y("./N3DataFactory")),j=Y("readable-stream"),k=(b=Y("./IRIs"))&&b.__esModule?b:{default:b};function H(b){if("function"!=typeof WeakMap)return null;var y=new WeakMap,S=new WeakMap;return(H=function(A){return A?S:y})(b)}class C{constructor(y,S){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!S&&y&&!y[0]&&(S=y,y=null),this._factory=(S=S||{}).factory||W.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const S=this._graphs;let A,z;for(const P in S)for(const X in A=S[P].subjects)for(const ue in z=A[X])y+=Object.keys(z[ue]).length;return this._size=y}_addToIndex(y,S,A,z){const P=y[S]||(y[S]={}),X=P[A]||(P[A]={}),ue=z in X;return ue||(X[z]=null),!ue}_removeFromIndex(y,S,A,z){const P=y[S],X=P[A];delete X[z];for(const ue in X)return;delete P[A];for(const ue in P)return;delete y[S]}*_findInIndex(y,S,A,z,P,X,ue,I){let O,K,E;const Z=!S+!A+!z>1?Object.keys(this._ids):this._entities,ae=(0,W.termFromId)(I,this._factory);S&&((O=y,y={})[S]=O[S]);for(const oe in y){const te=Z[oe];if(K=y[oe]){A&&((O=K,K={})[A]=O[A]);for(const Te in K){const me=Z[Te];if(E=K[Te]){const ne=z?z in E?[z]:[]:Object.keys(E);for(let ye=0;ye<ne.length;ye++){const Oe={subject:null,predicate:null,object:null};Oe[P]=(0,W.termFromId)(te,this._factory),Oe[X]=(0,W.termFromId)(me,this._factory),Oe[ue]=(0,W.termFromId)(Z[ne[ye]],this._factory),yield this._factory.quad(Oe.subject,Oe.predicate,Oe.object,ae)}}}}}}_loop(y,S){for(const A in y)S(A)}_loopByKey0(y,S,A){let z,P;if(z=y[S])for(P in z)A(P)}_loopByKey1(y,S,A){let z,P;for(z in y)P=y[z],P[S]&&A(z)}_loopBy2Keys(y,S,A,z){let P,X,ue;if((P=y[S])&&(X=P[A]))for(ue in X)z(ue)}_countInIndex(y,S,A,z){let X,ue,I,P=0;S&&((X=y,y={})[S]=X[S]);for(const O in y)if(ue=y[O]){A&&((X=ue,ue={})[A]=X[A]);for(const K in ue)(I=ue[K])&&(z?z in I&&P++:P+=Object.keys(I).length)}return P}_getGraphs(y){if(!R(y))return this._graphs;const S={};return S[y]=this._graphs[y],S}_uniqueEntities(y){const S=Object.create(null);return A=>{A in S||(S[A]=!0,y((0,W.termFromId)(this._entities[A],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,S,A,z){S||(z=y.graph,A=y.object,S=y.predicate,y=y.subject),y=(0,W.termToId)(y),S=(0,W.termToId)(S),A=(0,W.termToId)(A),z=(0,W.termToId)(z);let P=this._graphs[z];P||(P=this._graphs[z]={subjects:{},predicates:{},objects:{}},Object.freeze(P));const X=this._ids,ue=this._entities;y=X[y]||(X[ue[++this._id]=y]=this._id),S=X[S]||(X[ue[++this._id]=S]=this._id),A=X[A]||(X[ue[++this._id]=A]=this._id);const I=this._addToIndex(P.subjects,y,S,A);return this._addToIndex(P.predicates,S,A,y),this._addToIndex(P.objects,A,y,S),this._size=null,I}addQuads(y){for(let S=0;S<y.length;S++)this.addQuad(y[S])}delete(y){return this.removeQuad(y),this}has(y,S,A,z){return y&&y.subject&&({subject:y,predicate:S,object:A,graph:z}=y),!this.readQuads(y,S,A,z).next().done}import(y){return y.on("data",S=>{this.addQuad(S)}),y}removeQuad(y,S,A,z){S||(z=y.graph,A=y.object,S=y.predicate,y=y.subject),y=(0,W.termToId)(y),S=(0,W.termToId)(S),A=(0,W.termToId)(A),z=(0,W.termToId)(z);const P=this._ids,X=this._graphs;let ue,I,O;if(!((y=P[y])&&(S=P[S])&&(A=P[A])&&(ue=X[z])&&(I=ue.subjects[y])&&(O=I[S])&&A in O))return!1;for(y in this._removeFromIndex(ue.subjects,y,S,A),this._removeFromIndex(ue.predicates,S,A,y),this._removeFromIndex(ue.objects,A,y,S),null!==this._size&&this._size--,ue.subjects)return!0;return delete X[z],!0}removeQuads(y){for(let S=0;S<y.length;S++)this.removeQuad(y[S])}remove(y){return y.on("data",S=>{this.removeQuad(S)}),y}removeMatches(y,S,A,z){const P=new j.Readable({objectMode:!0});return P._read=()=>{for(const X of this.readQuads(y,S,A,z))P.push(X);P.push(null)},this.remove(P)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,S,A,z){return[...this.readQuads(y,S,A,z)]}*readQuads(y,S,A,z){y=y&&(0,W.termToId)(y),S=S&&(0,W.termToId)(S),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const P=this._getGraphs(z),X=this._ids;let ue,I,O,K;if(!(R(y)&&!(I=X[y])||R(S)&&!(O=X[S])||R(A)&&!(K=X[A])))for(const E in P)(ue=P[E])&&(I?K?yield*this._findInIndex(ue.objects,K,I,O,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ue.subjects,I,O,null,"subject","predicate","object",E,null,!0):O?yield*this._findInIndex(ue.predicates,O,K,null,"predicate","object","subject",E,null,!0):K?yield*this._findInIndex(ue.objects,K,null,null,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ue.subjects,null,null,null,"subject","predicate","object",E,null,!0))}match(y,S,A,z){return new T(this,y,S,A,z)}countQuads(y,S,A,z){y=y&&(0,W.termToId)(y),S=S&&(0,W.termToId)(S),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const P=this._getGraphs(z),X=this._ids;let I,O,K,E,ue=0;if(R(y)&&!(O=X[y])||R(S)&&!(K=X[S])||R(A)&&!(E=X[A]))return 0;for(const $ in P)(I=P[$])&&(ue+=y?A?this._countInIndex(I.objects,E,O,K):this._countInIndex(I.subjects,O,K,E):S?this._countInIndex(I.predicates,K,E,O):this._countInIndex(I.objects,E,O,K));return ue}forEach(y,S,A,z,P){this.some(X=>(y(X),!1),S,A,z,P)}every(y,S,A,z,P){let X=!1;const ue=!this.some(I=>(X=!0,!y(I)),S,A,z,P);return X&&ue}some(y,S,A,z,P){for(const X of this.readQuads(S,A,z,P))if(y(X))return!0;return!1}getSubjects(y,S,A){const z=[];return this.forSubjects(P=>{z.push(P)},y,S,A),z}forSubjects(y,S,A,z){S=S&&(0,W.termToId)(S),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const P=this._ids,X=this._getGraphs(z);let ue,I,O;if(y=this._uniqueEntities(y),!(R(S)&&!(I=P[S])||R(A)&&!(O=P[A])))for(z in X)(ue=X[z])&&(I?O?this._loopBy2Keys(ue.predicates,I,O,y):this._loopByKey1(ue.subjects,I,y):O?this._loopByKey0(ue.objects,O,y):this._loop(ue.subjects,y))}getPredicates(y,S,A){const z=[];return this.forPredicates(P=>{z.push(P)},y,S,A),z}forPredicates(y,S,A,z){S=S&&(0,W.termToId)(S),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const P=this._ids,X=this._getGraphs(z);let ue,I,O;if(y=this._uniqueEntities(y),!(R(S)&&!(I=P[S])||R(A)&&!(O=P[A])))for(z in X)(ue=X[z])&&(I?O?this._loopBy2Keys(ue.objects,O,I,y):this._loopByKey0(ue.subjects,I,y):O?this._loopByKey1(ue.predicates,O,y):this._loop(ue.predicates,y))}getObjects(y,S,A){const z=[];return this.forObjects(P=>{z.push(P)},y,S,A),z}forObjects(y,S,A,z){S=S&&(0,W.termToId)(S),A=A&&(0,W.termToId)(A),z=z&&(0,W.termToId)(z);const P=this._ids,X=this._getGraphs(z);let ue,I,O;if(y=this._uniqueEntities(y),!(R(S)&&!(I=P[S])||R(A)&&!(O=P[A])))for(z in X)(ue=X[z])&&(I?O?this._loopBy2Keys(ue.subjects,I,O,y):this._loopByKey1(ue.objects,I,y):O?this._loopByKey0(ue.predicates,O,y):this._loop(ue.objects,y))}getGraphs(y,S,A){const z=[];return this.forGraphs(P=>{z.push(P)},y,S,A),z}forGraphs(y,S,A,z){for(const P in this._graphs)this.some(X=>(y(X.graph),!0),S,A,z,P)}createBlankNode(y){let S,A;if(y)for(S=y=`_:${y}`,A=1;this._ids[S];)S=y+A++;else do{S="_:b"+this._blankNodeIndex++}while(this._ids[S]);return this._ids[S]=++this._id,this._entities[this._id]=S,this._factory.blankNode(S.substr(2))}extractLists({remove:y=!1,ignoreErrors:S=!1}={}){const A={},z=S?()=>!0:(ue,I)=>{throw new Error(`${ue.value} ${I}`)},P=this.getQuads(null,k.default.rdf.rest,k.default.rdf.nil,null),X=y?[...P]:[];return P.forEach(ue=>{const I=[];let K,E,O=!1;const $=ue.graph;let Z=ue.subject;for(;Z&&!O;){const ae=this.getQuads(null,null,Z,null),oe=this.getQuads(Z,null,null,null);let te,Te=null,me=null,ne=null;for(let ye=0;ye<oe.length&&!O;ye++)te=oe[ye],te.graph.equals($)?K?O=z(Z,"has non-list arcs out"):te.predicate.value===k.default.rdf.first?Te?O=z(Z,"has multiple rdf:first arcs"):X.push(Te=te):te.predicate.value===k.default.rdf.rest?me?O=z(Z,"has multiple rdf:rest arcs"):X.push(me=te):ae.length?O=z(Z,"can't be subject and object"):(K=te,E="subject"):O=z(Z,"not confined to single graph");for(let ye=0;ye<ae.length&&!O;++ye)te=ae[ye],K?O=z(Z,"can't have coreferences"):te.predicate.value===k.default.rdf.rest?ne?O=z(Z,"has incoming rdf:rest arcs"):ne=te:(K=te,E="object");Te?I.unshift(Te.object):O=z(Z,"has no list head"),Z=ne&&ne.subject}O?y=!1:K&&(A[K[E].value]=I)}),y&&this.removeQuads(X),A}*[Symbol.iterator](){yield*this.readQuads()}}function R(b){return"string"==typeof b||b instanceof String}he.default=C;class T extends j.Readable{constructor(y,S,A,z,P){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:S,predicate:A,object:z,graph:P})}get filtered(){if(!this._filtered){const{n3Store:y,graph:S,object:A,predicate:z,subject:P}=this,X=y.getQuads(P,z,A,S);this._filtered=new C(X,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,S,A,z){return new T(this.filtered,y,S,A,z)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var H,W=(H=Y("./N3Parser"))&&H.__esModule?H:{default:H},j=Y("readable-stream");he.default=class extends j.Transform{constructor(w){let R,T;super({decodeStrings:!0}),this._readableState.objectMode=!0,new W.default(w).parse({on:(b,y)=>{switch(b){case"data":R=y;break;case"end":T=y}}},(b,y)=>{b&&this.emit("error",b)||y&&this.push(y)},(b,y)=>{this.emit("prefix",b,y)}),this._transform=(b,y,S)=>{R(b),S()},this._flush=b=>{T(),b()}}import(w){return w.on("data",C=>{this.write(C)}),w.on("end",()=>{this.end()}),w.on("error",C=>{this.emit("error",C)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var H,W=Y("readable-stream"),j=(H=Y("./N3Writer"))&&H.__esModule?H:{default:H};he.default=class extends W.Transform{constructor(w){super({encoding:"utf8",writableObjectMode:!0});const C=this._writer=new j.default({write:(R,T,b)=>{this.push(R),b&&b()},end:R=>{this.push(null),R&&R()}},w);this._transform=(R,T,b)=>{C.addQuad(R,b)},this._flush=R=>{C.end(R)}}import(w){return w.on("data",C=>{this.write(C)}),w.on("end",()=>{this.end()}),w.on("error",C=>{this.emit("error",C)}),w.on("prefix",(C,R)=>{this._writer.addPrefix(C,R)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.inDefaultGraph=function(y){return C(y.graph)},he.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},he.isDefaultGraph=C,he.isLiteral=function(y){return!!y&&"Literal"===y.termType},he.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},he.isVariable=function(y){return!!y&&"Variable"===y.termType},he.prefix=function(y,S){return b({"":y.value||y},S)("")},he.prefixes=b;var y,W=(y=Y("./N3DataFactory"))&&y.__esModule?y:{default:y};function C(y){return!!y&&"DefaultGraph"===y.termType}function b(y,S){const A=Object.create(null);for(const P in y)z(P,y[P]);function z(P,X){if("string"==typeof X){const ue=Object.create(null);A[P]=I=>ue[I]||(ue[I]=S.namedNode(X+I))}else if(!(P in A))throw new Error(`Unknown prefix: ${P}`);return A[P]}return S=S||W.default,z}},{"./N3DataFactory":35}],42:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var ue,W=(ue=Y("./IRIs"))&&ue.__esModule?ue:{default:ue},j=function(ue,I){if(!I&&ue&&ue.__esModule)return ue;if(null===ue||"object"!=typeof ue&&"function"!=typeof ue)return{default:ue};var O=Q(I);if(O&&O.has(ue))return O.get(ue);var K={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in ue)if("default"!==$&&Object.prototype.hasOwnProperty.call(ue,$)){var Z=E?Object.getOwnPropertyDescriptor(ue,$):null;Z&&(Z.get||Z.set)?Object.defineProperty(K,$,Z):K[$]=ue[$]}return K.default=ue,O&&O.set(ue,K),K}(Y("./N3DataFactory")),k=Y("./N3Util");function Q(ue){if("function"!=typeof WeakMap)return null;var I=new WeakMap,O=new WeakMap;return(Q=function(K){return K?O:I})(ue)}const C=j.default.defaultGraph(),{rdf:R,xsd:T}=W.default,b=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,S={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class A extends j.Term{equals(){return!1}}function P(ue){let I=S[ue];return void 0===I&&(1===ue.length?(I=ue.charCodeAt(0).toString(16),I="\\u0000".substr(0,6-I.length)+I):(I=(1024*(ue.charCodeAt(0)-55296)+ue.charCodeAt(1)+9216).toString(16),I="\\U00000000".substr(0,10-I.length)+I)),I}function X(ue){return ue.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}he.default=class{constructor(I,O){if(this._prefixRegex=/$0^/,I&&"function"!=typeof I.write&&(O=I,I=null),this._lists=(O=O||{}).lists,I)this._outputStream=I,this._endStream=void 0===O.end||!!O.end;else{let K="";this._outputStream={write(E,$,Z){K+=E,Z&&Z()},end:E=>{E&&E(null,K)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(O.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=C,this._prefixIRIs=Object.create(null),O.prefixes&&this.addPrefixes(O.prefixes),O.baseIRI&&(this._baseMatcher=new RegExp(`^${X(O.baseIRI)}${O.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=O.baseIRI.length))}get _inDefaultGraph(){return C.equals(this._graph)}_write(I,O){this._outputStream.write(I,"utf8",O)}_writeQuad(I,O,K,E,$){try{E.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(C.equals(E)?"":`${this._encodeIriOrBlank(E)} {\n`)),this._graph=E,this._subject=null),I.equals(this._subject)?O.equals(this._predicate)?this._write(`, ${this._encodeObject(K)}`,$):this._write(`;\n    ${this._encodePredicate(this._predicate=O)} ${this._encodeObject(K)}`,$):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=I)} ${this._encodePredicate(this._predicate=O)} ${this._encodeObject(K)}`,$)}catch(Z){$&&$(Z)}}_writeQuadLine(I,O,K,E,$){delete this._prefixMatch,this._write(this.quadToString(I,O,K,E),$)}quadToString(I,O,K,E){return`${this._encodeSubject(I)} ${this._encodeIriOrBlank(O)} ${this._encodeObject(K)}${E&&E.value?` ${this._encodeIriOrBlank(E)} .\n`:" .\n"}`}quadsToString(I){return I.map(O=>this.quadToString(O.subject,O.predicate,O.object,O.graph)).join("")}_encodeSubject(I){return"Quad"===I.termType?this._encodeQuad(I):this._encodeIriOrBlank(I)}_encodeIriOrBlank(I){if("NamedNode"!==I.termType)return this._lists&&I.value in this._lists&&(I=this.list(this._lists[I.value])),"id"in I?I.id:`_:${I.value}`;let O=I.value;this._baseMatcher&&this._baseMatcher.test(O)&&(O=O.substr(this._baseLength)),b.test(O)&&(O=O.replace(y,P));const K=this._prefixRegex.exec(O);return K?K[1]?this._prefixIRIs[K[1]]+K[2]:O:`<${O}>`}_encodeLiteral(I){let O=I.value;if(b.test(O)&&(O=O.replace(y,P)),I.language)return`"${O}"@${I.language}`;if(this._lineMode){if(I.datatype.value===T.string)return`"${O}"`}else switch(I.datatype.value){case T.string:return`"${O}"`;case T.boolean:if("true"===O||"false"===O)return O;break;case T.integer:if(/^[+-]?\d+$/.test(O))return O;break;case T.decimal:if(/^[+-]?\d*\.\d+$/.test(O))return O;break;case T.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(O))return O}return`"${O}"^^${this._encodeIriOrBlank(I.datatype)}`}_encodePredicate(I){return I.value===R.type?"a":this._encodeIriOrBlank(I)}_encodeObject(I){switch(I.termType){case"Quad":return this._encodeQuad(I);case"Literal":return this._encodeLiteral(I);default:return this._encodeIriOrBlank(I)}}_encodeQuad({subject:I,predicate:O,object:K,graph:E}){return`<<${this._encodeSubject(I)} ${this._encodePredicate(O)} ${this._encodeObject(K)}${(0,k.isDefaultGraph)(E)?"":` ${this._encodeIriOrBlank(E)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(I,O,K,E,$){void 0===K?this._writeQuad(I.subject,I.predicate,I.object,I.graph,O):"function"==typeof E?this._writeQuad(I,O,K,C,E):this._writeQuad(I,O,K,E||C,$)}addQuads(I){for(let O=0;O<I.length;O++)this.addQuad(I[O])}addPrefix(I,O,K){const E={};E[I]=O,this.addPrefixes(E,K)}addPrefixes(I,O){if(!this._prefixIRIs)return O&&O();let K=!1;for(let E in I){let $=I[E];"string"!=typeof $&&($=$.value),K=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[$]=E+=":",this._write(`@prefix ${E} <${$}>.\n`)}if(K){let E="",$="";for(const Z in this._prefixIRIs)E+=E?`|${Z}`:Z,$+=($?"|":"")+this._prefixIRIs[Z];E=X(E),this._prefixRegex=new RegExp(`^(?:${$})[^/]*$|^(${E})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(K?"\n":"",O)}blank(I,O){let E,$,K=I;switch(void 0===I?K=[]:I.termType?K=[{predicate:I,object:O}]:"length"in I||(K=[I]),$=K.length){case 0:return new A("[]");case 1:if(E=K[0],!(E.object instanceof A))return new A(`[ ${this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)} ]`);default:let Z="[";for(let ae=0;ae<$;ae++)E=K[ae],E.predicate.equals(I)?Z+=`, ${this._encodeObject(E.object)}`:(Z+=`${(ae?";\n  ":"\n  ")+this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)}`,I=E.predicate);return new A(`${Z}\n]`)}}list(I){const O=I&&I.length||0,K=new Array(O);for(let E=0;E<O;E++)K[E]=this._encodeObject(I[E]);return new A(`(${K.join(" ")})`)}end(I){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let O=I&&((K,E)=>{O=null,I(K,E)});if(this._endStream)try{return this._outputStream.end(O)}catch(K){}O&&O()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),Object.defineProperty(he,"BlankNode",{enumerable:!0,get:function(){return R.BlankNode}}),Object.defineProperty(he,"DataFactory",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(he,"DefaultGraph",{enumerable:!0,get:function(){return R.DefaultGraph}}),Object.defineProperty(he,"Lexer",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(he,"Literal",{enumerable:!0,get:function(){return R.Literal}}),Object.defineProperty(he,"NamedNode",{enumerable:!0,get:function(){return R.NamedNode}}),Object.defineProperty(he,"Parser",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(he,"Quad",{enumerable:!0,get:function(){return R.Quad}}),Object.defineProperty(he,"Store",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(he,"StreamParser",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(he,"StreamWriter",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(he,"Term",{enumerable:!0,get:function(){return R.Term}}),Object.defineProperty(he,"Triple",{enumerable:!0,get:function(){return R.Triple}}),he.Util=void 0,Object.defineProperty(he,"Variable",{enumerable:!0,get:function(){return R.Variable}}),Object.defineProperty(he,"Writer",{enumerable:!0,get:function(){return k.default}}),he.default=void 0,Object.defineProperty(he,"termFromId",{enumerable:!0,get:function(){return R.termFromId}}),Object.defineProperty(he,"termToId",{enumerable:!0,get:function(){return R.termToId}});var W=y(Y("./N3Lexer")),j=y(Y("./N3Parser")),k=y(Y("./N3Writer")),Q=y(Y("./N3Store")),H=y(Y("./N3StreamParser")),w=y(Y("./N3StreamWriter")),C=b(Y("./N3Util"));he.Util=C;var R=b(Y("./N3DataFactory"));function T(A){if("function"!=typeof WeakMap)return null;var z=new WeakMap,P=new WeakMap;return(T=function(X){return X?P:z})(A)}function b(A,z){if(!z&&A&&A.__esModule)return A;if(null===A||"object"!=typeof A&&"function"!=typeof A)return{default:A};var P=T(z);if(P&&P.has(A))return P.get(A);var X={},ue=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in A)if("default"!==I&&Object.prototype.hasOwnProperty.call(A,I)){var O=ue?Object.getOwnPropertyDescriptor(A,I):null;O&&(O.get||O.set)?Object.defineProperty(X,I,O):X[I]=A[I]}return X.default=A,P&&P.set(A,X),X}function y(A){return A&&A.__esModule?A:{default:A}}he.default={Lexer:W.default,Parser:j.default,Writer:k.default,Store:Q.default,StreamParser:H.default,StreamWriter:w.default,Util:C,DataFactory:R.default,Term:R.Term,NamedNode:R.NamedNode,Literal:R.Literal,BlankNode:R.BlankNode,Variable:R.Variable,DefaultGraph:R.DefaultGraph,Quad:R.Quad,Triple:R.Triple,termFromId:R.termFromId,termToId:R.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(Y,Se,he){var j,k,W=Se.exports={};function Q(){throw new Error("setTimeout has not been defined")}function H(){throw new Error("clearTimeout has not been defined")}function w(X){if(j===setTimeout)return setTimeout(X,0);if((j===Q||!j)&&setTimeout)return j=setTimeout,setTimeout(X,0);try{return j(X,0)}catch(ue){try{return j.call(null,X,0)}catch(I){return j.call(this,X,0)}}}!function(){try{j="function"==typeof setTimeout?setTimeout:Q}catch(X){j=Q}try{k="function"==typeof clearTimeout?clearTimeout:H}catch(X){k=H}}();var b,R=[],T=!1,y=-1;function S(){!T||!b||(T=!1,b.length?R=b.concat(R):y=-1,R.length&&A())}function A(){if(!T){var X=w(S);T=!0;for(var ue=R.length;ue;){for(b=R,R=[];++y<ue;)b&&b[y].run();y=-1,ue=R.length}b=null,T=!1,function(X){if(k===clearTimeout)return clearTimeout(X);if((k===H||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(X);try{k(X)}catch(ue){try{return k.call(null,X)}catch(I){return k.call(this,X)}}}(X)}}function z(X,ue){this.fun=X,this.array=ue}function P(){}W.nextTick=function(X){var ue=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)ue[I-1]=arguments[I];R.push(new z(X,ue)),1===R.length&&!T&&w(A)},z.prototype.run=function(){this.fun.apply(null,this.array)},W.title="browser",W.browser=!0,W.env={},W.argv=[],W.version="",W.versions={},W.on=P,W.addListener=P,W.once=P,W.off=P,W.removeListener=P,W.removeAllListeners=P,W.emit=P,W.prependListener=P,W.prependOnceListener=P,W.listeners=function(X){return[]},W.binding=function(X){throw new Error("process.binding is not supported")},W.cwd=function(){return"/"},W.chdir=function(X){throw new Error("process.chdir is not supported")},W.umask=function(){return 0}},{}],45:[function(Y,Se,he){(function(W){(function(){let j;Se.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:W):k=>(j||(j=Promise.resolve())).then(k).catch(Q=>setTimeout(()=>{throw Q},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(Y,Se,he){Se.exports=Y("./lib")},{"./lib":55}],47:[function(Y,Se,he){"use strict";Se.exports=class kq{constructor(j,k=new Map,Q=0){this.prefix=j,this._existing=k,this.counter=Q}clone(){const{prefix:j,_existing:k,counter:Q}=this;return new kq(j,new Map(k),Q)}getId(j){const k=j&&this._existing.get(j);if(k)return k;const Q=this.prefix+this.counter;return this.counter++,j&&this._existing.set(j,Q),Q}hasId(j){return this._existing.has(j)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(Y,Se,he){"use strict";Y("setimmediate");const W=self.crypto||self.msCrypto;Se.exports=class{constructor(k){if(!W||!W.subtle)throw new Error("crypto.subtle not found.");if("sha256"===k)this.algorithm={name:"SHA-256"};else{if("sha1"!==k)throw new Error(`Unsupport algorithm "${k}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(k){this._content+=k}digest(){var k=this;return yt(function*(){const Q=(new TextEncoder).encode(k._content),H=new Uint8Array(yield W.subtle.digest(k.algorithm,Q));let w="";for(let C=0;C<H.length;++C)w+=H[C].toString(16).padStart(2,"0");return w})()}}},{setimmediate:86}],49:[function(Y,Se,he){"use strict";const k="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",Q="http://www.w3.org/2001/XMLSchema#string",H="NamedNode",w="BlankNode",C="Literal",R="DefaultGraph",T={};function b(P,X){return P.subject.termType===X.subject.termType&&P.object.termType===X.object.termType&&P.subject.value===X.subject.value&&P.predicate.value===X.predicate.value&&P.object.value===X.object.value&&(P.object.termType!==C||P.object.datatype.termType===X.object.datatype.termType&&P.object.language===X.object.language&&P.object.datatype.value===X.object.datatype.value)}T.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,T.empty=new RegExp("^[ \\t]*$"),T.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Se.exports=class nF{static parse(X){const ue=[],I={},O=X.split(T.eoln);let K=0;for(const E of O){if(K++,T.empty.test(E))continue;const $=E.match(T.quad);if(null===$)throw new Error("N-Quads parse error on line "+K+".");const Z={subject:null,predicate:null,object:null,graph:null};if(Z.subject=void 0!==$[1]?{termType:H,value:$[1]}:{termType:w,value:$[2]},Z.predicate={termType:H,value:$[3]},void 0!==$[4]?Z.object={termType:H,value:$[4]}:void 0!==$[5]?Z.object={termType:w,value:$[5]}:(Z.object={termType:C,value:void 0,datatype:{termType:H}},void 0!==$[7]?Z.object.datatype.value=$[7]:void 0!==$[8]?(Z.object.datatype.value=k,Z.object.language=$[8]):Z.object.datatype.value=Q,Z.object.value=$[6].replace(A,function(X,ue,I,O){if(ue)switch(ue){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(I)return String.fromCharCode(parseInt(I,16));if(O)throw new Error("Unsupported U escape")})),Z.graph=void 0!==$[9]?{termType:H,value:$[9]}:void 0!==$[10]?{termType:w,value:$[10]}:{termType:R,value:""},Z.graph.value in I){let ae=!0;const oe=I[Z.graph.value];for(const te of oe)if(b(te,Z)){ae=!1;break}ae&&(oe.push(Z),ue.push(Z))}else I[Z.graph.value]=[Z],ue.push(Z)}return ue}static serialize(X){Array.isArray(X)||(X=nF.legacyDatasetToQuads(X));const ue=[];for(const I of X)ue.push(nF.serializeQuad(I));return ue.sort().join("")}static serializeQuad(X){const ue=X.subject,O=X.object,K=X.graph;let E="";return E+=ue.termType===H?`<${ue.value}>`:`${ue.value}`,E+=` <${X.predicate.value}> `,O.termType===H?E+=`<${O.value}>`:O.termType===w?E+=O.value:(E+=`"${P=O.value,P.replace(y,function(X){switch(X){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,O.datatype.value===k?O.language&&(E+=`@${O.language}`):O.datatype.value!==Q&&(E+=`^^<${O.datatype.value}>`)),K.termType===H?E+=` <${K.value}>`:K.termType===w&&(E+=` ${K.value}`),E+=" .\n",E;var P}static legacyDatasetToQuads(X){const ue=[],I={"blank node":w,IRI:H,literal:C};for(const O in X)X[O].forEach(E=>{const $={};for(const Z in E){const ae=E[Z],oe={termType:I[ae.type],value:ae.value};oe.termType===C&&(oe.datatype={termType:H},"datatype"in ae&&(oe.datatype.value=ae.datatype),"language"in ae?("datatype"in ae||(oe.datatype.value=k),oe.language=ae.language):"datatype"in ae||(oe.datatype.value=Q)),$[Z]=oe}$.graph="@default"===O?{termType:R,value:""}:{termType:O.startsWith("_:")?w:H,value:O},ue.push($)});return ue}};const y=/["\\\n\r]/g;const A=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(Y,Se,he){"use strict";Se.exports=class{constructor(j){this.current=j.sort(),this.done=!1,this.dir=new Map;for(let k=0;k<j.length;++k)this.dir.set(j[k],!0)}hasNext(){return!this.done}next(){const{current:j,dir:k}=this,Q=j.slice();let H=null,w=0;const C=j.length;for(let R=0;R<C;++R){const T=j[R],b=k.get(T);(null===H||T>H)&&(b&&R>0&&T>j[R-1]||!b&&R<C-1&&T>j[R+1])&&(H=T,w=R)}if(null===H)this.done=!0;else{const R=k.get(H)?w-1:w+1;j[w]=j[R],j[R]=H;for(const T of j)T>H&&k.set(T,!k.get(T))}return Q}}},{}],51:[function(Y,Se,he){(function(W){(function(){"use strict";const j=Y("./IdentifierIssuer"),k=Y("./MessageDigest"),Q=Y("./Permuter"),H=Y("./NQuads");function w(C,R){return C.hash<R.hash?-1:C.hash>R.hash?1:0}Se.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new j("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(R){var T=this;return yt(function*(){T.quads=R;for(const X of R)T._addBlankNodeQuadInfo({quad:X,component:X.subject}),T._addBlankNodeQuadInfo({quad:X,component:X.object}),T._addBlankNodeQuadInfo({quad:X,component:X.graph});const b=new Map,y=[...T.blankNodeInfo.keys()];let S=0;for(const X of y)++S%100==0&&(yield T._yield()),yield T._hashAndTrackBlankNode({id:X,hashToBlankNodes:b});const A=[...b.keys()].sort(),z=[];for(const X of A){const ue=b.get(X);ue.length>1?z.push(ue):T.canonicalIssuer.getId(ue[0])}for(const X of z){const ue=[];for(const I of X){if(T.canonicalIssuer.hasId(I))continue;const O=new j("_:b");O.getId(I);const K=yield T.hashNDegreeQuads(I,O);ue.push(K)}ue.sort(w);for(const I of ue){const O=I.issuer.getOldIds();for(const K of O)T.canonicalIssuer.getId(K)}}const P=[];for(const X of T.quads){const ue=ot({},X);ue.subject=T._useCanonicalId({component:ue.subject}),ue.object=T._useCanonicalId({component:ue.object}),ue.graph=T._useCanonicalId({component:ue.graph}),P.push(H.serializeQuad(ue))}return P.sort(),P.join("")})()}hashFirstDegreeQuads(R){var T=this;return yt(function*(){const b=[],y=T.blankNodeInfo.get(R),S=y.quads;for(const z of S){const P={subject:null,predicate:z.predicate,object:null,graph:null};P.subject=T.modifyFirstDegreeComponent(R,z.subject,"subject"),P.object=T.modifyFirstDegreeComponent(R,z.object,"object"),P.graph=T.modifyFirstDegreeComponent(R,z.graph,"graph"),b.push(H.serializeQuad(P))}b.sort();const A=new k(T.hashAlgorithm);for(const z of b)A.update(z);return y.hash=yield A.digest(),y.hash})()}hashRelatedBlankNode(R,T,b,y){var S=this;return yt(function*(){let A;A=S.canonicalIssuer.hasId(R)?S.canonicalIssuer.getId(R):b.hasId(R)?b.getId(R):S.blankNodeInfo.get(R).hash;const z=new k(S.hashAlgorithm);return z.update(y),"g"!==y&&z.update(S.getRelatedPredicate(T)),z.update(A),z.digest()})()}hashNDegreeQuads(R,T){var b=this;return yt(function*(){const y=new k(b.hashAlgorithm),S=yield b.createHashToRelated(R,T),A=[...S.keys()].sort();for(const z of A){y.update(z);let X,P="";const ue=new Q(S.get(z));let I=0;for(;ue.hasNext();){const O=ue.next();++I%3==0&&(yield b._yield());let K=T.clone(),E="";const $=[];let Z=!1;for(const ae of O)if(b.canonicalIssuer.hasId(ae)?E+=b.canonicalIssuer.getId(ae):(K.hasId(ae)||$.push(ae),E+=K.getId(ae)),0!==P.length&&E>P){Z=!0;break}if(!Z){for(const ae of $){const oe=yield b.hashNDegreeQuads(ae,K);if(E+=K.getId(ae),E+=`<${oe.hash}>`,K=oe.issuer,0!==P.length&&E>P){Z=!0;break}}Z||(0===P.length||E<P)&&(P=E,X=K)}}y.update(P),T=X}return{hash:yield y.digest(),issuer:T}})()}modifyFirstDegreeComponent(R,T){return"BlankNode"!==T.termType?T:{termType:"BlankNode",value:T.value===R?"_:a":"_:z"}}getRelatedPredicate(R){return`<${R.predicate.value}>`}createHashToRelated(R,T){var b=this;return yt(function*(){const y=new Map,S=b.blankNodeInfo.get(R).quads;let A=0;for(const z of S)++A%100==0&&(yield b._yield()),yield Promise.all([b._addRelatedBlankNodeHash({quad:z,component:z.subject,position:"s",id:R,issuer:T,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:z,component:z.object,position:"o",id:R,issuer:T,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:z,component:z.graph,position:"g",id:R,issuer:T,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:R,hashToBlankNodes:T}){var b=this;return yt(function*(){const y=yield b.hashFirstDegreeQuads(R),S=T.get(y);S?S.push(R):T.set(y,[R])})()}_addBlankNodeQuadInfo({quad:R,component:T}){if("BlankNode"!==T.termType)return;const b=T.value,y=this.blankNodeInfo.get(b);y?y.quads.add(R):this.blankNodeInfo.set(b,{quads:new Set([R]),hash:null})}_addRelatedBlankNodeHash({quad:R,component:T,position:b,id:y,issuer:S,hashToRelated:A}){var z=this;return yt(function*(){if("BlankNode"!==T.termType||T.value===y)return;const P=T.value,X=yield z.hashRelatedBlankNode(P,R,S,b),ue=A.get(X);ue?ue.push(P):A.set(X,[P])})()}_useCanonicalId({component:R}){return"BlankNode"!==R.termType||R.value.startsWith(this.canonicalIssuer.prefix)?R:{termType:"BlankNode",value:this.canonicalIssuer.getId(R.value)}}_yield(){return yt(function*(){return new Promise(R=>W(R))})()}}}).call(this)}).call(this,Y("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(Y,Se,he){"use strict";const W=Y("./IdentifierIssuer"),j=Y("./MessageDigest"),k=Y("./Permuter"),Q=Y("./NQuads");function H(w,C){return w.hash<C.hash?-1:w.hash>C.hash?1:0}Se.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new W("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(C){this.quads=C;for(const A of C)this._addBlankNodeQuadInfo({quad:A,component:A.subject}),this._addBlankNodeQuadInfo({quad:A,component:A.object}),this._addBlankNodeQuadInfo({quad:A,component:A.graph});const R=new Map,T=[...this.blankNodeInfo.keys()];for(const A of T)this._hashAndTrackBlankNode({id:A,hashToBlankNodes:R});const b=[...R.keys()].sort(),y=[];for(const A of b){const z=R.get(A);z.length>1?y.push(z):this.canonicalIssuer.getId(z[0])}for(const A of y){const z=[];for(const P of A){if(this.canonicalIssuer.hasId(P))continue;const X=new W("_:b");X.getId(P);const ue=this.hashNDegreeQuads(P,X);z.push(ue)}z.sort(H);for(const P of z){const X=P.issuer.getOldIds();for(const ue of X)this.canonicalIssuer.getId(ue)}}const S=[];for(const A of this.quads){const z=ot({},A);z.subject=this._useCanonicalId({component:z.subject}),z.object=this._useCanonicalId({component:z.object}),z.graph=this._useCanonicalId({component:z.graph}),S.push(Q.serializeQuad(z))}return S.sort(),S.join("")}hashFirstDegreeQuads(C){const R=[],T=this.blankNodeInfo.get(C),b=T.quads;for(const S of b){const A={subject:null,predicate:S.predicate,object:null,graph:null};A.subject=this.modifyFirstDegreeComponent(C,S.subject,"subject"),A.object=this.modifyFirstDegreeComponent(C,S.object,"object"),A.graph=this.modifyFirstDegreeComponent(C,S.graph,"graph"),R.push(Q.serializeQuad(A))}R.sort();const y=new j(this.hashAlgorithm);for(const S of R)y.update(S);return T.hash=y.digest(),T.hash}hashRelatedBlankNode(C,R,T,b){let y;y=this.canonicalIssuer.hasId(C)?this.canonicalIssuer.getId(C):T.hasId(C)?T.getId(C):this.blankNodeInfo.get(C).hash;const S=new j(this.hashAlgorithm);return S.update(b),"g"!==b&&S.update(this.getRelatedPredicate(R)),S.update(y),S.digest()}hashNDegreeQuads(C,R){const T=new j(this.hashAlgorithm),b=this.createHashToRelated(C,R),y=[...b.keys()].sort();for(const S of y){T.update(S);let z,A="";const P=new k(b.get(S));for(;P.hasNext();){const X=P.next();let ue=R.clone(),I="";const O=[];let K=!1;for(const E of X)if(this.canonicalIssuer.hasId(E)?I+=this.canonicalIssuer.getId(E):(ue.hasId(E)||O.push(E),I+=ue.getId(E)),0!==A.length&&I>A){K=!0;break}if(!K){for(const E of O){const $=this.hashNDegreeQuads(E,ue);if(I+=ue.getId(E),I+=`<${$.hash}>`,ue=$.issuer,0!==A.length&&I>A){K=!0;break}}K||(0===A.length||I<A)&&(A=I,z=ue)}}T.update(A),R=z}return{hash:T.digest(),issuer:R}}modifyFirstDegreeComponent(C,R){return"BlankNode"!==R.termType?R:{termType:"BlankNode",value:R.value===C?"_:a":"_:z"}}getRelatedPredicate(C){return`<${C.predicate.value}>`}createHashToRelated(C,R){const T=new Map,b=this.blankNodeInfo.get(C).quads;for(const y of b)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:C,issuer:R,hashToRelated:T}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:C,issuer:R,hashToRelated:T}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:C,issuer:R,hashToRelated:T});return T}_hashAndTrackBlankNode({id:C,hashToBlankNodes:R}){const T=this.hashFirstDegreeQuads(C),b=R.get(T);b?b.push(C):R.set(T,[C])}_addBlankNodeQuadInfo({quad:C,component:R}){if("BlankNode"!==R.termType)return;const T=R.value,b=this.blankNodeInfo.get(T);b?b.quads.add(C):this.blankNodeInfo.set(T,{quads:new Set([C]),hash:null})}_addRelatedBlankNodeHash({quad:C,component:R,position:T,id:b,issuer:y,hashToRelated:S}){if("BlankNode"!==R.termType||R.value===b)return;const A=R.value,z=this.hashRelatedBlankNode(A,C,y,T),P=S.get(z);P?P.push(A):S.set(z,[A])}_useCanonicalId({component:C}){return"BlankNode"!==C.termType||C.value.startsWith(this.canonicalIssuer.prefix)?C:{termType:"BlankNode",value:this.canonicalIssuer.getId(C.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015");Se.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(k,Q,H){return"BlankNode"!==Q.termType?Q:"graph"===H?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===k?"_:a":"_:z"}}getRelatedPredicate(k){return k.predicate.value}createHashToRelated(k,Q){var H=this;return yt(function*(){const w=new Map,C=H.blankNodeInfo.get(k).quads;let R=0;for(const T of C){let b,y;if("BlankNode"===T.subject.termType&&T.subject.value!==k)y=T.subject.value,b="p";else{if("BlankNode"!==T.object.termType||T.object.value===k)continue;y=T.object.value,b="r"}++R%100==0&&(yield H._yield());const S=yield H.hashRelatedBlankNode(y,T,Q,b),A=w.get(S);A?A.push(y):w.set(S,[y])}return w})()}}},{"./URDNA2015":51}],54:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015Sync");Se.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(k,Q,H){return"BlankNode"!==Q.termType?Q:"graph"===H?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===k?"_:a":"_:z"}}getRelatedPredicate(k){return k.predicate.value}createHashToRelated(k,Q){const H=new Map,w=this.blankNodeInfo.get(k).quads;for(const C of w){let R,T;if("BlankNode"===C.subject.termType&&C.subject.value!==k)T=C.subject.value,R="p";else{if("BlankNode"!==C.object.termType||C.object.value===k)continue;T=C.object.value,R="r"}const b=this.hashRelatedBlankNode(T,C,Q,R),y=H.get(b);y?y.push(T):H.set(b,[T])}return H}}},{"./URDNA2015Sync":52}],55:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015"),j=Y("./URGNA2012"),k=Y("./URDNA2015Sync"),Q=Y("./URGNA2012Sync");let H;try{H=Y("rdf-canonize-native")}catch(C){}const w={};Se.exports=w,w.NQuads=Y("./NQuads"),w.IdentifierIssuer=Y("./IdentifierIssuer"),w._rdfCanonizeNative=function(C){return C&&(H=C),H},w.canonize=function(){var C=yt(function*(R,T){if(Array.isArray(R)||(R=w.NQuads.legacyDatasetToQuads(R)),T.useNative){if(!H)throw new Error("rdf-canonize-native not available");return new Promise((b,y)=>H.canonize(R,T,(S,A)=>S?y(S):b(A)))}if("URDNA2015"===T.algorithm)return new W(T).main(R);if("URGNA2012"===T.algorithm)return new j(T).main(R);throw"algorithm"in T?new Error("Invalid RDF Dataset Canonicalization algorithm: "+T.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(R,T){return C.apply(this,arguments)}}(),w._canonizeSync=function(C,R){if(Array.isArray(C)||(C=w.NQuads.legacyDatasetToQuads(C)),R.useNative){if(H)return H.canonizeSync(C,R);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===R.algorithm)return new k(R).main(C);if("URGNA2012"===R.algorithm)return new Q(R).main(C);throw"algorithm"in R?new Error("Invalid RDF Dataset Canonicalization algorithm: "+R.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(Y,Se,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(k,Q,H,w){void 0===w&&(w=H),Object.defineProperty(k,w,{enumerable:!0,get:function(){return Q[H]}})}:function(k,Q,H,w){void 0===w&&(w=H),k[w]=Q[H]}),j=this&&this.__exportStar||function(k,Q){for(var H in k)"default"!==H&&!Object.prototype.hasOwnProperty.call(Q,H)&&W(Q,k,H)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/BlankNode"),he),j(Y("./lib/DataFactory"),he),j(Y("./lib/DefaultGraph"),he),j(Y("./lib/Literal"),he),j(Y("./lib/NamedNode"),he),j(Y("./lib/Quad"),he),j(Y("./lib/Variable"),he)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.BlankNode=void 0;he.BlankNode=class{constructor(k){this.termType="BlankNode",this.value=k}equals(k){return!!k&&"BlankNode"===k.termType&&k.value===this.value}}},{}],58:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DataFactory=void 0;const W=Y("./BlankNode"),j=Y("./DefaultGraph"),k=Y("./Literal"),Q=Y("./NamedNode"),H=Y("./Quad"),w=Y("./Variable");let C=0;he.DataFactory=class{constructor(b){this.blankNodeCounter=0,this.blankNodePrefix=(b=b||{}).blankNodePrefix||`df_${C++}_`}namedNode(b){return new Q.NamedNode(b)}blankNode(b){return new W.BlankNode(b||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(b,y){return new k.Literal(b,y)}variable(b){return new w.Variable(b)}defaultGraph(){return j.DefaultGraph.INSTANCE}quad(b,y,S,A){return new H.Quad(b,y,S,A||this.defaultGraph())}fromTerm(b){switch(b.termType){case"NamedNode":return this.namedNode(b.value);case"BlankNode":return this.blankNode(b.value);case"Literal":return b.language?this.literal(b.value,b.language):b.datatype.equals(k.Literal.XSD_STRING)?this.literal(b.value):this.literal(b.value,this.fromTerm(b.datatype));case"Variable":return this.variable(b.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(b.subject),this.fromTerm(b.predicate),this.fromTerm(b.object),this.fromTerm(b.graph))}}fromQuad(b){return this.fromTerm(b)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultGraph=void 0;class W{constructor(){this.termType="DefaultGraph",this.value=""}equals(k){return!!k&&"DefaultGraph"===k.termType}}he.DefaultGraph=W,W.INSTANCE=new W},{}],60:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Literal=void 0;const W=Y("./NamedNode");class j{constructor(Q,H){this.termType="Literal",this.value=Q,"string"==typeof H?(this.language=H,this.datatype=j.RDF_LANGUAGE_STRING):H?(this.language="",this.datatype=H):(this.language="",this.datatype=j.XSD_STRING)}equals(Q){return!!Q&&"Literal"===Q.termType&&Q.value===this.value&&Q.language===this.language&&Q.datatype.equals(this.datatype)}}he.Literal=j,j.RDF_LANGUAGE_STRING=new W.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),j.XSD_STRING=new W.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.NamedNode=void 0;he.NamedNode=class{constructor(k){this.termType="NamedNode",this.value=k}equals(k){return!!k&&"NamedNode"===k.termType&&k.value===this.value}}},{}],62:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Quad=void 0;he.Quad=class{constructor(k,Q,H,w){this.termType="Quad",this.value="",this.subject=k,this.predicate=Q,this.object=H,this.graph=w}equals(k){return!!k&&("Quad"===k.termType||!k.termType)&&this.subject.equals(k.subject)&&this.predicate.equals(k.predicate)&&this.object.equals(k.object)&&this.graph.equals(k.graph)}}},{}],63:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Variable=void 0;he.Variable=class{constructor(k){this.termType="Variable",this.value=k}equals(k){return!!k&&"Variable"===k.termType&&k.value===this.value}}},{}],64:[function(Y,Se,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(k,Q,H,w){void 0===w&&(w=H),Object.defineProperty(k,w,{enumerable:!0,get:function(){return Q[H]}})}:function(k,Q,H,w){void 0===w&&(w=H),k[w]=Q[H]}),j=this&&this.__exportStar||function(k,Q){for(var H in k)"default"!==H&&!Object.prototype.hasOwnProperty.call(Q,H)&&W(Q,k,H)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/RdfXmlParser"),he)},{"./lib/RdfXmlParser":66}],65:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseError=void 0;class W extends Error{constructor(k,Q){const H=k.saxStream._parser;super(k.trackPosition?`Line ${H.line+1} column ${H.column+1}: ${Q}`:Q)}}he.ParseError=W},{}],66:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseType=he.RdfXmlParser=void 0;const W=Y("relative-to-absolute-iri"),j=Y("sax"),k=Y("stream"),Q=Y("./ParseError"),H=Y("rdf-data-factory");class w extends k.Transform{constructor(T){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},T&&(Object.assign(this,T),this.options=T),this.dataFactory||(this.dataFactory=new H.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=j.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(T,b){const y={};let S=!1;for(const z in T.attributes)z.startsWith("xmlns")&&(5===z.length?(S=!0,y[""]=T.attributes[z]):":"===z.charAt(5)&&(S=!0,y[z.substr(6)]=T.attributes[z]));const A=b&&b.ns?b.ns:[w.DEFAULT_NS];return S?A.concat([y]):A}static expandPrefixedTerm(T,b,y){const S=T.indexOf(":");let A,z;S>=0?(A=T.substr(0,S),z=T.substr(S+1)):(A="",z=T);let P=null,X=null;for(let ue=b.length-1;ue>=0;ue--){const I=b[ue][A];if(I){P=I;break}X||(X=b[ue][""])}if(!P){if(A&&"xmlns"!==A)throw new Q.ParseError(y,`The prefix '${A}' in term '${T}' was not bound.`);P=X||""}return{prefix:A,local:z,uri:P}}static isValidIri(T){return w.IRI_REGEX.test(T)}import(T){const b=new k.PassThrough({readableObjectMode:!0});T.on("error",S=>y.emit("error",S)),T.on("data",S=>b.push(S)),T.on("end",()=>b.push(null));const y=b.pipe(new w(this.options));return y}_transform(T,b,y){try{this.saxStream.write(T,b)}catch(S){return y(S)}y()}newParseError(T){return new Q.ParseError(this,T)}valueToUri(T,b){return this.uriToNamedNode(W.resolve(T,b.baseIRI))}uriToNamedNode(T){if(!w.isValidIri(T))throw this.newParseError(`Invalid URI: ${T}`);return this.dataFactory.namedNode(T)}validateNcname(T){if(!w.NCNAME_MATCHER.test(T))throw this.newParseError(`Not a valid NCName: ${T}`)}attachSaxListeners(){this.saxStream.on("error",T=>this.emit("error",T)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(T){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=C.RESOURCE;if(b&&(b.hadChildren=!0,y=b.childrenParseType),b&&b.childrenStringTags){const A=T.name;let z="";for(const I in T.attributes)z+=` ${I}="${T.attributes[I]}"`;b.childrenStringTags.push(`<${A}${z}>`);const ue={childrenStringTags:b.childrenStringTags};return ue.childrenStringEmitClosingTag=`</${A}>`,void this.activeTagStack.push(ue)}const S={};b?(S.language=b.language,S.baseIRI=b.baseIRI):S.baseIRI=this.baseIRI,this.activeTagStack.push(S),S.ns=w.parseNamespace(T,b),y===C.RESOURCE?this.onTagResource(T,S,b,!b):this.onTagProperty(T,S,b)}onTagResource(T,b,y,S){const A=w.expandPrefixedTerm(T.name,b.ns,this);b.childrenParseType=C.PROPERTY;let z=!0;if(A.uri===w.RDF){if(!S&&w.FORBIDDEN_NODE_ELEMENTS.indexOf(A.local)>=0)throw this.newParseError(`Illegal node element name: ${A.local}`);switch(A.local){case"RDF":b.childrenParseType=C.RESOURCE;case"Description":z=!1}}const P=[],X=[];let ue=null,I=!1,O=!1,K=null;for(const E in T.attributes){const $=T.attributes[E],Z=w.expandPrefixedTerm(E,b.ns,this);if(y&&Z.uri===w.RDF)switch(Z.local){case"about":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ue} where found.`);ue=$;continue;case"ID":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ue} where found.`);this.validateNcname($),ue="#"+$,I=!0;continue;case"nodeID":if(ue)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ue} where found.`);this.validateNcname($),ue=$,O=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":K=$;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Z.uri===w.XML){if("lang"===Z.local){b.language=""===$?null:$.toLowerCase();continue}if("base"===Z.local){b.baseIRI=W.resolve($,b.baseIRI);continue}}"xml"!==Z.prefix&&Z.uri&&(P.push(this.uriToNamedNode(Z.uri+Z.local)),X.push($))}if(null!==ue&&(b.subject=O?this.dataFactory.blankNode(ue):this.valueToUri(ue,b),I&&this.claimNodeId(b.subject)),b.subject||(b.subject=this.dataFactory.blankNode()),z){const E=this.uriToNamedNode(A.uri+A.local);this.emitTriple(b.subject,this.dataFactory.namedNode(w.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(w.RDF+"first"),b.subject,b.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(w.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,b.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(b.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<P.length;E++){const $=this.dataFactory.literal(X[E],b.datatype||b.language);this.emitTriple(b.subject,P[E],$,y.reifiedStatementId)}K&&this.emitTriple(b.subject,this.dataFactory.namedNode(w.RDF+"type"),this.uriToNamedNode(K),null)}}onTagProperty(T,b,y){const S=w.expandPrefixedTerm(T.name,b.ns,this);if(b.childrenParseType=C.RESOURCE,b.subject=y.subject,S.uri===w.RDF&&"li"===S.local?(y.listItemCounter||(y.listItemCounter=1),b.predicate=this.uriToNamedNode(S.uri+"_"+y.listItemCounter++)):b.predicate=this.uriToNamedNode(S.uri+S.local),S.uri===w.RDF&&w.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(S.local)>=0)throw this.newParseError(`Illegal property element name: ${S.local}`);b.predicateSubPredicates=[],b.predicateSubObjects=[];let A=!1,z=!1,P=null,X=!0;const ue=[],I=[];for(const O in T.attributes){const K=T.attributes[O],E=w.expandPrefixedTerm(O,b.ns,this);if(E.uri===w.RDF)switch(E.local){case"resource":if(P)throw this.newParseError(`Found both rdf:resource (${K}) and rdf:nodeID (${P}).`);if(A)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${K})`);b.hadChildren=!0,P=K,X=!1;continue;case"datatype":if(z)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${K}).`);if(A)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${K})`);b.datatype=this.valueToUri(K,b);continue;case"nodeID":if(z)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${K}).`);if(b.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${K}).`);if(A)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${K})`);this.validateNcname(K),b.hadChildren=!0,P=K,X=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(z)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(b.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${b.datatype.value})`);if(P)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${P})`);if("Resource"===K){A=!0,b.childrenParseType=C.PROPERTY;const $=this.dataFactory.blankNode();this.emitTriple(b.subject,b.predicate,$,b.reifiedStatementId),b.subject=$,b.predicate=null}else"Collection"===K?(A=!0,b.hadChildren=!0,b.childrenCollectionSubject=b.subject,b.childrenCollectionPredicate=b.predicate,X=!1):"Literal"===K&&(A=!0,b.childrenTagsToString=!0,b.childrenStringTags=[]);continue;case"ID":this.validateNcname(K),b.reifiedStatementId=this.valueToUri("#"+K,b),this.claimNodeId(b.reifiedStatementId);continue}else if(E.uri===w.XML&&"lang"===E.local){b.language=""===K?null:K.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(A||b.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${K}`);b.hadChildren=!0,z=!0,ue.push(this.uriToNamedNode(E.uri+E.local)),I.push(this.dataFactory.literal(K,b.datatype||b.language))}}if(null!==P){const O=b.subject;b.subject=X?this.dataFactory.blankNode(P):this.valueToUri(P,b),this.emitTriple(O,b.predicate,b.subject,b.reifiedStatementId);for(let K=0;K<ue.length;K++)this.emitTriple(b.subject,ue[K],I[K],null);b.predicateEmitted=!0}else X&&(b.predicateSubPredicates=ue,b.predicateSubObjects=I,b.predicateEmitted=!1)}emitTriple(T,b,y,S){this.push(this.dataFactory.quad(T,b,y,this.defaultGraph)),S&&(this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(w.RDF+"type"),this.dataFactory.namedNode(w.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(w.RDF+"subject"),T,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(w.RDF+"predicate"),b,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(w.RDF+"object"),y,this.defaultGraph)))}claimNodeId(T){if(!this.allowDuplicateRdfIds){if(this.nodeIds[T.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${T.value}'.`);this.nodeIds[T.value]=!0}}onText(T){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;b&&(b.childrenStringTags?b.childrenStringTags.push(T):b.predicate&&(b.text=T))}onCloseTag(){const T=this.activeTagStack.pop();if(T.childrenStringEmitClosingTag&&T.childrenStringTags.push(T.childrenStringEmitClosingTag),T.childrenTagsToString&&(T.datatype=this.dataFactory.namedNode(w.RDF+"XMLLiteral"),T.text=T.childrenStringTags.join(""),T.hadChildren=!1),T.childrenCollectionSubject)this.emitTriple(T.childrenCollectionSubject,T.childrenCollectionPredicate,this.dataFactory.namedNode(w.RDF+"nil"),T.reifiedStatementId);else if(T.predicate)if(T.hadChildren||T.childrenParseType===C.PROPERTY){if(!T.predicateEmitted){const b=this.dataFactory.blankNode();this.emitTriple(T.subject,T.predicate,b,T.reifiedStatementId);for(let y=0;y<T.predicateSubPredicates.length;y++)this.emitTriple(b,T.predicateSubPredicates[y],T.predicateSubObjects[y],null)}}else this.emitTriple(T.subject,T.predicate,this.dataFactory.literal(T.text||"",T.datatype||T.language),T.reifiedStatementId)}onDoctype(T){T.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(b,y,S)=>(this.saxStream._parser.ENTITIES[y]=S,""))}}var C,R;he.RdfXmlParser=w,w.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,w.MIME_TYPE="application/rdf+xml",w.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",w.XML="http://www.w3.org/XML/1998/namespace",w.XMLNS="http://www.w3.org/2000/xmlns/",w.DEFAULT_NS={xml:w.XML},w.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],w.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],w.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(R=C=he.ParseType||(he.ParseType={}))[R.RESOURCE=0]="RESOURCE",R[R.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(Y,Se,he){"use strict";var j={};function k(R,T,b){b||(b=Error);var S=function(A){function z(P,X,ue){return A.call(this,function(A,z,P){return"string"==typeof T?T:T(A,z,P)}(P,X,ue))||this}return function(R,T){R.prototype=Object.create(T.prototype),R.prototype.constructor=R,R.__proto__=T}(z,A),z}(b);S.prototype.name=b.name,S.prototype.code=R,j[R]=S}function Q(R,T){if(Array.isArray(R)){var b=R.length;return R=R.map(function(y){return String(y)}),b>2?"one of ".concat(T," ").concat(R.slice(0,b-1).join(", "),", or ")+R[b-1]:2===b?"one of ".concat(T," ").concat(R[0]," or ").concat(R[1]):"of ".concat(T," ").concat(R[0])}return"of ".concat(T," ").concat(String(R))}k("ERR_INVALID_OPT_VALUE",function(R,T){return'The value "'+T+'" is invalid for option "'+R+'"'},TypeError),k("ERR_INVALID_ARG_TYPE",function(R,T,b){var y,S;if("string"==typeof T&&function(R,T,b){return R.substr(!b||b<0?0:+b,T.length)===T}(T,"not ")?(y="must not be",T=T.replace(/^not /,"")):y="must be",function(R,T,b){return(void 0===b||b>R.length)&&(b=R.length),R.substring(b-T.length,b)===T}(R," argument"))S="The ".concat(R," ").concat(y," ").concat(Q(T,"type"));else{var A=function(R,T,b){return"number"!=typeof b&&(b=0),!(b+T.length>R.length)&&-1!==R.indexOf(T,b)}(R,".")?"property":"argument";S='The "'.concat(R,'" ').concat(A," ").concat(y," ").concat(Q(T,"type"))}return S+". Received type ".concat(typeof b)},TypeError),k("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),k("ERR_METHOD_NOT_IMPLEMENTED",function(R){return"The "+R+" method is not implemented"}),k("ERR_STREAM_PREMATURE_CLOSE","Premature close"),k("ERR_STREAM_DESTROYED",function(R){return"Cannot call "+R+" after a stream was destroyed"}),k("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),k("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),k("ERR_STREAM_WRITE_AFTER_END","write after end"),k("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),k("ERR_UNKNOWN_ENCODING",function(R){return"Unknown encoding: "+R},TypeError),k("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Se.exports.codes=j},{}],68:[function(Y,Se,he){(function(W){(function(){"use strict";var j=Object.keys||function(y){var S=[];for(var A in y)S.push(A);return S};Se.exports=R;var k=Y("./_stream_readable"),Q=Y("./_stream_writable");Y("inherits")(R,k);for(var H=j(Q.prototype),w=0;w<H.length;w++){var C=H[w];R.prototype[C]||(R.prototype[C]=Q.prototype[C])}function R(y){if(!(this instanceof R))return new R(y);k.call(this,y),Q.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",T)))}function T(){this._writableState.ended||W.nextTick(b,this)}function b(y){y.end()}Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,Y("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(Y,Se,he){"use strict";Se.exports=j;var W=Y("./_stream_transform");function j(k){if(!(this instanceof j))return new j(k);W.call(this,k)}Y("inherits")(j,W),j.prototype._transform=function(k,Q,H){H(null,k)}},{"./_stream_transform":71,inherits:10}],70:[function(Y,Se,he){(function(W,j){(function(){"use strict";var k;Se.exports=ne,ne.ReadableState=me,Y("events");var H=function(B,N){return B.listeners(N).length},w=Y("./internal/streams/stream"),C=Y("buffer").Buffer,R=j.Uint8Array||function(){};var S,y=Y("util");S=y&&y.debuglog?y.debuglog("stream"):function(){};var $,Z,ae,A=Y("./internal/streams/buffer_list"),z=Y("./internal/streams/destroy"),X=Y("./internal/streams/state").getHighWaterMark,ue=Y("../errors").codes,I=ue.ERR_INVALID_ARG_TYPE,O=ue.ERR_STREAM_PUSH_AFTER_EOF,K=ue.ERR_METHOD_NOT_IMPLEMENTED,E=ue.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Y("inherits")(ne,w);var oe=z.errorOrDestroy,te=["error","close","destroy","pause","resume"];function me(we,B,N){k=k||Y("./_stream_duplex"),"boolean"!=typeof N&&(N=B instanceof k),this.objectMode=!!(we=we||{}).objectMode,N&&(this.objectMode=this.objectMode||!!we.readableObjectMode),this.highWaterMark=X(this,we,"readableHighWaterMark",N),this.buffer=new A,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==we.emitClose,this.autoDestroy=!!we.autoDestroy,this.destroyed=!1,this.defaultEncoding=we.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,we.encoding&&($||($=Y("string_decoder/").StringDecoder),this.decoder=new $(we.encoding),this.encoding=we.encoding)}function ne(we){if(k=k||Y("./_stream_duplex"),!(this instanceof ne))return new ne(we);this._readableState=new me(we,this,this instanceof k),this.readable=!0,we&&("function"==typeof we.read&&(this._read=we.read),"function"==typeof we.destroy&&(this._destroy=we.destroy)),w.call(this)}function ye(we,B,N,V,Re){S("readableAddChunk",B);var Tt,Ze=we._readableState;if(null===B)Ze.reading=!1,function(we,B){if(S("onEofChunk"),!B.ended){if(B.decoder){var N=B.decoder.end();N&&N.length&&(B.buffer.push(N),B.length+=B.objectMode?1:N.length)}B.ended=!0,B.sync?ze(we):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,Le(we)))}}(we,Ze);else if(Re||(Tt=function(we,B){var N;return!function(we){return C.isBuffer(we)||we instanceof R}(B)&&"string"!=typeof B&&void 0!==B&&!we.objectMode&&(N=new I("chunk",["string","Buffer","Uint8Array"],B)),N}(Ze,B)),Tt)oe(we,Tt);else if(Ze.objectMode||B&&B.length>0)if("string"!=typeof B&&!Ze.objectMode&&Object.getPrototypeOf(B)!==C.prototype&&(B=function(we){return C.from(we)}(B)),V)Ze.endEmitted?oe(we,new E):Oe(we,Ze,B,!0);else if(Ze.ended)oe(we,new O);else{if(Ze.destroyed)return!1;Ze.reading=!1,Ze.decoder&&!N?(B=Ze.decoder.write(B),Ze.objectMode||0!==B.length?Oe(we,Ze,B,!1):Ke(we,Ze)):Oe(we,Ze,B,!1)}else V||(Ze.reading=!1,Ke(we,Ze));return!Ze.ended&&(Ze.length<Ze.highWaterMark||0===Ze.length)}function Oe(we,B,N,V){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,we.emit("data",N)):(B.length+=B.objectMode?1:N.length,V?B.buffer.unshift(N):B.buffer.push(N),B.needReadable&&ze(we)),Ke(we,B)}Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){!this._readableState||(this._readableState.destroyed=B)}}),ne.prototype.destroy=z.destroy,ne.prototype._undestroy=z.undestroy,ne.prototype._destroy=function(we,B){B(we)},ne.prototype.push=function(we,B){var V,N=this._readableState;return N.objectMode?V=!0:"string"==typeof we&&((B=B||N.defaultEncoding)!==N.encoding&&(we=C.from(we,B),B=""),V=!0),ye(this,we,B,!1,V)},ne.prototype.unshift=function(we){return ye(this,we,null,!0,!1)},ne.prototype.isPaused=function(){return!1===this._readableState.flowing},ne.prototype.setEncoding=function(we){$||($=Y("string_decoder/").StringDecoder);var B=new $(we);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var N=this._readableState.buffer.head,V="";null!==N;)V+=B.write(N.data),N=N.next;return this._readableState.buffer.clear(),""!==V&&this._readableState.buffer.push(V),this._readableState.length=V.length,this};var st=1073741824;function tt(we,B){return we<=0||0===B.length&&B.ended?0:B.objectMode?1:we!=we?B.flowing&&B.length?B.buffer.head.data.length:B.length:(we>B.highWaterMark&&(B.highWaterMark=function(we){return we>=st?we=st:(we--,we|=we>>>1,we|=we>>>2,we|=we>>>4,we|=we>>>8,we|=we>>>16,we++),we}(we)),we<=B.length?we:B.ended?B.length:(B.needReadable=!0,0))}function ze(we){var B=we._readableState;S("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(S("emitReadable",B.flowing),B.emittedReadable=!0,W.nextTick(Le,we))}function Le(we){var B=we._readableState;S("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(we.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,pe(we)}function Ke(we,B){B.readingMore||(B.readingMore=!0,W.nextTick(Me,we,B))}function Me(we,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var N=B.length;if(S("maybeReadMore read 0"),we.read(0),N===B.length)break}B.readingMore=!1}function qe(we){var B=we._readableState;B.readableListening=we.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:we.listenerCount("data")>0&&we.resume()}function ke(we){S("readable nexttick read 0"),we.read(0)}function G(we,B){S("resume",B.reading),B.reading||we.read(0),B.resumeScheduled=!1,we.emit("resume"),pe(we),B.flowing&&!B.reading&&we.read(0)}function pe(we){var B=we._readableState;for(S("flow",B.flowing);B.flowing&&null!==we.read(););}function de(we,B){return 0===B.length?null:(B.objectMode?N=B.buffer.shift():!we||we>=B.length?(N=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):N=B.buffer.consume(we,B.decoder),N);var N}function je(we){var B=we._readableState;S("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,W.nextTick(_t,B,we))}function _t(we,B){if(S("endReadableNT",we.endEmitted,we.length),!we.endEmitted&&0===we.length&&(we.endEmitted=!0,B.readable=!1,B.emit("end"),we.autoDestroy)){var N=B._writableState;(!N||N.autoDestroy&&N.finished)&&B.destroy()}}function pt(we,B){for(var N=0,V=we.length;N<V;N++)if(we[N]===B)return N;return-1}ne.prototype.read=function(we){S("read",we),we=parseInt(we,10);var B=this._readableState,N=we;if(0!==we&&(B.emittedReadable=!1),0===we&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return S("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?je(this):ze(this),null;if(0===(we=tt(we,B))&&B.ended)return 0===B.length&&je(this),null;var Re,V=B.needReadable;return S("need readable",V),(0===B.length||B.length-we<B.highWaterMark)&&S("length less than watermark",V=!0),B.ended||B.reading?S("reading or ended",V=!1):V&&(S("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(we=tt(N,B))),null===(Re=we>0?de(we,B):null)?(B.needReadable=B.length<=B.highWaterMark,we=0):(B.length-=we,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),N!==we&&B.ended&&je(this)),null!==Re&&this.emit("data",Re),Re},ne.prototype._read=function(we){oe(this,new K("_read()"))},ne.prototype.pipe=function(we,B){var N=this,V=this._readableState;switch(V.pipesCount){case 0:V.pipes=we;break;case 1:V.pipes=[V.pipes,we];break;default:V.pipes.push(we)}V.pipesCount+=1,S("pipe count=%d opts=%j",V.pipesCount,B);var Ze=B&&!1===B.end||we===W.stdout||we===W.stderr?fs:kt;function Tt(Bs,Kr){S("onunpipe"),Bs===N&&Kr&&!1===Kr.hasUnpiped&&(Kr.hasUnpiped=!0,S("cleanup"),we.removeListener("close",Xr),we.removeListener("finish",Ls),we.removeListener("drain",In),we.removeListener("error",xi),we.removeListener("unpipe",Tt),N.removeListener("end",kt),N.removeListener("end",fs),N.removeListener("data",Mi),Nn=!0,V.awaitDrain&&(!we._writableState||we._writableState.needDrain)&&In())}function kt(){S("onend"),we.end()}V.endEmitted?W.nextTick(Ze):N.once("end",Ze),we.on("unpipe",Tt);var In=function(we){return function(){var N=we._readableState;S("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,0===N.awaitDrain&&H(we,"data")&&(N.flowing=!0,pe(we))}}(N);we.on("drain",In);var Nn=!1;function Mi(Bs){S("ondata");var Kr=we.write(Bs);S("dest.write",Kr),!1===Kr&&((1===V.pipesCount&&V.pipes===we||V.pipesCount>1&&-1!==pt(V.pipes,we))&&!Nn&&(S("false write response, pause",V.awaitDrain),V.awaitDrain++),N.pause())}function xi(Bs){S("onerror",Bs),fs(),we.removeListener("error",xi),0===H(we,"error")&&oe(we,Bs)}function Xr(){we.removeListener("finish",Ls),fs()}function Ls(){S("onfinish"),we.removeListener("close",Xr),fs()}function fs(){S("unpipe"),N.unpipe(we)}return N.on("data",Mi),function(we,B,N){if("function"==typeof we.prependListener)return we.prependListener(B,N);we._events&&we._events[B]?Array.isArray(we._events[B])?we._events[B].unshift(N):we._events[B]=[N,we._events[B]]:we.on(B,N)}(we,"error",xi),we.once("close",Xr),we.once("finish",Ls),we.emit("pipe",N),V.flowing||(S("pipe resume"),N.resume()),we},ne.prototype.unpipe=function(we){var B=this._readableState,N={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return we&&we!==B.pipes||(we||(we=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,we&&we.emit("unpipe",this,N)),this;if(!we){var V=B.pipes,Re=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Ze=0;Ze<Re;Ze++)V[Ze].emit("unpipe",this,{hasUnpiped:!1});return this}var Tt=pt(B.pipes,we);return-1===Tt||(B.pipes.splice(Tt,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),we.emit("unpipe",this,N)),this},ne.prototype.addListener=ne.prototype.on=function(we,B){var N=w.prototype.on.call(this,we,B),V=this._readableState;return"data"===we?(V.readableListening=this.listenerCount("readable")>0,!1!==V.flowing&&this.resume()):"readable"===we&&!V.endEmitted&&!V.readableListening&&(V.readableListening=V.needReadable=!0,V.flowing=!1,V.emittedReadable=!1,S("on readable",V.length,V.reading),V.length?ze(this):V.reading||W.nextTick(ke,this)),N},ne.prototype.removeListener=function(we,B){var N=w.prototype.removeListener.call(this,we,B);return"readable"===we&&W.nextTick(qe,this),N},ne.prototype.removeAllListeners=function(we){var B=w.prototype.removeAllListeners.apply(this,arguments);return("readable"===we||void 0===we)&&W.nextTick(qe,this),B},ne.prototype.resume=function(){var we=this._readableState;return we.flowing||(S("resume"),we.flowing=!we.readableListening,function(we,B){B.resumeScheduled||(B.resumeScheduled=!0,W.nextTick(G,we,B))}(this,we)),we.paused=!1,this},ne.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},ne.prototype.wrap=function(we){var B=this,N=this._readableState,V=!1;for(var Re in we.on("end",function(){if(S("wrapped end"),N.decoder&&!N.ended){var Tt=N.decoder.end();Tt&&Tt.length&&B.push(Tt)}B.push(null)}),we.on("data",function(Tt){S("wrapped data"),N.decoder&&(Tt=N.decoder.write(Tt)),N.objectMode&&null==Tt||!(N.objectMode||Tt&&Tt.length)||B.push(Tt)||(V=!0,we.pause())}),we)void 0===this[Re]&&"function"==typeof we[Re]&&(this[Re]=function(kt){return function(){return we[kt].apply(we,arguments)}}(Re));for(var Ze=0;Ze<te.length;Ze++)we.on(te[Ze],this.emit.bind(this,te[Ze]));return this._read=function(Tt){S("wrapped _read",Tt),V&&(V=!1,we.resume())},this},"function"==typeof Symbol&&(ne.prototype[Symbol.asyncIterator]=function(){return void 0===Z&&(Z=Y("./internal/streams/async_iterator")),Z(this)}),Object.defineProperty(ne.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ne.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ne.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),ne._fromList=de,Object.defineProperty(ne.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(ne.from=function(we,B){return void 0===ae&&(ae=Y("./internal/streams/from")),ae(ne,we,B)})}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(Y,Se,he){"use strict";Se.exports=R;var W=Y("../errors").codes,j=W.ERR_METHOD_NOT_IMPLEMENTED,k=W.ERR_MULTIPLE_CALLBACK,Q=W.ERR_TRANSFORM_ALREADY_TRANSFORMING,H=W.ERR_TRANSFORM_WITH_LENGTH_0,w=Y("./_stream_duplex");function C(y,S){var A=this._transformState;A.transforming=!1;var z=A.writecb;if(null===z)return this.emit("error",new k);A.writechunk=null,A.writecb=null,null!=S&&this.push(S),z(y);var P=this._readableState;P.reading=!1,(P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark)}function R(y){if(!(this instanceof R))return new R(y);w.call(this,y),this._transformState={afterTransform:C.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",T)}function T(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?b(this,null,null):this._flush(function(S,A){b(y,S,A)})}function b(y,S,A){if(S)return y.emit("error",S);if(null!=A&&y.push(A),y._writableState.length)throw new H;if(y._transformState.transforming)throw new Q;return y.push(null)}Y("inherits")(R,w),R.prototype.push=function(y,S){return this._transformState.needTransform=!1,w.prototype.push.call(this,y,S)},R.prototype._transform=function(y,S,A){A(new j("_transform()"))},R.prototype._write=function(y,S,A){var z=this._transformState;if(z.writecb=A,z.writechunk=y,z.writeencoding=S,!z.transforming){var P=this._readableState;(z.needTransform||P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark)}},R.prototype._read=function(y){var S=this._transformState;null===S.writechunk||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},R.prototype._destroy=function(y,S){w.prototype._destroy.call(this,y,function(A){S(A)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(Y,Se,he){(function(W,j){(function(){"use strict";function Q(pe){var de=this;this.next=null,this.entry=null,this.finish=function(){!function(pe,de,je){var _t=pe.entry;for(pe.entry=null;_t;){var pt=_t.callback;de.pendingcb--,pt(je),_t=_t.next}de.corkedRequestsFree.next=pe}(de,pe)}}var H;Se.exports=me,me.WritableState=te;var w={deprecate:Y("util-deprecate")},C=Y("./internal/streams/stream"),R=Y("buffer").Buffer,T=j.Uint8Array||function(){};var Te,S=Y("./internal/streams/destroy"),z=Y("./internal/streams/state").getHighWaterMark,P=Y("../errors").codes,X=P.ERR_INVALID_ARG_TYPE,ue=P.ERR_METHOD_NOT_IMPLEMENTED,I=P.ERR_MULTIPLE_CALLBACK,O=P.ERR_STREAM_CANNOT_PIPE,K=P.ERR_STREAM_DESTROYED,E=P.ERR_STREAM_NULL_VALUES,$=P.ERR_STREAM_WRITE_AFTER_END,Z=P.ERR_UNKNOWN_ENCODING,ae=S.errorOrDestroy;function oe(){}function te(pe,de,je){H=H||Y("./_stream_duplex"),"boolean"!=typeof je&&(je=de instanceof H),this.objectMode=!!(pe=pe||{}).objectMode,je&&(this.objectMode=this.objectMode||!!pe.writableObjectMode),this.highWaterMark=z(this,pe,"writableHighWaterMark",je),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===pe.decodeStrings),this.defaultEncoding=pe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){!function(pe,de){var je=pe._writableState,_t=je.sync,pt=je.writecb;if("function"!=typeof pt)throw new I;if(function(pe){pe.writing=!1,pe.writecb=null,pe.length-=pe.writelen,pe.writelen=0}(je),de)!function(pe,de,je,_t,pt){--de.pendingcb,je?(W.nextTick(pt,_t),W.nextTick(ke,pe,de),pe._writableState.errorEmitted=!0,ae(pe,_t)):(pt(_t),pe._writableState.errorEmitted=!0,ae(pe,_t),ke(pe,de))}(pe,je,_t,de,pt);else{var we=Me(je)||pe.destroyed;!we&&!je.corked&&!je.bufferProcessing&&je.bufferedRequest&&Ke(pe,je),_t?W.nextTick(ze,pe,je,we,pt):ze(pe,je,we,pt)}}(de,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==pe.emitClose,this.autoDestroy=!!pe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Q(this)}function me(pe){var de=this instanceof(H=H||Y("./_stream_duplex"));if(!de&&!Te.call(me,this))return new me(pe);this._writableState=new te(pe,this,de),this.writable=!0,pe&&("function"==typeof pe.write&&(this._write=pe.write),"function"==typeof pe.writev&&(this._writev=pe.writev),"function"==typeof pe.destroy&&(this._destroy=pe.destroy),"function"==typeof pe.final&&(this._final=pe.final)),C.call(this)}function $e(pe,de,je,_t,pt,we){if(!je){var B=function(pe,de,je){return!pe.objectMode&&!1!==pe.decodeStrings&&"string"==typeof de&&(de=R.from(de,je)),de}(de,_t,pt);_t!==B&&(je=!0,pt="buffer",_t=B)}var N=de.objectMode?1:_t.length;de.length+=N;var V=de.length<de.highWaterMark;if(V||(de.needDrain=!0),de.writing||de.corked){var Re=de.lastBufferedRequest;de.lastBufferedRequest={chunk:_t,encoding:pt,isBuf:je,callback:we,next:null},Re?Re.next=de.lastBufferedRequest:de.bufferedRequest=de.lastBufferedRequest,de.bufferedRequestCount+=1}else st(pe,de,!1,N,_t,pt,we);return V}function st(pe,de,je,_t,pt,we,B){de.writelen=_t,de.writecb=B,de.writing=!0,de.sync=!0,de.destroyed?de.onwrite(new K("write")):je?pe._writev(pt,de.onwrite):pe._write(pt,we,de.onwrite),de.sync=!1}function ze(pe,de,je,_t){je||function(pe,de){0===de.length&&de.needDrain&&(de.needDrain=!1,pe.emit("drain"))}(pe,de),de.pendingcb--,_t(),ke(pe,de)}function Ke(pe,de){de.bufferProcessing=!0;var je=de.bufferedRequest;if(pe._writev&&je&&je.next){var pt=new Array(de.bufferedRequestCount),we=de.corkedRequestsFree;we.entry=je;for(var B=0,N=!0;je;)pt[B]=je,je.isBuf||(N=!1),je=je.next,B+=1;pt.allBuffers=N,st(pe,de,!0,de.length,pt,"",we.finish),de.pendingcb++,de.lastBufferedRequest=null,we.next?(de.corkedRequestsFree=we.next,we.next=null):de.corkedRequestsFree=new Q(de),de.bufferedRequestCount=0}else{for(;je;){var V=je.chunk;if(st(pe,de,!1,de.objectMode?1:V.length,V,je.encoding,je.callback),je=je.next,de.bufferedRequestCount--,de.writing)break}null===je&&(de.lastBufferedRequest=null)}de.bufferedRequest=je,de.bufferProcessing=!1}function Me(pe){return pe.ending&&0===pe.length&&null===pe.bufferedRequest&&!pe.finished&&!pe.writing}function Ue(pe,de){pe._final(function(je){de.pendingcb--,je&&ae(pe,je),de.prefinished=!0,pe.emit("prefinish"),ke(pe,de)})}function ke(pe,de){var je=Me(de);if(je&&(function(pe,de){!de.prefinished&&!de.finalCalled&&("function"!=typeof pe._final||de.destroyed?(de.prefinished=!0,pe.emit("prefinish")):(de.pendingcb++,de.finalCalled=!0,W.nextTick(Ue,pe,de)))}(pe,de),0===de.pendingcb&&(de.finished=!0,pe.emit("finish"),de.autoDestroy))){var _t=pe._readableState;(!_t||_t.autoDestroy&&_t.endEmitted)&&pe.destroy()}return je}Y("inherits")(me,C),te.prototype.getBuffer=function(){for(var de=this.bufferedRequest,je=[];de;)je.push(de),de=de.next;return je},function(){try{Object.defineProperty(te.prototype,"buffer",{get:w.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(pe){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Te=Function.prototype[Symbol.hasInstance],Object.defineProperty(me,Symbol.hasInstance,{value:function(de){return!!Te.call(this,de)||this===me&&de&&de._writableState instanceof te}})):Te=function(de){return de instanceof this},me.prototype.pipe=function(){ae(this,new O)},me.prototype.write=function(pe,de,je){var _t=this._writableState,pt=!1,we=!_t.objectMode&&function(pe){return R.isBuffer(pe)||pe instanceof T}(pe);return we&&!R.isBuffer(pe)&&(pe=function(pe){return R.from(pe)}(pe)),"function"==typeof de&&(je=de,de=null),we?de="buffer":de||(de=_t.defaultEncoding),"function"!=typeof je&&(je=oe),_t.ending?function(pe,de){var je=new $;ae(pe,je),W.nextTick(de,je)}(this,je):(we||function(pe,de,je,_t){var pt;return null===je?pt=new E:"string"!=typeof je&&!de.objectMode&&(pt=new X("chunk",["string","Buffer"],je)),!pt||(ae(pe,pt),W.nextTick(_t,pt),!1)}(this,_t,pe,je))&&(_t.pendingcb++,pt=$e(this,_t,we,pe,de,je)),pt},me.prototype.cork=function(){this._writableState.corked++},me.prototype.uncork=function(){var pe=this._writableState;pe.corked&&(pe.corked--,!pe.writing&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&Ke(this,pe))},me.prototype.setDefaultEncoding=function(de){if("string"==typeof de&&(de=de.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((de+"").toLowerCase())>-1))throw new Z(de);return this._writableState.defaultEncoding=de,this},Object.defineProperty(me.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(me.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),me.prototype._write=function(pe,de,je){je(new ue("_write()"))},me.prototype._writev=null,me.prototype.end=function(pe,de,je){var _t=this._writableState;return"function"==typeof pe?(je=pe,pe=null,de=null):"function"==typeof de&&(je=de,de=null),null!=pe&&this.write(pe,de),_t.corked&&(_t.corked=1,this.uncork()),_t.ending||function(pe,de,je){de.ending=!0,ke(pe,de),je&&(de.finished?W.nextTick(je):pe.once("finish",je)),de.ended=!0,pe.writable=!1}(this,_t,je),this},Object.defineProperty(me.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(me.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(de){!this._writableState||(this._writableState.destroyed=de)}}),me.prototype.destroy=S.destroy,me.prototype._undestroy=S.undestroy,me.prototype._destroy=function(pe,de){de(pe)}}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(Y,Se,he){(function(W){(function(){"use strict";var j;function k(O,K,E){return K in O?Object.defineProperty(O,K,{value:E,enumerable:!0,configurable:!0,writable:!0}):O[K]=E,O}var Q=Y("./end-of-stream"),H=Symbol("lastResolve"),w=Symbol("lastReject"),C=Symbol("error"),R=Symbol("ended"),T=Symbol("lastPromise"),b=Symbol("handlePromise"),y=Symbol("stream");function S(O,K){return{value:O,done:K}}function A(O){var K=O[H];if(null!==K){var E=O[y].read();null!==E&&(O[T]=null,O[H]=null,O[w]=null,K(S(E,!1)))}}function z(O){W.nextTick(A,O)}var X=Object.getPrototypeOf(function(){}),ue=Object.setPrototypeOf((k(j={get stream(){return this[y]},next:function(){var K=this,E=this[C];if(null!==E)return Promise.reject(E);if(this[R])return Promise.resolve(S(void 0,!0));if(this[y].destroyed)return new Promise(function(oe,te){W.nextTick(function(){K[C]?te(K[C]):oe(S(void 0,!0))})});var Z,$=this[T];if($)Z=new Promise(function(O,K){return function(E,$){O.then(function(){K[R]?E(S(void 0,!0)):K[b](E,$)},$)}}($,this));else{var ae=this[y].read();if(null!==ae)return Promise.resolve(S(ae,!1));Z=new Promise(this[b])}return this[T]=Z,Z}},Symbol.asyncIterator,function(){return this}),k(j,"return",function(){var K=this;return new Promise(function(E,$){K[y].destroy(null,function(Z){Z?$(Z):E(S(void 0,!0))})})}),j),X);Se.exports=function(K){var E,$=Object.create(ue,(k(E={},y,{value:K,writable:!0}),k(E,H,{value:null,writable:!0}),k(E,w,{value:null,writable:!0}),k(E,C,{value:null,writable:!0}),k(E,R,{value:K._readableState.endEmitted,writable:!0}),k(E,b,{value:function(ae,oe){var te=$[y].read();te?($[T]=null,$[H]=null,$[w]=null,ae(S(te,!1))):($[H]=ae,$[w]=oe)},writable:!0}),E));return $[T]=null,Q(K,function(Z){if(Z&&"ERR_STREAM_PREMATURE_CLOSE"!==Z.code){var ae=$[w];return null!==ae&&($[T]=null,$[H]=null,$[w]=null,ae(Z)),void($[C]=Z)}var oe=$[H];null!==oe&&($[T]=null,$[H]=null,$[w]=null,oe(S(void 0,!0))),$[R]=!0}),K.on("readable",z.bind(null,$)),$}}).call(this)}).call(this,Y("_process"))},{"./end-of-stream":76,_process:44}],74:[function(Y,Se,he){"use strict";function W(A,z){var P=Object.keys(A);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(A);z&&(X=X.filter(function(ue){return Object.getOwnPropertyDescriptor(A,ue).enumerable})),P.push.apply(P,X)}return P}function k(A,z,P){return z in A?Object.defineProperty(A,z,{value:P,enumerable:!0,configurable:!0,writable:!0}):A[z]=P,A}function H(A,z){for(var P=0;P<z.length;P++){var X=z[P];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(A,X.key,X)}}var R=Y("buffer").Buffer,b=Y("util").inspect,y=b&&b.custom||"inspect";function S(A,z,P){R.prototype.copy.call(A,z,P)}Se.exports=function(){function A(){(function(A,z){if(!(A instanceof z))throw new TypeError("Cannot call a class as a function")})(this,A),this.head=null,this.tail=null,this.length=0}return function(A,z,P){z&&H(A.prototype,z),P&&H(A,P)}(A,[{key:"push",value:function(P){var X={data:P,next:null};this.length>0?this.tail.next=X:this.head=X,this.tail=X,++this.length}},{key:"unshift",value:function(P){var X={data:P,next:this.head};0===this.length&&(this.tail=X),this.head=X,++this.length}},{key:"shift",value:function(){if(0!==this.length){var P=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,P}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(P){if(0===this.length)return"";for(var X=this.head,ue=""+X.data;X=X.next;)ue+=P+X.data;return ue}},{key:"concat",value:function(P){if(0===this.length)return R.alloc(0);for(var X=R.allocUnsafe(P>>>0),ue=this.head,I=0;ue;)S(ue.data,X,I),I+=ue.data.length,ue=ue.next;return X}},{key:"consume",value:function(P,X){var ue;return P<this.head.data.length?(ue=this.head.data.slice(0,P),this.head.data=this.head.data.slice(P)):ue=P===this.head.data.length?this.shift():X?this._getString(P):this._getBuffer(P),ue}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(P){var X=this.head,ue=1,I=X.data;for(P-=I.length;X=X.next;){var O=X.data,K=P>O.length?O.length:P;if(I+=K===O.length?O:O.slice(0,P),0==(P-=K)){K===O.length?(++ue,this.head=X.next?X.next:this.tail=null):(this.head=X,X.data=O.slice(K));break}++ue}return this.length-=ue,I}},{key:"_getBuffer",value:function(P){var X=R.allocUnsafe(P),ue=this.head,I=1;for(ue.data.copy(X),P-=ue.data.length;ue=ue.next;){var O=ue.data,K=P>O.length?O.length:P;if(O.copy(X,X.length-P,0,K),0==(P-=K)){K===O.length?(++I,this.head=ue.next?ue.next:this.tail=null):(this.head=ue,ue.data=O.slice(K));break}++I}return this.length-=I,X}},{key:y,value:function(P,X){return b(this,function(A){for(var z=1;z<arguments.length;z++){var P=null!=arguments[z]?arguments[z]:{};z%2?W(Object(P),!0).forEach(function(X){k(A,X,P[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(P)):W(Object(P)).forEach(function(X){Object.defineProperty(A,X,Object.getOwnPropertyDescriptor(P,X))})}return A}({},X,{depth:0,customInspect:!1}))}}]),A}()},{buffer:6,util:3}],75:[function(Y,Se,he){(function(W){(function(){"use strict";function k(R,T){w(R,T),Q(R)}function Q(R){R._writableState&&!R._writableState.emitClose||R._readableState&&!R._readableState.emitClose||R.emit("close")}function w(R,T){R.emit("error",T)}Se.exports={destroy:function(R,T){var b=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(T?T(R):R&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,W.nextTick(w,this,R)):W.nextTick(w,this,R)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(R||null,function(A){!T&&A?b._writableState?b._writableState.errorEmitted?W.nextTick(Q,b):(b._writableState.errorEmitted=!0,W.nextTick(k,b,A)):W.nextTick(k,b,A):T?(W.nextTick(Q,b),T(A)):W.nextTick(Q,b)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(R,T){var b=R._readableState,y=R._writableState;b&&b.autoDestroy||y&&y.autoDestroy?R.destroy(T):R.emit("error",T)}}}).call(this)}).call(this,Y("_process"))},{_process:44}],76:[function(Y,Se,he){"use strict";var W=Y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function k(){}Se.exports=function H(w,C,R){if("function"==typeof C)return H(w,null,C);C||(C={}),R=function(w){var C=!1;return function(){if(!C){C=!0;for(var R=arguments.length,T=new Array(R),b=0;b<R;b++)T[b]=arguments[b];w.apply(this,T)}}}(R||k);var T=C.readable||!1!==C.readable&&w.readable,b=C.writable||!1!==C.writable&&w.writable,y=function(){w.writable||A()},S=w._writableState&&w._writableState.finished,A=function(){b=!1,S=!0,T||R.call(w)},z=w._readableState&&w._readableState.endEmitted,P=function(){T=!1,z=!0,b||R.call(w)},X=function(K){R.call(w,K)},ue=function(){var K;return T&&!z?((!w._readableState||!w._readableState.ended)&&(K=new W),R.call(w,K)):b&&!S?((!w._writableState||!w._writableState.ended)&&(K=new W),R.call(w,K)):void 0},I=function(){w.req.on("finish",A)};return function(w){return w.setHeader&&"function"==typeof w.abort}(w)?(w.on("complete",A),w.on("abort",ue),w.req?I():w.on("request",I)):b&&!w._writableState&&(w.on("end",y),w.on("close",y)),w.on("end",P),w.on("finish",A),!1!==C.error&&w.on("error",X),w.on("close",ue),function(){w.removeListener("complete",A),w.removeListener("abort",ue),w.removeListener("request",I),w.req&&w.req.removeListener("finish",A),w.removeListener("end",y),w.removeListener("close",y),w.removeListener("finish",A),w.removeListener("end",P),w.removeListener("error",X),w.removeListener("close",ue)}}},{"../../../errors":67}],77:[function(Y,Se,he){Se.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(Y,Se,he){"use strict";var W;var k=Y("../../../errors").codes,Q=k.ERR_MISSING_ARGS,H=k.ERR_STREAM_DESTROYED;function w(A){if(A)throw A}function R(A,z,P,X){X=function(A){var z=!1;return function(){z||(z=!0,A.apply(void 0,arguments))}}(X);var ue=!1;A.on("close",function(){ue=!0}),void 0===W&&(W=Y("./end-of-stream")),W(A,{readable:z,writable:P},function(O){if(O)return X(O);ue=!0,X()});var I=!1;return function(O){if(!ue&&!I){if(I=!0,function(A){return A.setHeader&&"function"==typeof A.abort}(A))return A.abort();if("function"==typeof A.destroy)return A.destroy();X(O||new H("pipe"))}}}function T(A){A()}function b(A,z){return A.pipe(z)}function y(A){return A.length&&"function"==typeof A[A.length-1]?A.pop():w}Se.exports=function(){for(var A=arguments.length,z=new Array(A),P=0;P<A;P++)z[P]=arguments[P];var X=y(z);if(Array.isArray(z[0])&&(z=z[0]),z.length<2)throw new Q("streams");var ue,I=z.map(function(O,K){var E=K<z.length-1;return R(O,E,K>0,function(Z){ue||(ue=Z),Z&&I.forEach(T),!E&&(I.forEach(T),X(ue))})});return z.reduce(b)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(Y,Se,he){"use strict";var W=Y("../../../errors").codes.ERR_INVALID_OPT_VALUE;Se.exports={getHighWaterMark:function(Q,H,w,C){var R=function(Q,H,w){return null!=Q.highWaterMark?Q.highWaterMark:H?Q[w]:null}(H,C,w);if(null!=R){if(!isFinite(R)||Math.floor(R)!==R||R<0)throw new W(C?w:"highWaterMark",R);return Math.floor(R)}return Q.objectMode?16:16384}}},{"../../../errors":67}],80:[function(Y,Se,he){Se.exports=Y("events").EventEmitter},{events:8}],81:[function(Y,Se,he){(he=Se.exports=Y("./lib/_stream_readable.js")).Stream=he,he.Readable=he,he.Writable=Y("./lib/_stream_writable.js"),he.Duplex=Y("./lib/_stream_duplex.js"),he.Transform=Y("./lib/_stream_transform.js"),he.PassThrough=Y("./lib/_stream_passthrough.js"),he.finished=Y("./lib/internal/streams/end-of-stream.js"),he.pipeline=Y("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),function(j){for(var k in j)he.hasOwnProperty(k)||(he[k]=j[k])}(Y("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(Y,Se,he){"use strict";function j(H){const w=[];let C=0;for(;C<H.length;)switch(H[C]){case"/":if("."===H[C+1])if("."===H[C+2]){if(!Q(H[C+3])){w.push([]),C++;break}w.pop(),H[C+3]||w.push([]),C+=3}else{if(!Q(H[C+2])){w.push([]),C++;break}H[C+2]||w.push([]),C+=2}else w.push([]),C++;break;case"#":case"?":w.length||w.push([]),w[w.length-1].push(H.substr(C)),C=H.length;break;default:w.length||w.push([]),w[w.length-1].push(H[C]),C++}return"/"+w.map(R=>R.join("")).join("/")}function k(H,w){let C=w+1;w>=0?"/"===H[w+1]&&"/"===H[w+2]&&(C=w+3):"/"===H[0]&&"/"===H[1]&&(C=2);const R=H.indexOf("/",C);return R<0?H:H.substr(0,R)+j(H.substr(R))}function Q(H){return!H||"#"===H||"?"===H||"/"===H}Object.defineProperty(he,"__esModule",{value:!0}),he.resolve=function(H,w){const C=(w=w||"").indexOf("#");if(C>0&&(w=w.substr(0,C)),!H.length){if(w.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${w}' for value '${H}'`);return w}if(H.startsWith("?")){const z=w.indexOf("?");return z>0&&(w=w.substr(0,z)),w+H}if(H.startsWith("#"))return w+H;if(!w.length){const z=H.indexOf(":");if(z<0)throw new Error(`Found invalid relative IRI '${H}' for a missing baseIRI`);return k(H,z)}const R=H.indexOf(":");if(R>=0)return k(H,R);const T=w.indexOf(":");if(T<0)throw new Error(`Found invalid baseIRI '${w}' for value '${H}'`);const b=w.substr(0,T+1);if(0===H.indexOf("//"))return b+k(H,R);let y;if(w.indexOf("//",T)===T+1){if(y=w.indexOf("/",T+3),y<0)return w.length>T+3?w+"/"+k(H,R):b+k(H,R)}else if(y=w.indexOf("/",T+1),y<0)return b+k(H,R);if(0===H.indexOf("/"))return w.substr(0,y)+j(H);let S=w.substr(y);const A=S.lastIndexOf("/");return A>=0&&A<S.length-1&&(S=S.substr(0,A+1),"."===H[0]&&"."!==H[1]&&"/"!==H[1]&&H[2]&&(H=H.substr(1))),H=j(H=S+H),w.substr(0,y)+H},he.removeDotSegments=j,he.removeDotSegmentsOfPath=k},{}],84:[function(Y,Se,he){var W=Y("buffer"),j=W.Buffer;function k(H,w){for(var C in H)w[C]=H[C]}function Q(H,w,C){return j(H,w,C)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Se.exports=W:(k(W,he),he.Buffer=Q),Q.prototype=Object.create(j.prototype),k(j,Q),Q.from=function(H,w,C){if("number"==typeof H)throw new TypeError("Argument must not be a number");return j(H,w,C)},Q.alloc=function(H,w,C){if("number"!=typeof H)throw new TypeError("Argument must be a number");var R=j(H);return void 0!==w?"string"==typeof C?R.fill(w,C):R.fill(w):R.fill(0),R},Q.allocUnsafe=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return j(H)},Q.allocUnsafeSlow=function(H){if("number"!=typeof H)throw new TypeError("Argument must be a number");return W.SlowBuffer(H)}},{buffer:6}],85:[function(Y,Se,he){(function(W){(function(){!function(j){j.parser=function(q,G){return new Q(q,G)},j.SAXParser=Q,j.SAXStream=y,j.createStream=function(q,G){return new y(q,G)},j.MAX_BUFFER_LENGTH=65536;var R,k=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function Q(q,G){if(!(this instanceof Q))return new Q(q,G);var pe=this;(function(q){for(var G=0,pe=k.length;G<pe;G++)q[k[G]]=""})(pe),pe.q=pe.c="",pe.bufferCheckPosition=j.MAX_BUFFER_LENGTH,pe.opt=G||{},pe.opt.lowercase=pe.opt.lowercase||pe.opt.lowercasetags,pe.looseCase=pe.opt.lowercase?"toLowerCase":"toUpperCase",pe.tags=[],pe.closed=pe.closedRoot=pe.sawRoot=!1,pe.tag=pe.error=null,pe.strict=!!q,pe.noscript=!(!q&&!pe.opt.noscript),pe.state=te.BEGIN,pe.strictEntities=pe.opt.strictEntities,pe.ENTITIES=Object.create(pe.strictEntities?j.XML_ENTITIES:j.ENTITIES),pe.attribList=[],pe.opt.xmlns&&(pe.ns=Object.create(X)),pe.trackPosition=!1!==pe.opt.position,pe.trackPosition&&(pe.position=pe.line=pe.column=0),me(pe,"onready")}j.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(q){function G(){}return G.prototype=q,new G}),Object.keys||(Object.keys=function(q){var G=[];for(var pe in q)q.hasOwnProperty(pe)&&G.push(pe);return G}),Q.prototype={end:function(){st(this)},write:function(q){var G=this;if(this.error)throw this.error;if(G.closed)return $e(G,"Cannot write after close. Assign an onready handler.");if(null===q)return st(G);"object"==typeof q&&(q=q.toString());for(var pe=0,de="";de=qe(q,pe++),G.c=de,de;)switch(G.trackPosition&&(G.position++,"\n"===de?(G.line++,G.column=0):G.column++),G.state){case te.BEGIN:if(G.state=te.BEGIN_WHITESPACE,"\ufeff"===de)continue;Ue(G,de);continue;case te.BEGIN_WHITESPACE:Ue(G,de);continue;case te.TEXT:if(G.sawRoot&&!G.closedRoot){for(var je=pe-1;de&&"<"!==de&&"&"!==de;)(de=qe(q,pe++))&&G.trackPosition&&(G.position++,"\n"===de?(G.line++,G.column=0):G.column++);G.textNode+=q.substring(je,pe-1)}"<"!==de||G.sawRoot&&G.closedRoot&&!G.strict?(!E(de)&&(!G.sawRoot||G.closedRoot)&&Qe(G,"Text data outside of root node."),"&"===de?G.state=te.TEXT_ENTITY:G.textNode+=de):(G.state=te.OPEN_WAKA,G.startTagPosition=G.position);continue;case te.SCRIPT:"<"===de?G.state=te.SCRIPT_ENDING:G.script+=de;continue;case te.SCRIPT_ENDING:"/"===de?G.state=te.CLOSE_TAG:(G.script+="<"+de,G.state=te.SCRIPT);continue;case te.OPEN_WAKA:"!"===de?(G.state=te.SGML_DECL,G.sgmlDecl=""):E(de)||(ae(ue,de)?(G.state=te.OPEN_TAG,G.tagName=de):"/"===de?(G.state=te.CLOSE_TAG,G.tagName=""):"?"===de?(G.state=te.PROC_INST,G.procInstName=G.procInstBody=""):(Qe(G,"Unencoded <"),G.startTagPosition+1<G.position&&(de=new Array(G.position-G.startTagPosition).join(" ")+de),G.textNode+="<"+de,G.state=te.TEXT));continue;case te.SGML_DECL:"[CDATA["===(G.sgmlDecl+de).toUpperCase()?(ne(G,"onopencdata"),G.state=te.CDATA,G.sgmlDecl="",G.cdata=""):G.sgmlDecl+de==="--"?(G.state=te.COMMENT,G.comment="",G.sgmlDecl=""):"DOCTYPE"===(G.sgmlDecl+de).toUpperCase()?(G.state=te.DOCTYPE,(G.doctype||G.sawRoot)&&Qe(G,"Inappropriately located doctype declaration"),G.doctype="",G.sgmlDecl=""):">"===de?(ne(G,"onsgmldeclaration",G.sgmlDecl),G.sgmlDecl="",G.state=te.TEXT):($(de)&&(G.state=te.SGML_DECL_QUOTED),G.sgmlDecl+=de);continue;case te.SGML_DECL_QUOTED:de===G.q&&(G.state=te.SGML_DECL,G.q=""),G.sgmlDecl+=de;continue;case te.DOCTYPE:">"===de?(G.state=te.TEXT,ne(G,"ondoctype",G.doctype),G.doctype=!0):(G.doctype+=de,"["===de?G.state=te.DOCTYPE_DTD:$(de)&&(G.state=te.DOCTYPE_QUOTED,G.q=de));continue;case te.DOCTYPE_QUOTED:G.doctype+=de,de===G.q&&(G.q="",G.state=te.DOCTYPE);continue;case te.DOCTYPE_DTD:G.doctype+=de,"]"===de?G.state=te.DOCTYPE:$(de)&&(G.state=te.DOCTYPE_DTD_QUOTED,G.q=de);continue;case te.DOCTYPE_DTD_QUOTED:G.doctype+=de,de===G.q&&(G.state=te.DOCTYPE_DTD,G.q="");continue;case te.COMMENT:"-"===de?G.state=te.COMMENT_ENDING:G.comment+=de;continue;case te.COMMENT_ENDING:"-"===de?(G.state=te.COMMENT_ENDED,G.comment=Oe(G.opt,G.comment),G.comment&&ne(G,"oncomment",G.comment),G.comment=""):(G.comment+="-"+de,G.state=te.COMMENT);continue;case te.COMMENT_ENDED:">"!==de?(Qe(G,"Malformed comment"),G.comment+="--"+de,G.state=te.COMMENT):G.state=te.TEXT;continue;case te.CDATA:"]"===de?G.state=te.CDATA_ENDING:G.cdata+=de;continue;case te.CDATA_ENDING:"]"===de?G.state=te.CDATA_ENDING_2:(G.cdata+="]"+de,G.state=te.CDATA);continue;case te.CDATA_ENDING_2:">"===de?(G.cdata&&ne(G,"oncdata",G.cdata),ne(G,"onclosecdata"),G.cdata="",G.state=te.TEXT):"]"===de?G.cdata+="]":(G.cdata+="]]"+de,G.state=te.CDATA);continue;case te.PROC_INST:"?"===de?G.state=te.PROC_INST_ENDING:E(de)?G.state=te.PROC_INST_BODY:G.procInstName+=de;continue;case te.PROC_INST_BODY:if(!G.procInstBody&&E(de))continue;"?"===de?G.state=te.PROC_INST_ENDING:G.procInstBody+=de;continue;case te.PROC_INST_ENDING:">"===de?(ne(G,"onprocessinginstruction",{name:G.procInstName,body:G.procInstBody}),G.procInstName=G.procInstBody="",G.state=te.TEXT):(G.procInstBody+="?"+de,G.state=te.PROC_INST_BODY);continue;case te.OPEN_TAG:ae(I,de)?G.tagName+=de:(tt(G),">"===de?Le(G):"/"===de?G.state=te.OPEN_TAG_SLASH:(E(de)||Qe(G,"Invalid character in tag name"),G.state=te.ATTRIB));continue;case te.OPEN_TAG_SLASH:">"===de?(Le(G,!0),Ke(G)):(Qe(G,"Forward-slash in opening tag not followed by >"),G.state=te.ATTRIB);continue;case te.ATTRIB:if(E(de))continue;">"===de?Le(G):"/"===de?G.state=te.OPEN_TAG_SLASH:ae(ue,de)?(G.attribName=de,G.attribValue="",G.state=te.ATTRIB_NAME):Qe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME:"="===de?G.state=te.ATTRIB_VALUE:">"===de?(Qe(G,"Attribute without value"),G.attribValue=G.attribName,ze(G),Le(G)):E(de)?G.state=te.ATTRIB_NAME_SAW_WHITE:ae(I,de)?G.attribName+=de:Qe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME_SAW_WHITE:if("="===de)G.state=te.ATTRIB_VALUE;else{if(E(de))continue;Qe(G,"Attribute without value"),G.tag.attributes[G.attribName]="",G.attribValue="",ne(G,"onattribute",{name:G.attribName,value:""}),G.attribName="",">"===de?Le(G):ae(ue,de)?(G.attribName=de,G.state=te.ATTRIB_NAME):(Qe(G,"Invalid attribute name"),G.state=te.ATTRIB)}continue;case te.ATTRIB_VALUE:if(E(de))continue;$(de)?(G.q=de,G.state=te.ATTRIB_VALUE_QUOTED):(Qe(G,"Unquoted attribute value"),G.state=te.ATTRIB_VALUE_UNQUOTED,G.attribValue=de);continue;case te.ATTRIB_VALUE_QUOTED:if(de!==G.q){"&"===de?G.state=te.ATTRIB_VALUE_ENTITY_Q:G.attribValue+=de;continue}ze(G),G.q="",G.state=te.ATTRIB_VALUE_CLOSED;continue;case te.ATTRIB_VALUE_CLOSED:E(de)?G.state=te.ATTRIB:">"===de?Le(G):"/"===de?G.state=te.OPEN_TAG_SLASH:ae(ue,de)?(Qe(G,"No whitespace between attributes"),G.attribName=de,G.attribValue="",G.state=te.ATTRIB_NAME):Qe(G,"Invalid attribute name");continue;case te.ATTRIB_VALUE_UNQUOTED:if(!Z(de)){"&"===de?G.state=te.ATTRIB_VALUE_ENTITY_U:G.attribValue+=de;continue}ze(G),">"===de?Le(G):G.state=te.ATTRIB;continue;case te.CLOSE_TAG:if(G.tagName)">"===de?Ke(G):ae(I,de)?G.tagName+=de:G.script?(G.script+="</"+G.tagName,G.tagName="",G.state=te.SCRIPT):(E(de)||Qe(G,"Invalid tagname in closing tag"),G.state=te.CLOSE_TAG_SAW_WHITE);else{if(E(de))continue;oe(ue,de)?G.script?(G.script+="</"+de,G.state=te.SCRIPT):Qe(G,"Invalid tagname in closing tag."):G.tagName=de}continue;case te.CLOSE_TAG_SAW_WHITE:if(E(de))continue;">"===de?Ke(G):Qe(G,"Invalid characters in closing tag");continue;case te.TEXT_ENTITY:case te.ATTRIB_VALUE_ENTITY_Q:case te.ATTRIB_VALUE_ENTITY_U:var pt,we;switch(G.state){case te.TEXT_ENTITY:pt=te.TEXT,we="textNode";break;case te.ATTRIB_VALUE_ENTITY_Q:pt=te.ATTRIB_VALUE_QUOTED,we="attribValue";break;case te.ATTRIB_VALUE_ENTITY_U:pt=te.ATTRIB_VALUE_UNQUOTED,we="attribValue"}";"===de?(G[we]+=Me(G),G.entity="",G.state=pt):ae(G.entity.length?K:O,de)?G.entity+=de:(Qe(G,"Invalid character in entity name"),G[we]+="&"+G.entity+de,G.entity="",G.state=pt);continue;default:throw new Error(G,"Unknown state: "+G.state)}return G.position>=G.bufferCheckPosition&&function(q){for(var G=Math.max(j.MAX_BUFFER_LENGTH,10),pe=0,de=0,je=k.length;de<je;de++){var _t=q[k[de]].length;if(_t>G)switch(k[de]){case"textNode":ye(q);break;case"cdata":ne(q,"oncdata",q.cdata),q.cdata="";break;case"script":ne(q,"onscript",q.script),q.script="";break;default:$e(q,"Max buffer length exceeded: "+k[de])}pe=Math.max(pe,_t)}q.bufferCheckPosition=j.MAX_BUFFER_LENGTH-pe+q.position}(G),G},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(q){ye(q),""!==q.cdata&&(ne(q,"oncdata",q.cdata),q.cdata=""),""!==q.script&&(ne(q,"onscript",q.script),q.script="")}(this)}};try{R=Y("stream").Stream}catch(q){R=function(){}}var T=j.EVENTS.filter(function(q){return"error"!==q&&"end"!==q});function y(q,G){if(!(this instanceof y))return new y(q,G);R.apply(this),this._parser=new Q(q,G),this.writable=!0,this.readable=!0;var pe=this;this._parser.onend=function(){pe.emit("end")},this._parser.onerror=function(de){pe.emit("error",de),pe._parser.error=null},this._decoder=null,T.forEach(function(de){Object.defineProperty(pe,"on"+de,{get:function(){return pe._parser["on"+de]},set:function(je){if(!je)return pe.removeAllListeners(de),pe._parser["on"+de]=je,je;pe.on(de,je)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(R.prototype,{constructor:{value:y}})).write=function(q){if("function"==typeof W&&"function"==typeof W.isBuffer&&W.isBuffer(q)){if(!this._decoder){var G=Y("string_decoder").StringDecoder;this._decoder=new G("utf8")}q=this._decoder.write(q)}return this._parser.write(q.toString()),this.emit("data",q),!0},y.prototype.end=function(q){return q&&q.length&&this.write(q),this._parser.end(),!0},y.prototype.on=function(q,G){var pe=this;return!pe._parser["on"+q]&&-1!==T.indexOf(q)&&(pe._parser["on"+q]=function(){var de=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);de.splice(0,0,q),pe.emit.apply(pe,de)}),R.prototype.on.call(pe,q,G)};var z="http://www.w3.org/XML/1998/namespace",P="http://www.w3.org/2000/xmlns/",X={xml:z,xmlns:P},ue=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,I=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,O=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,K=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(q){return" "===q||"\n"===q||"\r"===q||"\t"===q}function $(q){return'"'===q||"'"===q}function Z(q){return">"===q||E(q)}function ae(q,G){return q.test(G)}function oe(q,G){return!ae(q,G)}var q,G,pe,te=0;for(var Te in j.STATE={BEGIN:te++,BEGIN_WHITESPACE:te++,TEXT:te++,TEXT_ENTITY:te++,OPEN_WAKA:te++,SGML_DECL:te++,SGML_DECL_QUOTED:te++,DOCTYPE:te++,DOCTYPE_QUOTED:te++,DOCTYPE_DTD:te++,DOCTYPE_DTD_QUOTED:te++,COMMENT_STARTING:te++,COMMENT:te++,COMMENT_ENDING:te++,COMMENT_ENDED:te++,CDATA:te++,CDATA_ENDING:te++,CDATA_ENDING_2:te++,PROC_INST:te++,PROC_INST_BODY:te++,PROC_INST_ENDING:te++,OPEN_TAG:te++,OPEN_TAG_SLASH:te++,ATTRIB:te++,ATTRIB_NAME:te++,ATTRIB_NAME_SAW_WHITE:te++,ATTRIB_VALUE:te++,ATTRIB_VALUE_QUOTED:te++,ATTRIB_VALUE_CLOSED:te++,ATTRIB_VALUE_UNQUOTED:te++,ATTRIB_VALUE_ENTITY_Q:te++,ATTRIB_VALUE_ENTITY_U:te++,CLOSE_TAG:te++,CLOSE_TAG_SAW_WHITE:te++,SCRIPT:te++,SCRIPT_ENDING:te++},j.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},j.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(j.ENTITIES).forEach(function(q){var G=j.ENTITIES[q],pe="number"==typeof G?String.fromCharCode(G):G;j.ENTITIES[q]=pe}),j.STATE)j.STATE[j.STATE[Te]]=Te;function me(q,G,pe){q[G]&&q[G](pe)}function ne(q,G,pe){q.textNode&&ye(q),me(q,G,pe)}function ye(q){q.textNode=Oe(q.opt,q.textNode),q.textNode&&me(q,"ontext",q.textNode),q.textNode=""}function Oe(q,G){return q.trim&&(G=G.trim()),q.normalize&&(G=G.replace(/\s+/g," ")),G}function $e(q,G){return ye(q),q.trackPosition&&(G+="\nLine: "+q.line+"\nColumn: "+q.column+"\nChar: "+q.c),G=new Error(G),q.error=G,me(q,"onerror",G),q}function st(q){return q.sawRoot&&!q.closedRoot&&Qe(q,"Unclosed root tag"),q.state!==te.BEGIN&&q.state!==te.BEGIN_WHITESPACE&&q.state!==te.TEXT&&$e(q,"Unexpected end"),ye(q),q.c="",q.closed=!0,me(q,"onend"),Q.call(q,q.strict,q.opt),q}function Qe(q,G){if("object"!=typeof q||!(q instanceof Q))throw new Error("bad call to strictFail");q.strict&&$e(q,G)}function tt(q){q.strict||(q.tagName=q.tagName[q.looseCase]());var G=q.tags[q.tags.length-1]||q,pe=q.tag={name:q.tagName,attributes:{}};q.opt.xmlns&&(pe.ns=G.ns),q.attribList.length=0,ne(q,"onopentagstart",pe)}function Xe(q,G){var de=q.indexOf(":")<0?["",q]:q.split(":"),je=de[0],_t=de[1];return G&&"xmlns"===q&&(je="xmlns",_t=""),{prefix:je,local:_t}}function ze(q){if(q.strict||(q.attribName=q.attribName[q.looseCase]()),-1!==q.attribList.indexOf(q.attribName)||q.tag.attributes.hasOwnProperty(q.attribName))q.attribName=q.attribValue="";else{if(q.opt.xmlns){var G=Xe(q.attribName,!0),de=G.local;if("xmlns"===G.prefix)if("xml"===de&&q.attribValue!==z)Qe(q,"xml: prefix must be bound to "+z+"\nActual: "+q.attribValue);else if("xmlns"===de&&q.attribValue!==P)Qe(q,"xmlns: prefix must be bound to "+P+"\nActual: "+q.attribValue);else{var je=q.tag,_t=q.tags[q.tags.length-1]||q;je.ns===_t.ns&&(je.ns=Object.create(_t.ns)),je.ns[de]=q.attribValue}q.attribList.push([q.attribName,q.attribValue])}else q.tag.attributes[q.attribName]=q.attribValue,ne(q,"onattribute",{name:q.attribName,value:q.attribValue});q.attribName=q.attribValue=""}}function Le(q,G){if(q.opt.xmlns){var pe=q.tag,de=Xe(q.tagName);pe.prefix=de.prefix,pe.local=de.local,pe.uri=pe.ns[de.prefix]||"",pe.prefix&&!pe.uri&&(Qe(q,"Unbound namespace prefix: "+JSON.stringify(q.tagName)),pe.uri=de.prefix),pe.ns&&(q.tags[q.tags.length-1]||q).ns!==pe.ns&&Object.keys(pe.ns).forEach(function(In){ne(q,"onopennamespace",{prefix:In,uri:pe.ns[In]})});for(var _t=0,pt=q.attribList.length;_t<pt;_t++){var we=q.attribList[_t],B=we[0],N=we[1],V=Xe(B,!0),Re=V.prefix,Tt=""===Re?"":pe.ns[Re]||"",kt={name:B,value:N,prefix:Re,local:V.local,uri:Tt};Re&&"xmlns"!==Re&&!Tt&&(Qe(q,"Unbound namespace prefix: "+JSON.stringify(Re)),kt.uri=Re),q.tag.attributes[B]=kt,ne(q,"onattribute",kt)}q.attribList.length=0}q.tag.isSelfClosing=!!G,q.sawRoot=!0,q.tags.push(q.tag),ne(q,"onopentag",q.tag),G||(q.state=q.noscript||"script"!==q.tagName.toLowerCase()?te.TEXT:te.SCRIPT,q.tag=null,q.tagName=""),q.attribName=q.attribValue="",q.attribList.length=0}function Ke(q){if(!q.tagName)return Qe(q,"Weird empty close tag."),q.textNode+="</>",void(q.state=te.TEXT);if(q.script){if("script"!==q.tagName)return q.script+="</"+q.tagName+">",q.tagName="",void(q.state=te.SCRIPT);ne(q,"onscript",q.script),q.script=""}var G=q.tags.length,pe=q.tagName;q.strict||(pe=pe[q.looseCase]());for(var de=pe;G--&&q.tags[G].name!==de;)Qe(q,"Unexpected close tag");if(G<0)return Qe(q,"Unmatched closing tag: "+q.tagName),q.textNode+="</"+q.tagName+">",void(q.state=te.TEXT);q.tagName=pe;for(var _t=q.tags.length;_t-- >G;){var pt=q.tag=q.tags.pop();q.tagName=q.tag.name,ne(q,"onclosetag",q.tagName);var we={};for(var B in pt.ns)we[B]=pt.ns[B];q.opt.xmlns&&pt.ns!==(q.tags[q.tags.length-1]||q).ns&&Object.keys(pt.ns).forEach(function(V){ne(q,"onclosenamespace",{prefix:V,uri:pt.ns[V]})})}0===G&&(q.closedRoot=!0),q.tagName=q.attribValue=q.attribName="",q.attribList.length=0,q.state=te.TEXT}function Me(q){var de,G=q.entity,pe=G.toLowerCase(),je="";return q.ENTITIES[G]?q.ENTITIES[G]:q.ENTITIES[pe]?q.ENTITIES[pe]:("#"===(G=pe).charAt(0)&&("x"===G.charAt(1)?(G=G.slice(2),je=(de=parseInt(G,16)).toString(16)):(G=G.slice(1),je=(de=parseInt(G,10)).toString(10))),G=G.replace(/^0+/,""),isNaN(de)||je.toLowerCase()!==G?(Qe(q,"Invalid character entity"),"&"+q.entity+";"):String.fromCodePoint(de))}function Ue(q,G){"<"===G?(q.state=te.OPEN_WAKA,q.startTagPosition=q.position):E(G)||(Qe(q,"Non-whitespace before first tag."),q.textNode=G,q.state=te.TEXT)}function qe(q,G){var pe="";return G<q.length&&(pe=q.charAt(G)),pe}te=j.STATE,String.fromCodePoint||(q=String.fromCharCode,G=Math.floor,pe=function(){var de=16384,je=[],we=-1,B=arguments.length;if(!B)return"";for(var N="";++we<B;){var V=Number(arguments[we]);if(!isFinite(V)||V<0||V>1114111||G(V)!==V)throw RangeError("Invalid code point: "+V);V<=65535?je.push(V):je.push(55296+((V-=65536)>>10),V%1024+56320),(we+1===B||je.length>de)&&(N+=q.apply(null,je),je.length=0)}return N},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:pe,configurable:!0,writable:!0}):String.fromCodePoint=pe)}(void 0===he?this.sax={}:he)}).call(this)}).call(this,Y("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(Y,Se,he){(function(W,j){(function(){!function(k,Q){"use strict";if(!k.setImmediate){var T,H=1,w={},C=!1,R=k.document,K=Object.getPrototypeOf&&Object.getPrototypeOf(k);K=K&&K.setTimeout?K:k,"[object process]"==={}.toString.call(k.process)?T=function(E){W.nextTick(function(){A(E)})}:function(){if(k.postMessage&&!k.importScripts){var E=!0,$=k.onmessage;return k.onmessage=function(){E=!1},k.postMessage("","*"),k.onmessage=$,E}}()?(E="setImmediate$"+Math.random()+"$",$=function(Z){Z.source===k&&"string"==typeof Z.data&&0===Z.data.indexOf(E)&&A(+Z.data.slice(E.length))},k.addEventListener?k.addEventListener("message",$,!1):k.attachEvent("onmessage",$),T=function(Z){k.postMessage(E+Z,"*")}):k.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function($){A($.data)},T=function($){E.port2.postMessage($)}}():R&&"onreadystatechange"in R.createElement("script")?function(){var E=R.documentElement;T=function($){var Z=R.createElement("script");Z.onreadystatechange=function(){A($),Z.onreadystatechange=null,E.removeChild(Z),Z=null},E.appendChild(Z)}}():T=function(E){setTimeout(A,0,E)},K.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var $=new Array(arguments.length-1),Z=0;Z<$.length;Z++)$[Z]=arguments[Z+1];return w[H]={callback:E,args:$},T(H),H++},K.clearImmediate=y}var E,$;function y(E){delete w[E]}function A(E){if(C)setTimeout(A,0,E);else{var $=w[E];if($){C=!0;try{!function(E){var $=E.callback,Z=E.args;switch(Z.length){case 0:$();break;case 1:$(Z[0]);break;case 2:$(Z[0],Z[1]);break;case 3:$(Z[0],Z[1],Z[2]);break;default:$.apply(void 0,Z)}}($)}finally{y(E),C=!1}}}}}("undefined"==typeof self?void 0===j?this:j:self)}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(Y,Se,he){Se.exports=k;var W=Y("events").EventEmitter;function k(){W.call(this)}Y("inherits")(k,W),k.Readable=Y("readable-stream/lib/_stream_readable.js"),k.Writable=Y("readable-stream/lib/_stream_writable.js"),k.Duplex=Y("readable-stream/lib/_stream_duplex.js"),k.Transform=Y("readable-stream/lib/_stream_transform.js"),k.PassThrough=Y("readable-stream/lib/_stream_passthrough.js"),k.finished=Y("readable-stream/lib/internal/streams/end-of-stream.js"),k.pipeline=Y("readable-stream/lib/internal/streams/pipeline.js"),k.Stream=k,k.prototype.pipe=function(Q,H){var w=this;function C(z){Q.writable&&!1===Q.write(z)&&w.pause&&w.pause()}function R(){w.readable&&w.resume&&w.resume()}w.on("data",C),Q.on("drain",R),!Q._isStdio&&(!H||!1!==H.end)&&(w.on("end",b),w.on("close",y));var T=!1;function b(){T||(T=!0,Q.end())}function y(){T||(T=!0,"function"==typeof Q.destroy&&Q.destroy())}function S(z){if(A(),0===W.listenerCount(this,"error"))throw z}function A(){w.removeListener("data",C),Q.removeListener("drain",R),w.removeListener("end",b),w.removeListener("close",y),w.removeListener("error",S),Q.removeListener("error",S),w.removeListener("end",A),w.removeListener("close",A),Q.removeListener("close",A)}return w.on("error",S),Q.on("error",S),w.on("end",A),w.on("close",A),Q.on("close",A),Q.emit("pipe",w),Q}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(Y,Se,he){arguments[4][5][0].apply(he,arguments)},{dup:5,"safe-buffer":84}],89:[function(Y,Se,he){(function(W,j){(function(){var k=Y("process/browser.js").nextTick,Q=Function.prototype.apply,H=Array.prototype.slice,w={},C=0;function R(T,b){this._id=T,this._clearFn=b}he.setTimeout=function(){return new R(Q.call(setTimeout,window,arguments),clearTimeout)},he.setInterval=function(){return new R(Q.call(setInterval,window,arguments),clearInterval)},he.clearTimeout=he.clearInterval=function(T){T.close()},R.prototype.unref=R.prototype.ref=function(){},R.prototype.close=function(){this._clearFn.call(window,this._id)},he.enroll=function(T,b){clearTimeout(T._idleTimeoutId),T._idleTimeout=b},he.unenroll=function(T){clearTimeout(T._idleTimeoutId),T._idleTimeout=-1},he._unrefActive=he.active=function(T){clearTimeout(T._idleTimeoutId);var b=T._idleTimeout;b>=0&&(T._idleTimeoutId=setTimeout(function(){T._onTimeout&&T._onTimeout()},b))},he.setImmediate="function"==typeof W?W:function(T){var b=C++,y=!(arguments.length<2)&&H.call(arguments,1);return w[b]=!0,k(function(){w[b]&&(y?T.apply(null,y):T.call(null),he.clearImmediate(b))}),b},he.clearImmediate="function"==typeof j?j:function(T){delete w[T]}}).call(this)}).call(this,Y("timers").setImmediate,Y("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(Y,Se,he){(function(W){(function(){function k(Q){try{if(!W.localStorage)return!1}catch(w){return!1}var H=W.localStorage[Q];return null!=H&&"true"===String(H).toLowerCase()}Se.exports=function(Q,H){if(k("noDeprecation"))return Q;var w=!1;return function(){if(!w){if(k("throwDeprecation"))throw new Error(H);k("traceDeprecation")?console.trace(H):console.warn(H),w=!0}return Q.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(Y,Se,he){"use strict";Se.exports=function(W){W.prototype[Symbol.iterator]=function*(){for(let j=this.head;j;j=j.next)yield j.value}}},{}],92:[function(Y,Se,he){"use strict";function W(w){var C=this;if(C instanceof W||(C=new W),C.tail=null,C.head=null,C.length=0,w&&"function"==typeof w.forEach)w.forEach(function(b){C.push(b)});else if(arguments.length>0)for(var R=0,T=arguments.length;R<T;R++)C.push(arguments[R]);return C}function j(w,C,R){var T=C===w.head?new H(R,null,C,w):new H(R,C,C.next,w);return null===T.next&&(w.tail=T),null===T.prev&&(w.head=T),w.length++,T}function k(w,C){w.tail=new H(C,w.tail,null,w),w.head||(w.head=w.tail),w.length++}function Q(w,C){w.head=new H(C,null,w.head,w),w.tail||(w.tail=w.head),w.length++}function H(w,C,R,T){if(!(this instanceof H))return new H(w,C,R,T);this.list=T,this.value=w,C?(C.next=this,this.prev=C):this.prev=null,R?(R.prev=this,this.next=R):this.next=null}Se.exports=W,W.Node=H,W.create=W,W.prototype.removeNode=function(w){if(w.list!==this)throw new Error("removing node which does not belong to this list");var C=w.next,R=w.prev;return C&&(C.prev=R),R&&(R.next=C),w===this.head&&(this.head=C),w===this.tail&&(this.tail=R),w.list.length--,w.next=null,w.prev=null,w.list=null,C},W.prototype.unshiftNode=function(w){if(w!==this.head){w.list&&w.list.removeNode(w);var C=this.head;w.list=this,w.next=C,C&&(C.prev=w),this.head=w,this.tail||(this.tail=w),this.length++}},W.prototype.pushNode=function(w){if(w!==this.tail){w.list&&w.list.removeNode(w);var C=this.tail;w.list=this,w.prev=C,C&&(C.next=w),this.tail=w,this.head||(this.head=w),this.length++}},W.prototype.push=function(){for(var w=0,C=arguments.length;w<C;w++)k(this,arguments[w]);return this.length},W.prototype.unshift=function(){for(var w=0,C=arguments.length;w<C;w++)Q(this,arguments[w]);return this.length},W.prototype.pop=function(){if(this.tail){var w=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,w}},W.prototype.shift=function(){if(this.head){var w=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,w}},W.prototype.forEach=function(w,C){C=C||this;for(var R=this.head,T=0;null!==R;T++)w.call(C,R.value,T,this),R=R.next},W.prototype.forEachReverse=function(w,C){C=C||this;for(var R=this.tail,T=this.length-1;null!==R;T--)w.call(C,R.value,T,this),R=R.prev},W.prototype.get=function(w){for(var C=0,R=this.head;null!==R&&C<w;C++)R=R.next;if(C===w&&null!==R)return R.value},W.prototype.getReverse=function(w){for(var C=0,R=this.tail;null!==R&&C<w;C++)R=R.prev;if(C===w&&null!==R)return R.value},W.prototype.map=function(w,C){C=C||this;for(var R=new W,T=this.head;null!==T;)R.push(w.call(C,T.value,this)),T=T.next;return R},W.prototype.mapReverse=function(w,C){C=C||this;for(var R=new W,T=this.tail;null!==T;)R.push(w.call(C,T.value,this)),T=T.prev;return R},W.prototype.reduce=function(w,C){var R,T=this.head;if(arguments.length>1)R=C;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");T=this.head.next,R=this.head.value}for(var b=0;null!==T;b++)R=w(R,T.value,b),T=T.next;return R},W.prototype.reduceReverse=function(w,C){var R,T=this.tail;if(arguments.length>1)R=C;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");T=this.tail.prev,R=this.tail.value}for(var b=this.length-1;null!==T;b--)R=w(R,T.value,b),T=T.prev;return R},W.prototype.toArray=function(){for(var w=new Array(this.length),C=0,R=this.head;null!==R;C++)w[C]=R.value,R=R.next;return w},W.prototype.toArrayReverse=function(){for(var w=new Array(this.length),C=0,R=this.tail;null!==R;C++)w[C]=R.value,R=R.prev;return w},W.prototype.slice=function(w,C){(C=C||this.length)<0&&(C+=this.length),(w=w||0)<0&&(w+=this.length);var R=new W;if(C<w||C<0)return R;w<0&&(w=0),C>this.length&&(C=this.length);for(var T=0,b=this.head;null!==b&&T<w;T++)b=b.next;for(;null!==b&&T<C;T++,b=b.next)R.push(b.value);return R},W.prototype.sliceReverse=function(w,C){(C=C||this.length)<0&&(C+=this.length),(w=w||0)<0&&(w+=this.length);var R=new W;if(C<w||C<0)return R;w<0&&(w=0),C>this.length&&(C=this.length);for(var T=this.length,b=this.tail;null!==b&&T>C;T--)b=b.prev;for(;null!==b&&T>w;T--,b=b.prev)R.push(b.value);return R},W.prototype.splice=function(w,C,...R){w>this.length&&(w=this.length-1),w<0&&(w=this.length+w);for(var T=0,b=this.head;null!==b&&T<w;T++)b=b.next;var y=[];for(T=0;b&&T<C;T++)y.push(b.value),b=this.removeNode(b);for(null===b&&(b=this.tail),b!==this.head&&b!==this.tail&&(b=b.prev),T=0;T<R.length;T++)b=j(this,b,R[T]);return y},W.prototype.reverse=function(){for(var w=this.head,C=this.tail,R=w;null!==R;R=R.prev){var T=R.prev;R.prev=R.next,R.next=T}return this.head=C,this.tail=w,this};try{Y("./iterator.js")(W)}catch(w){}},{"./iterator.js":91}]},{},[1])(1)},1002:Ut=>{"use strict";Ut.exports=et,Ut.exports.default=et;var it=1e20;function et(Y,Se,he,W,j,k){this.fontSize=Y||24,this.buffer=void 0===Se?3:Se,this.cutoff=W||.25,this.fontFamily=j||"sans-serif",this.fontWeight=k||"normal",this.radius=he||8;var Q=this.size=this.fontSize+2*this.buffer,H=Q+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(H*H),this.gridInner=new Float64Array(H*H),this.f=new Float64Array(H),this.z=new Float64Array(H+1),this.v=new Uint16Array(H),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Dt(Y,Se,he,W,j,k){for(var Q=0;Q<Se;Q++)dt(Y,Q,Se,he,W,j,k);for(var H=0;H<he;H++)dt(Y,H*Se,1,Se,W,j,k)}function dt(Y,Se,he,W,j,k,Q){var H,w,C,R;for(k[0]=0,Q[0]=-it,Q[1]=it,H=0;H<W;H++)j[H]=Y[Se+H*he];for(H=1,w=0,C=0;H<W;H++){do{C=(j[H]-j[R=k[w]]+H*H-R*R)/(H-R)/2}while(C<=Q[w]&&--w>-1);k[++w]=H,Q[w]=C,Q[w+1]=it}for(H=0,w=0;H<W;H++){for(;Q[w+1]<H;)w++;Y[Se+H*he]=j[R=k[w]]+(H-R)*(H-R)}}et.prototype._draw=function(Y,Se){var k,Q,H,w,C,R,T,b,y,he=this.ctx.measureText(Y),W=he.width,j=2*this.buffer;Se&&this.useMetrics?(C=Math.floor(he.actualBoundingBoxAscent),b=this.buffer+Math.ceil(he.actualBoundingBoxAscent),R=this.buffer,T=this.buffer,k=(Q=Math.min(this.size,Math.ceil(he.actualBoundingBoxRight-he.actualBoundingBoxLeft)))+j,H=(w=Math.min(this.size-R,Math.ceil(he.actualBoundingBoxAscent+he.actualBoundingBoxDescent)))+j,this.ctx.textBaseline="alphabetic"):(k=Q=this.size,H=w=this.size,C=19*this.fontSize/24,R=T=0,b=this.middle,this.ctx.textBaseline="middle"),Q&&w&&(this.ctx.clearRect(T,R,Q,w),this.ctx.fillText(Y,this.buffer,b),y=this.ctx.getImageData(T,R,Q,w));var S=new Uint8ClampedArray(k*H);return function(Y,Se,he,W,j,k,Q){k.fill(it,0,Se*he),Q.fill(0,0,Se*he);for(var H=(Se-W)/2,w=0;w<j;w++)for(var C=0;C<W;C++){var R=(w+H)*Se+C+H,T=Y.data[4*(w*W+C)+3]/255;if(1===T)k[R]=0,Q[R]=it;else if(0===T)k[R]=it,Q[R]=0;else{var b=Math.max(0,.5-T),y=Math.max(0,T-.5);k[R]=b*b,Q[R]=y*y}}}(y,k,H,Q,w,this.gridOuter,this.gridInner),Dt(this.gridOuter,k,H,this.f,this.v,this.z),Dt(this.gridInner,k,H,this.f,this.v,this.z),function(Y,Se,he,W,j,k,Q){for(var H=0;H<Se*he;H++){var w=Math.sqrt(W[H])-Math.sqrt(j[H]);Y[H]=Math.round(255-255*(w/k+Q))}}(S,k,H,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:S,metrics:{width:Q,height:w,sdfWidth:k,sdfHeight:H,top:C,left:0,advance:W}}},et.prototype.draw=function(Y){return this._draw(Y,!1).data},et.prototype.drawWithMetrics=function(Y){return this._draw(Y,!0)}},322:Ut=>{Ut.exports=function(et,yt){var ee=yt.length;if(0!==ee){var Dt=et.length;et.length+=ee;for(var dt=0;dt<ee;dt++)et[Dt+dt]=yt[dt]}}},4517:(Ut,it)=>{"use strict";var yt=(()=>{return(Dt=yt||(yt={})).typeOfFunction="function",Dt.boolTrue=!0,yt;var Dt})();function ee(Dt,dt,Y){if(!Y||typeof Y.value!==yt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:yt.boolTrue,get:function(){var Se=Y.value.bind(this);return Object.defineProperty(this,dt,{value:Se,configurable:yt.boolTrue,writable:yt.boolTrue}),Se}}}it.ak=ee,it.ZP=ee},7266:(Ut,it,et)=>{Ut.exports={ResizeSensor:et(9835),ElementQueries:et(4845)}},4845:function(Ut,it,et){"use strict";var yt,ee,Dt;"undefined"!=typeof window&&window,ee=[et(9835)],void 0!==(Dt="function"==typeof(yt=function(dt){var Y=function(){var he,W={},j=[];function k(I){I||(I=document.documentElement);var O=window.getComputedStyle(I,null).fontSize;return parseFloat(O)||16}function H(I,O){var K=O.split(/\d/),E=K[K.length-1];switch(O=parseFloat(O),E){case"px":return O;case"em":return O*k(I);case"rem":return O*k();case"vw":return O*document.documentElement.clientWidth/100;case"vh":return O*document.documentElement.clientHeight/100;case"vmin":case"vmax":var $=document.documentElement.clientWidth/100,Z=document.documentElement.clientHeight/100;return O*(0,Math["vmin"===E?"min":"max"])($,Z);default:return O}}function w(I,O){this.element=I;var K,E,$,Z,ae,oe,te,Te,me=["min-width","min-height","max-width","max-height"];this.call=function(){for(K in $=function(I){if(!I.getBoundingClientRect)return{width:I.offsetWidth,height:I.offsetHeight};var O=I.getBoundingClientRect();return{width:Math.round(O.width),height:Math.round(O.height)}}(this.element),oe={},W[O])!W[O].hasOwnProperty(K)||(Z=H(this.element,(E=W[O][K]).value),ae="width"===E.property?$.width:$.height,te="","min"===E.mode&&ae>=Z&&(te+=E.value),"max"===E.mode&&ae<=Z&&(te+=E.value),oe[Te=E.mode+"-"+E.property]||(oe[Te]=""),te&&-1===(" "+oe[Te]+" ").indexOf(" "+te+" ")&&(oe[Te]+=" "+te));for(var ne in me)!me.hasOwnProperty(ne)||(oe[me[ne]]?this.element.setAttribute(me[ne],oe[me[ne]].substr(1)):this.element.removeAttribute(me[ne]))}}function C(I,O){I.elementQueriesSetupInformation||(I.elementQueriesSetupInformation=new w(I,O)),I.elementQueriesSensor||(I.elementQueriesSensor=new dt(I,function(){I.elementQueriesSetupInformation.call()}))}function R(I,O,K,E){if(void 0===W[I]){W[I]=[];var $=j.length;he.innerHTML+="\n"+I+" {animation: 0.1s element-queries;}",he.innerHTML+="\n"+I+" > .resize-sensor {min-width: "+$+"px;}",j.push(I)}W[I].push({mode:O,property:K,value:E})}function T(I){var O;if(document.querySelectorAll&&(O=I?I.querySelectorAll.bind(I):document.querySelectorAll.bind(document)),!O&&"undefined"!=typeof $$&&(O=$$),!O&&"undefined"!=typeof jQuery&&(O=jQuery),!O)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return O}function y(I){var O=[],K=[],E=[],$=0,Z=-1,ae=[];for(var oe in I.children)if(I.children.hasOwnProperty(oe)&&I.children[oe].tagName&&"img"===I.children[oe].tagName.toLowerCase()){O.push(I.children[oe]);var te=I.children[oe].getAttribute("min-width")||I.children[oe].getAttribute("data-min-width"),Te=I.children[oe].getAttribute("data-src")||I.children[oe].getAttribute("url");E.push(Te),K.push({minWidth:te}),te?I.children[oe].style.display="none":($=O.length-1,I.children[oe].style.display="block")}function ne(){var Oe,ye=!1;for(Oe in O)!O.hasOwnProperty(Oe)||K[Oe].minWidth&&I.offsetWidth>K[Oe].minWidth&&(ye=Oe);if(ye||(ye=$),Z!==ye)if(ae[ye])O[Z].style.display="none",O[ye].style.display="block",Z=ye;else{var $e=new Image;$e.onload=function(){O[ye].src=E[ye],O[Z].style.display="none",O[ye].style.display="block",ae[ye]=!0,Z=ye},$e.src=E[ye]}else O[ye].src=E[ye]}Z=$,I.resizeSensorInstance=new dt(I,ne),ne()}var A=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,z=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function P(I){var O,K,E,$;for(I=I.replace(/'/g,'"');null!==(O=A.exec(I));)for(K=O[1]+O[3],E=O[2];null!==($=z.exec(E));)R(K,$[1],$[2],$[3])}function X(I){var O="";if(I)if("string"==typeof I)(-1!==(I=I.toLowerCase()).indexOf("min-width")||-1!==I.indexOf("max-width"))&&P(I);else for(var K=0,E=I.length;K<E;K++)1===I[K].type?(-1!==(O=I[K].selectorText||I[K].cssText).indexOf("min-height")||-1!==O.indexOf("max-height")||-1!==O.indexOf("min-width")||-1!==O.indexOf("max-width"))&&P(O):4===I[K].type?X(I[K].cssRules||I[K].rules):3===I[K].type&&I[K].styleSheet.hasOwnProperty("cssRules")&&X(I[K].styleSheet.cssRules)}var ue=!1;this.init=function(){var I="animationstart";void 0!==document.documentElement.style.webkitAnimationName?I="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?I="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(I="oanimationstart"),document.body.addEventListener(I,function(E){var $=E.target,Z=$&&window.getComputedStyle($,null),ae=Z&&Z.getPropertyValue("animation-name");if(ae&&-1!==ae.indexOf("element-queries")){$.elementQueriesSensor=new dt($,function(){$.elementQueriesSetupInformation&&$.elementQueriesSetupInformation.call()});var Te=window.getComputedStyle($.resizeSensor,null).getPropertyValue("min-width");Te=parseInt(Te.replace("px","")),C(E.target,j[Te])}}),ue||((he=document.createElement("style")).type="text/css",he.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",he.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(he),ue=!0);for(var O=0,K=document.styleSheets.length;O<K;O++)try{document.styleSheets[O].href&&0===document.styleSheets[O].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[O].href),X(document.styleSheets[O].cssRules||document.styleSheets[O].rules||document.styleSheets[O].cssText)}catch(E){}!function(){for(var O=T()("[data-responsive-image],[responsive-image]"),K=0,E=O.length;K<E;K++)y(O[K])}()},this.findElementQueriesElements=function(I){!function(I){var O=T(I);for(var K in W)if(W.hasOwnProperty(K))for(var E=O(K,I),$=0,Z=E.length;$<Z;$++)C(E[$],K)}(I)},this.update=function(){this.init()}};Y.update=function(){Y.instance.update()},Y.detach=function(he){he.elementQueriesSetupInformation?(he.elementQueriesSensor.detach(),delete he.elementQueriesSetupInformation,delete he.elementQueriesSensor):he.resizeSensorInstance&&(he.resizeSensorInstance.detach(),delete he.resizeSensorInstance)},Y.init=function(){Y.instance||(Y.instance=new Y),Y.instance.init()};return Y.findElementQueriesElements=function(he){Y.instance.findElementQueriesElements(he)},Y.listen=function(){!function(he){if(document.addEventListener)document.addEventListener("DOMContentLoaded",he,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var W=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(he(),clearInterval(W))},10);else window.onload=he}(Y.init)},Y})?yt.apply(it,ee):yt)&&(Ut.exports=Dt)},9835:function(Ut,it,et){"use strict";var yt,ee;"undefined"!=typeof window&&window,void 0!==(ee="function"==typeof(yt=function(){if("undefined"==typeof window)return null;var Dt="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=Dt.requestAnimationFrame||Dt.mozRequestAnimationFrame||Dt.webkitRequestAnimationFrame||function(Q){return Dt.setTimeout(Q,20)},Y=Dt.cancelAnimationFrame||Dt.mozCancelAnimationFrame||Dt.webkitCancelAnimationFrame||function(Q){Dt.clearTimeout(Q)};function Se(Q,H){var w=Object.prototype.toString.call(Q),C="[object Array]"===w||"[object NodeList]"===w||"[object HTMLCollection]"===w||"[object Object]"===w||"undefined"!=typeof jQuery&&Q instanceof jQuery||"undefined"!=typeof Elements&&Q instanceof Elements,R=0,T=Q.length;if(C)for(;R<T;R++)H(Q[R]);else H(Q)}function he(Q){if(!Q.getBoundingClientRect)return{width:Q.offsetWidth,height:Q.offsetHeight};var H=Q.getBoundingClientRect();return{width:Math.round(H.width),height:Math.round(H.height)}}function W(Q,H){Object.keys(H).forEach(function(w){Q.style[w]=H[w]})}var j=function(Q,H){var w=0;function C(){var b,y,T=[];this.add=function(S){T.push(S)},this.call=function(S){for(b=0,y=T.length;b<y;b++)T[b].call(this,S)},this.remove=function(S){var A=[];for(b=0,y=T.length;b<y;b++)T[b]!==S&&A.push(T[b]);T=A},this.length=function(){return T.length}}function R(T,b){if(T){if(T.resizedAttached)return void T.resizedAttached.add(b);T.resizedAttached=new C,T.resizedAttached.add(b),T.resizeSensor=document.createElement("div"),T.resizeSensor.dir="ltr",T.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},S={position:"absolute",left:"0px",top:"0px",transition:"0s"};W(T.resizeSensor,y);var A=document.createElement("div");A.className="resize-sensor-expand",W(A,y);var z=document.createElement("div");W(z,S),A.appendChild(z);var P=document.createElement("div");P.className="resize-sensor-shrink",W(P,y);var X=document.createElement("div");W(X,S),W(X,{width:"200%",height:"200%"}),P.appendChild(X),T.resizeSensor.appendChild(A),T.resizeSensor.appendChild(P),T.appendChild(T.resizeSensor);var ue=window.getComputedStyle(T),I=ue?ue.getPropertyValue("position"):null;"absolute"!==I&&"relative"!==I&&"fixed"!==I&&"sticky"!==I&&(T.style.position="relative");var O=!1,K=0,E=he(T),$=0,Z=0,ae=!0;w=0;var te=function(){if(ae){if(0===T.offsetWidth&&0===T.offsetHeight)return void(w||(w=dt(function(){w=0,te()})));ae=!1}var ye,Oe;Oe=T.offsetHeight,z.style.width=(ye=T.offsetWidth)+10+"px",z.style.height=Oe+10+"px",A.scrollLeft=ye+10,A.scrollTop=Oe+10,P.scrollLeft=ye+10,P.scrollTop=Oe+10};T.resizeSensor.resetSensor=te;var Te=function(){K=0,O&&($=E.width,Z=E.height,T.resizedAttached&&T.resizedAttached.call(E))},me=function(){E=he(T),(O=E.width!==$||E.height!==Z)&&!K&&(K=dt(Te)),te()},ne=function(ye,Oe,$e){ye.attachEvent?ye.attachEvent("on"+Oe,$e):ye.addEventListener(Oe,$e)};ne(A,"scroll",me),ne(P,"scroll",me),w=dt(function(){w=0,te()})}}Se(Q,function(T){R(T,H)}),this.detach=function(T){w||(Y(w),w=0),j.detach(Q,T)},this.reset=function(){Q.resizeSensor.resetSensor()}};if(j.reset=function(Q){Se(Q,function(H){H.resizeSensor.resetSensor()})},j.detach=function(Q,H){Se(Q,function(w){!w||w.resizedAttached&&"function"==typeof H&&(w.resizedAttached.remove(H),w.resizedAttached.length())||w.resizeSensor&&(w.contains(w.resizeSensor)&&w.removeChild(w.resizeSensor),delete w.resizeSensor,delete w.resizedAttached)})},"undefined"!=typeof MutationObserver){var k=new MutationObserver(function(Q){for(var H in Q)if(Q.hasOwnProperty(H))for(var w=Q[H].addedNodes,C=0;C<w.length;C++)w[C].resizeSensor&&j.reset(w[C])});document.addEventListener("DOMContentLoaded",function(Q){k.observe(document.body,{childList:!0,subtree:!0})})}return j})?yt.call(it,et,it,Ut):yt)&&(Ut.exports=ee)},7445:(Ut,it,et)=>{var yt=et(3910),ee=et(9369),Dt=et(322);function dt(Q,H,w){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!Q.hasNode(H))throw new Error('graphology-shortest-path: the "'+H+'" source node does not exist in the given graph.');if(!Q.hasNode(w))throw new Error('graphology-shortest-path: the "'+w+'" target node does not exist in the given graph.');if((H=""+H)==(w=""+w))return[H];var C=Q.inboundNeighbors.bind(Q),R=Q.outboundNeighbors.bind(Q),T={},b={};T[H]=null,b[w]=null;var A,z,P,X,ue,I,O,K,y=[H],S=[w],E=!1;e:for(;y.length&&S.length;)if(y.length<=S.length){for(A=y,y=[],ue=0,O=A.length;ue<O;ue++)for(I=0,K=(P=R(z=A[ue])).length;I<K;I++)if((X=P[I])in T||(y.push(X),T[X]=z),X in b){E=!0;break e}}else for(A=S,S=[],ue=0,O=A.length;ue<O;ue++)for(z=A[ue],P=C(z),I=0,K=P.length;I<K;I++)if(X=P[I],X in b||(S.push(X),b[X]=z),X in T){E=!0;break e}if(!E)return null;for(var $=[];X;)$.unshift(X),X=T[X];for(X=b[$[$.length-1]];X;)$.push(X),X=b[X];return $.length?$:null}function Y(Q,H){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!Q.hasNode(H))throw new Error('graphology-shortest-path: the "'+H+'" source node does not exist in the given graph.');var R,T,b,y,S,A,w={},C={};for(w[H=""+H]=!0,C[H]=[H];Object.keys(w).length;)for(b in R=w,w={},R)for(S=0,A=(T=Q.outboundNeighbors(b)).length;S<A;S++)C[y=T[S]]||(C[y]=C[b].concat(y),w[y]=!0);return C}function Se(Q,H,w){if(!yt(H))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!H.hasNode(w))throw new Error('graphology-shortest-path: the "'+w+'" source node does not exist in the given graph.');w=""+w;var C=new Set,R={},T=0;R[w]=0;for(var y,S,A,b=[w];0!==b.length;){var z=[];for(y=0,S=b.length;y<S;y++)!C.has(A=b[y])&&(C.add(A),Dt(z,H[Q](A)),R[A]=T);T++,b=z}return R}var he=Se.bind(null,"outboundNeighbors"),W=Se.bind(null,"neighbors");function j(Q,H,w){return arguments.length<3?Y(Q,H):dt(Q,H,w)}j.bidirectional=dt,j.singleSource=Y,j.singleSourceLength=he,j.undirectedSingleSourceLength=W,j.brandes=function(Q,H){H=""+H;var b,y,S,A,z,P,X,ue,I,w=[],C={},R={},T=Q.nodes();for(P=0,ue=T.length;P<ue;P++)C[A=T[P]]=[],R[A]=0;var O={};R[H]=1,O[H]=0;for(var K=ee.of(H);K.size;)for(A=K.dequeue(),w.push(A),b=O[A],y=R[A],X=0,I=(S=Q.outboundNeighbors(A)).length;X<I;X++)(z=S[X])in O||(K.enqueue(z),O[z]=b+1),O[z]===b+1&&(R[z]+=y,C[z].push(A));return[w,C,R]},Ut.exports=j},3910:Ut=>{Ut.exports=function(et){return null!==et&&"object"==typeof et&&"function"==typeof et.addUndirectedEdgeWithKey&&"function"==typeof et.dropNode&&"boolean"==typeof et.multi}},698:function(Ut){Ut.exports=function(){"use strict";function it(re){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(fe){return typeof fe}:function(fe){return fe&&"function"==typeof Symbol&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe})(re)}function et(re,fe){re.prototype=Object.create(fe.prototype),re.prototype.constructor=re,ee(re,fe)}function yt(re){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(fe){return fe.__proto__||Object.getPrototypeOf(fe)})(re)}function ee(re,fe){return(ee=Object.setPrototypeOf||function(se,M){return se.__proto__=M,se})(re,fe)}function Dt(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(re){return!1}}function dt(re,fe,se){return(dt=Dt()?Reflect.construct:function(M,L,J){var Ee=[null];Ee.push.apply(Ee,L);var Fe=new(Function.bind.apply(M,Ee));return J&&ee(Fe,J.prototype),Fe}).apply(null,arguments)}function Y(re){var fe="function"==typeof Map?new Map:void 0;return(Y=function(se){if(null===se||-1===Function.toString.call(se).indexOf("[native code]"))return se;if("function"!=typeof se)throw new TypeError("Super expression must either be null or a function");if(void 0!==fe){if(fe.has(se))return fe.get(se);fe.set(se,L)}function L(){return dt(se,arguments,yt(this).constructor)}return L.prototype=Object.create(se.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),ee(L,se)})(re)}function Se(re){if(void 0===re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re}var he=function(){for(var re=arguments[0],fe=1,se=arguments.length;fe<se;fe++)if(arguments[fe])for(var M in arguments[fe])re[M]=arguments[fe][M];return re};function W(re,fe,se,M){var L=re._nodes.get(fe),J=null;return L?J="mixed"===M?L.out&&L.out[se]||L.undirected&&L.undirected[se]:"directed"===M?L.out&&L.out[se]:L.undirected&&L.undirected[se]:J}function j(re){return null!==re&&"object"===it(re)&&"function"==typeof re.addUndirectedEdgeWithKey&&"function"==typeof re.dropNode}function k(re){return"object"===it(re)&&null!==re&&re.constructor===Object}function Q(re){var fe;for(fe in re)return!1;return!0}function H(re,fe,se){Object.defineProperty(re,fe,{enumerable:!1,configurable:!1,writable:!0,value:se})}function w(re,fe,se){var M={enumerable:!0,configurable:!0};"function"==typeof se?M.get=se:(M.value=se,M.writable=!1),Object.defineProperty(re,fe,M)}function C(re){return!(!k(re)||re.attributes&&!Array.isArray(re.attributes))}"function"==typeof Object.assign&&(he=Object.assign);var R,T={exports:{}},b="object"==typeof Reflect?Reflect:null,y=b&&"function"==typeof b.apply?b.apply:function(re,fe,se){return Function.prototype.apply.call(re,fe,se)};R=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(re){return Object.getOwnPropertyNames(re).concat(Object.getOwnPropertySymbols(re))}:function(re){return Object.getOwnPropertyNames(re)};var S=Number.isNaN||function(re){return re!=re};function A(){A.init.call(this)}T.exports=A,T.exports.once=function(re,fe){return new Promise(function(se,M){function L(Ee){re.removeListener(fe,J),M(Ee)}function J(){"function"==typeof re.removeListener&&re.removeListener("error",L),se([].slice.call(arguments))}var Ee;Z(re,fe,J,{once:!0}),"error"!==fe&&("function"==typeof(Ee=re).on&&Z(Ee,"error",L,{once:!0}))})},A.EventEmitter=A,A.prototype._events=void 0,A.prototype._eventsCount=0,A.prototype._maxListeners=void 0;var z=10;function P(re){if("function"!=typeof re)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof re)}function X(re){return void 0===re._maxListeners?A.defaultMaxListeners:re._maxListeners}function ue(re,fe,se,M){var L,J,Ee;if(P(se),void 0===(J=re._events)?(J=re._events=Object.create(null),re._eventsCount=0):(void 0!==J.newListener&&(re.emit("newListener",fe,se.listener?se.listener:se),J=re._events),Ee=J[fe]),void 0===Ee)Ee=J[fe]=se,++re._eventsCount;else if("function"==typeof Ee?Ee=J[fe]=M?[se,Ee]:[Ee,se]:M?Ee.unshift(se):Ee.push(se),(L=X(re))>0&&Ee.length>L&&!Ee.warned){Ee.warned=!0;var nt=new Error("Possible EventEmitter memory leak detected. "+Ee.length+" "+String(fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");nt.name="MaxListenersExceededWarning",nt.emitter=re,nt.type=fe,nt.count=Ee.length,console&&console.warn&&console.warn(nt)}return re}function I(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function O(re,fe,se){var M={fired:!1,wrapFn:void 0,target:re,type:fe,listener:se},L=I.bind(M);return L.listener=se,M.wrapFn=L,L}function K(re,fe,se){var M=re._events;if(void 0===M)return[];var L=M[fe];return void 0===L?[]:"function"==typeof L?se?[L.listener||L]:[L]:se?function(J){for(var Ee=new Array(J.length),Fe=0;Fe<Ee.length;++Fe)Ee[Fe]=J[Fe].listener||J[Fe];return Ee}(L):$(L,L.length)}function E(re){var fe=this._events;if(void 0!==fe){var se=fe[re];if("function"==typeof se)return 1;if(void 0!==se)return se.length}return 0}function $(re,fe){for(var se=new Array(fe),M=0;M<fe;++M)se[M]=re[M];return se}function Z(re,fe,se,M){if("function"==typeof re.on)M.once?re.once(fe,se):re.on(fe,se);else{if("function"!=typeof re.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof re);re.addEventListener(fe,function L(J){M.once&&re.removeEventListener(fe,L),se(J)})}}function ae(re){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:re}),this.done=!1}Object.defineProperty(A,"defaultMaxListeners",{enumerable:!0,get:function(){return z},set:function(re){if("number"!=typeof re||re<0||S(re))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+re+".");z=re}}),A.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},A.prototype.setMaxListeners=function(re){if("number"!=typeof re||re<0||S(re))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+re+".");return this._maxListeners=re,this},A.prototype.getMaxListeners=function(){return X(this)},A.prototype.emit=function(re){for(var fe=[],se=1;se<arguments.length;se++)fe.push(arguments[se]);var M="error"===re,L=this._events;if(void 0!==L)M=M&&void 0===L.error;else if(!M)return!1;if(M){var J;if(fe.length>0&&(J=fe[0]),J instanceof Error)throw J;var Ee=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw Ee.context=J,Ee}var Fe=L[re];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,fe);else{var nt=Fe.length,Pt=$(Fe,nt);for(se=0;se<nt;++se)y(Pt[se],this,fe)}return!0},A.prototype.on=A.prototype.addListener=function(re,fe){return ue(this,re,fe,!1)},A.prototype.prependListener=function(re,fe){return ue(this,re,fe,!0)},A.prototype.once=function(re,fe){return P(fe),this.on(re,O(this,re,fe)),this},A.prototype.prependOnceListener=function(re,fe){return P(fe),this.prependListener(re,O(this,re,fe)),this},A.prototype.off=A.prototype.removeListener=function(re,fe){var se,M,L,J,Ee;if(P(fe),void 0===(M=this._events))return this;if(void 0===(se=M[re]))return this;if(se===fe||se.listener===fe)0==--this._eventsCount?this._events=Object.create(null):(delete M[re],M.removeListener&&this.emit("removeListener",re,se.listener||fe));else if("function"!=typeof se){for(L=-1,J=se.length-1;J>=0;J--)if(se[J]===fe||se[J].listener===fe){Ee=se[J].listener,L=J;break}if(L<0)return this;0===L?se.shift():function(Fe,nt){for(;nt+1<Fe.length;nt++)Fe[nt]=Fe[nt+1];Fe.pop()}(se,L),1===se.length&&(M[re]=se[0]),void 0!==M.removeListener&&this.emit("removeListener",re,Ee||fe)}return this},A.prototype.removeAllListeners=function(re){var fe,se,M;if(void 0===(se=this._events))return this;if(void 0===se.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==se[re]&&(0==--this._eventsCount?this._events=Object.create(null):delete se[re]),this;if(0===arguments.length){var L,J=Object.keys(se);for(M=0;M<J.length;++M)"removeListener"!==(L=J[M])&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(fe=se[re]))this.removeListener(re,fe);else if(void 0!==fe)for(M=fe.length-1;M>=0;M--)this.removeListener(re,fe[M]);return this},A.prototype.listeners=function(re){return K(this,re,!0)},A.prototype.rawListeners=function(re){return K(this,re,!1)},A.listenerCount=function(re,fe){return"function"==typeof re.listenerCount?re.listenerCount(fe):E.call(re,fe)},A.prototype.listenerCount=E,A.prototype.eventNames=function(){return this._eventsCount>0?R(this._events):[]},ae.prototype.next=function(){if(this.done)return{done:!0};var re=this._next();return re.done&&(this.done=!0),re},"undefined"!=typeof Symbol&&(ae.prototype[Symbol.iterator]=function(){return this}),ae.of=function(){var re=arguments,fe=re.length,se=0;return new ae(function(){return se>=fe?{done:!0}:{done:!1,value:re[se++]}})},ae.empty=function(){var re=new ae(null);return re.done=!0,re},ae.is=function(re){return re instanceof ae||"object"==typeof re&&null!==re&&"function"==typeof re.next};var oe=ae,te=function(re,fe){for(var se,M=arguments.length>1?fe:1/0,L=M!==1/0?new Array(M):[],J=0;;){if(J===M)return L;if((se=re.next()).done)return J!==fe?L.slice(0,J):L;L[J++]=se.value}},Te=function(re){function fe(se,M){var L;return(L=re.call(this)||this).name="GraphError",L.message=se||"",L.data=M||{},L}return et(fe,re),fe}(Y(Error)),me=function(re){function fe(se,M){var L;return(L=re.call(this,se,M)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(L),fe.prototype.constructor),L}return et(fe,re),fe}(Te),ne=function(re){function fe(se,M){var L;return(L=re.call(this,se,M)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(L),fe.prototype.constructor),L}return et(fe,re),fe}(Te),ye=function(re){function fe(se,M){var L;return(L=re.call(this,se,M)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(L),fe.prototype.constructor),L}return et(fe,re),fe}(Te);function Oe(re,fe){this.key=re,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function $e(re,fe){this.key=re,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function st(re,fe){this.key=re,this.attributes=fe,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Qe(re,fe,se,M,L,J){this.key=fe,this.attributes=J,this.undirected=re,this.source=M,this.target=L,this.generatedKey=se}function tt(re,fe,se,M,L,J,Ee){var Fe,nt,Pt="out",We="in";if(fe&&(Pt=We="undirected"),re.multi){if(void 0===(nt=(Fe=J[Pt])[L])&&(nt=new Set,Fe[L]=nt),nt.add(se),M===L&&fe)return;void 0===(Fe=Ee[We])[M]&&(Fe[M]=nt)}else{if(J[Pt][L]=se,M===L&&fe)return;Ee[We][M]=se}}function Xe(re,fe,se){var M=re.multi,L=se.source,J=se.target,Ee=L.key,Fe=J.key,nt=L[fe?"undirected":"out"],Pt=fe?"undirected":"in";if(Fe in nt)if(M){var We=nt[Fe];1===We.size?(delete nt[Fe],delete J[Pt][Ee]):We.delete(se)}else delete nt[Fe];M||delete J[Pt][Ee]}$e.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},st.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var ze=[{name:function(re){return"get".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,Ee,Fe,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return J.attributes[L]}}},{name:function(re){return"get".concat(re,"Attributes")},attacher:function(re,fe,se){re.prototype[fe]=function(M){var L;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var J=""+M,Ee=""+arguments[1];if(!(L=W(this,J,Ee,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(J,'" - "').concat(Ee,'").'))}else if(!(L=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&L.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return L.attributes}}},{name:function(re){return"has".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,Ee,Fe,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return J.attributes.hasOwnProperty(L)}}},{name:function(re){return"set".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L,J){var Ee;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+M,nt=""+L;if(L=arguments[2],J=arguments[3],!(Ee=W(this,Fe,nt,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(nt,'").'))}else if(!(Ee=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&Ee.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return Ee.attributes[L]=J,this.emit("edgeAttributesUpdated",{key:Ee.key,type:"set",attributes:Ee.attributes,name:L}),this}}},{name:function(re){return"update".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L,J){var Ee;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+M,nt=""+L;if(L=arguments[2],J=arguments[3],!(Ee=W(this,Fe,nt,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(nt,'").'))}else if(!(Ee=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("function"!=typeof J)throw new me("Graph.".concat(fe,": updater should be a function."));if("mixed"!==se&&Ee.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return Ee.attributes[L]=J(Ee.attributes[L]),this.emit("edgeAttributesUpdated",{key:Ee.key,type:"set",attributes:Ee.attributes,name:L}),this}}},{name:function(re){return"remove".concat(re,"Attribute")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,Ee,Fe,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return delete J.attributes[L],this.emit("edgeAttributesUpdated",{key:J.key,type:"remove",attributes:J.attributes,name:L}),this}}},{name:function(re){return"replace".concat(re,"Attributes")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,Ee,Fe,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!k(L))throw new me("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return J.attributes=L,this.emit("edgeAttributesUpdated",{key:J.key,type:"replace",attributes:J.attributes}),this}}},{name:function(re){return"merge".concat(re,"Attributes")},attacher:function(re,fe,se){re.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==se&&se!==this.type)throw new ye("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Ee=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,Ee,Fe,se)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Ee,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!k(L))throw new me("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==se&&J.undirected!==("undirected"===se))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(se," edge in the graph."));return he(J.attributes,L),this.emit("edgeAttributesUpdated",{key:J.key,type:"merge",attributes:J.attributes,data:L}),this}}}],Le=oe,Ke=function(){var re,fe=arguments,se=-1;return new Le(function M(){if(!re){if(++se>=fe.length)return{done:!0};re=fe[se]}var L=re.next();return L.done?(re=null,M()):L})},Me=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ue(re,fe){for(var se in fe)re.push(fe[se].key)}function qe(re,fe){for(var se in fe)fe[se].forEach(function(M){return re.push(M.key)})}function ke(re,fe,se){for(var M in re)if(M!==se){var L=re[M];fe(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)}}function q(re,fe,se){for(var M in re)M!==se&&re[M].forEach(function(L){return fe(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function G(re,fe,se){for(var M in re)if(M!==se){var L=re[M];if(fe(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey))return!0}return!1}function pe(re,fe,se){var M,L,J,Ee,Fe;for(var nt in re)if(nt!==se)for(M=re[nt].values();!0!==(L=M.next()).done;)if(Ee=(J=L.value).source,fe(J.key,J.attributes,Ee.key,(Fe=J.target).key,Ee.attributes,Fe.attributes,J.undirected,J.generatedKey))return!0;return!1}function de(re,fe){var se=Object.keys(re),M=se.length,L=null,J=0;return new oe(function Ee(){var Fe;if(L){var nt=L.next();if(nt.done)return L=null,J++,Ee();Fe=nt.value}else{if(J>=M)return{done:!0};var Pt=se[J];if(Pt===fe)return J++,Ee();if((Fe=re[Pt])instanceof Set)return L=Fe.values(),Ee();J++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function je(re,fe,se){var M=fe[se];M&&re.push(M.key)}function _t(re,fe,se){var M=fe[se];M&&M.forEach(function(L){return re.push(L.key)})}function pt(re,fe,se){var M=re[fe];if(M){var L=M.source,J=M.target;se(M.key,M.attributes,L.key,J.key,L.attributes,J.attributes,M.undirected,M.generatedKey)}}function we(re,fe,se){var M=re[fe];M&&M.forEach(function(L){return se(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function B(re,fe,se){var M=re[fe];if(M){var L=M.source,J=M.target;return se(M.key,M.attributes,L.key,J.key,L.attributes,J.attributes,M.undirected,M.generatedKey)}}function N(re,fe,se){var M=re[fe];if(M){for(var L,J,Ee=M.values();!0!==(L=Ee.next()).done;)if(se((J=L.value).key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes,J.undirected,J.generatedKey))return!0;return!1}}function V(re,fe){var se=re[fe];if(se instanceof Set){var M=se.values();return new oe(function(){var L=M.next();if(L.done)return L;var J=L.value;return{done:!1,value:[J.key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes]}})}return oe.of([se.key,se.attributes,se.source.key,se.target.key,se.source.attributes,se.target.attributes])}function Re(re,fe){if(0===re.size)return[];if("mixed"===fe||fe===re.type)return"function"==typeof Array.from?Array.from(re._edges.keys()):te(re._edges.keys(),re._edges.size);for(var se,M,J=new Array("undirected"===fe?re.undirectedSize:re.directedSize),Ee="undirected"===fe,Fe=re._edges.values(),nt=0;!0!==(se=Fe.next()).done;)(M=se.value).undirected===Ee&&(J[nt++]=M.key);return J}function Ze(re,fe,se){if(0!==re.size)for(var M,L,J="mixed"!==fe&&fe!==re.type,Ee="undirected"===fe,Fe=re._edges.values();!0!==(M=Fe.next()).done;)if(L=M.value,!J||L.undirected===Ee){var qt=L.source,St=L.target;se(L.key,L.attributes,qt.key,St.key,qt.attributes,St.attributes,L.undirected,L.generatedKey)}}function Tt(re,fe,se){if(0!==re.size)for(var M,L,J="mixed"!==fe&&fe!==re.type,Ee="undirected"===fe,Fe=re._edges.values();!0!==(M=Fe.next()).done;)if(L=M.value,!J||L.undirected===Ee){var qt=L.source,St=L.target;if(se(L.key,L.attributes,qt.key,St.key,qt.attributes,St.attributes,L.undirected,L.generatedKey))break}}function kt(re,fe){if(0===re.size)return oe.empty();var se="mixed"!==fe&&fe!==re.type,M="undirected"===fe,L=re._edges.values();return new oe(function(){for(var J,Ee;;){if((J=L.next()).done)return J;if(Ee=J.value,!se||Ee.undirected===M)break}return{value:[Ee.key,Ee.attributes,Ee.source.key,Ee.target.key,Ee.source.attributes,Ee.target.attributes],done:!1}})}function In(re,fe,se,M){var L=[],J=re?qe:Ue;return"undirected"!==fe&&("out"!==se&&J(L,M.in),"in"!==se&&J(L,M.out),!se&&M.directedSelfLoops>0&&L.splice(L.lastIndexOf(M.key),1)),"directed"!==fe&&J(L,M.undirected),L}function Nn(re,fe,se,M,L){var J=re?q:ke;"undirected"!==fe&&("out"!==se&&J(M.in,L),"in"!==se&&J(M.out,L,se?null:M.key)),"directed"!==fe&&J(M.undirected,L)}function Yn(re,fe,se,M,L){var J=re?pe:G;"undirected"!==fe&&("out"!==se&&J(M.in,L)||"in"!==se&&J(M.out,L,se?null:M.key))||"directed"===fe||J(M.undirected,L)}function Mi(re,fe,se){var M=oe.empty();return"undirected"!==re&&("out"!==fe&&void 0!==se.in&&(M=Ke(M,de(se.in))),"in"!==fe&&void 0!==se.out&&(M=Ke(M,de(se.out,fe?null:se.key)))),"directed"!==re&&void 0!==se.undirected&&(M=Ke(M,de(se.undirected))),M}function xi(re,fe,se,M,L){var J=fe?_t:je,Ee=[];return"undirected"!==re&&(void 0!==M.in&&"out"!==se&&J(Ee,M.in,L),void 0!==M.out&&"in"!==se&&J(Ee,M.out,L),!se&&M.directedSelfLoops>0&&Ee.splice(Ee.lastIndexOf(M.key),1)),"directed"!==re&&void 0!==M.undirected&&J(Ee,M.undirected,L),Ee}function Xr(re,fe,se,M,L,J){var Ee=fe?we:pt;"undirected"!==re&&(void 0!==M.in&&"out"!==se&&Ee(M.in,L,J),M.key!==L&&void 0!==M.out&&"in"!==se&&Ee(M.out,L,J)),"directed"!==re&&void 0!==M.undirected&&Ee(M.undirected,L,J)}function Ls(re,fe,se,M,L,J){var Ee=fe?N:B;"undirected"!==re&&(void 0!==M.in&&"out"!==se&&Ee(M.in,L,J)||M.key!==L&&void 0!==M.out&&"in"!==se&&Ee(M.out,L,J,se?null:M.key))||"directed"===re||void 0===M.undirected||Ee(M.undirected,L,J)}function fs(re,fe,se,M){var L=oe.empty();return"undirected"!==re&&(void 0!==se.in&&"out"!==fe&&M in se.in&&(L=Ke(L,V(se.in,M))),void 0!==se.out&&"in"!==fe&&M in se.out&&(L=Ke(L,V(se.out,M)))),"directed"!==re&&void 0!==se.undirected&&M in se.undirected&&(L=Ke(L,V(se.undirected,M))),L}var Bs=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Kr(re,fe){if(void 0!==fe)for(var se in fe)re.add(se)}function xa(re,fe,se){if("mixed"!==re){if("undirected"===re)return Object.keys(se.undirected);if("string"==typeof fe)return Object.keys(se[fe])}var M=new Set;return"undirected"!==re&&("out"!==fe&&Kr(M,se.in),"in"!==fe&&Kr(M,se.out)),"directed"!==re&&Kr(M,se.undirected),te(M.values(),M.size)}function kl(re,fe,se){for(var M in fe){var L=fe[M];L instanceof Set&&(L=L.values().next().value);var J=L.source,Fe=J===re?L.target:J;se(Fe.key,Fe.attributes)}}function Sa(re,fe,se,M){for(var L in se){var J=se[L];J instanceof Set&&(J=J.values().next().value);var Ee=J.source,nt=Ee===fe?J.target:Ee;re.has(nt.key)||(re.add(nt.key),M(nt.key,nt.attributes))}}function ws(re,fe,se){for(var M in fe){var L=fe[M];L instanceof Set&&(L=L.values().next().value);var J=L.source,Fe=J===re?L.target:J;if(se(Fe.key,Fe.attributes))return!0}return!1}function en(re,fe,se,M){for(var L in se){var J=se[L];J instanceof Set&&(J=J.values().next().value);var Ee=J.source,nt=Ee===fe?J.target:Ee;if(!re.has(nt.key)&&(re.add(nt.key),M(nt.key,nt.attributes)))return!0}return!1}function nl(re,fe){var se=Object.keys(fe),M=se.length,L=0;return new oe(function(){if(L>=M)return{done:!0};var J=fe[se[L++]];J instanceof Set&&(J=J.values().next().value);var Ee=J.source,nt=Ee===re?J.target:Ee;return{done:!1,value:[nt.key,nt.attributes]}})}function rt(re,fe,se){var M=Object.keys(se),L=M.length,J=0;return new oe(function Ee(){if(J>=L)return{done:!0};var Fe=se[M[J++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var nt=Fe.source,We=nt===fe?Fe.target:nt;return re.has(We.key)?Ee():(re.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function lt(re,fe,se,M,L){var J=re._nodes.get(M);if("undirected"!==fe){if("out"!==se&&void 0!==J.in)for(var Ee in J.in)if(Ee===L)return!0;if("in"!==se&&void 0!==J.out)for(var Fe in J.out)if(Fe===L)return!0}if("directed"!==fe&&void 0!==J.undirected)for(var nt in J.undirected)if(nt===L)return!0;return!1}function Be(re,fe,se){for(var M,L,J,Ee,Fe,nt,Pt,We=fe._nodes.values(),qt=fe.type;!0!==(M=We.next()).done;){if(L=M.value,"undirected"!==qt)for(J in Ee=L.out)if(nt=(Fe=Ee[J]).target,Pt=se(L.key,nt.key,L.attributes,nt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),re&&Pt)return;if("directed"!==qt)for(J in Ee=L.undirected)if((nt=(Fe=Ee[J]).target).key!==J&&(nt=Fe.source),Pt=se(L.key,nt.key,L.attributes,nt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),re&&Pt)return}}function ut(re,fe,se){for(var M,L,J,Ee,Fe,nt,Pt,We,qt,St=fe._nodes.values(),vn=fe.type;!0!==(M=St.next()).done;){if(L=M.value,"undirected"!==vn)for(J in nt=L.out)for(Ee=nt[J].values();!0!==(Fe=Ee.next()).done;)if(We=(Pt=Fe.value).target,qt=se(L.key,We.key,L.attributes,We.attributes,Pt.key,Pt.attributes,Pt.undirected,Pt.generatedKey),re&&qt)return;if("directed"!==vn)for(J in nt=L.undirected)for(Ee=nt[J].values();!0!==(Fe=Ee.next()).done;)if((We=(Pt=Fe.value).target).key!==J&&(We=Pt.source),qt=se(L.key,We.key,L.attributes,We.attributes,Pt.key,Pt.attributes,Pt.undirected,Pt.generatedKey),re&&qt)return}}function Je(re,fe){var se={key:re};return Q(fe.attributes)||(se.attributes=he({},fe.attributes)),se}function Mt(re,fe){var se={source:fe.source.key,target:fe.target.key};return fe.generatedKey||(se.key=re),Q(fe.attributes)||(se.attributes=he({},fe.attributes)),fe.undirected&&(se.undirected=!0),se}function It(re){return k(re)?"key"in re?!("attributes"in re)||k(re.attributes)&&null!==re.attributes?null:"invalid-attributes":"no-key":"not-object"}function Ot(re){return k(re)?"source"in re?"target"in re?!("attributes"in re)||k(re.attributes)&&null!==re.attributes?"undirected"in re&&"boolean"!=typeof re.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Qt=new Set(["directed","undirected","mixed"]),zn=new Set(["domain","_events","_eventsCount","_maxListeners"]),ci={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function Rn(re,fe,se){var M=new re.NodeDataClass(fe,se);return re._nodes.set(fe,M),re.emit("nodeAdded",{key:fe,attributes:se}),M}function bn(re,fe,se,M,L,J,Ee,Fe){if(!M&&"undirected"===re.type)throw new ye("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===re.type)throw new ye("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!k(Fe))throw new me("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(J=""+J,Ee=""+Ee,Fe=Fe||{},!re.allowSelfLoops&&J===Ee)throw new ye("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var nt=re._nodes.get(J),Pt=re._nodes.get(Ee);if(!nt)throw new ne("Graph.".concat(fe,': source node "').concat(J,'" not found.'));if(!Pt)throw new ne("Graph.".concat(fe,': target node "').concat(Ee,'" not found.'));var We={key:null,undirected:M,source:J,target:Ee,attributes:Fe};if(se&&(L=re._edgeKeyGenerator(We)),re._edges.has(L=""+L))throw new ye("Graph.".concat(fe,': the "').concat(L,'" edge already exists in the graph.'));if(!re.multi&&(M?void 0!==nt.undirected[Ee]:void 0!==nt.out[Ee]))throw new ye("Graph.".concat(fe,': an edge linking "').concat(J,'" to "').concat(Ee,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var qt=new Qe(M,L,se,nt,Pt,Fe);return re._edges.set(L,qt),J===Ee?M?(nt.undirectedSelfLoops++,re._undirectedSelfLoopCount++):(nt.directedSelfLoops++,re._directedSelfLoopCount++):M?(nt.undirectedDegree++,Pt.undirectedDegree++):(nt.outDegree++,Pt.inDegree++),tt(re,M,qt,J,Ee,nt,Pt),M?re._undirectedSize++:re._directedSize++,We.key=L,re.emit("edgeAdded",We),L}function Xn(re,fe,se,M,L,J,Ee,Fe,nt){if(!M&&"undirected"===re.type)throw new ye("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===re.type)throw new ye("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(nt){if("function"!=typeof Fe)throw new me("Graph.".concat(fe,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!k(Fe))throw new me("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Pt;if(J=""+J,Ee=""+Ee,nt&&(Pt=Fe,Fe=void 0),!re.allowSelfLoops&&J===Ee)throw new ye("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,qt,St=re._nodes.get(J),vn=re._nodes.get(Ee);if(!se&&(We=re._edges.get(L))){if(We.source.key!==J||We.target.key!==Ee||M&&(We.source.key!==Ee||We.target.key!==J))throw new ye("Graph.".concat(fe,': inconsistency detected when attempting to merge the "').concat(L,'" edge with "').concat(J,'" source & "').concat(Ee,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));qt=We}if(qt||re.multi||!St||(qt=M?St.undirected[Ee]:St.out[Ee]),qt)return(nt?Pt:Fe)?(nt?(qt.attributes=Pt(qt.attributes),re.emit("edgeAttributesUpdated",{type:"replace",key:qt.key,attributes:qt.attributes})):(he(qt.attributes,Fe),re.emit("edgeAttributesUpdated",{type:"merge",key:qt.key,attributes:qt.attributes,data:Fe})),qt.key):qt.key;Fe=Fe||{},nt&&Pt&&(Fe=Pt(Fe));var Zr={key:null,undirected:M,source:J,target:Ee,attributes:Fe};if(se&&(L=re._edgeKeyGenerator(Zr)),re._edges.has(L=""+L))throw new ye("Graph.".concat(fe,': the "').concat(L,'" edge already exists in the graph.'));return St||(St=Rn(re,J,{}),J===Ee&&(vn=St)),vn||(vn=Rn(re,Ee,{})),We=new Qe(M,L,se,St,vn,Fe),re._edges.set(L,We),J===Ee?M?(St.undirectedSelfLoops++,re._undirectedSelfLoopCount++):(St.directedSelfLoops++,re._directedSelfLoopCount++):M?(St.undirectedDegree++,vn.undirectedDegree++):(St.outDegree++,vn.inDegree++),tt(re,M,We,J,Ee,St,vn),M?re._undirectedSize++:re._directedSize++,Zr.key=L,re.emit("edgeAdded",Zr),L}var re,Cn=function(re){function fe(M){var L;if(L=re.call(this)||this,(M=he({},ci,M)).edgeKeyGenerator&&"function"!=typeof M.edgeKeyGenerator)throw new me("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(M.edgeKeyGenerator,'".'));if("boolean"!=typeof M.multi)throw new me("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(M.multi,'".'));if(!Qt.has(M.type))throw new me('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(M.type,'".'));if("boolean"!=typeof M.allowSelfLoops)throw new me("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(M.allowSelfLoops,'".'));var J,Ee="mixed"===M.type?Oe:"directed"===M.type?$e:st;return H(Se(L),"NodeDataClass",Ee),H(Se(L),"_attributes",{}),H(Se(L),"_nodes",new Map),H(Se(L),"_edges",new Map),H(Se(L),"_directedSize",0),H(Se(L),"_undirectedSize",0),H(Se(L),"_directedSelfLoopCount",0),H(Se(L),"_undirectedSelfLoopCount",0),H(Se(L),"_edgeKeyGenerator",M.edgeKeyGenerator||(J=0,function(){return J++})),H(Se(L),"_options",M),zn.forEach(function(Fe){return H(Se(L),Fe,L[Fe])}),w(Se(L),"order",function(){return L._nodes.size}),w(Se(L),"size",function(){return L._edges.size}),w(Se(L),"directedSize",function(){return L._directedSize}),w(Se(L),"undirectedSize",function(){return L._undirectedSize}),w(Se(L),"selfLoopCount",function(){return L._directedSelfLoopCount+L._undirectedSelfLoopCount}),w(Se(L),"directedSelfLoopCount",function(){return L._directedSelfLoopCount}),w(Se(L),"undirectedSelfLoopCount",function(){return L._undirectedSelfLoopCount}),w(Se(L),"multi",L._options.multi),w(Se(L),"type",L._options.type),w(Se(L),"allowSelfLoops",L._options.allowSelfLoops),w(Se(L),"implementation",function(){return"graphology"}),L}et(fe,re);var se=fe.prototype;return se.hasNode=function(M){return this._nodes.has(""+M)},se.hasDirectedEdge=function(M,L){if("undirected"===this.type)return!1;if(1===arguments.length){var Ee=this._edges.get(""+M);return!!Ee&&!Ee.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(M=""+M);if(!Fe)return!1;var nt=Fe.out[L];return!(!nt||this.multi&&!nt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},se.hasUndirectedEdge=function(M,L){if("directed"===this.type)return!1;if(1===arguments.length){var Ee=this._edges.get(""+M);return!!Ee&&Ee.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(M=""+M);if(!Fe)return!1;var nt=Fe.undirected[L];return!(!nt||this.multi&&!nt.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},se.hasEdge=function(M,L){if(1===arguments.length)return this._edges.has(""+M);if(2===arguments.length){L=""+L;var Ee=this._nodes.get(M=""+M);if(!Ee)return!1;var Fe=void 0!==Ee.out&&Ee.out[L];return Fe||(Fe=void 0!==Ee.undirected&&Ee.undirected[L]),!(!Fe||this.multi&&!Fe.size)}throw new me("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},se.directedEdge=function(M,L){if("undirected"!==this.type){if(M=""+M,L=""+L,this.multi)throw new ye("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.directedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(L))throw new ne('Graph.directedEdge: could not find the "'.concat(L,'" target node in the graph.'));var Ee=J.out&&J.out[L]||void 0;return Ee?Ee.key:void 0}},se.undirectedEdge=function(M,L){if("directed"!==this.type){if(M=""+M,L=""+L,this.multi)throw new ye("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.undirectedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(L))throw new ne('Graph.undirectedEdge: could not find the "'.concat(L,'" target node in the graph.'));var Ee=J.undirected&&J.undirected[L]||void 0;return Ee?Ee.key:void 0}},se.edge=function(M,L){if(this.multi)throw new ye("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");L=""+L;var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.edge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(L))throw new ne('Graph.edge: could not find the "'.concat(L,'" target node in the graph.'));var Ee=J.out&&J.out[L]||J.undirected&&J.undirected[L]||void 0;if(Ee)return Ee.key},se.inDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.inDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.inDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.inDegree+(L?J.directedSelfLoops:0)},se.outDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.outDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.outDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.outDegree+(L?J.directedSelfLoops:0)},se.directedDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.directedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.directedDegree: could not find the "'.concat(M,'" node in the graph.'));if("undirected"===this.type)return 0;var Ee=L?J.directedSelfLoops:0;return J.inDegree+Ee+(J.outDegree+Ee)},se.undirectedDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.undirectedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.undirectedDegree: could not find the "'.concat(M,'" node in the graph.'));return"directed"===this.type?0:J.undirectedDegree+2*(L?J.undirectedSelfLoops:0)},se.degree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.degree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.degree: could not find the "'.concat(M,'" node in the graph.'));var Ee=0,Fe=0;return"directed"!==this.type&&(L&&(Fe=J.undirectedSelfLoops),Ee+=J.undirectedDegree+2*Fe),"undirected"!==this.type&&(L&&(Fe=J.directedSelfLoops),Ee+=J.inDegree+J.outDegree+2*Fe),Ee},se.source=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.source: could not find the "'.concat(M,'" edge in the graph.'));return L.source.key},se.target=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.target: could not find the "'.concat(M,'" edge in the graph.'));return L.target.key},se.extremities=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.extremities: could not find the "'.concat(M,'" edge in the graph.'));return[L.source.key,L.target.key]},se.opposite=function(M,L){M=""+M;var J=this._edges.get(L=""+L);if(!J)throw new ne('Graph.opposite: could not find the "'.concat(L,'" edge in the graph.'));var Ee=J.source.key,Fe=J.target.key;if(M!==Ee&&M!==Fe)throw new ne('Graph.opposite: the "'.concat(M,'" node is not attached to the "').concat(L,'" edge (').concat(Ee,", ").concat(Fe,")."));return M===Ee?Fe:Ee},se.hasExtremity=function(M,L){L=""+L;var J=this._edges.get(M=""+M);if(!J)throw new ne('Graph.hasExtremity: could not find the "'.concat(M,'" edge in the graph.'));return J.source.key===L||J.target.key===L},se.isUndirected=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.isUndirected: could not find the "'.concat(M,'" edge in the graph.'));return L.undirected},se.isDirected=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.isDirected: could not find the "'.concat(M,'" edge in the graph.'));return!L.undirected},se.isSelfLoop=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.isSelfLoop: could not find the "'.concat(M,'" edge in the graph.'));return L.source===L.target},se.hasGeneratedKey=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.hasGeneratedKey: could not find the "'.concat(M,'" edge in the graph.'));return L.generatedKey},se.addNode=function(M,L){return function(J,Ee,Fe){if(Fe&&!k(Fe))throw new me('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},J._nodes.has(Ee=""+Ee))throw new ye('Graph.addNode: the "'.concat(Ee,'" node already exist in the graph.'));var nt=new J.NodeDataClass(Ee,Fe);return J._nodes.set(Ee,nt),J.emit("nodeAdded",{key:Ee,attributes:Fe}),nt}(this,M,L).key},se.mergeNode=function(M,L){if(L&&!k(L))throw new me('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(L,'"'));L=L||{};var J=this._nodes.get(M=""+M);return J?(L&&(he(J.attributes,L),this.emit("nodeAttributesUpdated",{type:"merge",key:M,attributes:J.attributes,data:L})),M):(J=new this.NodeDataClass(M,L),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:L}),M)},se.updateNode=function(M,L){if(L&&"function"!=typeof L)throw new me('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(L,'"'));var J=this._nodes.get(M=""+M);if(J)return L&&(J.attributes=L(J.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:M,attributes:J.attributes})),M;var Fe=L?L({}):{};return J=new this.NodeDataClass(M,Fe),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:Fe}),M},se.dropNode=function(M){var L=this,J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.dropNode: could not find the "'.concat(M,'" node in the graph.'));this.forEachEdge(M,function(Ee){L.dropEdge(Ee)}),this._nodes.delete(M),this.emit("nodeDropped",{key:M,attributes:J.attributes})},se.dropEdge=function(M){var L;if(arguments.length>1){var J=""+arguments[0],Ee=""+arguments[1];if(!(L=W(this,J,Ee,this.type)))throw new ne('Graph.dropEdge: could not find the "'.concat(J,'" -> "').concat(Ee,'" edge in the graph.'))}else if(!(L=this._edges.get(M=""+M)))throw new ne('Graph.dropEdge: could not find the "'.concat(M,'" edge in the graph.'));this._edges.delete(L.key);var nt=L.source,Pt=L.target,We=L.attributes,qt=L.undirected;return nt===Pt?qt?(nt.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(nt.directedSelfLoops--,this._directedSelfLoopCount--):qt?(nt.undirectedDegree--,Pt.undirectedDegree--):(nt.outDegree--,Pt.inDegree--),Xe(this,qt,L),qt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:M,attributes:We,source:nt.key,target:Pt.key,undirected:qt}),this},se.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},se.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},se.getAttribute=function(M){return this._attributes[M]},se.getAttributes=function(){return this._attributes},se.hasAttribute=function(M){return this._attributes.hasOwnProperty(M)},se.setAttribute=function(M,L){return this._attributes[M]=L,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},se.updateAttribute=function(M,L){if("function"!=typeof L)throw new me("Graph.updateAttribute: updater should be a function.");return this._attributes[M]=L(this._attributes[M]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},se.removeAttribute=function(M){return delete this._attributes[M],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:M}),this},se.replaceAttributes=function(M){if(!k(M))throw new me("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=M,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},se.mergeAttributes=function(M){if(!k(M))throw new me("Graph.mergeAttributes: provided attributes are not a plain object.");return he(this._attributes,M),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:M}),this},se.getNodeAttribute=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.getNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes[L]},se.getNodeAttributes=function(M){var L=this._nodes.get(M=""+M);if(!L)throw new ne('Graph.getNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));return L.attributes},se.hasNodeAttribute=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes.hasOwnProperty(L)},se.setNodeAttribute=function(M,L,J){var Ee=this._nodes.get(M=""+M);if(!Ee)throw new ne('Graph.setNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return Ee.attributes[L]=J,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:Ee.attributes,name:L}),this},se.updateNodeAttribute=function(M,L,J){var Ee=this._nodes.get(M=""+M);if(!Ee)throw new ne('Graph.updateNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof J)throw new me("Graph.updateAttribute: updater should be a function.");var Fe=Ee.attributes,nt=J(Fe[L]);return Fe[L]=nt,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:Ee.attributes,name:L}),this},se.removeNodeAttribute=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return delete J.attributes[L],this.emit("nodeAttributesUpdated",{key:M,type:"remove",attributes:J.attributes,name:L}),this},se.replaceNodeAttributes=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.replaceNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!k(L))throw new me("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return J.attributes=L,this.emit("nodeAttributesUpdated",{key:M,type:"replace",attributes:J.attributes}),this},se.mergeNodeAttributes=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.mergeNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!k(L))throw new me("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return he(J.attributes,L),this.emit("nodeAttributesUpdated",{key:M,type:"merge",attributes:J.attributes,data:L}),this},se.updateEachNodeAttributes=function(M,L){if("function"!=typeof M)throw new me("Graph.updateEachNodeAttributes: expecting an updater function.");if(L&&!C(L))throw new me("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,Ee,Fe=this._nodes.values();!0!==(J=Fe.next()).done;)(Ee=J.value).attributes=M(Ee.key,Ee.attributes);this.emit("eachNodeAttributesUpdated",{hints:L||null})},se.updateEachEdgeAttributes=function(M,L){if("function"!=typeof M)throw new me("Graph.updateEachEdgeAttributes: expecting an updater function.");if(L&&!C(L))throw new me("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,Ee,Fe=this._edges.values();!0!==(J=Fe.next()).done;)(Ee=J.value).attributes=M(Ee.key,Ee.attributes);this.emit("eachEdgeAttributesUpdated",{hints:L||null})},se.forEach=function(M){if("function"!=typeof M)throw new me("Graph.forEach: expecting a callback.");this.multi?ut(!1,this,M):Be(!1,this,M)},se.forEachUntil=function(M){if("function"!=typeof M)throw new me("Graph.forEach: expecting a callback.");this.multi?ut(!0,this,M):Be(!0,this,M)},se.adjacency=function(){return this.multi?(nt=(M=this)._nodes.values(),Pt=M.type,We="outer",qt=null,new oe(function St(){var vn;if("outer"===We)return!0===(vn=nt.next()).done?vn:(L=vn.value,We="directed",St());if("directed"===We)return"undirected"===Pt?(We="undirected",St()):(Ee=L.out,J=Object.keys(L.out),Fe=0,We="inner-directed",St());if("undirected"===We){if("directed"===Pt)return We="outer",St();Ee=L.undirected,J=Object.keys(L.undirected),Fe=0,We="inner-undirected"}if(!qt&&Fe>=J.length)return We="inner-undirected"===We?"outer":"undirected",St();if(!qt){var Es=J[Fe++];return qt=Ee[Es].values(),St()}if((vn=qt.next()).done)return qt=null,St();var Zr=vn.value,Js=Zr.target;return"inner-undirected"===We&&Js.key===L.key&&(Js=Zr.source),{done:!1,value:[L.key,Js.key,L.attributes,Js.attributes,Zr.key,Zr.attributes]}})):(Fl=(St=this)._nodes.values(),fo=St.type,Br="outer",new oe(function Vs(){var Ac;if("outer"===Br)return!0===(Ac=Fl.next()).done?Ac:(vn=Ac.value,Br="directed",Vs());if("directed"===Br)return"undirected"===fo?(Br="undirected",Vs()):(Zr=vn.out,Es=Object.keys(vn.out),Js=0,Br="inner-directed",Vs());if("undirected"===Br){if("directed"===fo)return Br="outer",Vs();Zr=vn.undirected,Es=Object.keys(vn.undirected),Js=0,Br="inner-undirected"}if(Js>=Es.length)return Br="inner-undirected"===Br?"outer":"undirected",Vs();var xn=Es[Js++],po=Zr[xn],Ll=po.target;return"inner-undirected"===Br&&Ll.key===vn.key&&(Ll=po.source),{done:!1,value:[vn.key,Ll.key,vn.attributes,Ll.attributes,po.key,po.attributes]}}));var St,vn,Es,Zr,Js,Fl,fo,Br,M,L,J,Ee,Fe,nt,Pt,We,qt},se.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):te(this._nodes.keys(),this._nodes.size)},se.forEachNode=function(M){if("function"!=typeof M)throw new me("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(L,J){M(J,L.attributes)})},se.forEachNodeUntil=function(M){if("function"!=typeof M)throw new me("Graph.forEachNode: expecting a callback.");for(var L,J,Ee=this._nodes.values();!0!==(L=Ee.next())&&!M((J=L.value).key,J.attributes););},se.nodeEntries=function(){var M=this._nodes.values();return new oe(function(){var L=M.next();if(L.done)return L;var J=L.value;return{value:[J.key,J.attributes],done:!1}})},se.exportNode=function(M){var L=this._nodes.get(M=""+M);if(!L)throw new ne('Graph.exportNode: could not find the "'.concat(M,'" node in the graph.'));return Je(M,L)},se.exportEdge=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.exportEdge: could not find the "'.concat(M,'" edge in the graph.'));return Mt(M,L)},se.export=function(){var M=new Array(this._nodes.size),L=0;this._nodes.forEach(function(Ee,Fe){M[L++]=Je(Fe,Ee)});var J=new Array(this._edges.size);return L=0,this._edges.forEach(function(Ee,Fe){J[L++]=Mt(Fe,Ee)}),{attributes:this.getAttributes(),nodes:M,edges:J,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},se.importNode=function(M){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=It(M);if(J){if("not-object"===J)throw new me('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===J)throw new me("Graph.importNode: no key provided.");if("invalid-attributes"===J)throw new me("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var Ee=M.key,Fe=M.attributes,nt=void 0===Fe?{}:Fe;return L?this.mergeNode(Ee,nt):this.addNode(Ee,nt),this},se.importEdge=function(M){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Ot(M);if(J){if("not-object"===J)throw new me('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===J)throw new me("Graph.importEdge: missing souce.");if("no-target"===J)throw new me("Graph.importEdge: missing target.");if("invalid-attributes"===J)throw new me("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===J)throw new me("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var Ee=M.source,Fe=M.target,nt=M.attributes,Pt=void 0===nt?{}:nt,We=M.undirected,qt=void 0!==We&&We;return"key"in M?(L?qt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:qt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,M.key,Ee,Fe,Pt):(L?qt?this.mergeUndirectedEdge:this.mergeDirectedEdge:qt?this.addUndirectedEdge:this.addDirectedEdge).call(this,Ee,Fe,Pt),this},se.import=function(M){var L,J,Ee,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(j(M))return this.import(M.export(),Fe),this;if(!k(M))throw new me("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(M.attributes){if(!k(M.attributes))throw new me("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(M.attributes):this.replaceAttributes(M.attributes)}if(M.nodes){if(Ee=M.nodes,!Array.isArray(Ee))throw new me("Graph.import: invalid nodes. Expecting an array.");for(L=0,J=Ee.length;L<J;L++)this.importNode(Ee[L],Fe)}if(M.edges){if(Ee=M.edges,!Array.isArray(Ee))throw new me("Graph.import: invalid edges. Expecting an array.");for(L=0,J=Ee.length;L<J;L++)this.importEdge(Ee[L],Fe)}return this},se.nullCopy=function(M){return new fe(he({},this._options,M))},se.emptyCopy=function(M){var L=this.nullCopy(M);return this._nodes.forEach(function(J,Ee){var Fe=he({},J.attributes);J=new L.NodeDataClass(Ee,Fe),L._nodes.set(Ee,J)}),L},se.copy=function(){var M=new fe(this._options);return M.import(this),M},se.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(M){return M.upgradeToMixed()}),this._options.type="mixed",w(this,"type",this._options.type),H(this,"NodeDataClass",Oe)),this},se.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,w(this,"multi",!0),(M=this)._nodes.forEach(function(L,J){if(L.out)for(var Ee in L.out){var Fe=new Set;Fe.add(L.out[Ee]),L.out[Ee]=Fe,M._nodes.get(Ee).in[J]=Fe}if(L.undirected)for(var nt in L.undirected)if(!(nt>J)){var Pt=new Set;Pt.add(L.undirected[nt]),L.undirected[nt]=Pt,M._nodes.get(nt).undirected[J]=Pt}})),this;var M},se.clearIndex=function(){return this._nodes.forEach(function(M){void 0!==M.in&&(M.in={},M.out={}),void 0!==M.undirected&&(M.undirected={})}),this},se.toJSON=function(){return this.export()},se.toString=function(){return"[object Graph]"},se.inspect=function(){var M=this,L={};this._nodes.forEach(function(Pt,We){L[We]=Pt.attributes});var J={},Ee={};this._edges.forEach(function(Pt,We){var qt=Pt.undirected?"--":"->",St="",vn="(".concat(Pt.source.key,")").concat(qt,"(").concat(Pt.target.key,")");Pt.generatedKey?M.multi&&(void 0===Ee[vn]?Ee[vn]=0:Ee[vn]++,St+="".concat(Ee[vn],". ")):St+="[".concat(We,"]: "),J[St+=vn]=Pt.attributes});var Fe={};for(var nt in this)this.hasOwnProperty(nt)&&!zn.has(nt)&&"function"!=typeof this[nt]&&(Fe[nt]=this[nt]);return Fe.attributes=this._attributes,Fe.nodes=L,Fe.edges=J,H(Fe,"constructor",this.constructor),Fe},fe}(T.exports.EventEmitter);"undefined"!=typeof Symbol&&(Cn.prototype[Symbol.for("nodejs.util.inspect.custom")]=Cn.prototype.inspect),[{name:function(re){return"".concat(re,"Edge")},generateKey:!0},{name:function(re){return"".concat(re,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(re){return"".concat(re,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(re){return"".concat(re,"EdgeWithKey")}},{name:function(re){return"".concat(re,"DirectedEdgeWithKey")},type:"directed"},{name:function(re){return"".concat(re,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(re){["add","merge","update"].forEach(function(fe){var se=re.name(fe),M="add"===fe?bn:Xn;Cn.prototype[se]=re.generateKey?function(L,J,Ee){return M(this,se,!0,"undirected"===(re.type||this.type),null,L,J,Ee,"update"===fe)}:function(L,J,Ee,Fe){return M(this,se,!1,"undirected"===(re.type||this.type),L,J,Ee,Fe,"update"===fe)}})}),"undefined"!=typeof Symbol&&(Cn.prototype[Symbol.iterator]=Cn.prototype.adjacency),re=Cn,ze.forEach(function(fe){var se=fe.name,M=fe.attacher;M(re,se("Edge"),"mixed"),M(re,se("DirectedEdge"),"directed"),M(re,se("UndirectedEdge"),"undirected")}),function(re){Me.forEach(function(fe){var M,L,J,Ee;J=(M=fe).type,Ee=M.direction,re.prototype[L=M.name]=function(Fe,nt){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(!arguments.length)return Re(this,J);if(1===arguments.length){var Pt=this._nodes.get(Fe=""+Fe);if(void 0===Pt)throw new ne("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return In(this.multi,"mixed"===J?this.type:J,Ee,Pt)}if(2===arguments.length){nt=""+nt;var We=this._nodes.get(Fe=""+Fe);if(!We)throw new ne("Graph.".concat(L,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(nt))throw new ne("Graph.".concat(L,':  could not find the "').concat(nt,'" target node in the graph.'));return xi(J,this.multi,Ee,We,nt)}throw new me("Graph.".concat(L,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(se,M){var L=M.name,J=M.type,Ee=M.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1);se.prototype[Fe]=function(nt,Pt,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return Ze(this,J,We=nt);if(2===arguments.length){We=Pt;var qt=this._nodes.get(nt=""+nt);if(void 0===qt)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Nn(this.multi,"mixed"===J?this.type:J,Ee,qt,We)}if(3===arguments.length){Pt=""+Pt;var St=this._nodes.get(nt=""+nt);if(!St)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Pt))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Pt,'" target node in the graph.'));return Xr(J,this.multi,Ee,St,Pt,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(re,fe),function(se,M){var L=M.name,J=M.type,Ee=M.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1)+"Until";se.prototype[Fe]=function(nt,Pt,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return Tt(this,J,We=nt);if(2===arguments.length){We=Pt;var qt=this._nodes.get(nt=""+nt);if(void 0===qt)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Yn(this.multi,"mixed"===J?this.type:J,Ee,qt,We)}if(3===arguments.length){Pt=""+Pt;var St=this._nodes.get(nt=""+nt);if(!St)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Pt))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Pt,'" target node in the graph.'));return Ls(J,this.multi,Ee,St,Pt,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(re,fe),function(se,M){var J=M.type,Ee=M.direction,Fe=M.name.slice(0,-1)+"Entries";se.prototype[Fe]=function(nt,Pt){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return oe.empty();if(!arguments.length)return kt(this,J);if(1===arguments.length){var We=this._nodes.get(nt=""+nt);if(!We)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Mi(J,Ee,We)}if(2===arguments.length){Pt=""+Pt;var qt=this._nodes.get(nt=""+nt);if(!qt)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Pt))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Pt,'" target node in the graph.'));return fs(J,Ee,qt,Pt)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(re,fe)})}(Cn),function(re){Bs.forEach(function(fe){var M,L,J,Ee;J=(M=fe).type,Ee=M.direction,re.prototype[L=M.name]=function(Fe){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(2===arguments.length){var nt=""+arguments[0],Pt=""+arguments[1];if(!this._nodes.has(nt))throw new ne("Graph.".concat(L,': could not find the "').concat(nt,'" node in the graph.'));if(!this._nodes.has(Pt))throw new ne("Graph.".concat(L,': could not find the "').concat(Pt,'" node in the graph.'));return lt(this,J,Ee,nt,Pt)}if(1===arguments.length){var We=this._nodes.get(Fe=""+Fe);if(void 0===We)throw new ne("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return xa("mixed"===J?this.type:J,Ee,We)}throw new me("Graph.".concat(L,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(re,fe){var se=fe.name,M=fe.type,L=fe.direction,J="forEach"+se[0].toUpperCase()+se.slice(1,-1);re.prototype[J]=function(Ee,Fe){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(Ee=""+Ee);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(Ee,'" node in the graph.'));!function(Pt,We,qt,St){if("mixed"!==Pt){if("undirected"===Pt)return kl(qt,qt.undirected,St);if("string"==typeof We)return kl(qt,qt[We],St)}var vn=new Set;"undirected"!==Pt&&("out"!==We&&Sa(vn,qt,qt.in,St),"in"!==We&&Sa(vn,qt,qt.out,St)),"directed"!==Pt&&Sa(vn,qt,qt.undirected,St)}("mixed"===M?this.type:M,L,nt,Fe)}}}(re,fe),function(re,fe){var se=fe.name,M=fe.type,L=fe.direction,J="forEach"+se[0].toUpperCase()+se.slice(1,-1)+"Until";re.prototype[J]=function(Ee,Fe){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(Ee=""+Ee);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(Ee,'" node in the graph.'));!function(Pt,We,qt,St){if("mixed"!==Pt){if("undirected"===Pt)return ws(qt,qt.undirected,St);if("string"==typeof We)return ws(qt,qt[We],St)}var vn=new Set;"undirected"!==Pt&&("out"!==We&&en(vn,qt,qt.in,St)||"in"!==We&&en(vn,qt,qt.out,St))||"directed"===Pt||en(vn,qt,qt.undirected,St)}("mixed"===M?this.type:M,L,nt,Fe)}}}(re,fe),function(re,fe){var M=fe.type,L=fe.direction,J=fe.name.slice(0,-1)+"Entries";re.prototype[J]=function(Ee){if("mixed"!==M&&"mixed"!==this.type&&M!==this.type)return oe.empty();var Fe=this._nodes.get(Ee=""+Ee);if(void 0===Fe)throw new ne("Graph.".concat(J,': could not find the "').concat(Ee,'" node in the graph.'));return function(nt,Pt,We){if("mixed"!==nt){if("undirected"===nt)return nl(We,We.undirected);if("string"==typeof Pt)return nl(We,We[Pt])}var qt=oe.empty(),St=new Set;return"undirected"!==nt&&("out"!==Pt&&(qt=Ke(qt,rt(St,We,We.in))),"in"!==Pt&&(qt=Ke(qt,rt(St,We,We.out)))),"directed"!==nt&&(qt=Ke(qt,rt(St,We,We.undirected))),qt}("mixed"===M?this.type:M,L,Fe)}}(re,fe)})}(Cn);var rr=function(re){function fe(se){var M=he({type:"directed"},se);if("multi"in M&&!1!==M.multi)throw new me("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==M.type)throw new me('DirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Cn),sr=function(re){function fe(se){var M=he({type:"undirected"},se);if("multi"in M&&!1!==M.multi)throw new me("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==M.type)throw new me('UndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Cn),Qn=function(re){function fe(se){var M=he({multi:!0},se);if("multi"in M&&!0!==M.multi)throw new me("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return re.call(this,M)||this}return et(fe,re),fe}(Cn),Wi=function(re){function fe(se){var M=he({type:"directed",multi:!0},se);if("multi"in M&&!0!==M.multi)throw new me("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==M.type)throw new me('MultiDirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Cn),Ca=function(re){function fe(se){var M=he({type:"undirected",multi:!0},se);if("multi"in M&&!0!==M.multi)throw new me("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==M.type)throw new me('MultiUndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return re.call(this,M)||this}return et(fe,re),fe}(Cn);function Qr(re){re.from=function(fe,se){var M=he({},fe.options,se),L=new re(M);return L.import(fe),L}}return Qr(Cn),Qr(rr),Qr(sr),Qr(Qn),Qr(Wi),Qr(Ca),Cn.Graph=Cn,Cn.DirectedGraph=rr,Cn.UndirectedGraph=sr,Cn.MultiGraph=Qn,Cn.MultiDirectedGraph=Wi,Cn.MultiUndirectedGraph=Ca,Cn.InvalidArgumentsGraphError=me,Cn.NotFoundGraphError=ne,Cn.UsageGraphError=ye,Cn}()},1524:(Ut,it,et)=>{var yt;!function(ee,Dt,dt,Y){"use strict";var T,Se=["","webkit","Moz","MS","ms","o"],he=Dt.createElement("div"),j=Math.round,k=Math.abs,Q=Date.now;function H(be,De,Ge){return setTimeout(A(be,Ge),De)}function w(be,De,Ge){return!!Array.isArray(be)&&(C(be,Ge[De],Ge),!0)}function C(be,De,Ge){var vt;if(be)if(be.forEach)be.forEach(De,Ge);else if(be.length!==Y)for(vt=0;vt<be.length;)De.call(Ge,be[vt],vt,be),vt++;else for(vt in be)be.hasOwnProperty(vt)&&De.call(Ge,be[vt],vt,be)}function R(be,De,Ge){var vt="DEPRECATED METHOD: "+De+"\n"+Ge+" AT \n";return function(){var $t=new Error("get-stack-trace"),Xt=$t&&$t.stack?$t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ui=ee.console&&(ee.console.warn||ee.console.log);return ui&&ui.call(ee.console,vt,Xt),be.apply(this,arguments)}}T="function"!=typeof Object.assign?function(De){if(De===Y||null===De)throw new TypeError("Cannot convert undefined or null to object");for(var Ge=Object(De),vt=1;vt<arguments.length;vt++){var $t=arguments[vt];if($t!==Y&&null!==$t)for(var Xt in $t)$t.hasOwnProperty(Xt)&&(Ge[Xt]=$t[Xt])}return Ge}:Object.assign;var b=R(function(De,Ge,vt){for(var $t=Object.keys(Ge),Xt=0;Xt<$t.length;)(!vt||vt&&De[$t[Xt]]===Y)&&(De[$t[Xt]]=Ge[$t[Xt]]),Xt++;return De},"extend","Use `assign`."),y=R(function(De,Ge){return b(De,Ge,!0)},"merge","Use `assign`.");function S(be,De,Ge){var $t,vt=De.prototype;($t=be.prototype=Object.create(vt)).constructor=be,$t._super=vt,Ge&&T($t,Ge)}function A(be,De){return function(){return be.apply(De,arguments)}}function z(be,De){return"function"==typeof be?be.apply(De&&De[0]||Y,De):be}function P(be,De){return be===Y?De:be}function X(be,De,Ge){C(K(De),function(vt){be.addEventListener(vt,Ge,!1)})}function ue(be,De,Ge){C(K(De),function(vt){be.removeEventListener(vt,Ge,!1)})}function I(be,De){for(;be;){if(be==De)return!0;be=be.parentNode}return!1}function O(be,De){return be.indexOf(De)>-1}function K(be){return be.trim().split(/\s+/g)}function E(be,De,Ge){if(be.indexOf&&!Ge)return be.indexOf(De);for(var vt=0;vt<be.length;){if(Ge&&be[vt][Ge]==De||!Ge&&be[vt]===De)return vt;vt++}return-1}function $(be){return Array.prototype.slice.call(be,0)}function Z(be,De,Ge){for(var vt=[],$t=[],Xt=0;Xt<be.length;){var ui=De?be[Xt][De]:be[Xt];E($t,ui)<0&&vt.push(be[Xt]),$t[Xt]=ui,Xt++}return Ge&&(vt=De?vt.sort(function(Jr,xs){return Jr[De]>xs[De]}):vt.sort()),vt}function ae(be,De){for(var Ge,vt,$t=De[0].toUpperCase()+De.slice(1),Xt=0;Xt<Se.length;){if((vt=(Ge=Se[Xt])?Ge+$t:De)in be)return vt;Xt++}return Y}var oe=1;function Te(be){var De=be.ownerDocument||be;return De.defaultView||De.parentWindow||ee}var ne="ontouchstart"in ee,ye=ae(ee,"PointerEvent")!==Y,Oe=ne&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),$e="touch",Qe="mouse",_t=["x","y"],pt=["clientX","clientY"];function we(be,De){var Ge=this;this.manager=be,this.callback=De,this.element=be.element,this.target=be.options.inputTarget,this.domHandler=function(vt){z(be.options.enable,[be])&&Ge.handler(vt)},this.init()}function N(be,De,Ge){var vt=Ge.pointers.length,$t=Ge.changedPointers.length,Xt=1&De&&vt-$t==0,ui=12&De&&vt-$t==0;Ge.isFirst=!!Xt,Ge.isFinal=!!ui,Xt&&(be.session={}),Ge.eventType=De,function(be,De){var Ge=be.session,vt=De.pointers,$t=vt.length;Ge.firstInput||(Ge.firstInput=Tt(De)),$t>1&&!Ge.firstMultiple?Ge.firstMultiple=Tt(De):1===$t&&(Ge.firstMultiple=!1);var Xt=Ge.firstInput,ui=Ge.firstMultiple,Vr=ui?ui.center:Xt.center,Jr=De.center=kt(vt);De.timeStamp=Q(),De.deltaTime=De.timeStamp-Xt.timeStamp,De.angle=Mi(Vr,Jr),De.distance=Yn(Vr,Jr),function(be,De){var Ge=De.center,vt=be.offsetDelta||{},$t=be.prevDelta||{},Xt=be.prevInput||{};(1===De.eventType||4===Xt.eventType)&&($t=be.prevDelta={x:Xt.deltaX||0,y:Xt.deltaY||0},vt=be.offsetDelta={x:Ge.x,y:Ge.y}),De.deltaX=$t.x+(Ge.x-vt.x),De.deltaY=$t.y+(Ge.y-vt.y)}(Ge,De),De.offsetDirection=Nn(De.deltaX,De.deltaY);var xs=In(De.deltaTime,De.deltaX,De.deltaY);De.overallVelocityX=xs.x,De.overallVelocityY=xs.y,De.overallVelocity=k(xs.x)>k(xs.y)?xs.x:xs.y,De.scale=ui?function(be,De){return Yn(De[0],De[1],pt)/Yn(be[0],be[1],pt)}(ui.pointers,vt):1,De.rotation=ui?function(be,De){return Mi(De[1],De[0],pt)+Mi(be[1],be[0],pt)}(ui.pointers,vt):0,De.maxPointers=Ge.prevInput?De.pointers.length>Ge.prevInput.maxPointers?De.pointers.length:Ge.prevInput.maxPointers:De.pointers.length,function(be,De){var $t,Xt,ui,Vr,Ge=be.lastInterval||De,vt=De.timeStamp-Ge.timeStamp;if(8!=De.eventType&&(vt>25||Ge.velocity===Y)){var Jr=De.deltaX-Ge.deltaX,xs=De.deltaY-Ge.deltaY,Zn=In(vt,Jr,xs);Xt=Zn.x,ui=Zn.y,$t=k(Zn.x)>k(Zn.y)?Zn.x:Zn.y,Vr=Nn(Jr,xs),be.lastInterval=De}else $t=Ge.velocity,Xt=Ge.velocityX,ui=Ge.velocityY,Vr=Ge.direction;De.velocity=$t,De.velocityX=Xt,De.velocityY=ui,De.direction=Vr}(Ge,De);var Zn=be.element;I(De.srcEvent.target,Zn)&&(Zn=De.srcEvent.target),De.target=Zn}(be,Ge),be.emit("hammer.input",Ge),be.recognize(Ge),be.session.prevInput=Ge}function Tt(be){for(var De=[],Ge=0;Ge<be.pointers.length;)De[Ge]={clientX:j(be.pointers[Ge].clientX),clientY:j(be.pointers[Ge].clientY)},Ge++;return{timeStamp:Q(),pointers:De,center:kt(De),deltaX:be.deltaX,deltaY:be.deltaY}}function kt(be){var De=be.length;if(1===De)return{x:j(be[0].clientX),y:j(be[0].clientY)};for(var Ge=0,vt=0,$t=0;$t<De;)Ge+=be[$t].clientX,vt+=be[$t].clientY,$t++;return{x:j(Ge/De),y:j(vt/De)}}function In(be,De,Ge){return{x:De/be||0,y:Ge/be||0}}function Nn(be,De){return be===De?1:k(be)>=k(De)?be<0?2:4:De<0?8:16}function Yn(be,De,Ge){Ge||(Ge=_t);var vt=De[Ge[0]]-be[Ge[0]],$t=De[Ge[1]]-be[Ge[1]];return Math.sqrt(vt*vt+$t*$t)}function Mi(be,De,Ge){return Ge||(Ge=_t),180*Math.atan2(De[Ge[1]]-be[Ge[1]],De[Ge[0]]-be[Ge[0]])/Math.PI}we.prototype={handler:function(){},init:function(){this.evEl&&X(this.element,this.evEl,this.domHandler),this.evTarget&&X(this.target,this.evTarget,this.domHandler),this.evWin&&X(Te(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ue(this.element,this.evEl,this.domHandler),this.evTarget&&ue(this.target,this.evTarget,this.domHandler),this.evWin&&ue(Te(this.element),this.evWin,this.domHandler)}};var Ls={mousedown:1,mousemove:2,mouseup:4},fs="mousedown",Bs="mousemove mouseup";function Kr(){this.evEl=fs,this.evWin=Bs,this.pressed=!1,we.apply(this,arguments)}S(Kr,we,{handler:function(De){var Ge=Ls[De.type];1&Ge&&0===De.button&&(this.pressed=!0),2&Ge&&1!==De.which&&(Ge=4),this.pressed&&(4&Ge&&(this.pressed=!1),this.callback(this.manager,Ge,{pointers:[De],changedPointers:[De],pointerType:Qe,srcEvent:De}))}});var xa={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},kl={2:$e,3:"pen",4:Qe,5:"kinect"},Sa="pointerdown",ws="pointermove pointerup pointercancel";function en(){this.evEl=Sa,this.evWin=ws,we.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ee.MSPointerEvent&&!ee.PointerEvent&&(Sa="MSPointerDown",ws="MSPointerMove MSPointerUp MSPointerCancel"),S(en,we,{handler:function(De){var Ge=this.store,vt=!1,$t=De.type.toLowerCase().replace("ms",""),Xt=xa[$t],ui=kl[De.pointerType]||De.pointerType,Vr=ui==$e,Jr=E(Ge,De.pointerId,"pointerId");1&Xt&&(0===De.button||Vr)?Jr<0&&(Ge.push(De),Jr=Ge.length-1):12&Xt&&(vt=!0),!(Jr<0)&&(Ge[Jr]=De,this.callback(this.manager,Xt,{pointers:Ge,changedPointers:[De],pointerType:ui,srcEvent:De}),vt&&Ge.splice(Jr,1))}});var nl={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",lt="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=rt,this.evWin=lt,this.started=!1,we.apply(this,arguments)}function ge(be,De){var Ge=$(be.touches),vt=$(be.changedTouches);return 12&De&&(Ge=Z(Ge.concat(vt),"identifier",!0)),[Ge,vt]}S(ht,we,{handler:function(De){var Ge=nl[De.type];if(1===Ge&&(this.started=!0),this.started){var vt=ge.call(this,De,Ge);12&Ge&&vt[0].length-vt[1].length==0&&(this.started=!1),this.callback(this.manager,Ge,{pointers:vt[0],changedPointers:vt[1],pointerType:$e,srcEvent:De})}}});var ve={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Be="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=Be,this.targetIds={},we.apply(this,arguments)}function Je(be,De){var Ge=$(be.touches),vt=this.targetIds;if(3&De&&1===Ge.length)return vt[Ge[0].identifier]=!0,[Ge,Ge];var $t,Xt,ui=$(be.changedTouches),Vr=[],Jr=this.target;if(Xt=Ge.filter(function(xs){return I(xs.target,Jr)}),1===De)for($t=0;$t<Xt.length;)vt[Xt[$t].identifier]=!0,$t++;for($t=0;$t<ui.length;)vt[ui[$t].identifier]&&Vr.push(ui[$t]),12&De&&delete vt[ui[$t].identifier],$t++;return Vr.length?[Z(Xt.concat(Vr),"identifier",!0),Vr]:void 0}function Ot(){we.apply(this,arguments);var be=A(this.handler,this);this.touch=new ut(this.manager,be),this.mouse=new Kr(this.manager,be),this.primaryTouch=null,this.lastTouches=[]}function Qt(be,De){1&be?(this.primaryTouch=De.changedPointers[0].identifier,zn.call(this,De)):12&be&&zn.call(this,De)}function zn(be){var De=be.changedPointers[0];if(De.identifier===this.primaryTouch){var Ge={x:De.clientX,y:De.clientY};this.lastTouches.push(Ge);var vt=this.lastTouches;setTimeout(function(){var Xt=vt.indexOf(Ge);Xt>-1&&vt.splice(Xt,1)},2500)}}function ci(be){for(var De=be.srcEvent.clientX,Ge=be.srcEvent.clientY,vt=0;vt<this.lastTouches.length;vt++){var $t=this.lastTouches[vt],Xt=Math.abs(De-$t.x),ui=Math.abs(Ge-$t.y);if(Xt<=25&&ui<=25)return!0}return!1}S(ut,we,{handler:function(De){var Ge=ve[De.type],vt=Je.call(this,De,Ge);!vt||this.callback(this.manager,Ge,{pointers:vt[0],changedPointers:vt[1],pointerType:$e,srcEvent:De})}}),S(Ot,we,{handler:function(De,Ge,vt){var Xt=vt.pointerType==Qe;if(!(Xt&&vt.sourceCapabilities&&vt.sourceCapabilities.firesTouchEvents)){if(vt.pointerType==$e)Qt.call(this,Ge,vt);else if(Xt&&ci.call(this,vt))return;this.callback(De,Ge,vt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Rn=ae(he.style,"touchAction"),bn=Rn!==Y,Xn="compute",rr="manipulation",sr="none",Qn="pan-x",Wi="pan-y",Ca=function(){if(!bn)return!1;var be={},De=ee.CSS&&ee.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ge){be[Ge]=!De||ee.CSS.supports("touch-action",Ge)}),be}();function Qr(be,De){this.manager=be,this.set(De)}function Pt(be){this.options=T({},this.defaults,be||{}),this.id=oe++,this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(be){return 16&be?"cancel":8&be?"end":4&be?"move":2&be?"start":""}function qt(be){return 16==be?"down":8==be?"up":2==be?"left":4==be?"right":""}function St(be,De){var Ge=De.manager;return Ge?Ge.get(be):be}function vn(){Pt.apply(this,arguments)}function Es(){vn.apply(this,arguments),this.pX=null,this.pY=null}function Zr(){vn.apply(this,arguments)}function Js(){Pt.apply(this,arguments),this._timer=null,this._input=null}function Fl(){vn.apply(this,arguments)}function fo(){vn.apply(this,arguments)}function Br(){Pt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Vs(be,De){return(De=De||{}).recognizers=P(De.recognizers,Vs.defaults.preset),new po(be,De)}function po(be,De){this.options=T({},Vs.defaults,De||{}),this.options.inputTarget=this.options.inputTarget||be,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=be,this.input=function(be){return new(be.options.inputClass||(ye?en:Oe?ut:ne?Ot:Kr))(be,N)}(this),this.touchAction=new Qr(this,this.options.touchAction),Ll(this,!0),C(this.options.recognizers,function(Ge){var vt=this.add(new Ge[0](Ge[1]));Ge[2]&&vt.recognizeWith(Ge[2]),Ge[3]&&vt.requireFailure(Ge[3])},this)}function Ll(be,De){var vt,Ge=be.element;Ge.style&&(C(be.options.cssProps,function($t,Xt){vt=ae(Ge.style,Xt),De?(be.oldCssProps[vt]=Ge.style[vt],Ge.style[vt]=$t):Ge.style[vt]=be.oldCssProps[vt]||""}),De||(be.oldCssProps={}))}Qr.prototype={set:function(be){be==Xn&&(be=this.compute()),bn&&this.manager.element.style&&Ca[be]&&(this.manager.element.style[Rn]=be),this.actions=be.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var be=[];return C(this.manager.recognizers,function(De){z(De.options.enable,[De])&&(be=be.concat(De.getTouchAction()))}),function(be){if(O(be,sr))return sr;var De=O(be,Qn),Ge=O(be,Wi);return De&&Ge?sr:De||Ge?De?Qn:Wi:O(be,rr)?rr:"auto"}(be.join(" "))},preventDefaults:function(be){var De=be.srcEvent,Ge=be.offsetDirection;if(!this.manager.session.prevented){var vt=this.actions,$t=O(vt,sr)&&!Ca[sr],Xt=O(vt,Wi)&&!Ca[Wi],ui=O(vt,Qn)&&!Ca[Qn];if($t&&1===be.pointers.length&&be.distance<2&&be.deltaTime<250)return;return ui&&Xt||!($t||Xt&&6&Ge||ui&&24&Ge)?void 0:this.preventSrc(De)}De.preventDefault()},preventSrc:function(be){this.manager.session.prevented=!0,be.preventDefault()}},Pt.prototype={defaults:{},set:function(be){return T(this.options,be),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(be){if(w(be,"recognizeWith",this))return this;var De=this.simultaneous;return De[(be=St(be,this)).id]||(De[be.id]=be,be.recognizeWith(this)),this},dropRecognizeWith:function(be){return w(be,"dropRecognizeWith",this)||(be=St(be,this),delete this.simultaneous[be.id]),this},requireFailure:function(be){if(w(be,"requireFailure",this))return this;var De=this.requireFail;return-1===E(De,be=St(be,this))&&(De.push(be),be.requireFailure(this)),this},dropRequireFailure:function(be){if(w(be,"dropRequireFailure",this))return this;be=St(be,this);var De=E(this.requireFail,be);return De>-1&&this.requireFail.splice(De,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(be){return!!this.simultaneous[be.id]},emit:function(be){var De=this,Ge=this.state;function vt($t){De.manager.emit($t,be)}Ge<8&&vt(De.options.event+We(Ge)),vt(De.options.event),be.additionalEvent&&vt(be.additionalEvent),Ge>=8&&vt(De.options.event+We(Ge))},tryEmit:function(be){if(this.canEmit())return this.emit(be);this.state=32},canEmit:function(){for(var be=0;be<this.requireFail.length;){if(!(33&this.requireFail[be].state))return!1;be++}return!0},recognize:function(be){var De=T({},be);if(!z(this.options.enable,[this,De]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(De),30&this.state&&this.tryEmit(De)},process:function(be){},getTouchAction:function(){},reset:function(){}},S(vn,Pt,{defaults:{pointers:1},attrTest:function(be){var De=this.options.pointers;return 0===De||be.pointers.length===De},process:function(be){var De=this.state,Ge=be.eventType,vt=6&De,$t=this.attrTest(be);return vt&&(8&Ge||!$t)?16|De:vt||$t?4&Ge?8|De:2&De?4|De:2:32}}),S(Es,vn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var be=this.options.direction,De=[];return 6&be&&De.push(Wi),24&be&&De.push(Qn),De},directionTest:function(be){var De=this.options,Ge=!0,vt=be.distance,$t=be.direction,Xt=be.deltaX,ui=be.deltaY;return $t&De.direction||(6&De.direction?($t=0===Xt?1:Xt<0?2:4,Ge=Xt!=this.pX,vt=Math.abs(be.deltaX)):($t=0===ui?1:ui<0?8:16,Ge=ui!=this.pY,vt=Math.abs(be.deltaY))),be.direction=$t,Ge&&vt>De.threshold&&$t&De.direction},attrTest:function(be){return vn.prototype.attrTest.call(this,be)&&(2&this.state||!(2&this.state)&&this.directionTest(be))},emit:function(be){this.pX=be.deltaX,this.pY=be.deltaY;var De=qt(be.direction);De&&(be.additionalEvent=this.options.event+De),this._super.emit.call(this,be)}}),S(Zr,vn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[sr]},attrTest:function(be){return this._super.attrTest.call(this,be)&&(Math.abs(be.scale-1)>this.options.threshold||2&this.state)},emit:function(be){1!==be.scale&&(be.additionalEvent=this.options.event+(be.scale<1?"in":"out")),this._super.emit.call(this,be)}}),S(Js,Pt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(be){var De=this.options,Ge=be.pointers.length===De.pointers,vt=be.distance<De.threshold,$t=be.deltaTime>De.time;if(this._input=be,!vt||!Ge||12&be.eventType&&!$t)this.reset();else if(1&be.eventType)this.reset(),this._timer=H(function(){this.state=8,this.tryEmit()},De.time,this);else if(4&be.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(be){8===this.state&&(be&&4&be.eventType?this.manager.emit(this.options.event+"up",be):(this._input.timeStamp=Q(),this.manager.emit(this.options.event,this._input)))}}),S(Fl,vn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[sr]},attrTest:function(be){return this._super.attrTest.call(this,be)&&(Math.abs(be.rotation)>this.options.threshold||2&this.state)}}),S(fo,vn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Es.prototype.getTouchAction.call(this)},attrTest:function(be){var Ge,De=this.options.direction;return 30&De?Ge=be.overallVelocity:6&De?Ge=be.overallVelocityX:24&De&&(Ge=be.overallVelocityY),this._super.attrTest.call(this,be)&&De&be.offsetDirection&&be.distance>this.options.threshold&&be.maxPointers==this.options.pointers&&k(Ge)>this.options.velocity&&4&be.eventType},emit:function(be){var De=qt(be.offsetDirection);De&&this.manager.emit(this.options.event+De,be),this.manager.emit(this.options.event,be)}}),S(Br,Pt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rr]},process:function(be){var De=this.options,Ge=be.pointers.length===De.pointers,vt=be.distance<De.threshold,$t=be.deltaTime<De.time;if(this.reset(),1&be.eventType&&0===this.count)return this.failTimeout();if(vt&&$t&&Ge){if(4!=be.eventType)return this.failTimeout();var Xt=!this.pTime||be.timeStamp-this.pTime<De.interval,ui=!this.pCenter||Yn(this.pCenter,be.center)<De.posThreshold;if(this.pTime=be.timeStamp,this.pCenter=be.center,ui&&Xt?this.count+=1:this.count=1,this._input=be,0==this.count%De.taps)return this.hasRequireFailures()?(this._timer=H(function(){this.state=8,this.tryEmit()},De.interval,this),2):8}return 32},failTimeout:function(){return this._timer=H(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Vs.VERSION="2.0.7",Vs.defaults={domEvents:!1,touchAction:Xn,enable:!0,inputTarget:null,inputClass:null,preset:[[Fl,{enable:!1}],[Zr,{enable:!1},["rotate"]],[fo,{direction:6}],[Es,{direction:6},["swipe"]],[Br],[Br,{event:"doubletap",taps:2},["tap"]],[Js]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},po.prototype={set:function(be){return T(this.options,be),be.touchAction&&this.touchAction.update(),be.inputTarget&&(this.input.destroy(),this.input.target=be.inputTarget,this.input.init()),this},stop:function(be){this.session.stopped=be?2:1},recognize:function(be){var De=this.session;if(!De.stopped){this.touchAction.preventDefaults(be);var Ge,vt=this.recognizers,$t=De.curRecognizer;(!$t||$t&&8&$t.state)&&($t=De.curRecognizer=null);for(var Xt=0;Xt<vt.length;)Ge=vt[Xt],2===De.stopped||$t&&Ge!=$t&&!Ge.canRecognizeWith($t)?Ge.reset():Ge.recognize(be),!$t&&14&Ge.state&&($t=De.curRecognizer=Ge),Xt++}},get:function(be){if(be instanceof Pt)return be;for(var De=this.recognizers,Ge=0;Ge<De.length;Ge++)if(De[Ge].options.event==be)return De[Ge];return null},add:function(be){if(w(be,"add",this))return this;var De=this.get(be.options.event);return De&&this.remove(De),this.recognizers.push(be),be.manager=this,this.touchAction.update(),be},remove:function(be){if(w(be,"remove",this))return this;if(be=this.get(be)){var De=this.recognizers,Ge=E(De,be);-1!==Ge&&(De.splice(Ge,1),this.touchAction.update())}return this},on:function(be,De){if(be!==Y&&De!==Y){var Ge=this.handlers;return C(K(be),function(vt){Ge[vt]=Ge[vt]||[],Ge[vt].push(De)}),this}},off:function(be,De){if(be!==Y){var Ge=this.handlers;return C(K(be),function(vt){De?Ge[vt]&&Ge[vt].splice(E(Ge[vt],De),1):delete Ge[vt]}),this}},emit:function(be,De){this.options.domEvents&&function(be,De){var Ge=Dt.createEvent("Event");Ge.initEvent(be,!0,!0),Ge.gesture=De,De.target.dispatchEvent(Ge)}(be,De);var Ge=this.handlers[be]&&this.handlers[be].slice();if(Ge&&Ge.length){De.type=be,De.preventDefault=function(){De.srcEvent.preventDefault()};for(var vt=0;vt<Ge.length;)Ge[vt](De),vt++}},destroy:function(){this.element&&Ll(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},T(Vs,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:po,Input:we,TouchAction:Qr,TouchInput:ut,MouseInput:Kr,PointerEventInput:en,TouchMouseInput:Ot,SingleTouchInput:ht,Recognizer:Pt,AttrRecognizer:vn,Tap:Br,Pan:Es,Swipe:fo,Pinch:Zr,Rotate:Fl,Press:Js,on:X,off:ue,each:C,merge:y,extend:b,assign:T,inherit:S,bindFn:A,prefixed:ae}),(void 0!==ee?ee:"undefined"!=typeof self?self:{}).Hammer=Vs,(yt=function(){return Vs}.call(it,et,it,Ut))!==Y&&(Ut.exports=yt)}(window,document)},3815:function(Ut,it,et){var yt;Ut=et.nmd(Ut),function(){var ee,Se="Expected a function",W="__lodash_hash_undefined__",k="__lodash_placeholder__",z=32,X=128,te=1/0,Te=9007199254740991,ye=4294967295,st=[["ary",X],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",z],["partialRight",64],["rearg",256]],Qe="[object Arguments]",tt="[object Array]",ze="[object Boolean]",Le="[object Date]",Me="[object Error]",Ue="[object Function]",qe="[object GeneratorFunction]",ke="[object Map]",q="[object Number]",pe="[object Object]",de="[object Promise]",_t="[object RegExp]",pt="[object Set]",we="[object String]",B="[object Symbol]",V="[object WeakMap]",Ze="[object ArrayBuffer]",Tt="[object DataView]",kt="[object Float32Array]",In="[object Float64Array]",Nn="[object Int8Array]",Yn="[object Int16Array]",Mi="[object Int32Array]",xi="[object Uint8Array]",Xr="[object Uint8ClampedArray]",Ls="[object Uint16Array]",fs="[object Uint32Array]",Bs=/\b__p \+= '';/g,Kr=/\b(__p \+=) '' \+/g,xa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,kl=/&(?:amp|lt|gt|quot|#39);/g,Sa=/[&<>"']/g,ws=RegExp(kl.source),en=RegExp(Sa.source),nl=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,lt=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,ve=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Be=/[\\^$.*+?()[\]{}|]/g,ut=RegExp(Be.source),Je=/^\s+/,Mt=/\s/,It=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ot=/\{\n\/\* \[wrapped with (.+)\] \*/,Qt=/,? & /,zn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ci=/[()=,{}\[\]\/\s]/,Rn=/\\(\\)?/g,bn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Xn=/\w*$/,Cn=/^[-+]0x[0-9a-f]+$/i,rr=/^0b[01]+$/i,sr=/^\[object .+?Constructor\]$/,Qn=/^0o[0-7]+$/i,Wi=/^(?:0|[1-9]\d*)$/,Ca=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qr=/($^)/,re=/['\n\r\u2028\u2029\\]/g,fe="\\ud800-\\udfff",J="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ee="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",St="A-Z\\xc0-\\xd6\\xd8-\\xde",vn="\\ufe0e\\ufe0f",Es="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Js="["+fe+"]",Fl="["+Es+"]",fo="["+J+"]",Br="\\d+",Vs="["+Ee+"]",Ac="["+Fe+"]",xn="[^"+fe+Es+Br+Ee+Fe+St+"]",po="\\ud83c[\\udffb-\\udfff]",Ta="[^"+fe+"]",Ed="(?:\\ud83c[\\udde6-\\uddff]){2}",be="[\\ud800-\\udbff][\\udc00-\\udfff]",De="["+St+"]",vt="(?:"+Ac+"|"+xn+")",$t="(?:"+De+"|"+xn+")",Xt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ui="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Vr="(?:"+fo+"|"+po+")?",Jr="["+vn+"]?",C1=Jr+Vr+"(?:\\u200d(?:"+[Ta,Ed,be].join("|")+")"+Jr+Vr+")*",xd="(?:"+[Vs,Ed,be].join("|")+")"+C1,er="(?:"+[Ta+fo+"?",fo,Ed,be,Js].join("|")+")",fp=RegExp("['\u2019]","g"),n_=RegExp(fo,"g"),Oh=RegExp(po+"(?="+po+")|"+er+C1,"g"),iv=RegExp([De+"?"+Ac+"+"+Xt+"(?="+[Fl,De,"$"].join("|")+")",$t+"+"+ui+"(?="+[Fl,De+vt,"$"].join("|")+")",De+"?"+vt+"+"+Xt,De+"+"+ui,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Br,xd].join("|"),"g"),T1=RegExp("[\\u200d"+fe+J+vn+"]"),Bl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],A1=-1,rn={};rn[kt]=rn[In]=rn[Nn]=rn[Yn]=rn[Mi]=rn[xi]=rn[Xr]=rn[Ls]=rn[fs]=!0,rn[Qe]=rn[tt]=rn[Ze]=rn[ze]=rn[Tt]=rn[Le]=rn[Me]=rn[Ue]=rn[ke]=rn[q]=rn[pe]=rn[_t]=rn[pt]=rn[we]=rn[V]=!1;var or={};or[Qe]=or[tt]=or[Ze]=or[Tt]=or[ze]=or[Le]=or[kt]=or[In]=or[Nn]=or[Yn]=or[Mi]=or[ke]=or[q]=or[pe]=or[_t]=or[pt]=or[we]=or[B]=or[xi]=or[Xr]=or[Ls]=or[fs]=!0,or[Me]=or[Ue]=or[V]=!1;var tn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},M1=parseFloat,av=parseInt,Nt="object"==typeof global&&global&&global.Object===Object&&global,js="object"==typeof self&&self&&self.Object===Object&&self,Ui=Nt||js||Function("return this")(),Vl=it&&!it.nodeType&&it,Aa=Vl&&Ut&&!Ut.nodeType&&Ut,No=Aa&&Aa.exports===Vl,i_=No&&Nt.process,xr=function(){try{return Aa&&Aa.require&&Aa.require("util").types||i_&&i_.binding&&i_.binding("util")}catch(Rt){}}(),an=xr&&xr.isArrayBuffer,hi=xr&&xr.isDate,ur=xr&&xr.isMap,go=xr&&xr.isRegExp,Mc=xr&&xr.isSet,ss=xr&&xr.isTypedArray;function os(at,Rt,Ct){switch(Ct.length){case 0:return at.call(Rt);case 1:return at.call(Rt,Ct[0]);case 2:return at.call(Rt,Ct[0],Ct[1]);case 3:return at.call(Rt,Ct[0],Ct[1],Ct[2])}return at.apply(Rt,Ct)}function jr(at,Rt,Ct,hn){for(var Mn=-1,Li=null==at?0:at.length;++Mn<Li;){var es=at[Mn];Rt(hn,es,Ct(es),at)}return hn}function Us(at,Rt){for(var Ct=-1,hn=null==at?0:at.length;++Ct<hn&&!1!==Rt(at[Ct],Ct,at););return at}function Sd(at,Rt){for(var Ct=null==at?0:at.length;Ct--&&!1!==Rt(at[Ct],Ct,at););return at}function ri(at,Rt){for(var Ct=-1,hn=null==at?0:at.length;++Ct<hn;)if(!Rt(at[Ct],Ct,at))return!1;return!0}function Ma(at,Rt){for(var Ct=-1,hn=null==at?0:at.length,Mn=0,Li=[];++Ct<hn;){var es=at[Ct];Rt(es,Ct,at)&&(Li[Mn++]=es)}return Li}function jl(at,Rt){return!(null==at||!at.length)&&il(at,Rt,0)>-1}function Ph(at,Rt,Ct){for(var hn=-1,Mn=null==at?0:at.length;++hn<Mn;)if(Ct(Rt,at[hn]))return!0;return!1}function qi(at,Rt){for(var Ct=-1,hn=null==at?0:at.length,Mn=Array(hn);++Ct<hn;)Mn[Ct]=Rt(at[Ct],Ct,at);return Mn}function Ur(at,Rt){for(var Ct=-1,hn=Rt.length,Mn=at.length;++Ct<hn;)at[Mn+Ct]=Rt[Ct];return at}function Eu(at,Rt,Ct,hn){var Mn=-1,Li=null==at?0:at.length;for(hn&&Li&&(Ct=at[++Mn]);++Mn<Li;)Ct=Rt(Ct,at[Mn],Mn,at);return Ct}function Cd(at,Rt,Ct,hn){var Mn=null==at?0:at.length;for(hn&&Mn&&(Ct=at[--Mn]);Mn--;)Ct=Rt(Ct,at[Mn],Mn,at);return Ct}function ko(at,Rt){for(var Ct=-1,hn=null==at?0:at.length;++Ct<hn;)if(Rt(at[Ct],Ct,at))return!0;return!1}var ar=r_("length");function Nh(at,Rt,Ct){var hn;return Ct(at,function(Mn,Li,es){if(Rt(Mn,Li,es))return hn=Li,!1}),hn}function Td(at,Rt,Ct,hn){for(var Mn=at.length,Li=Ct+(hn?1:-1);hn?Li--:++Li<Mn;)if(Rt(at[Li],Li,at))return Li;return-1}function il(at,Rt,Ct){return Rt==Rt?function(at,Rt,Ct){for(var hn=Ct-1,Mn=at.length;++hn<Mn;)if(at[hn]===Rt)return hn;return-1}(at,Rt,Ct):Td(at,Dc,Ct)}function pp(at,Rt,Ct,hn){for(var Mn=Ct-1,Li=at.length;++Mn<Li;)if(hn(at[Mn],Rt))return Mn;return-1}function Dc(at){return at!=at}function Ss(at,Rt){var Ct=null==at?0:at.length;return Ct?Ad(at,Rt)/Ct:NaN}function r_(at){return function(Rt){return null==Rt?ee:Rt[at]}}function Jo(at){return function(Rt){return null==at?ee:at[Rt]}}function ea(at,Rt,Ct,hn,Mn){return Mn(at,function(Li,es,Yi){Ct=hn?(hn=!1,Li):Rt(Ct,Li,es,Yi)}),Ct}function Ad(at,Rt){for(var Ct,hn=-1,Mn=at.length;++hn<Mn;){var Li=Rt(at[hn]);Li!==ee&&(Ct=Ct===ee?Li:Ct+Li)}return Ct}function Md(at,Rt){for(var Ct=-1,hn=Array(at);++Ct<at;)hn[Ct]=Rt(Ct);return hn}function lv(at){return at&&at.slice(0,Ic(at)+1).replace(Je,"")}function ta(at){return function(Rt){return at(Rt)}}function o_(at,Rt){return qi(Rt,function(Ct){return at[Ct]})}function kh(at,Rt){return at.has(Rt)}function O1(at,Rt){for(var Ct=-1,hn=at.length;++Ct<hn&&il(Rt,at[Ct],0)>-1;);return Ct}function R1(at,Rt){for(var Ct=at.length;Ct--&&il(Rt,at[Ct],0)>-1;);return Ct}function rF(at,Rt){for(var Ct=at.length,hn=0;Ct--;)at[Ct]===Rt&&++hn;return hn}var sF=Jo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),oF=Jo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function aF(at){return"\\"+tn[at]}function Fh(at){return T1.test(at)}function cv(at){var Rt=-1,Ct=Array(at.size);return at.forEach(function(hn,Mn){Ct[++Rt]=[Mn,hn]}),Ct}function P1(at,Rt){return function(Ct){return at(Rt(Ct))}}function xu(at,Rt){for(var Ct=-1,hn=at.length,Mn=0,Li=[];++Ct<hn;){var es=at[Ct];(es===Rt||es===k)&&(at[Ct]=k,Li[Mn++]=Ct)}return Li}function a_(at){var Rt=-1,Ct=Array(at.size);return at.forEach(function(hn){Ct[++Rt]=hn}),Ct}function Lh(at){return Fh(at)?function(at){for(var Rt=Oh.lastIndex=0;Oh.test(at);)++Rt;return Rt}(at):ar(at)}function rl(at){return Fh(at)?function(at){return at.match(Oh)||[]}(at):function(at){return at.split("")}(at)}function Ic(at){for(var Rt=at.length;Rt--&&Mt.test(at.charAt(Rt)););return Rt}var c_=Jo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Bh=function at(Rt){var d,Ct=(Rt=null==Rt?Ui:Bh.defaults(Ui.Object(),Rt,Bh.pick(Ui,Rh))).Array,hn=Rt.Date,Mn=Rt.Error,Li=Rt.Function,es=Rt.Math,Yi=Rt.Object,u_=Rt.RegExp,d_=Rt.String,Ia=Rt.TypeError,dr=Ct.prototype,Su=Yi.prototype,gp=Rt["__core-js_shared__"],Sr=Li.prototype.toString,Xi=Su.hasOwnProperty,fF=0,Vh=(d=/[^.]+$/.exec(gp&&gp.keys&&gp.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",eo=Su.toString,F1=Sr.call(Yi),h_=Ui._,Dd=u_("^"+Sr.call(Xi).replace(Be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=No?Rt.Buffer:ee,Ul=Rt.Symbol,Id=Rt.Uint8Array,hv=zs?zs.allocUnsafe:ee,Oa=P1(Yi.getPrototypeOf,Yi),f_=Yi.create,mp=Su.propertyIsEnumerable,Ln=dr.splice,L1=Ul?Ul.isConcatSpreadable:ee,jh=Ul?Ul.iterator:ee,Cu=Ul?Ul.toStringTag:ee,_p=function(){try{var d=jc(Yi,"defineProperty");return d({},"",{}),d}catch(p){}}(),fv=Rt.clearTimeout!==Ui.clearTimeout&&Rt.clearTimeout,B1=hn&&hn.now!==Ui.Date.now&&hn.now,V1=Rt.setTimeout!==Ui.setTimeout&&Rt.setTimeout,Vt=es.ceil,Si=es.floor,_r=Yi.getOwnPropertySymbols,as=zs?zs.isBuffer:ee,p_=Rt.isFinite,Uh=dr.join,sl=P1(Yi.keys,Yi),zr=es.max,ps=es.min,pF=hn.now,j1=Rt.parseInt,zh=es.random,yp=dr.reverse,Cs=jc(Rt,"DataView"),mo=jc(Rt,"Map"),bp=jc(Rt,"Promise"),Ra=jc(Rt,"Set"),Fo=jc(Rt,"WeakMap"),Hh=jc(Yi,"create"),Gh=Fo&&new Fo,Od={},U1=Lu(Cs),g_=Lu(mo),m_=Lu(bp),pv=Lu(Ra),__=Lu(Fo),vp=Ul?Ul.prototype:ee,Rd=vp?vp.valueOf:ee,$h=vp?vp.toString:ee;function xe(d){if(Ar(d)&&!On(d)&&!(d instanceof fi)){if(d instanceof Lo)return d;if(Xi.call(d,"__wrapped__"))return sf(d)}return new Lo(d)}var Tu=function(){function d(){}return function(p){if(!Tr(p))return{};if(f_)return f_(p);d.prototype=p;var _=new d;return d.prototype=ee,_}}();function Wh(){}function Lo(d,p){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=ee}function fi(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ye,this.__views__=[]}function _o(d){var p=-1,_=null==d?0:d.length;for(this.clear();++p<_;){var F=d[p];this.set(F[0],F[1])}}function zl(d){var p=-1,_=null==d?0:d.length;for(this.clear();++p<_;){var F=d[p];this.set(F[0],F[1])}}function ol(d){var p=-1,_=null==d?0:d.length;for(this.clear();++p<_;){var F=d[p];this.set(F[0],F[1])}}function Pa(d){var p=-1,_=null==d?0:d.length;for(this.__data__=new ol;++p<_;)this.add(d[p])}function Na(d){var p=this.__data__=new zl(d);this.size=p.size}function Yh(d,p){var _=On(d),F=!_&&gl(d),le=!_&&!F&&ml(d),Ae=!_&&!F&&!le&&df(d),He=_||F||le||Ae,Ye=He?Md(d.length,d_):[],ct=Ye.length;for(var Ft in d)(p||Xi.call(d,Ft))&&(!He||!("length"==Ft||le&&("offset"==Ft||"parent"==Ft)||Ae&&("buffer"==Ft||"byteLength"==Ft||"byteOffset"==Ft)||jo(Ft,ct)))&&Ye.push(Ft);return Ye}function w_(d){var p=d.length;return p?d[Hl(0,p-1)]:ee}function yv(d,p){return qd(no(d),Au(p,0,d.length))}function Pd(d){return qd(no(d))}function E_(d,p,_){(_!==ee&&!Dn(d[p],_)||_===ee&&!(p in d))&&ll(d,p,_)}function al(d,p,_){var F=d[p];(!Xi.call(d,p)||!Dn(F,_)||_===ee&&!(p in d))&&ll(d,p,_)}function Nd(d,p){for(var _=d.length;_--;)if(Dn(d[_][0],p))return _;return-1}function Cp(d,p,_,F){return Pc(d,function(le,Ae,He){p(F,le,_(le),He)}),F}function Q1(d,p){return d&&Fa(p,Is(p),d)}function ll(d,p,_){"__proto__"==p&&_p?_p(d,p,{configurable:!0,enumerable:!0,value:_,writable:!0}):d[p]=_}function x_(d,p){for(var _=-1,F=p.length,le=Ct(F),Ae=null==d;++_<F;)le[_]=Ae?ee:pf(d,p[_]);return le}function Au(d,p,_){return d==d&&(_!==ee&&(d=d<=_?d:_),p!==ee&&(d=d>=p?d:p)),d}function Hs(d,p,_,F,le,Ae){var He,Ye=1&p,ct=2&p,Ft=4&p;if(_&&(He=le?_(d,F,le,Ae):_(d)),He!==ee)return He;if(!Tr(d))return d;var Lt=On(d);if(Lt){if(He=function(d){var p=d.length,_=new d.constructor(p);return p&&"string"==typeof d[0]&&Xi.call(d,"index")&&(_.index=d.index,_.input=d.input),_}(d),!Ye)return no(d,He)}else{var Gt=$s(d),nn=Gt==Ue||Gt==qe;if(ml(d))return Pp(d,Ye);if(Gt==pe||Gt==Qe||nn&&!le){if(He=ct||nn?{}:Uv(d),!Ye)return ct?function(d,p){return Fa(d,Bv(d),p)}(d,function(d,p){return d&&Fa(p,ro(p),d)}(He,d)):function(d,p){return Fa(d,V_(d),p)}(d,Q1(He,d))}else{if(!or[Gt])return le?d:{};He=function(d,p,_){var F=d.constructor;switch(p){case Ze:return Pu(d);case ze:case Le:return new F(+d);case Tt:return function(d,p){var _=p?Pu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.byteLength)}(d,_);case kt:case In:case Nn:case Yn:case Mi:case xi:case Xr:case Ls:case fs:return N_(d,_);case ke:return new F;case q:case we:return new F(d);case _t:return function(d){var p=new d.constructor(d.source,Xn.exec(d));return p.lastIndex=d.lastIndex,p}(d);case pt:return new F;case B:return function(d){return Rd?Yi(Rd.call(d)):{}}(d)}}(d,Gt,Ye)}}Ae||(Ae=new Na);var wn=Ae.get(d);if(wn)return wn;Ae.set(d,He),yA(d)?d.forEach(function(Bn){He.add(Hs(Bn,p,_,Bn,d,Ae))}):pA(d)&&d.forEach(function(Bn,mi){He.set(mi,Hs(Bn,p,_,mi,d,Ae))});var gi=Lt?ee:(Ft?ct?L_:ql:ct?ro:Is)(d);return Us(gi||d,function(Bn,mi){gi&&(Bn=d[mi=Bn]),al(He,mi,Hs(Bn,p,_,mi,d,Ae))}),He}function Tp(d,p,_){var F=_.length;if(null==d)return!F;for(d=Yi(d);F--;){var le=_[F],He=d[le];if(He===ee&&!(le in d)||!(0,p[le])(He))return!1}return!0}function Xh(d,p,_){if("function"!=typeof d)throw new Ia(Se);return nf(function(){d.apply(ee,_)},p)}function Rc(d,p,_,F){var le=-1,Ae=jl,He=!0,Ye=d.length,ct=[],Ft=p.length;if(!Ye)return ct;_&&(p=qi(p,ta(_))),F?(Ae=Ph,He=!1):p.length>=200&&(Ae=kh,He=!1,p=new Pa(p));e:for(;++le<Ye;){var Lt=d[le],Gt=null==_?Lt:_(Lt);if(Lt=F||0!==Lt?Lt:0,He&&Gt==Gt){for(var nn=Ft;nn--;)if(p[nn]===Gt)continue e;ct.push(Lt)}else Ae(p,Gt,F)||ct.push(Lt)}return ct}xe.templateSettings={escape:nl,evaluate:rt,interpolate:lt,variable:"",imports:{_:xe}},(xe.prototype=Wh.prototype).constructor=xe,(Lo.prototype=Tu(Wh.prototype)).constructor=Lo,(fi.prototype=Tu(Wh.prototype)).constructor=fi,_o.prototype.clear=function(){this.__data__=Hh?Hh(null):{},this.size=0},_o.prototype.delete=function(d){var p=this.has(d)&&delete this.__data__[d];return this.size-=p?1:0,p},_o.prototype.get=function(d){var p=this.__data__;if(Hh){var _=p[d];return _===W?ee:_}return Xi.call(p,d)?p[d]:ee},_o.prototype.has=function(d){var p=this.__data__;return Hh?p[d]!==ee:Xi.call(p,d)},_o.prototype.set=function(d,p){var _=this.__data__;return this.size+=this.has(d)?0:1,_[d]=Hh&&p===ee?W:p,this},zl.prototype.clear=function(){this.__data__=[],this.size=0},zl.prototype.delete=function(d){var p=this.__data__,_=Nd(p,d);return!(_<0||(_==p.length-1?p.pop():Ln.call(p,_,1),--this.size,0))},zl.prototype.get=function(d){var p=this.__data__,_=Nd(p,d);return _<0?ee:p[_][1]},zl.prototype.has=function(d){return Nd(this.__data__,d)>-1},zl.prototype.set=function(d,p){var _=this.__data__,F=Nd(_,d);return F<0?(++this.size,_.push([d,p])):_[F][1]=p,this},ol.prototype.clear=function(){this.size=0,this.__data__={hash:new _o,map:new(mo||zl),string:new _o}},ol.prototype.delete=function(d){var p=Gs(this,d).delete(d);return this.size-=p?1:0,p},ol.prototype.get=function(d){return Gs(this,d).get(d)},ol.prototype.has=function(d){return Gs(this,d).has(d)},ol.prototype.set=function(d,p){var _=Gs(this,d),F=_.size;return _.set(d,p),this.size+=_.size==F?0:1,this},Pa.prototype.add=Pa.prototype.push=function(d){return this.__data__.set(d,W),this},Pa.prototype.has=function(d){return this.__data__.has(d)},Na.prototype.clear=function(){this.__data__=new zl,this.size=0},Na.prototype.delete=function(d){var p=this.__data__,_=p.delete(d);return this.size=p.size,_},Na.prototype.get=function(d){return this.__data__.get(d)},Na.prototype.has=function(d){return this.__data__.has(d)},Na.prototype.set=function(d,p){var _=this.__data__;if(_ instanceof zl){var F=_.__data__;if(!mo||F.length<199)return F.push([d,p]),this.size=++_.size,this;_=this.__data__=new ol(F)}return _.set(d,p),this.size=_.size,this};var Pc=dl(cl),C_=dl(Ap,!0);function vv(d,p){var _=!0;return Pc(d,function(F,le,Ae){return _=!!p(F,le,Ae)}),_}function Kh(d,p,_){for(var F=-1,le=d.length;++F<le;){var Ae=d[F],He=p(Ae);if(null!=He&&(Ye===ee?He==He&&!da(He):_(He,Ye)))var Ye=He,ct=Ae}return ct}function Ev(d,p){var _=[];return Pc(d,function(F,le,Ae){p(F,le,Ae)&&_.push(F)}),_}function Ts(d,p,_,F,le){var Ae=-1,He=d.length;for(_||(_=gT),le||(le=[]);++Ae<He;){var Ye=d[Ae];p>0&&_(Ye)?p>1?Ts(Ye,p-1,_,F,le):Ur(le,Ye):F||(le[le.length]=Ye)}return le}var kd=Dv(),Fd=Dv(!0);function cl(d,p){return d&&kd(d,p,Is)}function Ap(d,p){return d&&Fd(d,p,Is)}function Qh(d,p){return Ma(p,function(_){return ua(d[_])})}function na(d,p){for(var _=0,F=(p=Lc(p,d)).length;null!=d&&_<F;)d=d[si(p[_++])];return _&&_==F?d:ee}function zi(d,p,_){var F=p(d);return On(d)?F:Ur(F,_(d))}function As(d){return null==d?d===ee?"[object Undefined]":"[object Null]":Cu&&Cu in Yi(d)?function(d){var p=Xi.call(d,Cu),_=d[Cu];try{d[Cu]=ee;var F=!0}catch(Ae){}var le=eo.call(d);return F&&(p?d[Cu]=_:delete d[Cu]),le}(d):function(d){return eo.call(d)}(d)}function yo(d,p){return d>p}function Ld(d,p){return null!=d&&Xi.call(d,p)}function Bd(d,p){return null!=d&&p in Yi(d)}function Mu(d,p,_){for(var F=_?Ph:jl,le=d[0].length,Ae=d.length,He=Ae,Ye=Ct(Ae),ct=1/0,Ft=[];He--;){var Lt=d[He];He&&p&&(Lt=qi(Lt,ta(p))),ct=ps(Lt.length,ct),Ye[He]=!_&&(p||le>=120&&Lt.length>=120)?new Pa(He&&Lt):ee}Lt=d[0];var Gt=-1,nn=Ye[0];e:for(;++Gt<le&&Ft.length<ct;){var wn=Lt[Gt],Fn=p?p(wn):wn;if(wn=_||0!==wn?wn:0,!(nn?kh(nn,Fn):F(Ft,Fn,_))){for(He=Ae;--He;){var gi=Ye[He];if(!(gi?kh(gi,Fn):F(d[He],Fn,_)))continue e}nn&&nn.push(Fn),Ft.push(wn)}}return Ft}function ka(d,p,_){var F=null==(d=H_(d,p=Lc(p,d)))?d:d[si(aa(p))];return null==F?ee:os(F,d,_)}function Z1(d){return Ar(d)&&As(d)==Qe}function Mp(d,p,_,F,le){return d===p||(null==d||null==p||!Ar(d)&&!Ar(p)?d!=d&&p!=p:function(d,p,_,F,le,Ae){var He=On(d),Ye=On(p),ct=He?tt:$s(d),Ft=Ye?tt:$s(p),Lt=(ct=ct==Qe?pe:ct)==pe,Gt=(Ft=Ft==Qe?pe:Ft)==pe,nn=ct==Ft;if(nn&&ml(d)){if(!ml(p))return!1;He=!0,Lt=!1}if(nn&&!Lt)return Ae||(Ae=new Na),He||df(d)?Vp(d,p,_,F,le,Ae):function(d,p,_,F,le,Ae,He){switch(_){case Tt:if(d.byteLength!=p.byteLength||d.byteOffset!=p.byteOffset)return!1;d=d.buffer,p=p.buffer;case Ze:return!(d.byteLength!=p.byteLength||!Ae(new Id(d),new Id(p)));case ze:case Le:case q:return Dn(+d,+p);case Me:return d.name==p.name&&d.message==p.message;case _t:case we:return d==p+"";case ke:var Ye=cv;case pt:if(Ye||(Ye=a_),d.size!=p.size&&!(1&F))return!1;var Ft=He.get(d);if(Ft)return Ft==p;F|=2,He.set(d,p);var Lt=Vp(Ye(d),Ye(p),F,le,Ae,He);return He.delete(d),Lt;case B:if(Rd)return Rd.call(d)==Rd.call(p)}return!1}(d,p,ct,_,F,le,Ae);if(!(1&_)){var wn=Lt&&Xi.call(d,"__wrapped__"),Fn=Gt&&Xi.call(p,"__wrapped__");if(wn||Fn){var gi=wn?d.value():d,Bn=Fn?p.value():p;return Ae||(Ae=new Na),le(gi,Bn,_,F,Ae)}}return!!nn&&(Ae||(Ae=new Na),function(d,p,_,F,le,Ae){var He=1&_,Ye=ql(d),ct=Ye.length;if(ct!=ql(p).length&&!He)return!1;for(var Gt=ct;Gt--;){var nn=Ye[Gt];if(!(He?nn in p:Xi.call(p,nn)))return!1}var wn=Ae.get(d),Fn=Ae.get(p);if(wn&&Fn)return wn==p&&Fn==d;var gi=!0;Ae.set(d,p),Ae.set(p,d);for(var Bn=He;++Gt<ct;){var mi=d[nn=Ye[Gt]],Di=p[nn];if(F)var wo=He?F(Di,mi,nn,p,d,Ae):F(mi,Di,nn,d,p,Ae);if(!(wo===ee?mi===Di||le(mi,Di,_,F,Ae):wo)){gi=!1;break}Bn||(Bn="constructor"==nn)}if(gi&&!Bn){var qs=d.constructor,ha=p.constructor;qs!=ha&&"constructor"in d&&"constructor"in p&&!("function"==typeof qs&&qs instanceof qs&&"function"==typeof ha&&ha instanceof ha)&&(gi=!1)}return Ae.delete(d),Ae.delete(p),gi}(d,p,_,F,le,Ae))}(d,p,_,F,Mp,le))}function A_(d,p,_,F){var le=_.length,Ae=le,He=!F;if(null==d)return!Ae;for(d=Yi(d);le--;){var Ye=_[le];if(He&&Ye[2]?Ye[1]!==d[Ye[0]]:!(Ye[0]in d))return!1}for(;++le<Ae;){var ct=(Ye=_[le])[0],Ft=d[ct],Lt=Ye[1];if(He&&Ye[2]){if(Ft===ee&&!(ct in d))return!1}else{var Gt=new Na;if(F)var nn=F(Ft,Lt,ct,d,p,Gt);if(!(nn===ee?Mp(Lt,Ft,3,F,Gt):nn))return!1}}return!0}function M_(d){return!(!Tr(d)||function(d){return!!Vh&&Vh in d}(d))&&(ua(d)?Dd:sr).test(Lu(d))}function tT(d){return"function"==typeof d?d:null==d?so:"object"==typeof d?On(d)?jd(d[0],d[1]):iT(d):Uu(d)}function xv(d){if(!zp(d))return sl(d);var p=[];for(var _ in Yi(d))Xi.call(d,_)&&"constructor"!=_&&p.push(_);return p}function Sv(d,p){return d<p}function nT(d,p){var _=-1,F=bo(d)?Ct(d.length):[];return Pc(d,function(le,Ae,He){F[++_]=p(le,Ae,He)}),F}function iT(d){var p=sa(d);return 1==p.length&&p[0][2]?_T(p[0][0],p[0][1]):function(_){return _===d||A_(_,d,p)}}function jd(d,p){return oa(d)&&mT(p)?_T(si(d),p):function(_){var F=pf(_,d);return F===ee&&F===p?eg(_,d):Mp(p,F,3)}}function D_(d,p,_,F,le){d!==p&&kd(p,function(Ae,He){if(le||(le=new Na),Tr(Ae))!function(d,p,_,F,le,Ae,He){var Ye=G_(d,_),ct=G_(p,_),Ft=He.get(ct);if(Ft)E_(d,_,Ft);else{var Lt=Ae?Ae(Ye,ct,_+"",d,p,He):ee,Gt=Lt===ee;if(Gt){var nn=On(ct),wn=!nn&&ml(ct),Fn=!nn&&!wn&&df(ct);Lt=ct,nn||wn||Fn?On(Ye)?Lt=Ye:Cr(Ye)?Lt=no(Ye):wn?(Gt=!1,Lt=Pp(ct,!0)):Fn?(Gt=!1,Lt=N_(ct,!0)):Lt=[]:Jp(ct)||gl(ct)?(Lt=Ye,gl(Ye)?Lt=Pw(Ye):(!Tr(Ye)||ua(Ye))&&(Lt=Uv(ct))):Gt=!1}Gt&&(He.set(ct,Lt),le(Lt,ct,F,Ae,He),He.delete(ct)),E_(d,_,Lt)}}(d,p,He,_,D_,F,le);else{var Ye=F?F(G_(d,He),Ae,He+"",d,p,le):ee;Ye===ee&&(Ye=Ae),E_(d,He,Ye)}},ro)}function Du(d,p){var _=d.length;if(_)return jo(p+=p<0?_:0,_)?d[p]:ee}function Zh(d,p,_){p=p.length?qi(p,function(Ae){return On(Ae)?function(He){return na(He,1===Ae.length?Ae[0]:Ae)}:Ae}):[so];var F=-1;return p=qi(p,ta(kn())),function(at,Rt){var Ct=at.length;for(at.sort(function(Ae,He){return function(d,p,_){for(var F=-1,le=d.criteria,Ae=p.criteria,He=le.length,Ye=_.length;++F<He;){var ct=Bc(le[F],Ae[F]);if(ct)return F>=Ye?ct:ct*("desc"==_[F]?-1:1)}return d.index-p.index}(Ae,He,_)});Ct--;)at[Ct]=at[Ct].value;return at}(nT(d,function(Ae,He,Ye){return{criteria:qi(p,function(Ft){return Ft(Ae)}),index:++F,value:Ae}}))}function Cv(d,p,_){for(var F=-1,le=p.length,Ae={};++F<le;){var He=p[F],Ye=na(d,He);_(Ye,He)&&Ip(Ae,Lc(He,d),Ye)}return Ae}function ra(d,p,_,F){var le=F?pp:il,Ae=-1,He=p.length,Ye=d;for(d===p&&(p=no(p)),_&&(Ye=qi(d,ta(_)));++Ae<He;)for(var ct=0,Ft=p[Ae],Lt=_?_(Ft):Ft;(ct=le(Ye,Lt,ct,F))>-1;)Ye!==d&&Ln.call(Ye,ct,1),Ln.call(d,ct,1);return d}function Jh(d,p){for(var _=d?p.length:0,F=_-1;_--;){var le=p[_];if(_==F||le!==Ae){var Ae=le;jo(le)?Ln.call(d,le,1):Iu(d,le)}}return d}function Hl(d,p){return d+Si(zh()*(p-d+1))}function Dp(d,p){var _="";if(!d||p<1||p>Te)return _;do{p%2&&(_+=d),(p=Si(p/2))&&(d+=d)}while(p);return _}function pi(d,p){return Hp(yT(d,p,so),d+"")}function rT(d){return w_(nh(d))}function xF(d,p){var _=nh(d);return qd(_,Au(p,0,_.length))}function Ip(d,p,_,F){if(!Tr(d))return d;for(var le=-1,Ae=(p=Lc(p,d)).length,He=Ae-1,Ye=d;null!=Ye&&++le<Ae;){var ct=si(p[le]),Ft=_;if("__proto__"===ct||"constructor"===ct||"prototype"===ct)return d;if(le!=He){var Lt=Ye[ct];(Ft=F?F(Lt,ct,Ye):ee)===ee&&(Ft=Tr(Lt)?Lt:jo(p[le+1])?[]:{})}al(Ye,ct,Ft),Ye=Ye[ct]}return d}var I_=Gh?function(d,p){return Gh.set(d,p),d}:so,Bo=_p?function(d,p){return _p(d,"toString",{configurable:!0,enumerable:!1,value:Oy(p),writable:!0})}:so;function O_(d){return qd(nh(d))}function Ms(d,p,_){var F=-1,le=d.length;p<0&&(p=-p>le?0:le+p),(_=_>le?le:_)<0&&(_+=le),le=p>_?0:_-p>>>0,p>>>=0;for(var Ae=Ct(le);++F<le;)Ae[F]=d[F+p];return Ae}function SF(d,p){var _;return Pc(d,function(F,le,Ae){return!(_=p(F,le,Ae))}),!!_}function ef(d,p,_){var F=0,le=null==d?F:d.length;if("number"==typeof p&&p==p&&le<=2147483647){for(;F<le;){var Ae=F+le>>>1,He=d[Ae];null!==He&&!da(He)&&(_?He<=p:He<p)?F=Ae+1:le=Ae}return le}return R_(d,p,so,_)}function R_(d,p,_,F){var le=0,Ae=null==d?0:d.length;if(0===Ae)return 0;for(var He=(p=_(p))!=p,Ye=null===p,ct=da(p),Ft=p===ee;le<Ae;){var Lt=Si((le+Ae)/2),Gt=_(d[Lt]),nn=Gt!==ee,wn=null===Gt,Fn=Gt==Gt,gi=da(Gt);if(He)var Bn=F||Fn;else Bn=Ft?Fn&&(F||nn):Ye?Fn&&nn&&(F||!wn):ct?Fn&&nn&&!wn&&(F||!gi):!wn&&!gi&&(F?Gt<=p:Gt<p);Bn?le=Lt+1:Ae=Lt}return ps(Ae,4294967294)}function Tv(d,p){for(var _=-1,F=d.length,le=0,Ae=[];++_<F;){var He=d[_],Ye=p?p(He):He;if(!_||!Dn(Ye,ct)){var ct=Ye;Ae[le++]=0===He?0:He}}return Ae}function Av(d){return"number"==typeof d?d:da(d)?NaN:+d}function Vo(d){if("string"==typeof d)return d;if(On(d))return qi(d,Vo)+"";if(da(d))return $h?$h.call(d):"";var p=d+"";return"0"==p&&1/d==-te?"-0":p}function kc(d,p,_){var F=-1,le=jl,Ae=d.length,He=!0,Ye=[],ct=Ye;if(_)He=!1,le=Ph;else if(Ae>=200){var Ft=p?null:F_(d);if(Ft)return a_(Ft);He=!1,le=kh,ct=new Pa}else ct=p?[]:Ye;e:for(;++F<Ae;){var Lt=d[F],Gt=p?p(Lt):Lt;if(Lt=_||0!==Lt?Lt:0,He&&Gt==Gt){for(var nn=ct.length;nn--;)if(ct[nn]===Gt)continue e;p&&ct.push(Gt),Ye.push(Lt)}else le(ct,Gt,_)||(ct!==Ye&&ct.push(Gt),Ye.push(Lt))}return Ye}function Iu(d,p){return null==(d=H_(d,p=Lc(p,d)))||delete d[si(aa(p))]}function Op(d,p,_,F){return Ip(d,p,_(na(d,p)),F)}function Ou(d,p,_,F){for(var le=d.length,Ae=F?le:-1;(F?Ae--:++Ae<le)&&p(d[Ae],Ae,d););return _?Ms(d,F?0:Ae,F?Ae+1:le):Ms(d,F?Ae+1:0,F?le:Ae)}function sT(d,p){var _=d;return _ instanceof fi&&(_=_.value()),Eu(p,function(F,le){return le.func.apply(le.thisArg,Ur([F],le.args))},_)}function Ru(d,p,_){var F=d.length;if(F<2)return F?kc(d[0]):[];for(var le=-1,Ae=Ct(F);++le<F;)for(var He=d[le],Ye=-1;++Ye<F;)Ye!=le&&(Ae[le]=Rc(Ae[le]||He,d[Ye],p,_));return kc(Ts(Ae,1),p,_)}function Rp(d,p,_){for(var F=-1,le=d.length,Ae=p.length,He={};++F<le;)_(He,d[F],F<Ae?p[F]:ee);return He}function Fc(d){return Cr(d)?d:[]}function P_(d){return"function"==typeof d?d:so}function Lc(d,p){return On(d)?d:oa(d,p)?[d]:$v(Hi(d))}var oT=pi;function ul(d,p,_){var F=d.length;return _=_===ee?F:_,!p&&_>=F?d:Ms(d,p,_)}var aT=fv||function(d){return Ui.clearTimeout(d)};function Pp(d,p){if(p)return d.slice();var _=d.length,F=hv?hv(_):new d.constructor(_);return d.copy(F),F}function Pu(d){var p=new d.constructor(d.byteLength);return new Id(p).set(new Id(d)),p}function N_(d,p){var _=p?Pu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.length)}function Bc(d,p){if(d!==p){var _=d!==ee,F=null===d,le=d==d,Ae=da(d),He=p!==ee,Ye=null===p,ct=p==p,Ft=da(p);if(!Ye&&!Ft&&!Ae&&d>p||Ae&&He&&ct&&!Ye&&!Ft||F&&He&&ct||!_&&ct||!le)return 1;if(!F&&!Ae&&!Ft&&d<p||Ft&&_&&le&&!F&&!Ae||Ye&&_&&le||!He&&le||!ct)return-1}return 0}function zd(d,p,_,F){for(var le=-1,Ae=d.length,He=_.length,Ye=-1,ct=p.length,Ft=zr(Ae-He,0),Lt=Ct(ct+Ft),Gt=!F;++Ye<ct;)Lt[Ye]=p[Ye];for(;++le<He;)(Gt||le<Ae)&&(Lt[_[le]]=d[le]);for(;Ft--;)Lt[Ye++]=d[le++];return Lt}function Mv(d,p,_,F){for(var le=-1,Ae=d.length,He=-1,Ye=_.length,ct=-1,Ft=p.length,Lt=zr(Ae-Ye,0),Gt=Ct(Lt+Ft),nn=!F;++le<Lt;)Gt[le]=d[le];for(var wn=le;++ct<Ft;)Gt[wn+ct]=p[ct];for(;++He<Ye;)(nn||le<Ae)&&(Gt[wn+_[He]]=d[le++]);return Gt}function no(d,p){var _=-1,F=d.length;for(p||(p=Ct(F));++_<F;)p[_]=d[_];return p}function Fa(d,p,_,F){var le=!_;_||(_={});for(var Ae=-1,He=p.length;++Ae<He;){var Ye=p[Ae],ct=F?F(_[Ye],d[Ye],Ye,_,d):ee;ct===ee&&(ct=d[Ye]),le?ll(_,Ye,ct):al(_,Ye,ct)}return _}function ts(d,p){return function(_,F){var le=On(_)?jr:Cp,Ae=p?p():{};return le(_,d,kn(F,2),Ae)}}function Gl(d){return pi(function(p,_){var F=-1,le=_.length,Ae=le>1?_[le-1]:ee,He=le>2?_[2]:ee;for(Ae=d.length>3&&"function"==typeof Ae?(le--,Ae):ee,He&&Ws(_[0],_[1],He)&&(Ae=le<3?ee:Ae,le=1),p=Yi(p);++F<le;){var Ye=_[F];Ye&&d(p,Ye,F,Ae)}return p})}function dl(d,p){return function(_,F){if(null==_)return _;if(!bo(_))return d(_,F);for(var le=_.length,Ae=p?le:-1,He=Yi(_);(p?Ae--:++Ae<le)&&!1!==F(He[Ae],Ae,He););return _}}function Dv(d){return function(p,_,F){for(var le=-1,Ae=Yi(p),He=F(p),Ye=He.length;Ye--;){var ct=He[d?Ye:++le];if(!1===_(Ae[ct],ct,Ae))break}return p}}function Np(d){return function(p){var _=Fh(p=Hi(p))?rl(p):ee,F=_?_[0]:p.charAt(0),le=_?ul(_,1).join(""):p.slice(1);return F[d]()+le}}function $l(d){return function(p){return Eu(Dy(Ey(p).replace(fp,"")),d,"")}}function Gd(d){return function(){var p=arguments;switch(p.length){case 0:return new d;case 1:return new d(p[0]);case 2:return new d(p[0],p[1]);case 3:return new d(p[0],p[1],p[2]);case 4:return new d(p[0],p[1],p[2],p[3]);case 5:return new d(p[0],p[1],p[2],p[3],p[4]);case 6:return new d(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new d(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var _=Tu(d.prototype),F=d.apply(_,p);return Tr(F)?F:_}}function Ov(d){return function(p,_,F){var le=Yi(p);if(!bo(p)){var Ae=kn(_,3);p=Is(p),_=function(Ye){return Ae(le[Ye],Ye,le)}}var He=d(p,_,F);return He>-1?le[Ae?p[He]:He]:ee}}function ku(d){return hl(function(p){var _=p.length,F=_,le=Lo.prototype.thru;for(d&&p.reverse();F--;){var Ae=p[F];if("function"!=typeof Ae)throw new Ia(Se);if(le&&!He&&"wrapper"==jp(Ae))var He=new Lo([],!0)}for(F=He?F:_;++F<_;){var Ye=jp(Ae=p[F]),ct="wrapper"==Ye?B_(Ae):ee;He=ct&&Up(ct[0])&&424==ct[1]&&!ct[4].length&&1==ct[9]?He[jp(ct[0])].apply(He,ct[3]):1==Ae.length&&Up(Ae)?He[Ye]():He.thru(Ae)}return function(){var Ft=arguments,Lt=Ft[0];if(He&&1==Ft.length&&On(Lt))return He.plant(Lt).value();for(var Gt=0,nn=_?p[Gt].apply(this,Ft):Lt;++Gt<_;)nn=p[Gt].call(this,nn);return nn}})}function Vc(d,p,_,F,le,Ae,He,Ye,ct,Ft){var Lt=p&X,Gt=1&p,nn=2&p,wn=24&p,Fn=512&p,gi=nn?ee:Gd(d);return function Bn(){for(var mi=arguments.length,Di=Ct(mi),wo=mi;wo--;)Di[wo]=arguments[wo];if(wn)var qs=Wd(Bn),ha=rF(Di,qs);if(F&&(Di=zd(Di,F,le,wn)),Ae&&(Di=Mv(Di,Ae,He,wn)),mi-=ha,wn&&mi<Ft){var Gi=xu(Di,qs);return Nv(d,p,Vc,Bn.placeholder,_,Di,Gi,Ye,ct,Ft-mi)}var bl=Gt?_:this,Gc=nn?bl[d]:d;return mi=Di.length,Ye?Di=bT(Di,Ye):Fn&&mi>1&&Di.reverse(),Lt&&ct<mi&&(Di.length=ct),this&&this!==Ui&&this instanceof Bn&&(Gc=gi||Gd(Gc)),Gc.apply(bl,Di)}}function Rv(d,p){return function(_,F){return function(d,p,_,F){return cl(d,function(le,Ae,He){p(F,_(le),Ae,He)}),F}(_,d,p(F),{})}}function k_(d,p){return function(_,F){var le;if(_===ee&&F===ee)return p;if(_!==ee&&(le=_),F!==ee){if(le===ee)return F;"string"==typeof _||"string"==typeof F?(_=Vo(_),F=Vo(F)):(_=Av(_),F=Av(F)),le=d(_,F)}return le}}function kp(d){return hl(function(p){return p=qi(p,ta(kn())),pi(function(_){var F=this;return d(p,function(le){return os(le,F,_)})})})}function Fp(d,p){var _=(p=p===ee?" ":Vo(p)).length;if(_<2)return _?Dp(p,d):p;var F=Dp(p,Vt(d/Lh(p)));return Fh(p)?ul(rl(F),0,d).join(""):F.slice(0,d)}function Pv(d){return function(p,_,F){return F&&"number"!=typeof F&&Ws(p,_,F)&&(_=F=ee),p=_l(p),_===ee?(_=p,p=0):_=_l(_),function(d,p,_,F){for(var le=-1,Ae=zr(Vt((p-d)/(_||1)),0),He=Ct(Ae);Ae--;)He[F?Ae:++le]=d,d+=_;return He}(p,_,F=F===ee?p<_?1:-1:_l(F),d)}}function Lp(d){return function(p,_){return"string"==typeof p&&"string"==typeof _||(p=vo(p),_=vo(_)),d(p,_)}}function Nv(d,p,_,F,le,Ae,He,Ye,ct,Ft){var Lt=8&p;p|=Lt?z:64,4&(p&=~(Lt?64:z))||(p&=-4);var gi=[d,p,le,Lt?Ae:ee,Lt?He:ee,Lt?ee:Ae,Lt?ee:He,Ye,ct,Ft],Bn=_.apply(ee,gi);return Up(d)&&Gv(Bn,gi),Bn.placeholder=F,rf(Bn,d,p)}function $d(d){var p=es[d];return function(_,F){if(_=vo(_),(F=null==F?0:ps(ti(F),292))&&p_(_)){var le=(Hi(_)+"e").split("e");return+((le=(Hi(p(le[0]+"e"+(+le[1]+F)))+"e").split("e"))[0]+"e"+(+le[1]-F))}return p(_)}}var F_=Ra&&1/a_(new Ra([,-0]))[1]==te?function(d){return new Ra(d)}:Ny;function Fu(d){return function(p){var _=$s(p);return _==ke?cv(p):_==pt?function(at){var Rt=-1,Ct=Array(at.size);return at.forEach(function(hn){Ct[++Rt]=[hn,hn]}),Ct}(p):function(at,Rt){return qi(Rt,function(Ct){return[Ct,at[Ct]]})}(p,d(p))}}function Wl(d,p,_,F,le,Ae,He,Ye){var ct=2&p;if(!ct&&"function"!=typeof d)throw new Ia(Se);var Ft=F?F.length:0;if(Ft||(p&=-97,F=le=ee),He=He===ee?He:zr(ti(He),0),Ye=Ye===ee?Ye:ti(Ye),Ft-=le?le.length:0,64&p){var Lt=F,Gt=le;F=le=ee}var nn=ct?ee:B_(d),wn=[d,p,_,F,le,Lt,Gt,Ae,He,Ye];if(nn&&function(d,p){var _=d[1],F=p[1],le=_|F;if(!(le<131||(F==X&&8==_||F==X&&256==_&&d[7].length<=p[8]||384==F&&p[7].length<=p[8]&&8==_)))return d;1&F&&(d[2]=p[2],le|=1&_?0:4);var Ye=p[3];if(Ye){var ct=d[3];d[3]=ct?zd(ct,Ye,p[4]):Ye,d[4]=ct?xu(d[3],k):p[4]}(Ye=p[5])&&(d[5]=(ct=d[5])?Mv(ct,Ye,p[6]):Ye,d[6]=ct?xu(d[5],k):p[6]),(Ye=p[7])&&(d[7]=Ye),F&X&&(d[8]=null==d[8]?p[8]:ps(d[8],p[8])),null==d[9]&&(d[9]=p[9]),d[0]=p[0],d[1]=le}(wn,nn),d=wn[0],p=wn[1],_=wn[2],F=wn[3],le=wn[4],!(Ye=wn[9]=wn[9]===ee?ct?0:d.length:zr(wn[9]-Ft,0))&&24&p&&(p&=-25),p&&1!=p)Fn=8==p||16==p?function(d,p,_){var F=Gd(d);return function le(){for(var Ae=arguments.length,He=Ct(Ae),Ye=Ae,ct=Wd(le);Ye--;)He[Ye]=arguments[Ye];var Ft=Ae<3&&He[0]!==ct&&He[Ae-1]!==ct?[]:xu(He,ct);return(Ae-=Ft.length)<_?Nv(d,p,Vc,le.placeholder,ee,He,Ft,ee,ee,_-Ae):os(this&&this!==Ui&&this instanceof le?F:d,this,He)}}(d,p,Ye):p!=z&&33!=p||le.length?Vc.apply(ee,wn):function(d,p,_,F){var le=1&p,Ae=Gd(d);return function He(){for(var Ye=-1,ct=arguments.length,Ft=-1,Lt=F.length,Gt=Ct(Lt+ct),nn=this&&this!==Ui&&this instanceof He?Ae:d;++Ft<Lt;)Gt[Ft]=F[Ft];for(;ct--;)Gt[Ft++]=arguments[++Ye];return os(nn,le?_:this,Gt)}}(d,p,_,F);else var Fn=function(d,p,_){var F=1&p,le=Gd(d);return function Ae(){return(this&&this!==Ui&&this instanceof Ae?le:d).apply(F?_:this,arguments)}}(d,p,_);return rf((nn?I_:Gv)(Fn,wn),d,p)}function kv(d,p,_,F){return d===ee||Dn(d,Su[_])&&!Xi.call(F,_)?p:d}function uT(d,p,_,F,le,Ae){return Tr(d)&&Tr(p)&&(Ae.set(p,d),D_(d,p,ee,uT,Ae),Ae.delete(p)),d}function Bp(d){return Jp(d)?ee:d}function Vp(d,p,_,F,le,Ae){var He=1&_,Ye=d.length,ct=p.length;if(Ye!=ct&&!(He&&ct>Ye))return!1;var Ft=Ae.get(d),Lt=Ae.get(p);if(Ft&&Lt)return Ft==p&&Lt==d;var Gt=-1,nn=!0,wn=2&_?new Pa:ee;for(Ae.set(d,p),Ae.set(p,d);++Gt<Ye;){var Fn=d[Gt],gi=p[Gt];if(F)var Bn=He?F(gi,Fn,Gt,p,d,Ae):F(Fn,gi,Gt,d,p,Ae);if(Bn!==ee){if(Bn)continue;nn=!1;break}if(wn){if(!ko(p,function(mi,Di){if(!kh(wn,Di)&&(Fn===mi||le(Fn,mi,_,F,Ae)))return wn.push(Di)})){nn=!1;break}}else if(Fn!==gi&&!le(Fn,gi,_,F,Ae)){nn=!1;break}}return Ae.delete(d),Ae.delete(p),nn}function hl(d){return Hp(yT(d,ee,Ds),d+"")}function ql(d){return zi(d,Is,V_)}function L_(d){return zi(d,ro,Bv)}var B_=Gh?function(d){return Gh.get(d)}:Ny;function jp(d){for(var p=d.name+"",_=Od[p],F=Xi.call(Od,p)?_.length:0;F--;){var le=_[F],Ae=le.func;if(null==Ae||Ae==d)return le.name}return p}function Wd(d){return(Xi.call(xe,"placeholder")?xe:d).placeholder}function kn(){var d=xe.iteratee||ju;return d=d===ju?tT:d,arguments.length?d(arguments[0],arguments[1]):d}function Gs(d,p){var _=d.__data__;return function(d){var p=typeof d;return"string"==p||"number"==p||"symbol"==p||"boolean"==p?"__proto__"!==d:null===d}(p)?_["string"==typeof p?"string":"hash"]:_.map}function sa(d){for(var p=Is(d),_=p.length;_--;){var F=p[_],le=d[F];p[_]=[F,le,mT(le)]}return p}function jc(d,p){var _=function(at,Rt){return null==at?ee:at[Rt]}(d,p);return M_(_)?_:ee}var V_=_r?function(d){return null==d?[]:(d=Yi(d),Ma(_r(d),function(p){return mp.call(d,p)}))}:Hc,Bv=_r?function(d){for(var p=[];d;)Ur(p,V_(d)),d=Oa(d);return p}:Hc,$s=As;function jv(d,p,_){for(var F=-1,le=(p=Lc(p,d)).length,Ae=!1;++F<le;){var He=si(p[F]);if(!(Ae=null!=d&&_(d,He)))break;d=d[He]}return Ae||++F!=le?Ae:!!(le=null==d?0:d.length)&&fy(le)&&jo(He,le)&&(On(d)||gl(d))}function Uv(d){return"function"!=typeof d.constructor||zp(d)?{}:Tu(Oa(d))}function gT(d){return On(d)||gl(d)||!!(L1&&d&&d[L1])}function jo(d,p){var _=typeof d;return!!(p=null==p?Te:p)&&("number"==_||"symbol"!=_&&Wi.test(d))&&d>-1&&d%1==0&&d<p}function Ws(d,p,_){if(!Tr(_))return!1;var F=typeof p;return!!("number"==F?bo(_)&&jo(p,_.length):"string"==F&&p in _)&&Dn(_[p],d)}function oa(d,p){if(On(d))return!1;var _=typeof d;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=d&&!da(d))||ge.test(d)||!ht.test(d)||null!=p&&d in Yi(p)}function Up(d){var p=jp(d),_=xe[p];if("function"!=typeof _||!(p in fi.prototype))return!1;if(d===_)return!0;var F=B_(_);return!!F&&d===F[0]}(Cs&&$s(new Cs(new ArrayBuffer(1)))!=Tt||mo&&$s(new mo)!=ke||bp&&$s(bp.resolve())!=de||Ra&&$s(new Ra)!=pt||Fo&&$s(new Fo)!=V)&&($s=function(d){var p=As(d),_=p==pe?d.constructor:ee,F=_?Lu(_):"";if(F)switch(F){case U1:return Tt;case g_:return ke;case m_:return de;case pv:return pt;case __:return V}return p});var Hv=gp?ua:Fy;function zp(d){var p=d&&d.constructor;return d===("function"==typeof p&&p.prototype||Su)}function mT(d){return d==d&&!Tr(d)}function _T(d,p){return function(_){return null!=_&&_[d]===p&&(p!==ee||d in Yi(_))}}function yT(d,p,_){return p=zr(p===ee?d.length-1:p,0),function(){for(var F=arguments,le=-1,Ae=zr(F.length-p,0),He=Ct(Ae);++le<Ae;)He[le]=F[p+le];le=-1;for(var Ye=Ct(p+1);++le<p;)Ye[le]=F[le];return Ye[p]=_(He),os(d,this,Ye)}}function H_(d,p){return p.length<2?d:na(d,Ms(p,0,-1))}function bT(d,p){for(var _=d.length,F=ps(p.length,_),le=no(d);F--;){var Ae=p[F];d[F]=jo(Ae,_)?le[Ae]:ee}return d}function G_(d,p){if(("constructor"!==p||"function"!=typeof d[p])&&"__proto__"!=p)return d[p]}var Gv=$_(I_),nf=V1||function(d,p){return Ui.setTimeout(d,p)},Hp=$_(Bo);function rf(d,p,_){var F=p+"";return Hp(d,function(d,p){var _=p.length;if(!_)return d;var F=_-1;return p[F]=(_>1?"& ":"")+p[F],p=p.join(_>2?", ":" "),d.replace(It,"{\n/* [wrapped with "+p+"] */\n")}(F,function(d,p){return Us(st,function(_){var F="_."+_[0];p&_[1]&&!jl(d,F)&&d.push(F)}),d.sort()}(function(d){var p=d.match(Ot);return p?p[1].split(Qt):[]}(F),_)))}function $_(d){var p=0,_=0;return function(){var F=pF(),le=16-(F-_);if(_=F,le>0){if(++p>=800)return arguments[0]}else p=0;return d.apply(ee,arguments)}}function qd(d,p){var _=-1,F=d.length,le=F-1;for(p=p===ee?F:p;++_<p;){var Ae=Hl(_,le),He=d[Ae];d[Ae]=d[_],d[_]=He}return d.length=p,d}var p,_,$v=(p=uf(function(d){var p=[];return 46===d.charCodeAt(0)&&p.push(""),d.replace(ve,function(_,F,le,Ae){p.push(le?Ae.replace(Rn,"$1"):F||_)}),p},function(F){return 500===_.size&&_.clear(),F}),_=p.cache,p);function si(d){if("string"==typeof d||da(d))return d;var p=d+"";return"0"==p&&1/d==-te?"-0":p}function Lu(d){if(null!=d){try{return Sr.call(d)}catch(p){}try{return d+""}catch(p){}}return""}function sf(d){if(d instanceof fi)return d.clone();var p=new Lo(d.__wrapped__,d.__chain__);return p.__actions__=no(d.__actions__),p.__index__=d.__index__,p.__values__=d.__values__,p}var xT=pi(function(d,p){return Cr(d)?Rc(d,Ts(p,1,Cr,!0)):[]}),ST=pi(function(d,p){var _=aa(p);return Cr(_)&&(_=ee),Cr(d)?Rc(d,Ts(p,1,Cr,!0),kn(_,2)):[]}),CT=pi(function(d,p){var _=aa(p);return Cr(_)&&(_=ee),Cr(d)?Rc(d,Ts(p,1,Cr,!0),ee,_):[]});function q_(d,p,_){var F=null==d?0:d.length;if(!F)return-1;var le=null==_?0:ti(_);return le<0&&(le=zr(F+le,0)),Td(d,kn(p,3),le)}function Y_(d,p,_){var F=null==d?0:d.length;if(!F)return-1;var le=F-1;return _!==ee&&(le=ti(_),le=_<0?zr(F+le,0):ps(le,F-1)),Td(d,kn(p,3),le,!0)}function Ds(d){return null!=d&&d.length?Ts(d,1):[]}function qv(d){return d&&d.length?d[0]:ee}var Xv=pi(function(d){var p=qi(d,Fc);return p.length&&p[0]===d[0]?Mu(p):[]}),MT=pi(function(d){var p=aa(d),_=qi(d,Fc);return p===aa(_)?p=ee:_.pop(),_.length&&_[0]===d[0]?Mu(_,kn(p,2)):[]}),Kv=pi(function(d){var p=aa(d),_=qi(d,Fc);return(p="function"==typeof p?p:ee)&&_.pop(),_.length&&_[0]===d[0]?Mu(_,ee,p):[]});function aa(d){var p=null==d?0:d.length;return p?d[p-1]:ee}var K_=pi(Q_);function Q_(d,p){return d&&d.length&&p&&p.length?ra(d,p):d}var Zv=hl(function(d,p){var _=null==d?0:d.length,F=x_(d,p);return Jh(d,qi(p,function(le){return jo(le,_)?+le:le}).sort(Bc)),F});function Z_(d){return null==d?d:yp.call(d)}var tw=pi(function(d){return kc(Ts(d,1,Cr,!0))}),jT=pi(function(d){var p=aa(d);return Cr(p)&&(p=ee),kc(Ts(d,1,Cr,!0),kn(p,2))}),UT=pi(function(d){var p=aa(d);return p="function"==typeof p?p:ee,kc(Ts(d,1,Cr,!0),ee,p)});function nw(d){if(!d||!d.length)return[];var p=0;return d=Ma(d,function(_){if(Cr(_))return p=zr(_.length,p),!0}),Md(p,function(_){return qi(d,r_(_))})}function HT(d,p){if(!d||!d.length)return[];var _=nw(d);return null==p?_:qi(_,function(F){return os(p,ee,F)})}var iw=pi(function(d,p){return Cr(d)?Rc(d,p):[]}),PF=pi(function(d){return Ru(Ma(d,Cr))}),Uo=pi(function(d){var p=aa(d);return Cr(p)&&(p=ee),Ru(Ma(d,Cr),kn(p,2))}),J_=pi(function(d){var p=aa(d);return p="function"==typeof p?p:ee,Ru(Ma(d,Cr),ee,p)}),ey=pi(nw),lf=pi(function(d){var p=d.length,_=p>1?d[p-1]:ee;return _="function"==typeof _?(d.pop(),_):ee,HT(d,_)});function ty(d){var p=xe(d);return p.__chain__=!0,p}function Xd(d,p){return p(d)}var ny=hl(function(d){var p=d.length,_=p?d[0]:0,F=this.__wrapped__,le=function(Ae){return x_(Ae,d)};return!(p>1||this.__actions__.length)&&F instanceof fi&&jo(_)?((F=F.slice(_,+_+(p?1:0))).__actions__.push({func:Xd,args:[le],thisArg:ee}),new Lo(F,this.__chain__).thru(function(Ae){return p&&!Ae.length&&Ae.push(ee),Ae})):this.thru(le)}),WT=ts(function(d,p,_){Xi.call(d,_)?++d[_]:ll(d,_,1)}),KT=Ov(q_),QT=Ov(Y_);function oy(d,p){return(On(d)?Us:Pc)(d,kn(p,3))}function Wp(d,p){return(On(d)?Sd:C_)(d,kn(p,3))}var JT=ts(function(d,p,_){Xi.call(d,_)?d[_].push(p):ll(d,_,[p])}),cw=pi(function(d,p,_){var F=-1,le="function"==typeof p,Ae=bo(d)?Ct(d.length):[];return Pc(d,function(He){Ae[++F]=le?os(p,He,_):ka(He,p,_)}),Ae}),uw=ts(function(d,p,_){ll(d,_,p)});function pl(d,p){return(On(d)?qi:nT)(d,kn(p,3))}var hw=ts(function(d,p,_){d[_?0:1].push(p)},function(){return[[],[]]}),Yp=pi(function(d,p){if(null==d)return[];var _=p.length;return _>1&&Ws(d,p[0],p[1])?p=[]:_>2&&Ws(p[0],p[1],p[2])&&(p=[p[0]]),Zh(d,Ts(p,1),[])}),Bu=B1||function(){return Ui.Date.now()};function Xp(d,p,_){return p=_?ee:p,Wl(d,X,ee,ee,ee,ee,p=d&&null==p?d.length:p)}function ly(d,p){var _;if("function"!=typeof p)throw new Ia(Se);return d=ti(d),function(){return--d>0&&(_=p.apply(this,arguments)),d<=1&&(p=ee),_}}var cf=pi(function(d,p,_){var F=1;if(_.length){var le=xu(_,Wd(cf));F|=z}return Wl(d,F,p,_,le)}),Qd=pi(function(d,p,_){var F=3;if(_.length){var le=xu(_,Wd(Qd));F|=z}return Wl(p,F,d,_,le)});function bw(d,p,_){var F,le,Ae,He,Ye,ct,Ft=0,Lt=!1,Gt=!1,nn=!0;if("function"!=typeof d)throw new Ia(Se);function wn(Gi){var bl=F,Gc=le;return F=le=ee,Ft=Gi,He=d.apply(Gc,bl)}function Fn(Gi){return Ft=Gi,Ye=nf(mi,p),Lt?wn(Gi):He}function Bn(Gi){var bl=Gi-ct;return ct===ee||bl>=p||bl<0||Gt&&Gi-Ft>=Ae}function mi(){var Gi=Bu();if(Bn(Gi))return Di(Gi);Ye=nf(mi,function(Gi){var aM=p-(Gi-ct);return Gt?ps(aM,Ae-(Gi-Ft)):aM}(Gi))}function Di(Gi){return Ye=ee,nn&&F?wn(Gi):(F=le=ee,He)}function ha(){var Gi=Bu(),bl=Bn(Gi);if(F=arguments,le=this,ct=Gi,bl){if(Ye===ee)return Fn(ct);if(Gt)return aT(Ye),Ye=nf(mi,p),wn(ct)}return Ye===ee&&(Ye=nf(mi,p)),He}return p=vo(p)||0,Tr(_)&&(Lt=!!_.leading,Ae=(Gt="maxWait"in _)?zr(vo(_.maxWait)||0,p):Ae,nn="trailing"in _?!!_.trailing:nn),ha.cancel=function(){Ye!==ee&&aT(Ye),Ft=0,F=ct=le=Ye=ee},ha.flush=function(){return Ye===ee?He:Di(Bu())},ha}var iA=pi(function(d,p){return Xh(d,1,p)}),vw=pi(function(d,p,_){return Xh(d,vo(p)||0,_)});function uf(d,p){if("function"!=typeof d||null!=p&&"function"!=typeof p)throw new Ia(Se);var _=function(){var F=arguments,le=p?p.apply(this,F):F[0],Ae=_.cache;if(Ae.has(le))return Ae.get(le);var He=d.apply(this,F);return _.cache=Ae.set(le,He)||Ae,He};return _.cache=new(uf.Cache||ol),_}function dy(d){if("function"!=typeof d)throw new Ia(Se);return function(){var p=arguments;switch(p.length){case 0:return!d.call(this);case 1:return!d.call(this,p[0]);case 2:return!d.call(this,p[0],p[1]);case 3:return!d.call(this,p[0],p[1],p[2])}return!d.apply(this,p)}}uf.Cache=ol;var rA=oT(function(d,p){var _=(p=1==p.length&&On(p[0])?qi(p[0],ta(kn())):qi(Ts(p,1),ta(kn()))).length;return pi(function(F){for(var le=-1,Ae=ps(F.length,_);++le<Ae;)F[le]=p[le].call(this,F[le]);return os(d,this,F)})}),Kp=pi(function(d,p){var _=xu(p,Wd(Kp));return Wl(d,z,ee,p,_)}),Ew=pi(function(d,p){var _=xu(p,Wd(Ew));return Wl(d,64,ee,p,_)}),sA=hl(function(d,p){return Wl(d,256,ee,ee,ee,p)});function Dn(d,p){return d===p||d!=d&&p!=p}var zt=Lp(yo),Cw=Lp(function(d,p){return d>=p}),gl=Z1(function(){return arguments}())?Z1:function(d){return Ar(d)&&Xi.call(d,"callee")&&!mp.call(d,"callee")},On=Ct.isArray,Tw=an?ta(an):function(d){return Ar(d)&&As(d)==Ze};function bo(d){return null!=d&&fy(d.length)&&!ua(d)}function Cr(d){return Ar(d)&&bo(d)}var ml=as||Fy,Aw=hi?ta(hi):function(d){return Ar(d)&&As(d)==Le};function Ba(d){if(!Ar(d))return!1;var p=As(d);return p==Me||"[object DOMException]"==p||"string"==typeof d.message&&"string"==typeof d.name&&!Jp(d)}function ua(d){if(!Tr(d))return!1;var p=As(d);return p==Ue||p==qe||"[object AsyncFunction]"==p||"[object Proxy]"==p}function Zp(d){return"number"==typeof d&&d==ti(d)}function fy(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=Te}function Tr(d){var p=typeof d;return null!=d&&("object"==p||"function"==p)}function Ar(d){return null!=d&&"object"==typeof d}var pA=ur?ta(ur):function(d){return Ar(d)&&$s(d)==ke};function _A(d){return"number"==typeof d||Ar(d)&&As(d)==q}function Jp(d){if(!Ar(d)||As(d)!=pe)return!1;var p=Oa(d);if(null===p)return!0;var _=Xi.call(p,"constructor")&&p.constructor;return"function"==typeof _&&_ instanceof _&&Sr.call(_)==F1}var Ow=go?ta(go):function(d){return Ar(d)&&As(d)==_t},yA=Mc?ta(Mc):function(d){return Ar(d)&&$s(d)==pt};function gy(d){return"string"==typeof d||!On(d)&&Ar(d)&&As(d)==we}function da(d){return"symbol"==typeof d||Ar(d)&&As(d)==B}var df=ss?ta(ss):function(d){return Ar(d)&&fy(d.length)&&!!rn[As(d)]},Uc=Lp(Sv),my=Lp(function(d,p){return d<=p});function Rw(d){if(!d)return[];if(bo(d))return gy(d)?rl(d):no(d);if(jh&&d[jh])return function(at){for(var Rt,Ct=[];!(Rt=at.next()).done;)Ct.push(Rt.value);return Ct}(d[jh]());var p=$s(d);return(p==ke?cv:p==pt?a_:nh)(d)}function _l(d){return d?(d=vo(d))===te||d===-te?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function ti(d){var p=_l(d),_=p%1;return p==p?_?p-_:p:0}function _y(d){return d?Au(ti(d),0,ye):0}function vo(d){if("number"==typeof d)return d;if(da(d))return NaN;if(Tr(d)){var p="function"==typeof d.valueOf?d.valueOf():d;d=Tr(p)?p+"":p}if("string"!=typeof d)return 0===d?d:+d;d=lv(d);var _=rr.test(d);return _||Qn.test(d)?av(d.slice(2),_?2:8):Cn.test(d)?NaN:+d}function Pw(d){return Fa(d,ro(d))}function Hi(d){return null==d?"":Vo(d)}var bA=Gl(function(d,p){if(zp(p)||bo(p))Fa(p,Is(p),d);else for(var _ in p)Xi.call(p,_)&&al(d,_,p[_])}),vA=Gl(function(d,p){Fa(p,ro(p),d)}),Zd=Gl(function(d,p,_,F){Fa(p,ro(p),d,F)}),wA=Gl(function(d,p,_,F){Fa(p,Is(p),d,F)}),Nw=hl(x_),xA=pi(function(d,p){d=Yi(d);var _=-1,F=p.length,le=F>2?p[2]:ee;for(le&&Ws(p[0],p[1],le)&&(F=1);++_<F;)for(var Ae=p[_],He=ro(Ae),Ye=-1,ct=He.length;++Ye<ct;){var Ft=He[Ye],Lt=d[Ft];(Lt===ee||Dn(Lt,Su[Ft])&&!Xi.call(d,Ft))&&(d[Ft]=Ae[Ft])}return d}),hf=pi(function(d){return d.push(ee,uT),os(jw,ee,d)});function pf(d,p,_){var F=null==d?ee:na(d,p);return F===ee?_:F}function eg(d,p){return null!=d&&jv(d,p,Bd)}var tg=Rv(function(d,p,_){null!=p&&"function"!=typeof p.toString&&(p=eo.call(p)),d[p]=_},Oy(so)),CA=Rv(function(d,p,_){null!=p&&"function"!=typeof p.toString&&(p=eo.call(p)),Xi.call(d,p)?d[p].push(_):d[p]=[_]},kn),Lw=pi(ka);function Is(d){return bo(d)?Yh(d):xv(d)}function ro(d){return bo(d)?Yh(d,!0):function(d){if(!Tr(d))return function(d){var p=[];if(null!=d)for(var _ in Yi(d))p.push(_);return p}(d);var p=zp(d),_=[];for(var F in d)"constructor"==F&&(p||!Xi.call(d,F))||_.push(F);return _}(d)}var Vw=Gl(function(d,p,_){D_(d,p,_)}),jw=Gl(function(d,p,_,F){D_(d,p,_,F)}),AA=hl(function(d,p){var _={};if(null==d)return _;var F=!1;p=qi(p,function(Ae){return Ae=Lc(Ae,d),F||(F=Ae.length>1),Ae}),Fa(d,L_(d),_),F&&(_=Hs(_,7,Bp));for(var le=p.length;le--;)Iu(_,p[le]);return _}),MA=hl(function(d,p){return null==d?{}:function(d,p){return Cv(d,p,function(_,F){return eg(d,F)})}(d,p)});function Uw(d,p){if(null==d)return{};var _=qi(L_(d),function(F){return[F]});return p=kn(p),Cv(d,_,function(F,le){return p(F,le[0])})}var DA=Fu(Is),Hw=Fu(ro);function nh(d){return null==d?[]:o_(d,Is(d))}var NA=$l(function(d,p,_){return p=p.toLowerCase(),d+(_?wy(p):p)});function wy(d){return ig(Hi(d).toLowerCase())}function Ey(d){return(d=Hi(d))&&d.replace(Ca,sF).replace(n_,"")}var FA=$l(function(d,p,_){return d+(_?"-":"")+p.toLowerCase()}),LA=$l(function(d,p,_){return d+(_?" ":"")+p.toLowerCase()}),GF=Np("toLowerCase"),zA=$l(function(d,p,_){return d+(_?"_":"")+p.toLowerCase()}),Cy=$l(function(d,p,_){return d+(_?" ":"")+ig(p)}),Xw=$l(function(d,p,_){return d+(_?" ":"")+p.toUpperCase()}),ig=Np("toUpperCase");function Dy(d,p,_){return d=Hi(d),(p=_?ee:p)===ee?function(at){return Bl.test(at)}(d)?function(at){return at.match(iv)||[]}(d):function(at){return at.match(zn)||[]}(d):d.match(p)||[]}var Iy=pi(function(d,p){try{return os(d,ee,p)}catch(_){return Ba(_)?_:new Mn(_)}}),Kw=hl(function(d,p){return Us(p,function(_){_=si(_),ll(d,_,cf(d[_],d))}),d});function Oy(d){return function(){return d}}var WF=ku(),Vu=ku(!0);function so(d){return d}function ju(d){return tT("function"==typeof d?d:Hs(d,1))}var Ry=pi(function(d,p){return function(_){return ka(_,d,p)}}),Qw=pi(function(d,p){return function(_){return ka(d,_,p)}});function Py(d,p,_){var F=Is(p),le=Qh(p,F);null==_&&(!Tr(p)||!le.length&&F.length)&&(_=p,p=d,d=this,le=Qh(p,Is(p)));var Ae=!(Tr(_)&&"chain"in _&&!_.chain),He=ua(d);return Us(le,function(Ye){var ct=p[Ye];d[Ye]=ct,He&&(d.prototype[Ye]=function(){var Ft=this.__chain__;if(Ae||Ft){var Lt=d(this.__wrapped__),Gt=Lt.__actions__=no(this.__actions__);return Gt.push({func:ct,args:arguments,thisArg:d}),Lt.__chain__=Ft,Lt}return ct.apply(d,Ur([this.value()],arguments))})}),d}function Ny(){}var XA=kp(qi),KA=kp(ri),Jw=kp(ko);function Uu(d){return oa(d)?r_(si(d)):function(d){return function(p){return na(p,d)}}(d)}var QA=Pv(),ZA=Pv(!0);function Hc(){return[]}function Fy(){return!1}var Hn=k_(function(d,p){return d+p},0),Ly=$d("ceil"),YF=k_(function(d,p){return d/p},1),Kl=$d("floor"),iE=k_(function(d,p){return d*p},1),rE=$d("round"),sE=k_(function(d,p){return d-p},0);return xe.after=function(d,p){if("function"!=typeof p)throw new Ia(Se);return d=ti(d),function(){if(--d<1)return p.apply(this,arguments)}},xe.ary=Xp,xe.assign=bA,xe.assignIn=vA,xe.assignInWith=Zd,xe.assignWith=wA,xe.at=Nw,xe.before=ly,xe.bind=cf,xe.bindAll=Kw,xe.bindKey=Qd,xe.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return On(d)?d:[d]},xe.chain=ty,xe.chunk=function(d,p,_){p=(_?Ws(d,p,_):p===ee)?1:zr(ti(p),0);var F=null==d?0:d.length;if(!F||p<1)return[];for(var le=0,Ae=0,He=Ct(Vt(F/p));le<F;)He[Ae++]=Ms(d,le,le+=p);return He},xe.compact=function(d){for(var p=-1,_=null==d?0:d.length,F=0,le=[];++p<_;){var Ae=d[p];Ae&&(le[F++]=Ae)}return le},xe.concat=function(){var d=arguments.length;if(!d)return[];for(var p=Ct(d-1),_=arguments[0],F=d;F--;)p[F-1]=arguments[F];return Ur(On(_)?no(_):[_],Ts(p,1))},xe.cond=function(d){var p=null==d?0:d.length,_=kn();return d=p?qi(d,function(F){if("function"!=typeof F[1])throw new Ia(Se);return[_(F[0]),F[1]]}):[],pi(function(F){for(var le=-1;++le<p;){var Ae=d[le];if(os(Ae[0],this,F))return os(Ae[1],this,F)}})},xe.conforms=function(d){return function(d){var p=Is(d);return function(_){return Tp(_,d,p)}}(Hs(d,1))},xe.constant=Oy,xe.countBy=WT,xe.create=function(d,p){var _=Tu(d);return null==p?_:Q1(_,p)},xe.curry=function yw(d,p,_){var F=Wl(d,8,ee,ee,ee,ee,ee,p=_?ee:p);return F.placeholder=yw.placeholder,F},xe.curryRight=function cy(d,p,_){var F=Wl(d,16,ee,ee,ee,ee,ee,p=_?ee:p);return F.placeholder=cy.placeholder,F},xe.debounce=bw,xe.defaults=xA,xe.defaultsDeep=hf,xe.defer=iA,xe.delay=vw,xe.difference=xT,xe.differenceBy=ST,xe.differenceWith=CT,xe.drop=function(d,p,_){var F=null==d?0:d.length;return F?Ms(d,(p=_||p===ee?1:ti(p))<0?0:p,F):[]},xe.dropRight=function(d,p,_){var F=null==d?0:d.length;return F?Ms(d,0,(p=F-(p=_||p===ee?1:ti(p)))<0?0:p):[]},xe.dropRightWhile=function(d,p){return d&&d.length?Ou(d,kn(p,3),!0,!0):[]},xe.dropWhile=function(d,p){return d&&d.length?Ou(d,kn(p,3),!0):[]},xe.fill=function(d,p,_,F){var le=null==d?0:d.length;return le?(_&&"number"!=typeof _&&Ws(d,p,_)&&(_=0,F=le),function(d,p,_,F){var le=d.length;for((_=ti(_))<0&&(_=-_>le?0:le+_),(F=F===ee||F>le?le:ti(F))<0&&(F+=le),F=_>F?0:_y(F);_<F;)d[_++]=p;return d}(d,p,_,F)):[]},xe.filter=function(d,p){return(On(d)?Ma:Ev)(d,kn(p,3))},xe.flatMap=function(d,p){return Ts(pl(d,p),1)},xe.flatMapDeep=function(d,p){return Ts(pl(d,p),te)},xe.flatMapDepth=function(d,p,_){return _=_===ee?1:ti(_),Ts(pl(d,p),_)},xe.flatten=Ds,xe.flattenDeep=function(d){return null!=d&&d.length?Ts(d,te):[]},xe.flattenDepth=function(d,p){return null!=d&&d.length?Ts(d,p=p===ee?1:ti(p)):[]},xe.flip=function(d){return Wl(d,512)},xe.flow=WF,xe.flowRight=Vu,xe.fromPairs=function(d){for(var p=-1,_=null==d?0:d.length,F={};++p<_;){var le=d[p];F[le[0]]=le[1]}return F},xe.functions=function(d){return null==d?[]:Qh(d,Is(d))},xe.functionsIn=function(d){return null==d?[]:Qh(d,ro(d))},xe.groupBy=JT,xe.initial=function(d){return null!=d&&d.length?Ms(d,0,-1):[]},xe.intersection=Xv,xe.intersectionBy=MT,xe.intersectionWith=Kv,xe.invert=tg,xe.invertBy=CA,xe.invokeMap=cw,xe.iteratee=ju,xe.keyBy=uw,xe.keys=Is,xe.keysIn=ro,xe.map=pl,xe.mapKeys=function(d,p){var _={};return p=kn(p,3),cl(d,function(F,le,Ae){ll(_,p(F,le,Ae),F)}),_},xe.mapValues=function(d,p){var _={};return p=kn(p,3),cl(d,function(F,le,Ae){ll(_,le,p(F,le,Ae))}),_},xe.matches=function(d){return iT(Hs(d,1))},xe.matchesProperty=function(d,p){return jd(d,Hs(p,1))},xe.memoize=uf,xe.merge=Vw,xe.mergeWith=jw,xe.method=Ry,xe.methodOf=Qw,xe.mixin=Py,xe.negate=dy,xe.nthArg=function(d){return d=ti(d),pi(function(p){return Du(p,d)})},xe.omit=AA,xe.omitBy=function(d,p){return Uw(d,dy(kn(p)))},xe.once=function(d){return ly(2,d)},xe.orderBy=function(d,p,_,F){return null==d?[]:(On(p)||(p=null==p?[]:[p]),On(_=F?ee:_)||(_=null==_?[]:[_]),Zh(d,p,_))},xe.over=XA,xe.overArgs=rA,xe.overEvery=KA,xe.overSome=Jw,xe.partial=Kp,xe.partialRight=Ew,xe.partition=hw,xe.pick=MA,xe.pickBy=Uw,xe.property=Uu,xe.propertyOf=function(d){return function(p){return null==d?ee:na(d,p)}},xe.pull=K_,xe.pullAll=Q_,xe.pullAllBy=function(d,p,_){return d&&d.length&&p&&p.length?ra(d,p,kn(_,2)):d},xe.pullAllWith=function(d,p,_){return d&&d.length&&p&&p.length?ra(d,p,ee,_):d},xe.pullAt=Zv,xe.range=QA,xe.rangeRight=ZA,xe.rearg=sA,xe.reject=function(d,p){return(On(d)?Ma:Ev)(d,dy(kn(p,3)))},xe.remove=function(d,p){var _=[];if(!d||!d.length)return _;var F=-1,le=[],Ae=d.length;for(p=kn(p,3);++F<Ae;){var He=d[F];p(He,F,d)&&(_.push(He),le.push(F))}return Jh(d,le),_},xe.rest=function(d,p){if("function"!=typeof d)throw new Ia(Se);return pi(d,p=p===ee?p:ti(p))},xe.reverse=Z_,xe.sampleSize=function(d,p,_){return p=(_?Ws(d,p,_):p===ee)?1:ti(p),(On(d)?yv:xF)(d,p)},xe.set=function(d,p,_){return null==d?d:Ip(d,p,_)},xe.setWith=function(d,p,_,F){return F="function"==typeof F?F:ee,null==d?d:Ip(d,p,_,F)},xe.shuffle=function(d){return(On(d)?Pd:O_)(d)},xe.slice=function(d,p,_){var F=null==d?0:d.length;return F?(_&&"number"!=typeof _&&Ws(d,p,_)?(p=0,_=F):(p=null==p?0:ti(p),_=_===ee?F:ti(_)),Ms(d,p,_)):[]},xe.sortBy=Yp,xe.sortedUniq=function(d){return d&&d.length?Tv(d):[]},xe.sortedUniqBy=function(d,p){return d&&d.length?Tv(d,kn(p,2)):[]},xe.split=function(d,p,_){return _&&"number"!=typeof _&&Ws(d,p,_)&&(p=_=ee),(_=_===ee?ye:_>>>0)?(d=Hi(d))&&("string"==typeof p||null!=p&&!Ow(p))&&!(p=Vo(p))&&Fh(d)?ul(rl(d),0,_):d.split(p,_):[]},xe.spread=function(d,p){if("function"!=typeof d)throw new Ia(Se);return p=null==p?0:zr(ti(p),0),pi(function(_){var F=_[p],le=ul(_,0,p);return F&&Ur(le,F),os(d,this,le)})},xe.tail=function(d){var p=null==d?0:d.length;return p?Ms(d,1,p):[]},xe.take=function(d,p,_){return d&&d.length?Ms(d,0,(p=_||p===ee?1:ti(p))<0?0:p):[]},xe.takeRight=function(d,p,_){var F=null==d?0:d.length;return F?Ms(d,(p=F-(p=_||p===ee?1:ti(p)))<0?0:p,F):[]},xe.takeRightWhile=function(d,p){return d&&d.length?Ou(d,kn(p,3),!1,!0):[]},xe.takeWhile=function(d,p){return d&&d.length?Ou(d,kn(p,3)):[]},xe.tap=function(d,p){return p(d),d},xe.throttle=function(d,p,_){var F=!0,le=!0;if("function"!=typeof d)throw new Ia(Se);return Tr(_)&&(F="leading"in _?!!_.leading:F,le="trailing"in _?!!_.trailing:le),bw(d,p,{leading:F,maxWait:p,trailing:le})},xe.thru=Xd,xe.toArray=Rw,xe.toPairs=DA,xe.toPairsIn=Hw,xe.toPath=function(d){return On(d)?qi(d,si):da(d)?[d]:no($v(Hi(d)))},xe.toPlainObject=Pw,xe.transform=function(d,p,_){var F=On(d),le=F||ml(d)||df(d);if(p=kn(p,4),null==_){var Ae=d&&d.constructor;_=le?F?new Ae:[]:Tr(d)&&ua(Ae)?Tu(Oa(d)):{}}return(le?Us:cl)(d,function(He,Ye,ct){return p(_,He,Ye,ct)}),_},xe.unary=function(d){return Xp(d,1)},xe.union=tw,xe.unionBy=jT,xe.unionWith=UT,xe.uniq=function(d){return d&&d.length?kc(d):[]},xe.uniqBy=function(d,p){return d&&d.length?kc(d,kn(p,2)):[]},xe.uniqWith=function(d,p){return p="function"==typeof p?p:ee,d&&d.length?kc(d,ee,p):[]},xe.unset=function(d,p){return null==d||Iu(d,p)},xe.unzip=nw,xe.unzipWith=HT,xe.update=function(d,p,_){return null==d?d:Op(d,p,P_(_))},xe.updateWith=function(d,p,_,F){return F="function"==typeof F?F:ee,null==d?d:Op(d,p,P_(_),F)},xe.values=nh,xe.valuesIn=function(d){return null==d?[]:o_(d,ro(d))},xe.without=iw,xe.words=Dy,xe.wrap=function(d,p){return Kp(P_(p),d)},xe.xor=PF,xe.xorBy=Uo,xe.xorWith=J_,xe.zip=ey,xe.zipObject=function(d,p){return Rp(d||[],p||[],al)},xe.zipObjectDeep=function(d,p){return Rp(d||[],p||[],Ip)},xe.zipWith=lf,xe.entries=DA,xe.entriesIn=Hw,xe.extend=vA,xe.extendWith=Zd,Py(xe,xe),xe.add=Hn,xe.attempt=Iy,xe.camelCase=NA,xe.capitalize=wy,xe.ceil=Ly,xe.clamp=function(d,p,_){return _===ee&&(_=p,p=ee),_!==ee&&(_=(_=vo(_))==_?_:0),p!==ee&&(p=(p=vo(p))==p?p:0),Au(vo(d),p,_)},xe.clone=function(d){return Hs(d,4)},xe.cloneDeep=function(d){return Hs(d,5)},xe.cloneDeepWith=function(d,p){return Hs(d,5,p="function"==typeof p?p:ee)},xe.cloneWith=function(d,p){return Hs(d,4,p="function"==typeof p?p:ee)},xe.conformsTo=function(d,p){return null==p||Tp(d,p,Is(p))},xe.deburr=Ey,xe.defaultTo=function(d,p){return null==d||d!=d?p:d},xe.divide=YF,xe.endsWith=function(d,p,_){d=Hi(d),p=Vo(p);var F=d.length,le=_=_===ee?F:Au(ti(_),0,F);return(_-=p.length)>=0&&d.slice(_,le)==p},xe.eq=Dn,xe.escape=function(d){return(d=Hi(d))&&en.test(d)?d.replace(Sa,oF):d},xe.escapeRegExp=function(d){return(d=Hi(d))&&ut.test(d)?d.replace(Be,"\\$&"):d},xe.every=function(d,p,_){var F=On(d)?ri:vv;return _&&Ws(d,p,_)&&(p=ee),F(d,kn(p,3))},xe.find=KT,xe.findIndex=q_,xe.findKey=function(d,p){return Nh(d,kn(p,3),cl)},xe.findLast=QT,xe.findLastIndex=Y_,xe.findLastKey=function(d,p){return Nh(d,kn(p,3),Ap)},xe.floor=Kl,xe.forEach=oy,xe.forEachRight=Wp,xe.forIn=function(d,p){return null==d?d:kd(d,kn(p,3),ro)},xe.forInRight=function(d,p){return null==d?d:Fd(d,kn(p,3),ro)},xe.forOwn=function(d,p){return d&&cl(d,kn(p,3))},xe.forOwnRight=function(d,p){return d&&Ap(d,kn(p,3))},xe.get=pf,xe.gt=zt,xe.gte=Cw,xe.has=function(d,p){return null!=d&&jv(d,p,Ld)},xe.hasIn=eg,xe.head=qv,xe.identity=so,xe.includes=function(d,p,_,F){d=bo(d)?d:nh(d),_=_&&!F?ti(_):0;var le=d.length;return _<0&&(_=zr(le+_,0)),gy(d)?_<=le&&d.indexOf(p,_)>-1:!!le&&il(d,p,_)>-1},xe.indexOf=function(d,p,_){var F=null==d?0:d.length;if(!F)return-1;var le=null==_?0:ti(_);return le<0&&(le=zr(F+le,0)),il(d,p,le)},xe.inRange=function(d,p,_){return p=_l(p),_===ee?(_=p,p=0):_=_l(_),function(d,p,_){return d>=ps(p,_)&&d<zr(p,_)}(d=vo(d),p,_)},xe.invoke=Lw,xe.isArguments=gl,xe.isArray=On,xe.isArrayBuffer=Tw,xe.isArrayLike=bo,xe.isArrayLikeObject=Cr,xe.isBoolean=function(d){return!0===d||!1===d||Ar(d)&&As(d)==ze},xe.isBuffer=ml,xe.isDate=Aw,xe.isElement=function(d){return Ar(d)&&1===d.nodeType&&!Jp(d)},xe.isEmpty=function(d){if(null==d)return!0;if(bo(d)&&(On(d)||"string"==typeof d||"function"==typeof d.splice||ml(d)||df(d)||gl(d)))return!d.length;var p=$s(d);if(p==ke||p==pt)return!d.size;if(zp(d))return!xv(d).length;for(var _ in d)if(Xi.call(d,_))return!1;return!0},xe.isEqual=function(d,p){return Mp(d,p)},xe.isEqualWith=function(d,p,_){var F=(_="function"==typeof _?_:ee)?_(d,p):ee;return F===ee?Mp(d,p,ee,_):!!F},xe.isError=Ba,xe.isFinite=function(d){return"number"==typeof d&&p_(d)},xe.isFunction=ua,xe.isInteger=Zp,xe.isLength=fy,xe.isMap=pA,xe.isMatch=function(d,p){return d===p||A_(d,p,sa(p))},xe.isMatchWith=function(d,p,_){return _="function"==typeof _?_:ee,A_(d,p,sa(p),_)},xe.isNaN=function(d){return _A(d)&&d!=+d},xe.isNative=function(d){if(Hv(d))throw new Mn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return M_(d)},xe.isNil=function(d){return null==d},xe.isNull=function(d){return null===d},xe.isNumber=_A,xe.isObject=Tr,xe.isObjectLike=Ar,xe.isPlainObject=Jp,xe.isRegExp=Ow,xe.isSafeInteger=function(d){return Zp(d)&&d>=-Te&&d<=Te},xe.isSet=yA,xe.isString=gy,xe.isSymbol=da,xe.isTypedArray=df,xe.isUndefined=function(d){return d===ee},xe.isWeakMap=function(d){return Ar(d)&&$s(d)==V},xe.isWeakSet=function(d){return Ar(d)&&"[object WeakSet]"==As(d)},xe.join=function(d,p){return null==d?"":Uh.call(d,p)},xe.kebabCase=FA,xe.last=aa,xe.lastIndexOf=function(d,p,_){var F=null==d?0:d.length;if(!F)return-1;var le=F;return _!==ee&&(le=(le=ti(_))<0?zr(F+le,0):ps(le,F-1)),p==p?function(at,Rt,Ct){for(var hn=Ct+1;hn--;)if(at[hn]===Rt)return hn;return hn}(d,p,le):Td(d,Dc,le,!0)},xe.lowerCase=LA,xe.lowerFirst=GF,xe.lt=Uc,xe.lte=my,xe.max=function(d){return d&&d.length?Kh(d,so,yo):ee},xe.maxBy=function(d,p){return d&&d.length?Kh(d,kn(p,2),yo):ee},xe.mean=function(d){return Ss(d,so)},xe.meanBy=function(d,p){return Ss(d,kn(p,2))},xe.min=function(d){return d&&d.length?Kh(d,so,Sv):ee},xe.minBy=function(d,p){return d&&d.length?Kh(d,kn(p,2),Sv):ee},xe.stubArray=Hc,xe.stubFalse=Fy,xe.stubObject=function(){return{}},xe.stubString=function(){return""},xe.stubTrue=function(){return!0},xe.multiply=iE,xe.nth=function(d,p){return d&&d.length?Du(d,ti(p)):ee},xe.noConflict=function(){return Ui._===this&&(Ui._=h_),this},xe.noop=Ny,xe.now=Bu,xe.pad=function(d,p,_){d=Hi(d);var F=(p=ti(p))?Lh(d):0;if(!p||F>=p)return d;var le=(p-F)/2;return Fp(Si(le),_)+d+Fp(Vt(le),_)},xe.padEnd=function(d,p,_){d=Hi(d);var F=(p=ti(p))?Lh(d):0;return p&&F<p?d+Fp(p-F,_):d},xe.padStart=function(d,p,_){d=Hi(d);var F=(p=ti(p))?Lh(d):0;return p&&F<p?Fp(p-F,_)+d:d},xe.parseInt=function(d,p,_){return _||null==p?p=0:p&&(p=+p),j1(Hi(d).replace(Je,""),p||0)},xe.random=function(d,p,_){if(_&&"boolean"!=typeof _&&Ws(d,p,_)&&(p=_=ee),_===ee&&("boolean"==typeof p?(_=p,p=ee):"boolean"==typeof d&&(_=d,d=ee)),d===ee&&p===ee?(d=0,p=1):(d=_l(d),p===ee?(p=d,d=0):p=_l(p)),d>p){var F=d;d=p,p=F}if(_||d%1||p%1){var le=zh();return ps(d+le*(p-d+M1("1e-"+((le+"").length-1))),p)}return Hl(d,p)},xe.reduce=function(d,p,_){var F=On(d)?Eu:ea,le=arguments.length<3;return F(d,kn(p,4),_,le,Pc)},xe.reduceRight=function(d,p,_){var F=On(d)?Cd:ea,le=arguments.length<3;return F(d,kn(p,4),_,le,C_)},xe.repeat=function(d,p,_){return p=(_?Ws(d,p,_):p===ee)?1:ti(p),Dp(Hi(d),p)},xe.replace=function(){var d=arguments,p=Hi(d[0]);return d.length<3?p:p.replace(d[1],d[2])},xe.result=function(d,p,_){var F=-1,le=(p=Lc(p,d)).length;for(le||(le=1,d=ee);++F<le;){var Ae=null==d?ee:d[si(p[F])];Ae===ee&&(F=le,Ae=_),d=ua(Ae)?Ae.call(d):Ae}return d},xe.round=rE,xe.runInContext=at,xe.sample=function(d){return(On(d)?w_:rT)(d)},xe.size=function(d){if(null==d)return 0;if(bo(d))return gy(d)?Lh(d):d.length;var p=$s(d);return p==ke||p==pt?d.size:xv(d).length},xe.snakeCase=zA,xe.some=function(d,p,_){var F=On(d)?ko:SF;return _&&Ws(d,p,_)&&(p=ee),F(d,kn(p,3))},xe.sortedIndex=function(d,p){return ef(d,p)},xe.sortedIndexBy=function(d,p,_){return R_(d,p,kn(_,2))},xe.sortedIndexOf=function(d,p){var _=null==d?0:d.length;if(_){var F=ef(d,p);if(F<_&&Dn(d[F],p))return F}return-1},xe.sortedLastIndex=function(d,p){return ef(d,p,!0)},xe.sortedLastIndexBy=function(d,p,_){return R_(d,p,kn(_,2),!0)},xe.sortedLastIndexOf=function(d,p){if(null!=d&&d.length){var F=ef(d,p,!0)-1;if(Dn(d[F],p))return F}return-1},xe.startCase=Cy,xe.startsWith=function(d,p,_){return d=Hi(d),_=null==_?0:Au(ti(_),0,d.length),p=Vo(p),d.slice(_,_+p.length)==p},xe.subtract=sE,xe.sum=function(d){return d&&d.length?Ad(d,so):0},xe.sumBy=function(d,p){return d&&d.length?Ad(d,kn(p,2)):0},xe.template=function(d,p,_){var F=xe.templateSettings;_&&Ws(d,p,_)&&(p=ee),d=Hi(d),p=Zd({},p,F,kv);var Ye,ct,le=Zd({},p.imports,F.imports,kv),Ae=Is(le),He=o_(le,Ae),Ft=0,Lt=p.interpolate||Qr,Gt="__p += '",nn=u_((p.escape||Qr).source+"|"+Lt.source+"|"+(Lt===lt?bn:Qr).source+"|"+(p.evaluate||Qr).source+"|$","g"),wn="//# sourceURL="+(Xi.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++A1+"]")+"\n";d.replace(nn,function(Bn,mi,Di,wo,qs,ha){return Di||(Di=wo),Gt+=d.slice(Ft,ha).replace(re,aF),mi&&(Ye=!0,Gt+="' +\n__e("+mi+") +\n'"),qs&&(ct=!0,Gt+="';\n"+qs+";\n__p += '"),Di&&(Gt+="' +\n((__t = ("+Di+")) == null ? '' : __t) +\n'"),Ft=ha+Bn.length,Bn}),Gt+="';\n";var Fn=Xi.call(p,"variable")&&p.variable;if(Fn){if(ci.test(Fn))throw new Mn("Invalid `variable` option passed into `_.template`")}else Gt="with (obj) {\n"+Gt+"\n}\n";Gt=(ct?Gt.replace(Bs,""):Gt).replace(Kr,"$1").replace(xa,"$1;"),Gt="function("+(Fn||"obj")+") {\n"+(Fn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(Ye?", __e = _.escape":"")+(ct?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Gt+"return __p\n}";var gi=Iy(function(){return Li(Ae,wn+"return "+Gt).apply(ee,He)});if(gi.source=Gt,Ba(gi))throw gi;return gi},xe.times=function(d,p){if((d=ti(d))<1||d>Te)return[];var _=ye,F=ps(d,ye);p=kn(p),d-=ye;for(var le=Md(F,p);++_<d;)p(_);return le},xe.toFinite=_l,xe.toInteger=ti,xe.toLength=_y,xe.toLower=function(d){return Hi(d).toLowerCase()},xe.toNumber=vo,xe.toSafeInteger=function(d){return d?Au(ti(d),-Te,Te):0===d?d:0},xe.toString=Hi,xe.toUpper=function(d){return Hi(d).toUpperCase()},xe.trim=function(d,p,_){if((d=Hi(d))&&(_||p===ee))return lv(d);if(!d||!(p=Vo(p)))return d;var F=rl(d),le=rl(p);return ul(F,O1(F,le),R1(F,le)+1).join("")},xe.trimEnd=function(d,p,_){if((d=Hi(d))&&(_||p===ee))return d.slice(0,Ic(d)+1);if(!d||!(p=Vo(p)))return d;var F=rl(d);return ul(F,0,R1(F,rl(p))+1).join("")},xe.trimStart=function(d,p,_){if((d=Hi(d))&&(_||p===ee))return d.replace(Je,"");if(!d||!(p=Vo(p)))return d;var F=rl(d);return ul(F,O1(F,rl(p))).join("")},xe.truncate=function(d,p){var _=30,F="...";if(Tr(p)){var le="separator"in p?p.separator:le;_="length"in p?ti(p.length):_,F="omission"in p?Vo(p.omission):F}var Ae=(d=Hi(d)).length;if(Fh(d)){var He=rl(d);Ae=He.length}if(_>=Ae)return d;var Ye=_-Lh(F);if(Ye<1)return F;var ct=He?ul(He,0,Ye).join(""):d.slice(0,Ye);if(le===ee)return ct+F;if(He&&(Ye+=ct.length-Ye),Ow(le)){if(d.slice(Ye).search(le)){var Ft,Lt=ct;for(le.global||(le=u_(le.source,Hi(Xn.exec(le))+"g")),le.lastIndex=0;Ft=le.exec(Lt);)var Gt=Ft.index;ct=ct.slice(0,Gt===ee?Ye:Gt)}}else if(d.indexOf(Vo(le),Ye)!=Ye){var nn=ct.lastIndexOf(le);nn>-1&&(ct=ct.slice(0,nn))}return ct+F},xe.unescape=function(d){return(d=Hi(d))&&ws.test(d)?d.replace(kl,c_):d},xe.uniqueId=function(d){var p=++fF;return Hi(d)+p},xe.upperCase=Xw,xe.upperFirst=ig,xe.each=oy,xe.eachRight=Wp,xe.first=qv,Py(xe,function(){var d={};return cl(xe,function(p,_){Xi.call(xe.prototype,_)||(d[_]=p)}),d}(),{chain:!1}),xe.VERSION="4.17.21",Us(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){xe[d].placeholder=xe}),Us(["drop","take"],function(d,p){fi.prototype[d]=function(_){_=_===ee?1:zr(ti(_),0);var F=this.__filtered__&&!p?new fi(this):this.clone();return F.__filtered__?F.__takeCount__=ps(_,F.__takeCount__):F.__views__.push({size:ps(_,ye),type:d+(F.__dir__<0?"Right":"")}),F},fi.prototype[d+"Right"]=function(_){return this.reverse()[d](_).reverse()}}),Us(["filter","map","takeWhile"],function(d,p){var _=p+1,F=1==_||3==_;fi.prototype[d]=function(le){var Ae=this.clone();return Ae.__iteratees__.push({iteratee:kn(le,3),type:_}),Ae.__filtered__=Ae.__filtered__||F,Ae}}),Us(["head","last"],function(d,p){var _="take"+(p?"Right":"");fi.prototype[d]=function(){return this[_](1).value()[0]}}),Us(["initial","tail"],function(d,p){var _="drop"+(p?"":"Right");fi.prototype[d]=function(){return this.__filtered__?new fi(this):this[_](1)}}),fi.prototype.compact=function(){return this.filter(so)},fi.prototype.find=function(d){return this.filter(d).head()},fi.prototype.findLast=function(d){return this.reverse().find(d)},fi.prototype.invokeMap=pi(function(d,p){return"function"==typeof d?new fi(this):this.map(function(_){return ka(_,d,p)})}),fi.prototype.reject=function(d){return this.filter(dy(kn(d)))},fi.prototype.slice=function(d,p){d=ti(d);var _=this;return _.__filtered__&&(d>0||p<0)?new fi(_):(d<0?_=_.takeRight(-d):d&&(_=_.drop(d)),p!==ee&&(_=(p=ti(p))<0?_.dropRight(-p):_.take(p-d)),_)},fi.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},fi.prototype.toArray=function(){return this.take(ye)},cl(fi.prototype,function(d,p){var _=/^(?:filter|find|map|reject)|While$/.test(p),F=/^(?:head|last)$/.test(p),le=xe[F?"take"+("last"==p?"Right":""):p],Ae=F||/^find/.test(p);!le||(xe.prototype[p]=function(){var He=this.__wrapped__,Ye=F?[1]:arguments,ct=He instanceof fi,Ft=Ye[0],Lt=ct||On(He),Gt=function(mi){var Di=le.apply(xe,Ur([mi],Ye));return F&&nn?Di[0]:Di};Lt&&_&&"function"==typeof Ft&&1!=Ft.length&&(ct=Lt=!1);var nn=this.__chain__,wn=!!this.__actions__.length,Fn=Ae&&!nn,gi=ct&&!wn;if(!Ae&&Lt){He=gi?He:new fi(this);var Bn=d.apply(He,Ye);return Bn.__actions__.push({func:Xd,args:[Gt],thisArg:ee}),new Lo(Bn,nn)}return Fn&&gi?d.apply(this,Ye):(Bn=this.thru(Gt),Fn?F?Bn.value()[0]:Bn.value():Bn)})}),Us(["pop","push","shift","sort","splice","unshift"],function(d){var p=dr[d],_=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",F=/^(?:pop|shift)$/.test(d);xe.prototype[d]=function(){var le=arguments;if(F&&!this.__chain__){var Ae=this.value();return p.apply(On(Ae)?Ae:[],le)}return this[_](function(He){return p.apply(On(He)?He:[],le)})}}),cl(fi.prototype,function(d,p){var _=xe[p];if(_){var F=_.name+"";Xi.call(Od,F)||(Od[F]=[]),Od[F].push({name:p,func:_})}}),Od[Vc(ee,2).name]=[{name:"wrapper",func:ee}],fi.prototype.clone=function(){var d=new fi(this.__wrapped__);return d.__actions__=no(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=no(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=no(this.__views__),d},fi.prototype.reverse=function(){if(this.__filtered__){var d=new fi(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},fi.prototype.value=function(){var d=this.__wrapped__.value(),p=this.__dir__,_=On(d),F=p<0,le=_?d.length:0,Ae=function(d,p,_){for(var F=-1,le=_.length;++F<le;){var Ae=_[F],He=Ae.size;switch(Ae.type){case"drop":d+=He;break;case"dropRight":p-=He;break;case"take":p=ps(p,d+He);break;case"takeRight":d=zr(d,p-He)}}return{start:d,end:p}}(0,le,this.__views__),He=Ae.start,Ye=Ae.end,ct=Ye-He,Ft=F?Ye:He-1,Lt=this.__iteratees__,Gt=Lt.length,nn=0,wn=ps(ct,this.__takeCount__);if(!_||!F&&le==ct&&wn==ct)return sT(d,this.__actions__);var Fn=[];e:for(;ct--&&nn<wn;){for(var gi=-1,Bn=d[Ft+=p];++gi<Gt;){var mi=Lt[gi],wo=mi.type,qs=(0,mi.iteratee)(Bn);if(2==wo)Bn=qs;else if(!qs){if(1==wo)continue e;break e}}Fn[nn++]=Bn}return Fn},xe.prototype.at=ny,xe.prototype.chain=function(){return ty(this)},xe.prototype.commit=function(){return new Lo(this.value(),this.__chain__)},xe.prototype.next=function(){this.__values__===ee&&(this.__values__=Rw(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?ee:this.__values__[this.__index__++]}},xe.prototype.plant=function(d){for(var p,_=this;_ instanceof Wh;){var F=sf(_);F.__index__=0,F.__values__=ee,p?le.__wrapped__=F:p=F;var le=F;_=_.__wrapped__}return le.__wrapped__=d,p},xe.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof fi){var p=d;return this.__actions__.length&&(p=new fi(this)),(p=p.reverse()).__actions__.push({func:Xd,args:[Z_],thisArg:ee}),new Lo(p,this.__chain__)}return this.thru(Z_)},xe.prototype.toJSON=xe.prototype.valueOf=xe.prototype.value=function(){return sT(this.__wrapped__,this.__actions__)},xe.prototype.first=xe.prototype.head,jh&&(xe.prototype[jh]=function(){return this}),xe}();Ui._=Bh,(yt=function(){return Bh}.call(it,et,it,Ut))!==ee&&(Ut.exports=yt)}.call(this)},5478:function(Ut){Ut.exports=function(){"use strict";function it(rt,lt){for(var ht=0;ht<lt.length;ht++){var ge=lt[ht];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(rt,ge.key,ge)}}function ee(rt,lt){(null==lt||lt>rt.length)&&(lt=rt.length);for(var ht=0,ge=new Array(lt);ht<lt;ht++)ge[ht]=rt[ht];return ge}function Dt(rt,lt){var ht="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ht)return(ht=ht.call(rt)).next.bind(ht);if(Array.isArray(rt)||(ht=function(rt,lt){if(rt){if("string"==typeof rt)return ee(rt,lt);var ht=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ht&&rt.constructor&&(ht=rt.constructor.name),"Map"===ht||"Set"===ht)return Array.from(rt);if("Arguments"===ht||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ht))return ee(rt,lt)}}(rt))||lt&&rt&&"number"==typeof rt.length){ht&&(rt=ht);var ge=0;return function(){return ge>=rt.length?{done:!0}:{done:!1,value:rt[ge++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function Y(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:Y,changeDefaults:function(rt){dt.exports.defaults=rt}};var he=/[&<>"']/,W=/[&<>"']/g,j=/[<>"']|&(?!#?\w+;)/,k=/[<>"']|&(?!#?\w+;)/g,Q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},H=function(lt){return Q[lt]};var C=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function R(rt){return rt.replace(C,function(lt,ht){return"colon"===(ht=ht.toLowerCase())?":":"#"===ht.charAt(0)?"x"===ht.charAt(1)?String.fromCharCode(parseInt(ht.substring(2),16)):String.fromCharCode(+ht.substring(1)):""})}var T=/(^|[^\[])\^/g;var y=/[^\w:]/g,S=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var z={},P=/^[^:]+:\/*[^/]*$/,X=/^([^:]+:)[\s\S]*$/,ue=/^([^:]+:\/*[^/]*)[\s\S]*$/;function I(rt,lt){z[" "+rt]||(z[" "+rt]=P.test(rt)?rt+"/":$(rt,"/",!0));var ht=-1===(rt=z[" "+rt]).indexOf(":");return"//"===lt.substring(0,2)?ht?lt:rt.replace(X,"$1")+lt:"/"===lt.charAt(0)?ht?lt:rt.replace(ue,"$1")+lt:rt+lt}function $(rt,lt,ht){var ge=rt.length;if(0===ge)return"";for(var ve=0;ve<ge;){var Be=rt.charAt(ge-ve-1);if(Be!==lt||ht){if(Be===lt||!ht)break;ve++}else ve++}return rt.substr(0,ge-ve)}var te_escape=function(rt,lt){if(lt){if(he.test(rt))return rt.replace(W,H)}else if(j.test(rt))return rt.replace(k,H);return rt},te_unescape=R,te_edit=function(rt,lt){rt=rt.source||rt,lt=lt||"";var ht={replace:function(ve,Be){return Be=(Be=Be.source||Be).replace(T,"$1"),rt=rt.replace(ve,Be),ht},getRegex:function(){return new RegExp(rt,lt)}};return ht},te_cleanUrl=function(rt,lt,ht){if(rt){var ge;try{ge=decodeURIComponent(R(ht)).replace(y,"").toLowerCase()}catch(ve){return null}if(0===ge.indexOf("javascript:")||0===ge.indexOf("vbscript:")||0===ge.indexOf("data:"))return null}lt&&!S.test(ht)&&(ht=I(lt,ht));try{ht=encodeURI(ht).replace(/%25/g,"%")}catch(ve){return null}return ht},te_noopTest={exec:function(){}},te_merge=function(rt){for(var ht,ge,lt=1;lt<arguments.length;lt++)for(ge in ht=arguments[lt])Object.prototype.hasOwnProperty.call(ht,ge)&&(rt[ge]=ht[ge]);return rt},te_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},te_repeatString=function(rt,lt){if(lt<1)return"";for(var ht="";lt>1;)1&lt&&(ht+=rt),lt>>=1,rt+=rt;return ht+rt},Te=dt.exports.defaults,me=$,ne=function(rt,lt){var ge=rt.replace(/\|/g,function(Be,ut,Je){for(var Mt=!1,It=ut;--It>=0&&"\\"===Je[It];)Mt=!Mt;return Mt?"|":" |"}).split(/ \|/),ve=0;if(ge.length>lt)ge.splice(lt);else for(;ge.length<lt;)ge.push("");for(;ve<ge.length;ve++)ge[ve]=ge[ve].trim().replace(/\\\|/g,"|");return ge},ye=te_escape,Oe=function(rt,lt){if(-1===rt.indexOf(lt[1]))return-1;for(var ht=rt.length,ge=0,ve=0;ve<ht;ve++)if("\\"===rt[ve])ve++;else if(rt[ve]===lt[0])ge++;else if(rt[ve]===lt[1]&&--ge<0)return ve;return-1};function $e(rt,lt,ht){var ge=lt.href,ve=lt.title?ye(lt.title):null,Be=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ht,href:ge,title:ve,text:Be}:{type:"image",raw:ht,href:ge,title:ve,text:ye(Be)}}var Qe=function(){function rt(ht){this.options=ht||Te}var lt=rt.prototype;return lt.space=function(ge){var ve=this.rules.block.newline.exec(ge);if(ve)return ve[0].length>1?{type:"space",raw:ve[0]}:{raw:"\n"}},lt.code=function(ge){var ve=this.rules.block.code.exec(ge);if(ve){var Be=ve[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:ve[0],codeBlockStyle:"indented",text:this.options.pedantic?Be:me(Be,"\n")}}},lt.fences=function(ge){var ve=this.rules.block.fences.exec(ge);if(ve){var Be=ve[0],ut=function(rt,lt){var ht=rt.match(/^(\s+)(?:```)/);if(null===ht)return lt;var ge=ht[1];return lt.split("\n").map(function(ve){var Be=ve.match(/^\s+/);return null===Be?ve:Be[0].length>=ge.length?ve.slice(ge.length):ve}).join("\n")}(Be,ve[3]||"");return{type:"code",raw:Be,lang:ve[2]?ve[2].trim():ve[2],text:ut}}},lt.heading=function(ge){var ve=this.rules.block.heading.exec(ge);if(ve){var Be=ve[2].trim();if(/#$/.test(Be)){var ut=me(Be,"#");(this.options.pedantic||!ut||/ $/.test(ut))&&(Be=ut.trim())}return{type:"heading",raw:ve[0],depth:ve[1].length,text:Be}}},lt.nptable=function(ge){var ve=this.rules.block.nptable.exec(ge);if(ve){var Be={type:"table",header:ne(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[],raw:ve[0]};if(Be.header.length===Be.align.length){var Je,ut=Be.align.length;for(Je=0;Je<ut;Je++)Be.align[Je]=/^ *-+: *$/.test(Be.align[Je])?"right":/^ *:-+: *$/.test(Be.align[Je])?"center":/^ *:-+ *$/.test(Be.align[Je])?"left":null;for(ut=Be.cells.length,Je=0;Je<ut;Je++)Be.cells[Je]=ne(Be.cells[Je],Be.header.length);return Be}}},lt.hr=function(ge){var ve=this.rules.block.hr.exec(ge);if(ve)return{type:"hr",raw:ve[0]}},lt.blockquote=function(ge){var ve=this.rules.block.blockquote.exec(ge);if(ve){var Be=ve[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:ve[0],text:Be}}},lt.list=function(ge){var ve=this.rules.block.list.exec(ge);if(ve){var Qt,zn,ci,Rn,bn,Xn,Cn,rr,sr,Be=ve[0],ut=ve[2],Je=ut.length>1,Mt={type:"list",raw:Be,ordered:Je,start:Je?+ut.slice(0,-1):"",loose:!1,items:[]},It=ve[0].match(this.rules.block.item),Ot=!1,Qn=It.length;ci=this.rules.block.listItemStart.exec(It[0]);for(var Wi=0;Wi<Qn;Wi++){if(Be=Qt=It[Wi],this.options.pedantic||(sr=Qt.match(new RegExp("\\n\\s*\\n {0,"+(ci[0].length-1)+"}\\S")))&&(bn=Qt.length-sr.index+It.slice(Wi+1).join("\n").length,Mt.raw=Mt.raw.substring(0,Mt.raw.length-bn),Be=Qt=Qt.substring(0,sr.index),Qn=Wi+1),Wi!==Qn-1){if(Rn=this.rules.block.listItemStart.exec(It[Wi+1]),this.options.pedantic?Rn[1].length>ci[1].length:Rn[1].length>=ci[0].length||Rn[1].length>3){It.splice(Wi,2,It[Wi]+(!this.options.pedantic&&Rn[1].length<ci[0].length&&!It[Wi].match(/\n$/)?"":"\n")+It[Wi+1]),Wi--,Qn--;continue}(!this.options.pedantic||this.options.smartLists?Rn[2][Rn[2].length-1]!==ut[ut.length-1]:Je===(1===Rn[2].length))&&(bn=It.slice(Wi+1).join("\n").length,Mt.raw=Mt.raw.substring(0,Mt.raw.length-bn),Wi=Qn-1),ci=Rn}zn=Qt.length,~(Qt=Qt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(zn-=Qt.length,Qt=Qt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+zn+"}","gm"),"")),Qt=me(Qt,"\n"),Wi!==Qn-1&&(Be+="\n"),Xn=Ot||/\n\n(?!\s*$)/.test(Be),Wi!==Qn-1&&(Ot="\n\n"===Be.slice(-2),Xn||(Xn=Ot)),Xn&&(Mt.loose=!0),this.options.gfm&&(rr=void 0,(Cn=/^\[[ xX]\] /.test(Qt))&&(rr=" "!==Qt[1],Qt=Qt.replace(/^\[[ xX]\] +/,""))),Mt.items.push({type:"list_item",raw:Be,task:Cn,checked:rr,loose:Xn,text:Qt})}return Mt}},lt.html=function(ge){var ve=this.rules.block.html.exec(ge);if(ve)return{type:this.options.sanitize?"paragraph":"html",raw:ve[0],pre:!this.options.sanitizer&&("pre"===ve[1]||"script"===ve[1]||"style"===ve[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ve[0]):ye(ve[0]):ve[0]}},lt.def=function(ge){var ve=this.rules.block.def.exec(ge);if(ve)return ve[3]&&(ve[3]=ve[3].substring(1,ve[3].length-1)),{type:"def",tag:ve[1].toLowerCase().replace(/\s+/g," "),raw:ve[0],href:ve[2],title:ve[3]}},lt.table=function(ge){var ve=this.rules.block.table.exec(ge);if(ve){var Be={type:"table",header:ne(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[]};if(Be.header.length===Be.align.length){Be.raw=ve[0];var Je,ut=Be.align.length;for(Je=0;Je<ut;Je++)Be.align[Je]=/^ *-+: *$/.test(Be.align[Je])?"right":/^ *:-+: *$/.test(Be.align[Je])?"center":/^ *:-+ *$/.test(Be.align[Je])?"left":null;for(ut=Be.cells.length,Je=0;Je<ut;Je++)Be.cells[Je]=ne(Be.cells[Je].replace(/^ *\| *| *\| *$/g,""),Be.header.length);return Be}}},lt.lheading=function(ge){var ve=this.rules.block.lheading.exec(ge);if(ve)return{type:"heading",raw:ve[0],depth:"="===ve[2].charAt(0)?1:2,text:ve[1]}},lt.paragraph=function(ge){var ve=this.rules.block.paragraph.exec(ge);if(ve)return{type:"paragraph",raw:ve[0],text:"\n"===ve[1].charAt(ve[1].length-1)?ve[1].slice(0,-1):ve[1]}},lt.text=function(ge){var ve=this.rules.block.text.exec(ge);if(ve)return{type:"text",raw:ve[0],text:ve[0]}},lt.escape=function(ge){var ve=this.rules.inline.escape.exec(ge);if(ve)return{type:"escape",raw:ve[0],text:ye(ve[1])}},lt.tag=function(ge,ve,Be){var ut=this.rules.inline.tag.exec(ge);if(ut)return!ve&&/^<a /i.test(ut[0])?ve=!0:ve&&/^<\/a>/i.test(ut[0])&&(ve=!1),!Be&&/^<(pre|code|kbd|script)(\s|>)/i.test(ut[0])?Be=!0:Be&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ut[0])&&(Be=!1),{type:this.options.sanitize?"text":"html",raw:ut[0],inLink:ve,inRawBlock:Be,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):ye(ut[0]):ut[0]}},lt.link=function(ge){var ve=this.rules.inline.link.exec(ge);if(ve){var Be=ve[2].trim();if(!this.options.pedantic&&/^</.test(Be)){if(!/>$/.test(Be))return;var ut=me(Be.slice(0,-1),"\\");if((Be.length-ut.length)%2==0)return}else{var Je=Oe(ve[2],"()");if(Je>-1){var It=(0===ve[0].indexOf("!")?5:4)+ve[1].length+Je;ve[2]=ve[2].substring(0,Je),ve[0]=ve[0].substring(0,It).trim(),ve[3]=""}}var Ot=ve[2],Qt="";if(this.options.pedantic){var zn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Ot);zn&&(Ot=zn[1],Qt=zn[3])}else Qt=ve[3]?ve[3].slice(1,-1):"";return Ot=Ot.trim(),/^</.test(Ot)&&(Ot=this.options.pedantic&&!/>$/.test(Be)?Ot.slice(1):Ot.slice(1,-1)),$e(ve,{href:Ot&&Ot.replace(this.rules.inline._escapes,"$1"),title:Qt&&Qt.replace(this.rules.inline._escapes,"$1")},ve[0])}},lt.reflink=function(ge,ve){var Be;if((Be=this.rules.inline.reflink.exec(ge))||(Be=this.rules.inline.nolink.exec(ge))){var ut=(Be[2]||Be[1]).replace(/\s+/g," ");if(!(ut=ve[ut.toLowerCase()])||!ut.href){var Je=Be[0].charAt(0);return{type:"text",raw:Je,text:Je}}return $e(Be,ut,Be[0])}},lt.emStrong=function(ge,ve,Be){void 0===Be&&(Be="");var ut=this.rules.inline.emStrong.lDelim.exec(ge);if(ut&&(!ut[3]||!Be.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Je=ut[1]||ut[2]||"";if(!Je||Je&&(""===Be||this.rules.inline.punctuation.exec(Be))){var It,Ot,Mt=ut[0].length-1,Qt=Mt,zn=0,ci="*"===ut[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ci.lastIndex=0,ve=ve.slice(-1*ge.length+Mt);null!=(ut=ci.exec(ve));)if(It=ut[1]||ut[2]||ut[3]||ut[4]||ut[5]||ut[6]){if(Ot=It.length,ut[3]||ut[4]){Qt+=Ot;continue}if((ut[5]||ut[6])&&Mt%3&&!((Mt+Ot)%3)){zn+=Ot;continue}if(!((Qt-=Ot)>0))return Ot=Math.min(Ot,Ot+Qt+zn),Math.min(Mt,Ot)%2?{type:"em",raw:ge.slice(0,Mt+ut.index+Ot+1),text:ge.slice(1,Mt+ut.index+Ot)}:{type:"strong",raw:ge.slice(0,Mt+ut.index+Ot+1),text:ge.slice(2,Mt+ut.index+Ot-1)}}}}},lt.codespan=function(ge){var ve=this.rules.inline.code.exec(ge);if(ve){var Be=ve[2].replace(/\n/g," "),ut=/[^ ]/.test(Be),Je=/^ /.test(Be)&&/ $/.test(Be);return ut&&Je&&(Be=Be.substring(1,Be.length-1)),Be=ye(Be,!0),{type:"codespan",raw:ve[0],text:Be}}},lt.br=function(ge){var ve=this.rules.inline.br.exec(ge);if(ve)return{type:"br",raw:ve[0]}},lt.del=function(ge){var ve=this.rules.inline.del.exec(ge);if(ve)return{type:"del",raw:ve[0],text:ve[2]}},lt.autolink=function(ge,ve){var ut,Je,Be=this.rules.inline.autolink.exec(ge);if(Be)return Je="@"===Be[2]?"mailto:"+(ut=ye(this.options.mangle?ve(Be[1]):Be[1])):ut=ye(Be[1]),{type:"link",raw:Be[0],text:ut,href:Je,tokens:[{type:"text",raw:ut,text:ut}]}},lt.url=function(ge,ve){var Be;if(Be=this.rules.inline.url.exec(ge)){var ut,Je;if("@"===Be[2])Je="mailto:"+(ut=ye(this.options.mangle?ve(Be[0]):Be[0]));else{var Mt;do{Mt=Be[0],Be[0]=this.rules.inline._backpedal.exec(Be[0])[0]}while(Mt!==Be[0]);ut=ye(Be[0]),Je="www."===Be[1]?"http://"+ut:ut}return{type:"link",raw:Be[0],text:ut,href:Je,tokens:[{type:"text",raw:ut,text:ut}]}}},lt.inlineText=function(ge,ve,Be){var Je,ut=this.rules.inline.text.exec(ge);if(ut)return Je=ve?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):ye(ut[0]):ut[0]:ye(this.options.smartypants?Be(ut[0]):ut[0]),{type:"text",raw:ut[0],text:Je}},rt}(),tt=te_noopTest,Xe=te_edit,ze=te_merge,Le={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:tt,table:tt,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Le.def=Xe(Le.def).replace("label",Le._label).replace("title",Le._title).getRegex(),Le.bullet=/(?:[*+-]|\d{1,9}[.)])/,Le.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Le.item=Xe(Le.item,"gm").replace(/bull/g,Le.bullet).getRegex(),Le.listItemStart=Xe(/^( *)(bull) */).replace("bull",Le.bullet).getRegex(),Le.list=Xe(Le.list).replace(/bull/g,Le.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Le.def.source+")").getRegex(),Le._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Le._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Le.html=Xe(Le.html,"i").replace("comment",Le._comment).replace("tag",Le._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Le.paragraph=Xe(Le._paragraph).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.blockquote=Xe(Le.blockquote).replace("paragraph",Le.paragraph).getRegex(),Le.normal=ze({},Le),Le.gfm=ze({},Le.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Le.gfm.nptable=Xe(Le.gfm.nptable).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.gfm.table=Xe(Le.gfm.table).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.pedantic=ze({},Le.normal,{html:Xe("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Le._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tt,paragraph:Xe(Le.normal._paragraph).replace("hr",Le.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Le.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ke={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:tt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:tt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ke.punctuation=Xe(Ke.punctuation).replace(/punctuation/g,Ke._punctuation).getRegex(),Ke.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ke.escapedEmSt=/\\\*|\\_/g,Ke._comment=Xe(Le._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ke.emStrong.lDelim=Xe(Ke.emStrong.lDelim).replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimAst=Xe(Ke.emStrong.rDelimAst,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimUnd=Xe(Ke.emStrong.rDelimUnd,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ke._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ke._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ke.autolink=Xe(Ke.autolink).replace("scheme",Ke._scheme).replace("email",Ke._email).getRegex(),Ke._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ke.tag=Xe(Ke.tag).replace("comment",Ke._comment).replace("attribute",Ke._attribute).getRegex(),Ke._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ke._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ke._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ke.link=Xe(Ke.link).replace("label",Ke._label).replace("href",Ke._href).replace("title",Ke._title).getRegex(),Ke.reflink=Xe(Ke.reflink).replace("label",Ke._label).getRegex(),Ke.reflinkSearch=Xe(Ke.reflinkSearch,"g").replace("reflink",Ke.reflink).replace("nolink",Ke.nolink).getRegex(),Ke.normal=ze({},Ke),Ke.pedantic=ze({},Ke.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Xe(/^!?\[(label)\]\((.*?)\)/).replace("label",Ke._label).getRegex(),reflink:Xe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ke._label).getRegex()}),Ke.gfm=ze({},Ke.normal,{escape:Xe(Ke.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ke.gfm.url=Xe(Ke.gfm.url,"i").replace("email",Ke.gfm._extended_email).getRegex(),Ke.breaks=ze({},Ke.gfm,{br:Xe(Ke.br).replace("{2,}","*").getRegex(),text:Xe(Ke.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Me={block:Le,inline:Ke},Ue=Qe,qe=dt.exports.defaults,ke=Me.block,q=Me.inline,G=te_repeatString;function pe(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function de(rt){var ht,ge,lt="",ve=rt.length;for(ht=0;ht<ve;ht++)ge=rt.charCodeAt(ht),Math.random()>.5&&(ge="x"+ge.toString(16)),lt+="&#"+ge+";";return lt}var je=function(){function rt(ht){this.tokens=[],this.tokens.links=Object.create(null),this.options=ht||qe,this.options.tokenizer=this.options.tokenizer||new Ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var ge={block:ke.normal,inline:q.normal};this.options.pedantic?(ge.block=ke.pedantic,ge.inline=q.pedantic):this.options.gfm&&(ge.block=ke.gfm,ge.inline=this.options.breaks?q.breaks:q.gfm),this.tokenizer.rules=ge}rt.lex=function(ge,ve){return new rt(ve).lex(ge)},rt.lexInline=function(ge,ve){return new rt(ve).inlineTokens(ge)};var lt=rt.prototype;return lt.lex=function(ge){return ge=ge.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(ge,this.tokens,!0),this.inline(this.tokens),this.tokens},lt.blockTokens=function(ge,ve,Be){var Je,Mt,It,Ot,Qt,zn,ut=this;for(void 0===ve&&(ve=[]),void 0===Be&&(Be=!0),this.options.pedantic&&(ge=ge.replace(/^ +$/gm,""));ge;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(Rn){return!!(Je=Rn.call(ut,ge,ve))&&(ge=ge.substring(Je.raw.length),ve.push(Je),!0)}))){if(Je=this.tokenizer.space(ge)){ge=ge.substring(Je.raw.length),Je.type&&ve.push(Je);continue}if(Je=this.tokenizer.code(ge)){ge=ge.substring(Je.raw.length),(Ot=ve[ve.length-1])&&"paragraph"===Ot.type?(Ot.raw+="\n"+Je.raw,Ot.text+="\n"+Je.text):ve.push(Je);continue}if(Je=this.tokenizer.fences(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.heading(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.nptable(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.hr(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.blockquote(ge)){ge=ge.substring(Je.raw.length),Je.tokens=this.blockTokens(Je.text,[],Be),ve.push(Je);continue}if(Je=this.tokenizer.list(ge)){for(ge=ge.substring(Je.raw.length),It=Je.items.length,Mt=0;Mt<It;Mt++)Je.items[Mt].tokens=this.blockTokens(Je.items[Mt].text,[],!1);ve.push(Je);continue}if(Je=this.tokenizer.html(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Be&&(Je=this.tokenizer.def(ge))){ge=ge.substring(Je.raw.length),this.tokens.links[Je.tag]||(this.tokens.links[Je.tag]={href:Je.href,title:Je.title});continue}if(Je=this.tokenizer.table(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Je=this.tokenizer.lheading(ge)){ge=ge.substring(Je.raw.length),ve.push(Je);continue}if(Qt=ge,this.options.extensions&&this.options.extensions.startBlock&&function(){var Rn=1/0,bn=ge.slice(1),Xn=void 0;ut.options.extensions.startBlock.forEach(function(Cn){"number"==typeof(Xn=Cn.call(this,bn))&&Xn>=0&&(Rn=Math.min(Rn,Xn))}),Rn<1/0&&Rn>=0&&(Qt=ge.substring(0,Rn+1))}(),Be&&(Je=this.tokenizer.paragraph(Qt))){Ot=ve[ve.length-1],zn&&"paragraph"===Ot.type?(Ot.raw+="\n"+Je.raw,Ot.text+="\n"+Je.text):ve.push(Je),zn=Qt.length!==ge.length,ge=ge.substring(Je.raw.length);continue}if(Je=this.tokenizer.text(ge)){ge=ge.substring(Je.raw.length),(Ot=ve[ve.length-1])&&"text"===Ot.type?(Ot.raw+="\n"+Je.raw,Ot.text+="\n"+Je.text):ve.push(Je);continue}if(ge){var ci="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(ci);break}throw new Error(ci)}}return ve},lt.inline=function(ge){var ve,Be,ut,Je,Mt,It,Ot=ge.length;for(ve=0;ve<Ot;ve++)switch(It=ge[ve],It.type){case"paragraph":case"text":case"heading":It.tokens=[],this.inlineTokens(It.text,It.tokens);break;case"table":for(It.tokens={header:[],cells:[]},Je=It.header.length,Be=0;Be<Je;Be++)It.tokens.header[Be]=[],this.inlineTokens(It.header[Be],It.tokens.header[Be]);for(Je=It.cells.length,Be=0;Be<Je;Be++)for(Mt=It.cells[Be],It.tokens.cells[Be]=[],ut=0;ut<Mt.length;ut++)It.tokens.cells[Be][ut]=[],this.inlineTokens(Mt[ut],It.tokens.cells[Be][ut]);break;case"blockquote":this.inline(It.tokens);break;case"list":for(Je=It.items.length,Be=0;Be<Je;Be++)this.inline(It.items[Be].tokens)}return ge},lt.inlineTokens=function(ge,ve,Be,ut){var Je=this;void 0===ve&&(ve=[]),void 0===Be&&(Be=!1),void 0===ut&&(ut=!1);var Mt,It,Ot,zn,ci,Rn,Qt=ge;if(this.tokens.links){var bn=Object.keys(this.tokens.links);if(bn.length>0)for(;null!=(zn=this.tokenizer.rules.inline.reflinkSearch.exec(Qt));)bn.includes(zn[0].slice(zn[0].lastIndexOf("[")+1,-1))&&(Qt=Qt.slice(0,zn.index)+"["+G("a",zn[0].length-2)+"]"+Qt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(zn=this.tokenizer.rules.inline.blockSkip.exec(Qt));)Qt=Qt.slice(0,zn.index)+"["+G("a",zn[0].length-2)+"]"+Qt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(zn=this.tokenizer.rules.inline.escapedEmSt.exec(Qt));)Qt=Qt.slice(0,zn.index)+"++"+Qt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;ge;)if(ci||(Rn=""),ci=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Cn){return!!(Mt=Cn.call(Je,ge,ve))&&(ge=ge.substring(Mt.raw.length),ve.push(Mt),!0)}))){if(Mt=this.tokenizer.escape(ge)){ge=ge.substring(Mt.raw.length),ve.push(Mt);continue}if(Mt=this.tokenizer.tag(ge,Be,ut)){ge=ge.substring(Mt.raw.length),Be=Mt.inLink,ut=Mt.inRawBlock,(It=ve[ve.length-1])&&"text"===Mt.type&&"text"===It.type?(It.raw+=Mt.raw,It.text+=Mt.text):ve.push(Mt);continue}if(Mt=this.tokenizer.link(ge)){ge=ge.substring(Mt.raw.length),"link"===Mt.type&&(Mt.tokens=this.inlineTokens(Mt.text,[],!0,ut)),ve.push(Mt);continue}if(Mt=this.tokenizer.reflink(ge,this.tokens.links)){ge=ge.substring(Mt.raw.length),It=ve[ve.length-1],"link"===Mt.type?(Mt.tokens=this.inlineTokens(Mt.text,[],!0,ut),ve.push(Mt)):It&&"text"===Mt.type&&"text"===It.type?(It.raw+=Mt.raw,It.text+=Mt.text):ve.push(Mt);continue}if(Mt=this.tokenizer.emStrong(ge,Qt,Rn)){ge=ge.substring(Mt.raw.length),Mt.tokens=this.inlineTokens(Mt.text,[],Be,ut),ve.push(Mt);continue}if(Mt=this.tokenizer.codespan(ge)){ge=ge.substring(Mt.raw.length),ve.push(Mt);continue}if(Mt=this.tokenizer.br(ge)){ge=ge.substring(Mt.raw.length),ve.push(Mt);continue}if(Mt=this.tokenizer.del(ge)){ge=ge.substring(Mt.raw.length),Mt.tokens=this.inlineTokens(Mt.text,[],Be,ut),ve.push(Mt);continue}if(Mt=this.tokenizer.autolink(ge,de)){ge=ge.substring(Mt.raw.length),ve.push(Mt);continue}if(!Be&&(Mt=this.tokenizer.url(ge,de))){ge=ge.substring(Mt.raw.length),ve.push(Mt);continue}if(Ot=ge,this.options.extensions&&this.options.extensions.startInline&&function(){var Cn=1/0,rr=ge.slice(1),sr=void 0;Je.options.extensions.startInline.forEach(function(Qn){"number"==typeof(sr=Qn.call(this,rr))&&sr>=0&&(Cn=Math.min(Cn,sr))}),Cn<1/0&&Cn>=0&&(Ot=ge.substring(0,Cn+1))}(),Mt=this.tokenizer.inlineText(Ot,ut,pe)){ge=ge.substring(Mt.raw.length),"_"!==Mt.raw.slice(-1)&&(Rn=Mt.raw.slice(-1)),ci=!0,(It=ve[ve.length-1])&&"text"===It.type?(It.raw+=Mt.raw,It.text+=Mt.text):ve.push(Mt);continue}if(ge){var Xn="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(Xn);break}throw new Error(Xn)}}return ve},function(rt,lt,ht){lt&&it(rt.prototype,lt),ht&&it(rt,ht)}(rt,null,[{key:"rules",get:function(){return{block:ke,inline:q}}}]),rt}(),_t=dt.exports.defaults,pt=te_cleanUrl,we=te_escape,B=function(){function rt(ht){this.options=ht||_t}var lt=rt.prototype;return lt.code=function(ge,ve,Be){var ut=(ve||"").match(/\S*/)[0];if(this.options.highlight){var Je=this.options.highlight(ge,ut);null!=Je&&Je!==ge&&(Be=!0,ge=Je)}return ge=ge.replace(/\n$/,"")+"\n",ut?'<pre><code class="'+this.options.langPrefix+we(ut,!0)+'">'+(Be?ge:we(ge,!0))+"</code></pre>\n":"<pre><code>"+(Be?ge:we(ge,!0))+"</code></pre>\n"},lt.blockquote=function(ge){return"<blockquote>\n"+ge+"</blockquote>\n"},lt.html=function(ge){return ge},lt.heading=function(ge,ve,Be,ut){return this.options.headerIds?"<h"+ve+' id="'+this.options.headerPrefix+ut.slug(Be)+'">'+ge+"</h"+ve+">\n":"<h"+ve+">"+ge+"</h"+ve+">\n"},lt.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},lt.list=function(ge,ve,Be){var ut=ve?"ol":"ul";return"<"+ut+(ve&&1!==Be?' start="'+Be+'"':"")+">\n"+ge+"</"+ut+">\n"},lt.listitem=function(ge){return"<li>"+ge+"</li>\n"},lt.checkbox=function(ge){return"<input "+(ge?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},lt.paragraph=function(ge){return"<p>"+ge+"</p>\n"},lt.table=function(ge,ve){return ve&&(ve="<tbody>"+ve+"</tbody>"),"<table>\n<thead>\n"+ge+"</thead>\n"+ve+"</table>\n"},lt.tablerow=function(ge){return"<tr>\n"+ge+"</tr>\n"},lt.tablecell=function(ge,ve){var Be=ve.header?"th":"td";return(ve.align?"<"+Be+' align="'+ve.align+'">':"<"+Be+">")+ge+"</"+Be+">\n"},lt.strong=function(ge){return"<strong>"+ge+"</strong>"},lt.em=function(ge){return"<em>"+ge+"</em>"},lt.codespan=function(ge){return"<code>"+ge+"</code>"},lt.br=function(){return this.options.xhtml?"<br/>":"<br>"},lt.del=function(ge){return"<del>"+ge+"</del>"},lt.link=function(ge,ve,Be){if(null===(ge=pt(this.options.sanitize,this.options.baseUrl,ge)))return Be;var ut='<a href="'+we(ge)+'"';return ve&&(ut+=' title="'+ve+'"'),ut+">"+Be+"</a>"},lt.image=function(ge,ve,Be){if(null===(ge=pt(this.options.sanitize,this.options.baseUrl,ge)))return Be;var ut='<img src="'+ge+'" alt="'+Be+'"';return ve&&(ut+=' title="'+ve+'"'),ut+(this.options.xhtml?"/>":">")},lt.text=function(ge){return ge},rt}(),N=function(){function rt(){}var lt=rt.prototype;return lt.strong=function(ge){return ge},lt.em=function(ge){return ge},lt.codespan=function(ge){return ge},lt.del=function(ge){return ge},lt.html=function(ge){return ge},lt.text=function(ge){return ge},lt.link=function(ge,ve,Be){return""+Be},lt.image=function(ge,ve,Be){return""+Be},lt.br=function(){return""},rt}(),V=function(){function rt(){this.seen={}}var lt=rt.prototype;return lt.serialize=function(ge){return ge.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},lt.getNextSafeSlug=function(ge,ve){var Be=ge,ut=0;if(this.seen.hasOwnProperty(Be)){ut=this.seen[ge];do{Be=ge+"-"+ ++ut}while(this.seen.hasOwnProperty(Be))}return ve||(this.seen[ge]=ut,this.seen[Be]=0),Be},lt.slug=function(ge,ve){void 0===ve&&(ve={});var Be=this.serialize(ge);return this.getNextSafeSlug(Be,ve.dryrun)},rt}(),Re=B,Ze=N,Tt=V,kt=dt.exports.defaults,In=te_unescape,Yn=je,Mi=function(){function rt(ht){this.options=ht||kt,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Ze,this.slugger=new Tt}rt.parse=function(ge,ve){return new rt(ve).parse(ge)},rt.parseInline=function(ge,ve){return new rt(ve).parseInline(ge)};var lt=rt.prototype;return lt.parse=function(ge,ve){void 0===ve&&(ve=!0);var ut,Je,Mt,It,Ot,Qt,zn,ci,Rn,bn,Xn,Cn,rr,sr,Qn,Wi,Ca,Qr,re,Be="",fe=ge.length;for(ut=0;ut<fe;ut++)if(bn=ge[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[bn.type]&&(!1!==(re=this.options.extensions.renderers[bn.type].call(this,bn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(bn.type)))Be+=re||"";else switch(bn.type){case"space":continue;case"hr":Be+=this.renderer.hr();continue;case"heading":Be+=this.renderer.heading(this.parseInline(bn.tokens),bn.depth,In(this.parseInline(bn.tokens,this.textRenderer)),this.slugger);continue;case"code":Be+=this.renderer.code(bn.text,bn.lang,bn.escaped);continue;case"table":for(ci="",zn="",It=bn.header.length,Je=0;Je<It;Je++)zn+=this.renderer.tablecell(this.parseInline(bn.tokens.header[Je]),{header:!0,align:bn.align[Je]});for(ci+=this.renderer.tablerow(zn),Rn="",It=bn.cells.length,Je=0;Je<It;Je++){for(zn="",Ot=(Qt=bn.tokens.cells[Je]).length,Mt=0;Mt<Ot;Mt++)zn+=this.renderer.tablecell(this.parseInline(Qt[Mt]),{header:!1,align:bn.align[Mt]});Rn+=this.renderer.tablerow(zn)}Be+=this.renderer.table(ci,Rn);continue;case"blockquote":Rn=this.parse(bn.tokens),Be+=this.renderer.blockquote(Rn);continue;case"list":for(Xn=bn.ordered,Cn=bn.start,rr=bn.loose,It=bn.items.length,Rn="",Je=0;Je<It;Je++)Wi=(Qn=bn.items[Je]).checked,Ca=Qn.task,sr="",Qn.task&&(Qr=this.renderer.checkbox(Wi),rr?Qn.tokens.length>0&&"text"===Qn.tokens[0].type?(Qn.tokens[0].text=Qr+" "+Qn.tokens[0].text,Qn.tokens[0].tokens&&Qn.tokens[0].tokens.length>0&&"text"===Qn.tokens[0].tokens[0].type&&(Qn.tokens[0].tokens[0].text=Qr+" "+Qn.tokens[0].tokens[0].text)):Qn.tokens.unshift({type:"text",text:Qr}):sr+=Qr),sr+=this.parse(Qn.tokens,rr),Rn+=this.renderer.listitem(sr,Ca,Wi);Be+=this.renderer.list(Rn,Xn,Cn);continue;case"html":Be+=this.renderer.html(bn.text);continue;case"paragraph":Be+=this.renderer.paragraph(this.parseInline(bn.tokens));continue;case"text":for(Rn=bn.tokens?this.parseInline(bn.tokens):bn.text;ut+1<fe&&"text"===ge[ut+1].type;)Rn+="\n"+((bn=ge[++ut]).tokens?this.parseInline(bn.tokens):bn.text);Be+=ve?this.renderer.paragraph(Rn):Rn;continue;default:var se='Token with "'+bn.type+'" type was not found.';if(this.options.silent)return void console.error(se);throw new Error(se)}return Be},lt.parseInline=function(ge,ve){ve=ve||this.renderer;var ut,Je,Mt,Be="",It=ge.length;for(ut=0;ut<It;ut++)if(Je=ge[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Je.type]&&(!1!==(Mt=this.options.extensions.renderers[Je.type].call(this,Je))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Je.type)))Be+=Mt||"";else switch(Je.type){case"escape":Be+=ve.text(Je.text);break;case"html":Be+=ve.html(Je.text);break;case"link":Be+=ve.link(Je.href,Je.title,this.parseInline(Je.tokens,ve));break;case"image":Be+=ve.image(Je.href,Je.title,Je.text);break;case"strong":Be+=ve.strong(this.parseInline(Je.tokens,ve));break;case"em":Be+=ve.em(this.parseInline(Je.tokens,ve));break;case"codespan":Be+=ve.codespan(Je.text);break;case"br":Be+=ve.br();break;case"del":Be+=ve.del(this.parseInline(Je.tokens,ve));break;case"text":Be+=ve.text(Je.text);break;default:var Ot='Token with "'+Je.type+'" type was not found.';if(this.options.silent)return void console.error(Ot);throw new Error(Ot)}return Be},rt}(),xi=Qe,Xr=B,Ls=N,fs=V,Bs=te_merge,Kr=te_checkSanitizeDeprecation,xa=te_escape,kl=dt.exports.getDefaults,Sa=dt.exports.changeDefaults,ws=dt.exports.defaults;function en(rt,lt,ht){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof lt&&(ht=lt,lt=null),lt=Bs({},en.defaults,lt||{}),Kr(lt),ht){var ve,ge=lt.highlight;try{ve=Yn.lex(rt,lt)}catch(Mt){return ht(Mt)}var Be=function(It){var Ot;if(!It)try{lt.walkTokens&&en.walkTokens(ve,lt.walkTokens),Ot=Mi.parse(ve,lt)}catch(Qt){It=Qt}return lt.highlight=ge,It?ht(It):ht(null,Ot)};if(!ge||ge.length<3||(delete lt.highlight,!ve.length))return Be();var ut=0;return en.walkTokens(ve,function(Mt){"code"===Mt.type&&(ut++,setTimeout(function(){ge(Mt.text,Mt.lang,function(It,Ot){if(It)return Be(It);null!=Ot&&Ot!==Mt.text&&(Mt.text=Ot,Mt.escaped=!0),0==--ut&&Be()})},0))}),void(0===ut&&Be())}try{var Je=Yn.lex(rt,lt);return lt.walkTokens&&en.walkTokens(Je,lt.walkTokens),Mi.parse(Je,lt)}catch(Mt){if(Mt.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+xa(Mt.message+"",!0)+"</pre>";throw Mt}}return en.options=en.setOptions=function(rt){return Bs(en.defaults,rt),Sa(en.defaults),en},en.getDefaults=kl,en.defaults=ws,en.use=function(){for(var rt=this,lt=arguments.length,ht=new Array(lt),ge=0;ge<lt;ge++)ht[ge]=arguments[ge];var ut,ve=Bs.apply(void 0,[{}].concat(ht)),Be=en.defaults.extensions||{renderers:{},childTokens:{}};ht.forEach(function(Je){if(Je.extensions&&(ut=!0,Je.extensions.forEach(function(It){if(!It.name)throw new Error("extension name required");if(It.renderer){var Ot=Be.renderers?Be.renderers[It.name]:null;Be.renderers[It.name]=Ot?function(){for(var Qt=arguments.length,zn=new Array(Qt),ci=0;ci<Qt;ci++)zn[ci]=arguments[ci];var Rn=It.renderer.apply(this,zn);return!1===Rn&&(Rn=Ot.apply(this,zn)),Rn}:It.renderer}if(It.tokenizer){if(!It.level||"block"!==It.level&&"inline"!==It.level)throw new Error("extension level must be 'block' or 'inline'");Be[It.level]?Be[It.level].unshift(It.tokenizer):Be[It.level]=[It.tokenizer],It.start&&("block"===It.level?Be.startBlock?Be.startBlock.push(It.start):Be.startBlock=[It.start]:"inline"===It.level&&(Be.startInline?Be.startInline.push(It.start):Be.startInline=[It.start]))}It.childTokens&&(Be.childTokens[It.name]=It.childTokens)})),Je.renderer&&function(){var It=en.defaults.renderer||new Xr,Ot=function(ci){var Rn=It[ci];It[ci]=function(){for(var bn=arguments.length,Xn=new Array(bn),Cn=0;Cn<bn;Cn++)Xn[Cn]=arguments[Cn];var rr=Je.renderer[ci].apply(It,Xn);return!1===rr&&(rr=Rn.apply(It,Xn)),rr}};for(var Qt in Je.renderer)Ot(Qt);ve.renderer=It}(),Je.tokenizer&&function(){var It=en.defaults.tokenizer||new xi,Ot=function(ci){var Rn=It[ci];It[ci]=function(){for(var bn=arguments.length,Xn=new Array(bn),Cn=0;Cn<bn;Cn++)Xn[Cn]=arguments[Cn];var rr=Je.tokenizer[ci].apply(It,Xn);return!1===rr&&(rr=Rn.apply(It,Xn)),rr}};for(var Qt in Je.tokenizer)Ot(Qt);ve.tokenizer=It}(),Je.walkTokens){var Mt=en.defaults.walkTokens;ve.walkTokens=function(It){Je.walkTokens.call(rt,It),Mt&&Mt(It)}}ut&&(ve.extensions=Be),en.setOptions(ve)})},en.walkTokens=function(rt,lt){for(var ve,ht=function(){var ut=ve.value;switch(lt(ut),ut.type){case"table":for(var Mt,Je=Dt(ut.tokens.header);!(Mt=Je()).done;)en.walkTokens(Mt.value,lt);for(var Qt,Ot=Dt(ut.tokens.cells);!(Qt=Ot()).done;)for(var Rn,ci=Dt(Qt.value);!(Rn=ci()).done;)en.walkTokens(Rn.value,lt);break;case"list":en.walkTokens(ut.items,lt);break;default:en.defaults.extensions&&en.defaults.extensions.childTokens&&en.defaults.extensions.childTokens[ut.type]?en.defaults.extensions.childTokens[ut.type].forEach(function(Xn){en.walkTokens(ut[Xn],lt)}):ut.tokens&&en.walkTokens(ut.tokens,lt)}},ge=Dt(rt);!(ve=ge()).done;)ht()},en.parseInline=function(rt,lt){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");lt=Bs({},en.defaults,lt||{}),Kr(lt);try{var ht=Yn.lexInline(rt,lt);return lt.walkTokens&&en.walkTokens(ht,lt.walkTokens),Mi.parseInline(ht,lt)}catch(ge){if(ge.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+xa(ge.message+"",!0)+"</pre>";throw ge}},en.Parser=Mi,en.parser=Mi.parse,en.Renderer=Xr,en.TextRenderer=Ls,en.Lexer=Yn,en.lexer=Yn.lex,en.Tokenizer=xi,en.Slugger=fs,en.parse=en,en}()},9369:(Ut,it,et)=>{var yt=et(6284),ee=et(7830);function Dt(){this.clear()}Dt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},Dt.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},Dt.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},Dt.prototype.peek=function(){if(this.size)return this.items[this.offset]},Dt.prototype.forEach=function(dt,Y){Y=arguments.length>1?Y:this;for(var Se=this.offset,he=0,W=this.items.length;Se<W;Se++,he++)dt.call(Y,this.items[Se],he,this)},Dt.prototype.toArray=function(){return this.items.slice(this.offset)},Dt.prototype.values=function(){var dt=this.items,Y=this.offset;return new yt(function(){if(Y>=dt.length)return{done:!0};var Se=dt[Y];return Y++,{value:Se,done:!1}})},Dt.prototype.entries=function(){var dt=this.items,Y=this.offset,Se=0;return new yt(function(){if(Y>=dt.length)return{done:!0};var he=dt[Y];return Y++,{value:[Se++,he],done:!1}})},"undefined"!=typeof Symbol&&(Dt.prototype[Symbol.iterator]=Dt.prototype.values),Dt.prototype.toString=function(){return this.toArray().join(",")},Dt.prototype.toJSON=function(){return this.toArray()},Dt.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:Dt,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(Dt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Dt.prototype.inspect),Dt.from=function(dt){var Y=new Dt;return ee(dt,function(Se){Y.enqueue(Se)}),Y},Dt.of=function(){return Dt.from(arguments)},Ut.exports=Dt},7830:Ut=>{var it="undefined"!=typeof ArrayBuffer,et="undefined"!=typeof Symbol;function yt(ee,Dt){var dt,Y,Se,he,W;if(!ee)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof Dt)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(Se=0,he=ee.length;Se<he;Se++)Dt(ee[Se],Se);else if("function"!=typeof ee.forEach)if(et&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&Dt(ee[Y],Y);else for(dt=ee,Se=0;!0!==(W=dt.next()).done;)Dt(W.value,Se),Se++;else ee.forEach(Dt)}yt.forEachWithNullKeys=function(ee,Dt){var dt,Y,Se,he,W;if(!ee)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof Dt)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(Se=0,he=ee.length;Se<he;Se++)Dt(ee[Se],null);else if(ee instanceof Set)ee.forEach(function(j){Dt(j,null)});else if("function"!=typeof ee.forEach)if(et&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&Dt(ee[Y],Y);else for(dt=ee,Se=0;!0!==(W=dt.next()).done;)Dt(W.value,null),Se++;else ee.forEach(Dt)},Ut.exports=yt},6284:Ut=>{function it(et){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:et}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var et=this._next();return et.done&&(this.done=!0),et},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var et=arguments,yt=et.length,ee=0;return new it(function(){return ee>=yt?{done:!0}:{done:!1,value:et[ee++]}})},it.empty=function(){var et=new it(null);return et.done=!0,et},it.is=function(et){return et instanceof it||"object"==typeof et&&null!==et&&"function"==typeof et.next},Ut.exports=it},7310:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==ee.window.orientation},it.default=function(he){if(!he&&!(0,Dt.default)())return"Node";if((0,dt.default)(he))return"Electron";var W="undefined"!=typeof navigator?navigator:{},j=he||W.userAgent||"";if(j.indexOf("Edge")>-1)return"Edge";var k=-1!==j.indexOf("MSIE "),Q=-1!==j.indexOf("Trident/");return k||Q?"IE":ee.window.chrome?"Chrome":ee.window.safari?"Safari":ee.window.mozInnerScreenX?"Firefox":"Unknown"};var ee=et(1151),Dt=yt(et(1602)),dt=yt(et(2344))},1151:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var ee=yt(et(4321)),Dt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&process};it.self=Dt.self||Dt.window||Dt.global,it.window=Dt.window||Dt.self||Dt.global,it.global=Dt.global||Dt.self||Dt.window,it.document=Dt.document||{},it.process=Dt.process||{};var j=console;it.console=j},4761:(Ut,it,et)=>{"use strict";var ee=et(1948),Dt=et(4321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return Se.default}});var dt=et(1151),Se=(j(et(1602)),j(et(7310)));ee(et(2344));function W(k){if("function"!=typeof WeakMap)return null;var Q=new WeakMap,H=new WeakMap;return(W=function(C){return C?H:Q})(k)}function j(k,Q){if(!Q&&k&&k.__esModule)return k;if(null===k||"object"!==Dt(k)&&"function"!=typeof k)return{default:k};var H=W(Q);if(H&&H.has(k))return H.get(k);var w={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in k)if("default"!==R&&Object.prototype.hasOwnProperty.call(k,R)){var T=C?Object.getOwnPropertyDescriptor(k,R):null;T&&(T.get||T.set)?Object.defineProperty(w,R,T):w[R]=k[R]}return w.default=k,H&&H.set(k,w),w}},1602:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=dt,it.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var ee=yt(et(4321)),Dt=yt(et(2344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,Dt.default)()}},2344:(Ut,it,et)=>{"use strict";var yt=et(1948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(dt){if("undefined"!=typeof window&&"object"===(0,ee.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,ee.default)(process.versions)&&Boolean(process.versions.electron))return!0;var Y="object"===("undefined"==typeof navigator?"undefined":(0,ee.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Se=dt||Y;return!!(Se&&Se.indexOf("Electron")>=0)};var ee=yt(et(4321))},6991:function(Ut,it,et){"use strict";var yt=this&&this.__createBinding||(Object.create?function(Dt,dt,Y,Se){void 0===Se&&(Se=Y),Object.defineProperty(Dt,Se,{enumerable:!0,get:function(){return dt[Y]}})}:function(Dt,dt,Y,Se){void 0===Se&&(Se=Y),Dt[Se]=dt[Y]}),ee=this&&this.__exportStar||function(Dt,dt){for(var Y in Dt)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,Dt,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(et(4180),it),ee(et(5103),it),ee(et(8965),it),ee(et(2595),it),ee(et(2417),it),ee(et(2451),it),ee(et(7735),it)},4180:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(ee){this.termType="BlankNode",this.value=ee}equals(ee){return!!ee&&"BlankNode"===ee.termType&&ee.value===this.value}}},5103:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const yt=et(4180),ee=et(8965),Dt=et(2595),dt=et(2417),Y=et(2451),Se=et(7735);let he=0;it.DataFactory=class{constructor(k){this.blankNodeCounter=0,this.blankNodePrefix=(k=k||{}).blankNodePrefix||`df_${he++}_`}namedNode(k){return new dt.NamedNode(k)}blankNode(k){return new yt.BlankNode(k||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(k,Q){return new Dt.Literal(k,Q)}variable(k){return new Se.Variable(k)}defaultGraph(){return ee.DefaultGraph.INSTANCE}quad(k,Q,H,w){return new Y.Quad(k,Q,H,w||this.defaultGraph())}fromTerm(k){switch(k.termType){case"NamedNode":return this.namedNode(k.value);case"BlankNode":return this.blankNode(k.value);case"Literal":return k.language?this.literal(k.value,k.language):k.datatype.equals(Dt.Literal.XSD_STRING)?this.literal(k.value):this.literal(k.value,this.fromTerm(k.datatype));case"Variable":return this.variable(k.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(k.subject),this.fromTerm(k.predicate),this.fromTerm(k.object),this.fromTerm(k.graph))}}fromQuad(k){return this.fromTerm(k)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},8965:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class et{constructor(){this.termType="DefaultGraph",this.value=""}equals(ee){return!!ee&&"DefaultGraph"===ee.termType}}it.DefaultGraph=et,et.INSTANCE=new et},2595:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const yt=et(2417);class ee{constructor(dt,Y){this.termType="Literal",this.value=dt,"string"==typeof Y?(this.language=Y,this.datatype=ee.RDF_LANGUAGE_STRING):Y?(this.language="",this.datatype=Y):(this.language="",this.datatype=ee.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}it.Literal=ee,ee.RDF_LANGUAGE_STRING=new yt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),ee.XSD_STRING=new yt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},2417:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(ee){this.termType="NamedNode",this.value=ee}equals(ee){return!!ee&&"NamedNode"===ee.termType&&ee.value===this.value}}},2451:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(ee,Dt,dt,Y){this.termType="Quad",this.value="",this.subject=ee,this.predicate=Dt,this.object=dt,this.graph=Y}equals(ee){return!!ee&&("Quad"===ee.termType||!ee.termType)&&this.subject.equals(ee.subject)&&this.predicate.equals(ee.predicate)&&this.object.equals(ee.object)&&this.graph.equals(ee.graph)}}},7735:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(ee){this.termType="Variable",this.value=ee}equals(ee){return!!ee&&"Variable"===ee.termType&&ee.value===this.value}}},1609:function(Ut,it,et){"use strict";var yt=this&&this.__createBinding||(Object.create?function(w,C,R,T){void 0===T&&(T=R),Object.defineProperty(w,T,{enumerable:!0,get:function(){return C[R]}})}:function(w,C,R,T){void 0===T&&(T=R),w[T]=C[R]}),ee=this&&this.__exportStar||function(w,C){for(var R in w)"default"!==R&&!Object.prototype.hasOwnProperty.call(C,R)&&yt(C,w,R)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const Dt=et(6991),dt=et(9938),Y=et(6060);ee(et(9938),it),ee(et(8871),it),ee(et(6060),it);const Se=new Dt.DataFactory,he=new Y.Translator;function W(w,C){return he.fromRdf(w,C)}he.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(w=>Se.namedNode(w)),["string"]),he.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(w=>Se.namedNode(w)),["boolean"]),he.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(w=>Se.namedNode(w)),["number"]),he.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(w=>Se.namedNode(w)),["number"]),he.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(w=>Se.namedNode(w)),["object"]),it.fromRdf=W,it.toRdf=function(w,C){return C&&"namedNode"in C&&(C={dataFactory:C}),(C=C||{})&&!C.dataFactory&&(C.dataFactory=Se),he.toRdf(w,C)},it.getTermRaw=function(w,C){return"Literal"===w.termType?W(w,C):w.value},it.getSupportedRdfDatatypes=function(){return he.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return he.getSupportedJavaScriptPrimitives()}},8871:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},6060:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(ee){throw new Error(`Invalid RDF ${ee.datatype.value} value: '${ee.value}'`)}registerHandler(ee,Dt,dt){for(const Y of Dt)this.supportedRdfDatatypes.push(Y),this.fromRdfHandlers[Y.value]=ee;for(const Y of dt){let Se=this.toRdfHandlers[Y];Se||(this.toRdfHandlers[Y]=Se=[]),Se.push(ee)}}fromRdf(ee,Dt){const dt=this.fromRdfHandlers[ee.datatype.value];return dt?dt.fromRdf(ee,Dt):ee.value}toRdf(ee,Dt){const dt=this.toRdfHandlers[typeof ee];if(dt)for(const Y of dt){const Se=Y.toRdf(ee,Dt);if(Se)return Se}throw new Error(`Invalid JavaScript value: '${ee}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return Y&&yt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:Y,dataFactory:Se}){return Se.literal(dt?"true":"false",Y||Se.namedNode(ee.TYPE))}}it.TypeHandlerBoolean=ee,ee.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},2525:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){switch(Y&&!dt.value.match(ee.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&yt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Se=dt.value.split("-");return new Date(0,parseInt(Se[0],10)-1,parseInt(Se[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:Y,dataFactory:Se}){if(Y=Y||Se.namedNode(ee.TYPES[0]),!(dt instanceof Date))return null;const he=dt;let W;switch(Y.value){case"http://www.w3.org/2001/XMLSchema#gDay":W=String(he.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":W=he.getUTCMonth()+1+"-"+he.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":W=String(he.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":W=he.getUTCFullYear()+"-"+(he.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":W=he.toISOString().replace(/T.*$/,"");break;default:W=he.toISOString()}return Se.literal(W,Y)}}it.TypeHandlerDate=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],ee.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},8554:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){const Se=parseFloat(dt.value);return Y&&isNaN(Se)&&yt.Translator.incorrectRdfDataType(dt),Se}toRdf(dt,{datatype:Y,dataFactory:Se}){return Y=Y||Se.namedNode(ee.TYPES[0]),isNaN(dt)?Se.literal("NaN",Y):isFinite(dt)?dt%1==0?null:Se.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Y):Se.literal(dt>0?"INF":"-INF",Y)}}it.TypeHandlerNumberDouble=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},7750:(Ut,it,et)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const yt=et(6060);class ee{fromRdf(dt,Y){const Se=parseInt(dt.value,10);return Y&&(isNaN(Se)||dt.value.indexOf(".")>=0)&&yt.Translator.incorrectRdfDataType(dt),Se}toRdf(dt,{datatype:Y,dataFactory:Se}){return Se.literal(String(dt),Y||Se.namedNode(dt<=ee.MAX_INT&&dt>=ee.MIN_INT?ee.TYPES[0]:ee.TYPES[1]))}}it.TypeHandlerNumberInteger=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],ee.MAX_INT=2147483647,ee.MIN_INT=-2147483648},4608:(Ut,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class et{fromRdf(ee){return ee.value}toRdf(ee,{datatype:Dt,dataFactory:dt}){return dt.literal(ee,Dt)}}it.TypeHandlerString=et,et.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},9938:function(Ut,it,et){"use strict";var yt=this&&this.__createBinding||(Object.create?function(Dt,dt,Y,Se){void 0===Se&&(Se=Y),Object.defineProperty(Dt,Se,{enumerable:!0,get:function(){return dt[Y]}})}:function(Dt,dt,Y,Se){void 0===Se&&(Se=Y),Dt[Se]=dt[Y]}),ee=this&&this.__exportStar||function(Dt,dt){for(var Y in Dt)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,Dt,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(et(727),it),ee(et(2525),it),ee(et(8554),it),ee(et(7750),it),ee(et(4608),it)},2829:(Ut,it,et)=>{"use strict";var yt={};et.r(yt),et.d(yt,{decode:()=>Ume,encode:()=>zme});var ee={};et.r(ee),et.d(ee,{decode:()=>qme,encode:()=>Yme});var Dt={};et.r(Dt),et.d(Dt,{decode:()=>Xme,encode:()=>Kme});var dt={};function Y(n){return"function"==typeof n}et.r(dt),et.d(dt,{decode:()=>Qme,encode:()=>Zme});let Se=!1;const he={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Se&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Se=n},get useDeprecatedSynchronousErrorHandling(){return Se}};function W(n){setTimeout(()=>{throw n},0)}const j={closed:!0,next(n){},error(n){if(he.useDeprecatedSynchronousErrorHandling)throw n;W(n)},complete(){}},k=Array.isArray||(n=>n&&"number"==typeof n.length);function Q(n){return null!==n&&"object"==typeof n}const w=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class C{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof C)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(Y(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof w?R(o.errors):[o]}}if(k(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(Q(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof w?e=e.concat(R(c.errors)):e.push(c)}}}if(e)throw new w(e)}add(e){let t=e;if(!e)return C.EMPTY;switch(typeof e){case"function":t=new C(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof C)){const s=t;t=new C,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof C){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function R(n){return n.reduce((e,t)=>e.concat(t instanceof w?t.errors:t),[])}C.EMPTY=((n=new C).closed=!0,n);const T="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends C{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=j;break;case 1:if(!e){this.destination=j;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new S(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new S(this,e,t,i)}}[T](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class S extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;Y(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==j&&(o=Object.create(t),Y(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;he.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=he;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):W(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;W(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);he.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),he.useDeprecatedSynchronousErrorHandling)throw i;W(i)}}__tryOrSetError(e,t,i){if(!he.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return he.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(W(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const P="function"==typeof Symbol&&Symbol.observable||"@@observable";function X(n){return n}function ue(...n){return I(n)}function I(n){return 0===n.length?X:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let O=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[T])return n[T]()}return n||e||t?new y(n,e,t):new y(j)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||he.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),he.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){he.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=K(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[P](){return this}pipe(...t){return 0===t.length?this:I(t)(this)}toPromise(t){return new(t=K(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function K(n){if(n||(n=he.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const $=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Z extends C{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class ae extends y{constructor(e){super(e),this.destination=e}}let oe=(()=>{class n extends O{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[T](){return new ae(this)}lift(t){const i=new te(this,this);return i.operator=t,i}next(t){if(this.closed)throw new $;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new $;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new $;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new $;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new $;return this.hasError?(t.error(this.thrownError),C.EMPTY):this.isStopped?(t.complete(),C.EMPTY):(this.observers.push(t),new Z(this,t))}asObservable(){const t=new O;return t.source=this,t}}return n.create=(e,t)=>new te(e,t),n})();class te extends oe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):C.EMPTY}}function Te(n){return n&&"function"==typeof n.schedule}function me(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new ne(n,e))}}class ne{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new ye(e,this.project,this.thisArg))}}class ye extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Oe=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Qe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Le=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ke(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Me=n=>{if(n&&"function"==typeof n[P])return(n=>e=>{const t=n[P]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Le(n))return Oe(n);if(Ke(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W),e))(n);if(n&&"function"==typeof n[Qe])return(n=>e=>{const t=n[Qe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${Q(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function ke(n,e){return new O(t=>{const i=new C;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function je(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[P]}(n))return function(n,e){return new O(t=>{const i=new C;return i.add(e.schedule(()=>{const r=n[P]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ke(n))return function(n,e){return new O(t=>{const i=new C;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Le(n))return ke(n,e);if(function(n){return n&&"function"==typeof n[Qe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new O(t=>{const i=new C;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Qe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof O?n:new O(Me(n))}class _t extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class we extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function N(n,e){if(e.closed)return;if(n instanceof O)return n.subscribe(e);let t;try{t=Me(n)(e)}catch(i){e.error(i)}return t}function V(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(V((r,s)=>je(n(r,s)).pipe(me((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Re(n,t)))}class Re{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Ze(e,this.project,this.concurrent))}}class Ze extends we{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function kt(n=Number.POSITIVE_INFINITY){return V(X,n)}function In(n,e){return e?ke(n,e):new O(Oe(n))}function Nn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Te(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof O?n[0]:kt(e)(In(n,t))}function Yn(){return function(e){return e.lift(new Mi(e))}}class Mi{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new xi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class xi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Xr extends O{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new C,e.add(this.source.subscribe(new fs(this.getSubject(),this))),e.closed&&(this._connection=null,e=C.EMPTY)),e}refCount(){return Yn()(this)}}const Ls=(()=>{const n=Xr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class fs extends ae{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function xa(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new kl(r,e));const s=Object.create(i,Ls);return s.source=i,s.subjectFactory=r,s}}class kl{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function Sa(){return new oe}function ws(){return n=>Yn()(xa(Sa)(n))}function en(n){for(let e in n)if(n[e]===en)return e;throw Error("Could not find renamed property on target object.")}function nl(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function lt(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ht=en({__forward_ref__:en});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return rt(this())},n}function ve(n){return Be(n)?n():n}function Be(n){return"function"==typeof n&&n.hasOwnProperty(ht)&&n.__forward_ref__===ge}class Je extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Ot(n){return"string"==typeof n?n:null==n?"":String(n)}function Qt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Ot(n)}function bn(n,e){const t=e?` in ${e}`:"";throw new Je("201",`No provider for ${Qt(n)} found${t}`)}function J(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function St(n){return{providers:n.providers||[],imports:n.imports||[]}}function vn(n){return Es(n,fo)||Es(n,Vs)}function Es(n,e){return n.hasOwnProperty(e)?n[e]:null}function Fl(n){return n&&(n.hasOwnProperty(Br)||n.hasOwnProperty(Ac))?n[Br]:null}const fo=en({\u0275prov:en}),Br=en({\u0275inj:en}),Vs=en({ngInjectableDef:en}),Ac=en({ngInjectorDef:en});var xn=(()=>((xn=xn||{})[xn.Default=0]="Default",xn[xn.Host=1]="Host",xn[xn.Self=2]="Self",xn[xn.SkipSelf=4]="SkipSelf",xn[xn.Optional=8]="Optional",xn))();let po;function Ta(n){const e=po;return po=n,e}function Ed(n,e,t){const i=vn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&xn.Optional?null:void 0!==e?e:void bn(rt(n),"Injector")}function De(n){return{toString:n}.toString()}var Ge=(()=>((Ge=Ge||{})[Ge.OnPush=0]="OnPush",Ge[Ge.Default=1]="Default",Ge))(),Xt=(()=>((Xt=Xt||{})[Xt.Emulated=0]="Emulated",Xt[Xt.None=2]="None",Xt[Xt.ShadowDom=3]="ShadowDom",Xt))();const ui="undefined"!=typeof globalThis&&globalThis,Vr="undefined"!=typeof window&&window,Jr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,xs="undefined"!=typeof global&&global,Zn=ui||xs||Vr||Jr,xd={},er=[],fp=en({\u0275cmp:en}),n_=en({\u0275dir:en}),Oh=en({\u0275pipe:en}),iv=en({\u0275mod:en}),T1=en({\u0275loc:en}),Bl=en({\u0275fac:en}),Rh=en({__NG_ELEMENT_ID__:en});let A1=0;function rn(n){return De(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ge.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||er,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Xt.Emulated,id:"c",styles:n.styles||er,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=A1++,i.inputs=av(n.inputs,t),i.outputs=av(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(rv):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(sv):null,i})}function rv(n){return Ui(n)||function(n){return n[n_]||null}(n)}function sv(n){return function(n){return n[Oh]||null}(n)}const ov={};function tn(n){return De(()=>{const e={type:n.type,bootstrap:n.bootstrap||er,declarations:n.declarations||er,imports:n.imports||er,exports:n.exports||er,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(ov[n.id]=n.type),e})}function av(n,e){if(null==n)return xd;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Nt=rn;function js(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ui(n){return n[fp]||null}function No(n,e){const t=n[iv]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function Jo(n){return Array.isArray(n)&&"object"==typeof n[1]}function ea(n){return Array.isArray(n)&&!0===n[1]}function s_(n){return 0!=(8&n.flags)}function Ad(n){return 2==(2&n.flags)}function Md(n){return 1==(1&n.flags)}function Da(n){return null!==n.template}function lv(n){return 0!=(512&n[2])}function Ic(n,e){return n.hasOwnProperty(Bl)?n[Bl]:null}class c_{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Fi(){return dv}function dv(n){return n.type.prototype.ngOnChanges&&(n.setInput=k1),N1}function N1(){const n=at(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===xd)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function k1(n,e,t,i){const r=at(n)||function(n,e){return n[Bh]=e}(n,{previous:xd,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new c_(l&&l.currentValue,e,o===xd),n[i]=e}Fi.ngInherit=!0;const Bh="__ngSimpleChanges__";function at(n){return n[Bh]||null}let Yi;function dr(n){return!!n.listen}const Su={createRenderer:(n,e)=>void 0!==Yi?Yi:"undefined"!=typeof document?document:void 0};function Sr(n){for(;Array.isArray(n);)n=n[0];return n}function Vh(n,e){return Sr(e[n])}function eo(n,e){return Sr(e[n.index])}function h_(n,e){return n.data[e]}function Dd(n,e){return n[e]}function zs(n,e){const t=e[n];return Jo(t)?t:t[0]}function Ul(n){return 4==(4&n[2])}function Id(n){return 128==(128&n[2])}function Oa(n,e){return null==e?null:n[e]}function f_(n){n[18]=0}function mp(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Ln={lFrame:Tu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function fv(){return Ln.bindingsEnabled}function Vt(){return Ln.lFrame.lView}function Si(){return Ln.lFrame.tView}function _r(n){return Ln.lFrame.contextLView=n,n[8]}function as(){let n=p_();for(;null!==n&&64===n.type;)n=n.parent;return n}function p_(){return Ln.lFrame.currentTNode}function sl(n,e){const t=Ln.lFrame;t.currentTNode=n,t.isParent=e}function zr(){return Ln.lFrame.isParent}function ps(){Ln.lFrame.isParent=!1}function zh(){return Ln.isInCheckNoChangesMode}function yp(n){Ln.isInCheckNoChangesMode=n}function Cs(){const n=Ln.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Ra(){return Ln.lFrame.bindingIndex++}function Fo(n){const e=Ln.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Od(n,e){const t=Ln.lFrame;t.bindingIndex=t.bindingRootIndex=n,g_(e)}function g_(n){Ln.lFrame.currentDirectiveIndex=n}function m_(n){const e=Ln.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function pv(){return Ln.lFrame.currentQueryIndex}function __(n){Ln.lFrame.currentQueryIndex=n}function vp(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function Rd(n,e,t){if(t&xn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&xn.Host||(r=vp(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ln.lFrame=xe();return i.currentTNode=e,i.lView=n,!0}function $h(n){const e=xe(),t=n[1];Ln.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function xe(){const n=Ln.lFrame,e=null===n?null:n.child;return null===e?Tu(n):e}function Tu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Wh(){const n=Ln.lFrame;return Ln.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Lo=Wh;function fi(){const n=Wh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function to(){return Ln.lFrame.selectedIndex}function _o(n){Ln.lFrame.selectedIndex=n}function Nr(){const n=Ln.lFrame;return h_(n.tView,n.selectedIndex)}function wp(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function Ep(n,e,t){ol(n,e,3,t)}function xp(n,e,t,i){(3&n[2])===t&&ol(n,e,t,i)}function y_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function ol(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(q1(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function q1(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class qh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Sp(n,e,t){const i=dr(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];v_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function _v(n){return 3===n||4===n||6===n}function v_(n){return 64===n.charCodeAt(0)}function Yh(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||w_(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function w_(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function yv(n){return-1!==n}function Pd(n){return 32767&n}function al(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Nd=!0;function Cp(n){const e=Nd;return Nd=n,e}let x_=0;function Hs(n,e){const t=Tp(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,S_(i.data,n),S_(e,null),S_(i.blueprint,null));const r=Xh(n,e),s=n.injectorIndex;if(yv(r)){const o=Pd(r),a=al(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function S_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Tp(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Xh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Rc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Rh)&&(i=t[Rh]),null==i&&(i=t[Rh]=x_++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function C_(n,e,t){if(t&xn.Optional)return n;bn(e,"NodeInjector")}function vv(n,e,t,i){if(t&xn.Optional&&void 0===i&&(i=null),0==(t&(xn.Self|xn.Host))){const r=n[9],s=Ta(void 0);try{return r?r.get(e,i,t&xn.Optional):Ed(e,i,t&xn.Optional)}finally{Ta(s)}}return C_(i,e,t)}function Kh(n,e,t,i=xn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Rh)?n[Rh]:void 0;return"number"==typeof e?e>=0?255&e:Ev:e}(t);if("function"==typeof s){if(!Rd(e,n,i))return i&xn.Host?C_(r,t,i):vv(e,t,i,r);try{const o=s(i);if(null!=o||i&xn.Optional)return o;bn(t)}finally{Lo()}}else if("number"==typeof s){let o=null,a=Tp(n,e),l=-1,c=i&xn.Host?e[16][6]:null;for((-1===a||i&xn.SkipSelf)&&(l=-1===a?Xh(n,e):e[a+8],-1!==l&&Qh(i,!1)?(o=e[1],a=Pd(l),e=al(l,e)):a=-1);-1!==a;){const u=e[1];if(Ap(s,a,u.data)){const h=Ts(a,e,t,o,i,c);if(h!==wv)return h}l=e[a+8],-1!==l&&Qh(i,e[1].data[a+8]===c)&&Ap(s,a,e)?(o=u,a=Pd(l),e=al(l,e)):a=-1}}}return vv(e,t,i,r)}const wv={};function Ev(){return new na(as(),Vt())}function Ts(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=kd(a,o,t,null==i?Ad(a)&&Nd:i!=o&&0!=(3&a.type),r&xn.Host&&s===a);return null!==u?Fd(e,o,u,a):wv}function kd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,f=r?a+u:n.directiveEnd;for(let g=i?a:a+u;g<f;g++){const m=o[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=o[l];if(g&&Da(g)&&g.type===t)return l}return null}function Fd(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof qh}(r)){const o=r;o.resolving&&function(n,e){throw new Je("200",`Circular dependency in DI detected for ${n}`)}(Qt(s[t]));const a=Cp(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ta(o.injectImpl):null;Rd(n,i,xn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=dv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&Ta(l),Cp(a),o.resolving=!1,Lo()}}return r}function Ap(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Qh(n,e){return!(n&xn.Self||n&xn.Host&&e)}class na{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Kh(this._tNode,this._lView,e,void 0,t)}}function zi(n){return De(()=>{const e=n.prototype.constructor,t=e[Bl]||As(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Bl]||As(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function As(n){return Be(n)?()=>{const e=As(ve(n));return e&&e()}:Ic(n)}function yo(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(_v(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(as(),n)}const Bd="__parameters__";function ka(n,e,t){return De(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Bd)?l[Bd]:Object.defineProperty(l,Bd,{value:[]})[Bd];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Ht{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Du=Function;function ia(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),ia(i,e)):e!==n&&e.push(i)}return e}function ra(n,e){n.forEach(t=>Array.isArray(t)?ra(t,e):e(t))}function Jh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Hl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Nc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Bo(n,e,t){let i=Ms(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function O_(n,e){const t=Ms(n,e);if(t>=0)return n[1|t]}function Ms(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Ru={},Rp="__NG_DI_FLAG__",Fc="ngTempTokenPath",Lc=/\n/gm,ul="__source",Pp=en({provide:String,useValue:en});let Pu;function Ud(n){const e=Pu;return Pu=n,e}function lT(n,e=xn.Default){if(void 0===Pu)throw new Error("inject() must be called from an injection context");return null===Pu?Ed(n,void 0,e):Pu.get(n,e&xn.Optional?null:void 0,e)}function Ie(n,e=xn.Default){return(po||lT)(ve(n),e)}const Bc=Ie;function Nu(n){const e=[];for(let t=0;t<n.length;t++){const i=ve(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=xn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Mv(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ie(r,s))}else e.push(Ie(i))}return e}function zd(n,e){return n[Rp]=e,n.prototype[Rp]=e,n}function Mv(n){return n[Rp]}function no(n,e,t,i){const r=n[Fc];throw e[ul]&&r.unshift(e[ul]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Lc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Fc]=null,n}const Hd=zd(ka("Inject",n=>({token:n})),-1),ts=zd(ka("Optional"),8),dl=zd(ka("SkipSelf"),4);let $d;function Fu(n){var e;return(null===(e=function(){if(void 0===$d&&($d=null,Zn.trustedTypes))try{$d=Zn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return $d}())||void 0===e?void 0:e.createHTML(n))||n}class ql{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class L_ extends ql{getTypeName(){return"HTML"}}class B_ extends ql{getTypeName(){return"Style"}}class jp extends ql{getTypeName(){return"Script"}}class Wd extends ql{getTypeName(){return"URL"}}class kn extends ql{getTypeName(){return"ResourceURL"}}function Gs(n){return n instanceof ql?n.changingThisBreaksApplicationSecurity:n}function sa(n,e){const t=jc(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function jc(n){return n instanceof ql&&n.getTypeName()||null}class jv{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Fu(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class fT{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const i=this.inertDocument.createElement("body");t.appendChild(i)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Fu(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=Fu(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const pT=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,gT=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function jo(n){return(n=String(n)).match(pT)||n.match(gT)?n:"unsafe:"+n}function Ws(n){return(n=String(n)).split(",").map(e=>jo(e.trim())).join(", ")}function oa(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function tf(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const Up=oa("area,br,col,hr,img,wbr"),zv=oa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Hv=oa("rp,rt"),j_=tf(Up,tf(zv,oa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),tf(Hv,oa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),tf(Hv,zv)),U_=oa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),z_=oa("srcset"),H_=tf(U_,z_,oa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),oa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),bT=oa("script,style,template");class G_{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!j_.hasOwnProperty(t))return this.sanitizedSomething=!0,!bT.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!H_.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;U_[a]&&(l=jo(l)),z_[a]&&(l=Ws(l)),this.buf.push(" ",o,'="',Hp(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();j_.hasOwnProperty(t)&&!Up.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Hp(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Gv=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,nf=/([^\#-~ |!])/g;function Hp(n){return n.replace(/&/g,"&amp;").replace(Gv,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(nf,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let rf;function $_(n,e){let t=null;try{rf=rf||function(n){const e=new fT(n);return function(){try{return!!(new window.DOMParser).parseFromString(Fu(""),"text/html")}catch(n){return!1}}()?new jv(e):e}(n);let i=e?String(e):"";t=rf.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=rf.getInertBodyElement(i)}while(i!==s);return Fu((new G_).sanitizeChildren(qd(t)||t))}finally{if(t){const i=qd(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function qd(n){return"content"in n&&function(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var si=(()=>((si=si||{})[si.NONE=0]="NONE",si[si.HTML=1]="HTML",si[si.STYLE=2]="STYLE",si[si.SCRIPT=3]="SCRIPT",si[si.URL=4]="URL",si[si.RESOURCE_URL=5]="RESOURCE_URL",si))();function sf(n){const e=function(){const n=Vt();return n&&n[12]}();return e?e.sanitize(si.URL,n)||"":sa(n,"URL")?Gs(n):jo(Ot(n))}const Y_="__ngContext__";function Ds(n,e){n[Y_]=e}function X_(n){const e=function(n){return n[Y_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Gp(n){return n.ngOriginalError}function RT(n,...e){n.error(...e)}class la{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||RT}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Gp(e)):null}_findOriginalError(e){let t=e&&Gp(e);for(;t&&Gp(t);)t=Gp(t);return t||null}}const tw=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Zn))();function fl(n){return n instanceof Function?n():n}var Uo=(()=>((Uo=Uo||{})[Uo.Important=1]="Important",Uo[Uo.DashCase=2]="DashCase",Uo))();function ey(n,e){return undefined(n,e)}function lf(n){const e=n[3];return ea(e)?e[3]:e}function Xd(n){return ow(n[13])}function ny(n){return ow(n[4])}function ow(n){for(;null!==n&&!ea(n);)n=n[4];return n}function Kd(n,e,t,i,r){if(null!=i){let s,o=!1;ea(i)?s=i:Jo(i)&&(o=!0,i=i[0]);const a=Sr(i);0===n&&null!==t?null==r?dw(e,t,a):pl(e,t,a,r||null,!0):1===n&&null!==t?pl(e,t,a,r||null,!0):2===n?function(n,e,t){const i=qp(n,e);i&&function(n,e,t,i){dr(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==Sr(t)&&Kd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Qd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function ry(n,e,t){return dr(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function lw(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,mp(r,-1)),t.splice(i,1)}function sy(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&lw(r,i),e>0&&(n[t-1][4]=i[4]);const s=Hl(n,10+e);!function(n,e){Qd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function oy(n,e){if(!(256&e[2])){const t=e[11];dr(t)&&t.destroyNode&&Qd(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return Wp(n[1],n);for(;e;){let t=null;if(Jo(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Jo(e)&&Wp(e[1],e),e=e[3];null===e&&(e=n),Jo(e)&&Wp(e[1],e),t=e&&e[4]}e=t}}(e)}}function Wp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof qh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):Sr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&dr(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&ea(e[3])){t!==e[3]&&lw(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function cw(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Xt.None||r===Xt.Emulated)return null}return eo(i,t)}(n,e.parent,t)}function pl(n,e,t,i,r){dr(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function dw(n,e,t){dr(n)?n.appendChild(e,t):e.appendChild(t)}function hw(n,e,t,i,r){null!==i?pl(n,e,t,i,r):dw(n,e,t)}function qp(n,e){return dr(n)?n.parentNode(e):e.parentNode}function fw(n,e,t){return gw(n,e,t)}let gw=function(n,e,t){return 40&n.type?eo(n,t):null};function Yp(n,e,t,i){const r=cw(n,i,e),s=e[11],a=fw(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)hw(s,r,t[l],a,!1);else hw(s,r,t,a,!1)}function Bu(n,e){if(null!==e){const t=e.type;if(3&t)return eo(e,n);if(4&t)return Xp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Bu(n,i);{const r=n[e.index];return ea(r)?Xp(-1,r):Sr(r)}}if(32&t)return ey(e,n)()||Sr(n[e.index]);{const i=_w(n,e);return null!==i?Array.isArray(i)?i[0]:Bu(lf(n[16]),i):Bu(n,e.next)}}return null}function _w(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Xp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Bu(i,r)}return e[7]}function cf(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Ds(Sr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)cf(n,e,t.child,i,r,s,!1),Kd(e,n,r,a,s);else if(32&l){const c=ey(t,i);let u;for(;u=c();)Kd(e,n,r,u,s);Kd(e,n,r,a,s)}else 16&l?cy(n,e,i,t,r,s):Kd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Qd(n,e,t,i,r,s){cf(t,i,n.firstChild,e,r,s,!1)}function cy(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Kd(e,n,r,l[c],s);else cf(n,e,l,o[3],r,s,!0)}function vw(n,e,t){dr(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function uy(n,e,t){dr(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function uf(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const ww="ng-template";function rA(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==uf(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Kp(n){return 4===n.type&&n.value!==ww}function Ew(n,e,t){return e===(4!==n.type||t?n.value:ww)}function sA(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(_v(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Ew(n,l,t)||""===l&&1===e.length){if(La(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!rA(n.attrs,c,t)){if(La(i))return!1;o=!0}continue}const h=oA(8&i?"class":l,r,Kp(n),t);if(-1===h){if(La(i))return!1;o=!0;continue}if(""!==c){let f;f=h>s?"":r[h+1].toLowerCase();const g=8&i?f:null;if(g&&-1!==uf(g,c,0)||2&i&&c!==f){if(La(i))return!1;o=!0}}}}else{if(!o&&!La(i)&&!La(l))return!1;if(o&&La(l))continue;o=!1,i=l|1&i}}return La(i)||o}function La(n){return 0==(1&n)}function oA(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function xw(n,e,t=!1){for(let i=0;i<e.length;i++)if(sA(n,e[i],t))return!0;return!1}function uA(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Sw(n,e){return n?":not("+e.trim()+")":e}function dA(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!La(o)&&(e+=Sw(s,r),r=""),i=o,s=s||!La(i);t++}return""!==r&&(e+=Sw(s,r)),e}const Dn={};function zt(n){Cw(Si(),Vt(),to()+n,zh())}function Cw(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&Ep(e,s,t)}else{const s=n.preOrderHooks;null!==s&&xp(e,s,0,t)}_o(t)}function gl(n,e){return n<<17|e<<2}function On(n){return n>>17&32767}function Cr(n){return 2|n}function Yl(n){return(131068&n)>>2}function ml(n,e){return-131069&n|e<<2}function hy(n){return 1|n}function Nw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];__(r),o.contentQueries(2,e[s],s)}}}function hf(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,f_(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function Jd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=p_(),o=zr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Ln.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Ln.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return sl(s,!0),s}function eh(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function ff(n,e,t){$h(e);try{const i=n.viewQuery;null!==i&&My(1,i,t);const r=n.template;null!==r&&kw(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Nw(n,e),n.staticViewQueries&&My(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)UA(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,fi()}}function th(n,e,t,i){const r=e[2];if(256==(256&r))return;$h(e);const s=zh();try{f_(e),function(n){Ln.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&kw(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&Ep(e,c,null)}else{const c=n.preOrderHooks;null!==c&&xp(e,c,0,null),y_(e,0)}if(function(n){for(let e=Xd(n);null!==e;e=ny(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&mp(s,1),r[2]|=1024}}}(e),function(n){for(let e=Xd(n);null!==e;e=ny(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];Id(i)&&th(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&Nw(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&Ep(e,c)}else{const c=n.contentHooks;null!==c&&xp(e,c,1),y_(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)_o(~r);else{const s=r,o=t[++i],a=t[++i];Od(o,s),a(2,e[s])}}}finally{_o(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)jA(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&My(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&Ep(e,c)}else{const c=n.viewHooks;null!==c&&xp(e,c,2),y_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,mp(e[3],-1))}finally{fi()}}function SA(n,e,t,i){const r=e[10],s=!zh(),o=Ul(e);try{s&&!o&&r.begin&&r.begin(),o&&ff(n,e,i),th(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function kw(n,e,t,i,r){const s=to(),o=2&i;try{_o(-1),o&&e.length>20&&Cw(n,e,20,zh()),t(i,r)}finally{_o(s)}}function pf(n,e,t){!fv()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||Hs(t,e),Ds(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Da(l);c&&kA(e,t,l);const u=Fd(e,n,a,t);Ds(u,e),null!==o&&FA(0,a-r,u,l,0,o),c&&(zs(t.index,e)[8]=u)}}(n,e,t,eo(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Ln.lFrame.currentDirectiveIndex;try{_o(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];g_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&$w(c,u)}}finally{_o(-1),g_(a)}}(n,e,t))}function by(n,e,t=eo){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function eg(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=tg(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function tg(n,e,t,i,r,s,o,a,l,c){const u=20+i,h=u+r,f=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Dn);return t}(u,h),g="function"==typeof c?c():c;return f[1]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function Bw(n,e,t,i){const r=Xw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&ig(n).push(i,r.length-1))}function Vw(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function zo(n,e,t,i,r,s,o,a){const l=eo(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(Kw(n,t,u,i,r),Ad(e)&&function(n,e){const t=zs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,dr(s)?s.setProperty(l,i,r):v_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function vy(n,e,t,i){let r=!1;if(fv()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];xw(t,o.selectors,!1)&&(r||(r=[]),Rc(Hs(t,e),n,o.type),Da(o)?(Ww(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,wy(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=eh(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Yh(t.mergedAttrs,h.hostAttrs),Ey(n,t,e,c,h),NA(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const f=h.type.prototype;!a&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,f=null===s||Kp(e)?null:LA(h,s);o.push(f),a=Vw(h,c,a),l=Vw(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Je("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Yh(t.mergedAttrs,t.attrs),r}function Gw(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function $w(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Ww(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function NA(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Da(e)&&(t[""]=n)}}function wy(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Ey(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Ic(r.type)),o=new qh(s,Da(r),null);n.blueprint[i]=o,t[i]=o,Gw(n,e,0,i,eh(n,t,r.hostVars,Dn),r)}function kA(n,e,t){const i=eo(e,n),r=eg(t),s=n[10],o=ng(n,hf(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function yl(n,e,t,i,r,s){const o=eo(n,e);!function(n,e,t,i,r,s,o){if(null==s)dr(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Ot(s):o(s,i||"",r);dr(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function FA(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function LA(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function qw(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function jA(n,e){const t=zs(e,n);if(Id(t)){const i=t[1];80&t[2]?th(i,t,i.template,t[8]):t[5]>0&&Sy(t)}}function Sy(n){for(let i=Xd(n);null!==i;i=ny(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];th(o,s,o.template,s[8])}else s[5]>0&&Sy(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=zs(t[i],n);Id(r)&&r[5]>0&&Sy(r)}}function UA(n,e){const t=zs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),ff(i,t,t[8])}function ng(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Cy(n){for(;n;){n[2]|=64;const e=lf(n);if(lv(n)&&!e)return n;n=e}return null}function Ay(n,e,t){const i=e[10];i.begin&&i.begin();try{th(n,e,n.template,t)}catch(r){throw Iy(e,r),r}finally{i.end&&i.end()}}function Yw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=X_(t),r=i[1];SA(r,i,r.template,t)}}(n[8])}function My(n,e,t){__(0),e(n,t)}const WA=(()=>Promise.resolve(null))();function Xw(n){return n[7]||(n[7]=[])}function ig(n){return n.cleanup||(n.cleanup=[])}function Dy(n,e,t){return(null===n||Da(n))&&(t=function(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(t[e.index])),t[11]}function Iy(n,e){const t=n[9],i=t?t.get(la,null):null;i&&i.handleError(e)}function Kw(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Xl(n,e,t){const i=Vh(e,n);!function(n,e,t){dr(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function rg(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=lt(r,a):2==s&&(i=lt(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Vu=new Ht("INJECTOR",-1);class so{get(e,t=Ru){if(t===Ru){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const ju=new Ht("Set Injector scope."),gf={},YA={};let Ry;function Qw(){return void 0===Ry&&(Ry=new so),Ry}function Zw(n,e=null,t=null,i){return new Ny(n,t,e||Qw(),i)}class Ny{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&ra(t,a=>this.processProvider(a,e,t)),ra([e],a=>this.processInjectorType(a,[],s)),this.records.set(Vu,Uu(void 0,this));const o=this.records.get(ju);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Ru,i=xn.Default){this.assertNotDestroyed();const r=Ud(this),s=Ta(void 0);try{if(!(i&xn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ht}(e)&&vn(e);a=l&&this.injectableDefInScope(l)?Uu(ky(e),gf):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&xn.Self?Qw():this.parent).get(e,t=i&xn.Optional&&t===Ru?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Fc]=o[Fc]||[]).unshift(rt(e)),r)throw o;return no(o,e,"R3InjectorError",this.source)}throw o}finally{Ta(s),Ud(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=ve(e)))return!1;let r=Fl(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Fl(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{ra(r.imports,h=>{this.processInjectorType(h,t,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:f,providers:g}=u[h];ra(g,m=>this.processProvider(m,f,g||er))}}this.injectorDefTypes.add(o);const l=Ic(o)||(()=>new o);this.records.set(o,Uu(l,gf));const c=r.providers;if(null!=c&&!a){const u=e;ra(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Hc(e=ve(e))?e:ve(e&&e.provide);const s=function(n,e,t){return eE(n)?Uu(void 0,n.useValue):Uu(Jw(n),gf)}(e);if(Hc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Uu(void 0,gf,!0),o.factory=()=>Nu(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===gf&&(t.value=YA,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ve(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function ky(n){const e=vn(n),t=null!==e?e.factory:Ic(n);if(null!==t)return t;if(n instanceof Ht)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=Nc(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[fo]||n[Vs]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function Jw(n,e,t){let i;if(Hc(n)){const r=ve(n);return Ic(r)||ky(r)}if(eE(n))i=()=>ve(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Nu(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Ie(ve(n.useExisting));else{const r=ve(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return Ic(r)||ky(r);i=()=>new r(...Nu(n.deps))}return i}function Uu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function eE(n){return null!==n&&"object"==typeof n&&Pp in n}function Hc(n){return"function"==typeof n}const tE=function(n,e,t){return function(n,e=null,t=null,i){const r=Zw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class Hn{static create(e,t){return Array.isArray(e)?tE(e,t,""):tE(e.providers,e.parent,e.name||"")}}function Fq(n,e){wp(X_(n)[1],as())}function En(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Da(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=lM(n.inputs),o.declaredInputs=lM(n.declaredInputs),o.outputs=lM(n.outputs);const a=r.hostBindings;a&&jq(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&Bq(n,l),c&&Vq(n,c),nl(n.inputs,r.inputs),nl(n.declaredInputs,r.declaredInputs),nl(n.outputs,r.outputs),Da(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===En&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Yh(r.hostAttrs,t=Yh(t,r.hostAttrs))}}(i)}function lM(n){return n===xd?{}:n===er?[]:n}function Bq(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function Vq(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function jq(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}Hn.THROW_IF_NOT_FOUND=Ru,Hn.NULL=new so,Hn.\u0275prov=We({token:Hn,providedIn:"any",factory:()=>Ie(Vu)}),Hn.__NG_ELEMENT_ID__=-1;let oE=null;function sg(){if(!oE){const n=Zn.Symbol;if(n&&n.iterator)oE=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(oE=i)}}}return oE}class Ql{constructor(e){this.wrapped=e}static wrap(e){return new Ql(e)}static unwrap(e){return Ql.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Ql}}function jy(n){return!!cM(n)&&(Array.isArray(n)||!(n instanceof Map)&&sg()in n)}function cM(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function $c(n,e,t){return n[e]=t}function Eo(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Ii(n,e,t,i){const r=Vt();return Eo(r,Ra(),e)&&(Si(),yl(Nr(),r,n,e,t,i)),Ii}function ag(n,e,t,i){return Eo(n,Ra(),t)?e+Ot(t)+i:Dn}function wi(n,e,t,i,r,s,o,a){const l=Vt(),c=Si(),u=n+20,h=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Jd(e,n,4,o||null,Oa(c,a));vy(e,t,u,Oa(c,l)),wp(e,u);const h=u.tViews=tg(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];sl(h,!1);const f=l[11].createComment("");Yp(c,l,f,h),Ds(f,l),ng(l,l[u]=qw(f,l,f,h)),Md(h)&&pf(c,l,h),null!=o&&by(l,h,a)}function ih(n){return Dd(Ln.lFrame.contextLView,20+n)}function Ce(n,e=xn.Default){const t=Vt();return null===t?Ie(n,e):Kh(as(),t,ve(n),e)}function Jt(n,e,t){const i=Vt();return Eo(i,Ra(),e)&&zo(Si(),Nr(),i,n,e,i[11],t,!1),Jt}function pM(n,e,t,i,r){const o=r?"class":"style";Kw(n,t,e.inputs[o],o,i)}function wt(n,e,t,i){const r=Vt(),s=Si(),o=20+n,a=r[11],l=r[o]=ry(a,e,Ln.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Jd(e,n,2,r,Oa(a,s));return vy(e,t,c,Oa(a,o)),null!==c.attrs&&rg(c,c.attrs,!1),null!==c.mergedAttrs&&rg(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];sl(c,!0);const u=c.mergedAttrs;null!==u&&Sp(a,l,u);const h=c.classes;null!==h&&uy(a,l,h);const f=c.styles;null!==f&&vw(a,l,f),64!=(64&c.flags)&&Yp(s,r,l,c),0===Ln.lFrame.elementDepthCount&&Ds(l,r),Ln.lFrame.elementDepthCount++,Md(c)&&(pf(s,r,c),function(n,e,t){if(s_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&by(r,c)}function Et(){let n=as();zr()?ps():(n=n.parent,sl(n,!1));const e=n;Ln.lFrame.elementDepthCount--;const t=Si();t.firstCreatePass&&(wp(t,n),s_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&pM(t,e,Vt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&pM(t,e,Vt(),e.stylesWithoutHost,!1)}function ni(n,e,t,i){wt(n,e,t,i),Et()}function wl(){return Vt()}function yg(n){return!!n&&"function"==typeof n.then}function x2(n){return!!n&&"function"==typeof n.subscribe}const cE=x2;function Tn(n,e,t,i){const r=Vt(),s=Si(),o=as();return S2(s,r,r[11],o,n,e,!!t,i),Tn}function uE(n,e){const t=as(),i=Vt(),r=Si();return S2(r,i,Dy(m_(r.data),t,i),t,n,e,!1),uE}function S2(n,e,t,i,r,s,o,a){const l=Md(i),u=n.firstCreatePass&&ig(n),h=e[8],f=Xw(e);let g=!0;if(3&i.type||a){const x=eo(i,e),U=a?a(x):x,D=f.length,ie=a?_e=>a(Sr(_e[i.index])):i.index;if(dr(t)){let _e=null;if(!a&&l&&(_e=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==_e)(_e.__ngLastListenerFn__||_e).__ngNextListenerFn__=s,_e.__ngLastListenerFn__=s,g=!1;else{s=gM(i,e,h,s,!1);const Pe=t.listen(U,r,s);f.push(s,Pe),u&&u.push(r,ie,D,D+1)}}else s=gM(i,e,h,s,!0),U.addEventListener(r,s,o),f.push(s),u&&u.push(r,ie,D,o)}else s=gM(i,e,h,s,!1);const m=i.outputs;let v;if(g&&null!==m&&(v=m[r])){const x=v.length;if(x)for(let U=0;U<x;U+=2){const Ne=e[v[U]][v[U+1]].subscribe(s),Ve=f.length;f.push(s,Ne),u&&u.push(r,i.index,Ve,-(Ve+1))}}}function C2(n,e,t,i){try{return!1!==t(i)}catch(r){return Iy(n,r),!1}}function gM(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?zs(n.index,e):e;0==(32&e[2])&&Cy(a);let l=C2(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=C2(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function _i(n=1){return function(n){return(Ln.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Ln.lFrame.contextLView))[8]}(n)}function vY(n,e){let t=null;const i=function(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?xw(n,s,!0):uA(i,s))return r}else t=r}return t}function Hr(n){const e=Vt()[16][6];if(!e.projection){const i=e.projection=Nc(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?vY(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function oi(n,e=0,t){const i=Vt(),r=Si(),s=Jd(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),ps(),64!=(64&s.flags)&&function(n,e,t){cy(e[11],0,e,t,cw(n,t,e),fw(t.parent||e[6],t,e))}(r,i,s)}function dE(n,e,t){return mM(n,"",e,"",t),dE}function mM(n,e,t,i,r){const s=Vt(),o=ag(s,e,t,i);return o!==Dn&&zo(Si(),Nr(),s,n,o,s[11],r,!1),mM}function N2(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?On(s):Yl(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];xY(n[a],e)&&(l=!0,n[a+1]=i?hy(u):Cr(u)),a=i?On(u):Yl(u)}l&&(n[t+1]=i?Cr(s):hy(s))}function xY(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Ms(n,e)>=0}const Os={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function k2(n){return n.substring(Os.key,Os.keyEnd)}function F2(n,e){const t=Os.textEnd;return t===e?-1:(e=Os.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Os.key=e,t),bg(n,e,t))}function bg(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function zy(n,e,t){return Jl(n,e,t,!1),zy}function ai(n,e){return Jl(n,e,null,!0),ai}function Va(n){!function(n,e,t,i){const r=Si(),s=Fo(2);r.firstUpdatePass&&z2(r,null,s,i);const o=Vt();if(t!==Dn&&Eo(o,s,t)){const a=r.data[to()];if(W2(a,i)&&!U2(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=lt(l,t||"")),pM(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===Dn&&(r=er);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const f=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let v,m=null;u===h?(l+=2,c+=2,f!==g&&(m=h,v=g)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,v=g),null!==m&&G2(n,e,t,i,m,v,o,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return er;const i=[],r=Gs(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Bo,Wc,n,!0)}function Wc(n,e){for(let t=function(n){return function(n){Os.key=0,Os.keyEnd=0,Os.value=0,Os.valueEnd=0,Os.textEnd=n.length}(n),F2(n,bg(n,0,Os.textEnd))}(e);t>=0;t=F2(e,t))Bo(n,k2(e),!0)}function Jl(n,e,t,i){const r=Vt(),s=Si(),o=Fo(2);s.firstUpdatePass&&z2(s,n,o,i),e!==Dn&&Eo(r,o,e)&&G2(s,s.data[to()],r,r[11],n,r[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=rt(Gs(n)))),n}(e,t),i,o)}function U2(n,e){return e>=n.expandoStartIndex}function z2(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[to()],o=U2(n,t);W2(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=m_(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Hy(t=_M(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=_M(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Yl(i))return n[On(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=_M(null,n,e,l[1],i),l=Hy(l,e.attrs,i),function(n,e,t,i){n[On(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Hy(i,n[s].hostAttrs,t);return Hy(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=On(o),l=Yl(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Ms(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const f=On(n[a+1]);n[i+1]=gl(f,a),0!==f&&(n[f+1]=ml(n[f+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=gl(a,0),0!==a&&(n[a+1]=ml(n[a+1],i)),a=i;else n[i+1]=gl(l,0),0===a?a=i:n[l+1]=ml(n[l+1],i),l=i;c&&(n[i+1]=Cr(n[i+1])),N2(n,u,i,!0),N2(n,u,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Ms(s,e)>=0&&(t[i+1]=hy(t[i+1]))}(e,u,n,i,s),o=gl(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function _M(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Hy(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Hy(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Bo(n,o,!!t||e[++s]))}return void 0===n?null:n}function G2(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];hE(function(n){return 1==(1&n)}(c)?$2(l,e,t,r,Yl(c),o):void 0)||(hE(s)||function(n){return 2==(2&n)}(c)&&(s=$2(l,null,t,r,a,o)),function(n,e,t,i,r){const s=dr(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Uo.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Uo.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Vh(to(),t),r,s))}function $2(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let f=t[r+1];f===Dn&&(f=h?er:void 0);let g=h?O_(f,i):u===i?f:void 0;if(c&&!hE(g)&&(g=O_(l,i)),hE(g)&&(a=g,o))return a;const m=n[r+1];r=o?On(m):Yl(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=O_(l,i))}return a}function hE(n){return void 0!==n}function W2(n,e){return 0!=(n.flags&(e?16:32))}function Jn(n,e=""){const t=Vt(),i=Si(),r=n+20,s=i.firstCreatePass?Jd(i,r,1,e,null):i.data[r],o=t[r]=function(n,e){return dr(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Yp(i,t,o,s),sl(s,!1)}function gs(n){return xo("",n,""),gs}function xo(n,e,t){const i=Vt(),r=ag(i,n,e,t);return r!==Dn&&Xl(i,to(),r),xo}function qc(n,e,t){const i=Vt();return Eo(i,Ra(),e)&&zo(Si(),Nr(),i,n,e,i[11],t,!0),qc}function fE(n,e,t){const i=Vt();if(Eo(i,Ra(),e)){const s=Si(),o=Nr();zo(s,o,i,n,e,Dy(m_(s.data),o,i),t,!0)}return fE}const _f=void 0;var iX=["en",[["a","p"],["AM","PM"],_f],[["AM","PM"],_f,_f],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],_f,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],_f,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",_f,"{1} 'at' {0}",_f],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let vg={};function uL(n){return n in vg||(vg[n]=Zn.ng&&Zn.ng.common&&Zn.ng.common.locales&&Zn.ng.common.locales[n]),vg[n]}var un=(()=>((un=un||{})[un.LocaleId=0]="LocaleId",un[un.DayPeriodsFormat=1]="DayPeriodsFormat",un[un.DayPeriodsStandalone=2]="DayPeriodsStandalone",un[un.DaysFormat=3]="DaysFormat",un[un.DaysStandalone=4]="DaysStandalone",un[un.MonthsFormat=5]="MonthsFormat",un[un.MonthsStandalone=6]="MonthsStandalone",un[un.Eras=7]="Eras",un[un.FirstDayOfWeek=8]="FirstDayOfWeek",un[un.WeekendRange=9]="WeekendRange",un[un.DateFormat=10]="DateFormat",un[un.TimeFormat=11]="TimeFormat",un[un.DateTimeFormat=12]="DateTimeFormat",un[un.NumberSymbols=13]="NumberSymbols",un[un.NumberFormats=14]="NumberFormats",un[un.CurrencyCode=15]="CurrencyCode",un[un.CurrencySymbol=16]="CurrencySymbol",un[un.CurrencyName=17]="CurrencyName",un[un.Currencies=18]="Currencies",un[un.Directionality=19]="Directionality",un[un.PluralCase=20]="PluralCase",un[un.ExtraData=21]="ExtraData",un))();const pE="en-US";let dL=pE;function bM(n){J(n,"Expected localeId to be defined"),"string"==typeof n&&(dL=n.toLowerCase().replace(/_/g,"-"))}function EM(n,e,t,i,r){if(n=ve(n),Array.isArray(n))for(let s=0;s<n.length;s++)EM(n[s],e,t,i,r);else{const s=Si(),o=Vt();let a=Hc(n)?n:ve(n.provide),l=Jw(n);const c=as(),u=1048575&c.providerIndexes,h=c.directiveStart,f=c.providerIndexes>>20;if(Hc(n)||!n.multi){const g=new qh(l,r,Ce),m=SM(a,e,r?u:u+f,h);-1===m?(Rc(Hs(c,o),s,a),xM(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)):(t[m]=g,o[m]=g)}else{const g=SM(a,e,u+f,h),m=SM(a,e,u,u+f),v=g>=0&&t[g],x=m>=0&&t[m];if(r&&!x||!r&&!v){Rc(Hs(c,o),s,a);const U=function(n,e,t,i,r){const s=new qh(n,t,Ce);return s.multi=[],s.index=e,s.componentProviders=0,kL(s,r,i&&!t),s}(r?eK:JX,t.length,r,i,l);!r&&x&&(t[m].providerFactory=U),xM(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(U),o.push(U)}else xM(s,n,g>-1?g:m,kL(t[r?m:g],l,!r&&i));!r&&i&&x&&t[m].componentProviders++}}}function xM(n,e,t,i){const r=Hc(e);if(r||function(n){return!!n.useClass}(e)){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const l=a.indexOf(t);-1===l?a.push(t,[i,o]):a[l+1].push(i,o)}else a.push(t,o)}}}function kL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function SM(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function JX(n,e,t,i){return CM(this.multi,[])}function eK(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Fd(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),CM(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],CM(r,s);return s}function CM(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Vn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function(n,e,t){const i=Si();if(i.firstCreatePass){const r=Da(n);EM(t,i.data,i.blueprint,r,!0),EM(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class FL{}const BL="ngComponent";class iK{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[BL]=n,e}(e)}}class El{}function bE(...n){}function Eg(n,e){return new gn(eo(n,e))}El.NULL=new iK;const oK=function(){return Eg(as(),Vt())};let gn=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=oK,n})();function VL(n){return n instanceof gn?n.nativeElement:n}class yf{}let AM=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Hu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const jL=new Hu("12.2.5");class UL{constructor(){}supports(e){return jy(e)}create(e){return new hK(e)}}const dK=(n,e)=>e;class hK{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||dK}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<HL(i,r,s)?t:i,a=HL(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let f=0;f<c;f++){const g=f<s.length?s[f]:s[f]=0,m=g+f;u<=m&&m<c&&(s[f]=g+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!jy(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[sg()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new fK(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new zL),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zL),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class fK{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class pK{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class zL{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new pK,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function HL(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class GL{constructor(){}supports(e){return e instanceof Map||cM(e)}create(){return new gK}}class gK{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||cM(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new mK(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class mK{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function $L(){return new xg([new UL])}let xg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||$L()),deps:[[n,new dl,new ts]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:$L}),n})();function WL(){return new Sg([new GL])}let Sg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||WL()),deps:[[n,new dl,new ts]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:WL}),n})();function vE(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Sr(s)),ea(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&vE(l[1],l,c,i)}const o=t.type;if(8&o)vE(n,e,t.child,i);else if(32&o){const a=ey(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=_w(e,t);if(Array.isArray(a))i.push(...a);else{const l=lf(e[16]);vE(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class Yy{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return vE(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(ea(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(sy(e,i),Hl(t,i))}this._attachedToViewContainer=!1}oy(this._lView[1],this._lView)}onDestroy(e){Bw(this._lView[1],this._lView,null,e)}markForCheck(){Cy(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Ay(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){yp(!0);try{Ay(n,e,t)}finally{yp(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Qd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class yK extends Yy{constructor(e){super(e),this._view=e}detectChanges(){Yw(this._view)}checkNoChanges(){!function(n){yp(!0);try{Yw(n)}finally{yp(!1)}}(this._view)}get context(){return null}}const vK=function(n){return function(n,e,t){if(Ad(n)&&!t){const i=zs(n.index,e);return new Yy(i,i)}return 47&n.type?new Yy(e[16],e):null}(as(),Vt(),16==(16&n))};let Mr=(()=>{class n{}return n.__NG_ELEMENT_ID__=vK,n})();const xK=[new GL],CK=new xg([new UL]),TK=new Sg(xK),MK=function(){return wE(as(),Vt())};let Go=(()=>{class n{}return n.__NG_ELEMENT_ID__=MK,n})();const DK=Go,IK=class extends DK{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=hf(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),ff(t,i,e),new Yy(i)}};function wE(n,e){return 4&n.type?new IK(e,n,Eg(n,e)):null}class Yc{}const PK=function(){return KL(as(),Vt())};let Rs=(()=>{class n{}return n.__NG_ELEMENT_ID__=PK,n})();const kK=Rs,YL=class extends kK{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Eg(this._hostTNode,this._hostLView)}get injector(){return new na(this._hostTNode,this._hostLView)}get parentInjector(){const e=Xh(this._hostTNode,this._hostLView);if(yv(e)){const t=al(e,this._hostLView),i=Pd(e);return new na(t[1].data[i+8],t)}return new na(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=XL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Yc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return ea(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],f=new YL(h,h[6],h[3]);f.detach(f.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Jh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Xp(s,o),l=i[11],c=qp(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Qd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Jh(MM(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=XL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=sy(this._lContainer,t);i&&(Hl(MM(this._lContainer),t),oy(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=sy(this._lContainer,t);return i&&null!=Hl(MM(this._lContainer),t)?new Yy(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function XL(n){return n[8]}function MM(n){return n[8]||(n[8]=[])}function KL(n,e){let t;const i=e[n.index];if(ea(i))t=i;else{let r;if(8&n.type)r=Sr(i);else{const s=e[11];r=s.createComment("");const o=eo(n,e);pl(s,qp(s,o),r,function(n,e){return dr(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=qw(i,e,r,n),ng(e,t)}return new YL(t,n,e)}const Mg={};class _3 extends El{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ui(e);return new b3(t,this.ngModule)}}function y3(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const OQ=new Ht("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>tw});class b3 extends FL{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(dA).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return y3(this.componentDef.inputs)}get outputs(){return y3(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,Mg,r);return s!==Mg||i===Mg?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(yf,Su),a=s.get(AM,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function(n,e,t){if(dr(n))return n.selectRootElement(e,t===Xt.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):ry(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),h=this.componentDef.onPush?576:528,f=function(n,e){return{components:[],scheduler:n||tw,clean:WA,playerHandler:e||null,flags:0}}(),g=tg(0,null,null,1,0,null,null,null,null,null),m=hf(null,g,f,h,null,null,o,l,a,s);let v,x;$h(m);try{const U=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Jd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(rg(l,c,!0),null!==n&&(Sp(r,n,c),null!==l.classes&&uy(r,n,l.classes),null!==l.styles&&vw(r,n,l.styles)));const u=i.createRenderer(n,e),h=hf(t,eg(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(Rc(Hs(l,t),o,e.type),Ww(o,l),wy(l,t.length,1)),ng(t,h),t[20]=h}(u,this.componentDef,m,o,l);if(u)if(i)Sp(l,u,["ng-version",jL.full]);else{const{attrs:D,classes:ie}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!La(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);D&&Sp(l,u,D),ie&&ie.length>0&&uy(l,u,ie.join(" "))}if(x=h_(g,20),void 0!==t){const D=x.projection=[];for(let ie=0;ie<this.ngContentSelectors.length;ie++){const _e=t[ie];D.push(null!=_e?Array.from(_e):null)}}v=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=as();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),Ey(n,i,e,eh(n,e,1,null),t));const r=Fd(e,n,i.directiveStart,i);Ds(r,e);const s=eo(i,e);return s&&Ds(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=as();e.contentQueries(1,o,l.directiveStart)}const a=as();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(_o(a.index),Gw(t[1],a,0,a.directiveStart,a.directiveEnd,e),$w(e,o)),o}(U,this.componentDef,m,f,[Fq]),ff(g,m,null)}finally{fi()}return new NQ(this.componentType,v,Eg(x,m),m,x)}}class NQ extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new yK(r),this.componentType=e}get injector(){return new na(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const Dg=new Map;class LQ extends Yc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new _3(this);const i=No(e),r=function(n){return n[T1]||null}(e);r&&bM(r),this._bootstrapComponents=fl(i.bootstrap),this._r3Injector=Zw(e,t,[{provide:Yc,useValue:this},{provide:El,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Hn.THROW_IF_NOT_FOUND,i=xn.Default){return e===Hn||e===Yc||e===Vu?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class UM extends class{}{constructor(e){super(),this.moduleType=e,null!==No(e)&&function(n){const e=new Set;!function t(i){const r=No(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,Dg.get(s),i),Dg.set(s,i));const o=fl(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new LQ(this.moduleType,e)}}function TE(n,e,t){const i=Cs()+n,r=Vt();return r[i]===Dn?$c(r,i,t?e.call(t):e()):function(n,e){return n[e]}(r,i)}function E3(n,e,t,i,r,s){const o=e+t;return Eo(n,o,r)?$c(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===Dn?void 0:t}(n,o+1)}function Ps(n,e){const t=Si();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Je("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Ic(i.type)),o=Ta(Ce);try{const a=Cp(!1),l=s();return Cp(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Vt(),r,l),l}finally{Ta(o)}}function To(n,e,t){const i=n+20,r=Vt(),s=Dd(r,i);return function(n,e){Ql.isWrapped(e)&&(e=Ql.unwrap(e),n[Ln.lFrame.bindingIndex]=Dn);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?E3(r,Cs(),e,s.transform,t,s):s.transform(t))}function HM(n){return e=>{setTimeout(n,void 0,e)}}const ln=class extends oe{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=HM(l),a&&(a=HM(a)),c&&(c=HM(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof C&&e.add(u),u}};function QQ(){return this._results[sg()]()}class wf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=sg(),i=wf.prototype;i[t]||(i[t]=QQ)}get changes(){return this._changes||(this._changes=new ln)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=ia(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class GM{constructor(e){this.queryList=e,this.matches=null}clone(){return new GM(this.queryList)}setDirty(){this.queryList.setDirty()}}class $M{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new $M(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==O3(e,t).matches&&this.queries[t].setDirty()}}class A3{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class WM{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new WM(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class qM{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new qM(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,eZ(t,s)),this.matchTNodeWithReadOption(e,t,kd(t,e,s,!1,!1))}else i===Go?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,kd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===gn||r===Rs||r===Go&&4&t.type)this.addMatch(t.index,-2);else{const s=kd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function eZ(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function nZ(n,e,t,i){return-1===t?function(n,e){return 11&n.type?Eg(n,e):4&n.type?wE(n,e):null}(e,n):-2===t?function(n,e,t){return t===gn?Eg(e,n):t===Go?wE(e,n):t===Rs?KL(e,n):void 0}(n,e,i):Fd(n,n[1],t,e)}function M3(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:nZ(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function YM(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=M3(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const f=u[h];f[17]===f[3]&&YM(f[1],f,c,i)}if(null!==u[9]){const h=u[9];for(let f=0;f<h.length;f++){const g=h[f];YM(g[1],g,c,i)}}}}}return i}function Gn(n){const e=Vt(),t=Si(),i=pv();__(i+1);const r=O3(t,i);if(n.dirty&&Ul(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?YM(t,e,i,[]):M3(t,e,r,i);n.reset(s,VL),n.notifyOnChanges()}return!0}return!1}function hr(n,e,t){const i=Si();i.firstCreatePass&&(I3(i,new A3(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),D3(i,Vt(),e)}function $n(){return function(n,e){return n[19].queries[e].queryList}(Vt(),pv())}function D3(n,e,t){const i=new wf(4==(4&t));Bw(n,e,i,i.destroy),null===e[19]&&(e[19]=new $M),e[19].queries.push(new GM(i))}function I3(n,e,t){null===n.queries&&(n.queries=new WM),n.queries.track(new qM(e,t))}function O3(n,e){return n.queries.getByIndex(e)}const Ef=new Ht("Application Initializer");let Og=(()=>{class n{constructor(t){this.appInits=t,this.resolve=bE,this.reject=bE,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(yg(s))t.push(s);else if(cE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ef,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const a0=new Ht("AppId"),PZ={provide:a0,useFactory:function(){return`${eD()}${eD()}${eD()}`},deps:[]};function eD(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const X3=new Ht("Platform Initializer"),Xc=new Ht("Platform ID"),IE=new Ht("appBootstrapListener");let OE=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Gu=new Ht("LocaleId"),K3=new Ht("DefaultCurrencyCode");class kZ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const tD=function(n){return new UM(n)},FZ=tD,LZ=function(n){return Promise.resolve(tD(n))},Q3=function(n){const e=tD(n),i=fl(No(n).declarations).reduce((r,s)=>{const o=Ui(s);return o&&r.push(new b3(o)),r},[]);return new kZ(e,i)},BZ=Q3,VZ=function(n){return Promise.resolve(Q3(n))};let xf=(()=>{class n{constructor(){this.compileModuleSync=FZ,this.compileModuleAsync=LZ,this.compileModuleAndAllComponentsSync=BZ,this.compileModuleAndAllComponentsAsync=VZ}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Z3=new Ht("compilerOptions"),UZ=(()=>Promise.resolve(0))();function nD(n){"undefined"==typeof Zone?UZ.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class pn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ln(!1),this.onMicrotaskEmpty=new ln(!1),this.onStable=new ln(!1),this.onError=new ln(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=Zn.requestAnimationFrame,e=Zn.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Zn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,rD(n),n.isCheckStableRunning=!0,iD(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),rD(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return J3(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),eB(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return J3(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),eB(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,rD(n),iD(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!pn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(pn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,HZ,bE,bE);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const HZ={};function iD(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function rD(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function J3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function eB(n){n._nesting--,iD(n)}class WZ{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ln,this.onMicrotaskEmpty=new ln,this.onStable=new ln,this.onError=new ln}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let sD=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{pn.assertNotInAngularZone(),nD(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())nD(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Ie(pn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),tB=(()=>{class n{constructor(){this._applications=new Map,oD.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return oD.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class qZ{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let oD=new qZ,nB=!0,iB=!1;function fa(){return iB=!0,nB}let ic;const rB=new Ht("AllowMultipleToken");function sB(n,e,t=[]){const i=`Platform: ${e}`,r=new Ht(i);return(s=[])=>{let o=lD();if(!o||o.injector.get(rB,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:ju,useValue:"platform"});!function(n){if(ic&&!ic.destroyed&&!ic.injector.get(rB,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");ic=n.get(oB);const e=n.get(X3,null);e&&e.forEach(t=>t())}(Hn.create({providers:a,name:i}))}return function(n){const e=lD();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function lD(){return ic&&!ic.destroyed?ic:null}let oB=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new WZ:("zone.js"===n?void 0:n)||new pn({enableLongStackTrace:fa(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:pn,useValue:a}];return a.run(()=>{const c=Hn.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(la,null);if(!h)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const f=a.onError.subscribe({next:g=>{h.handleError(g)}});u.onDestroy(()=>{cD(this._modules,u),f.unsubscribe()})}),function(n,e,t){try{const i=t();return yg(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,a,()=>{const f=u.injector.get(Og);return f.runInitializers(),f.donePromise.then(()=>(bM(u.injector.get(Gu,pE)||pE),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=aB({},i);return function(n,e,t){const i=new UM(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(sh);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function aB(n,e){return Array.isArray(e)?e.reduce(aB,n):Object.assign(Object.assign({},n),e)}let sh=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new O(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new O(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{pn.assertNotInAngularZone(),nD(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{pn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=Nn(a,l.pipe(ws()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof FL?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Yc),a=r.create(Hn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(sD,null),u=c&&a.injector.get(tB);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),cD(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;cD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(IE,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Ie(pn),Ie(Hn),Ie(la),Ie(El),Ie(Og))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function cD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const vJ=sB(null,"core",[{provide:Xc,useValue:"unknown"},{provide:oB,deps:[Hn]},{provide:tB,deps:[]},{provide:OE,deps:[]}]),CJ=[{provide:sh,useClass:sh,deps:[pn,Hn,la,El,Og]},{provide:OQ,deps:[pn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Og,useClass:Og,deps:[[new ts,Ef]]},{provide:xf,useClass:xf,deps:[]},PZ,{provide:xg,useFactory:function(){return CK},deps:[]},{provide:Sg,useFactory:function(){return TK},deps:[]},{provide:Gu,useFactory:function(n){return bM(n=n||"undefined"!=typeof $localize&&$localize.locale||pE),n},deps:[[new Hd(Gu),new ts,new dl]]},{provide:K3,useValue:"USD"}];let AJ=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Ie(sh))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:CJ}),n})(),zE=null;function Kc(){return zE}const fn=new Ht("DocumentToken");let Tf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:Tee,token:n,providedIn:"platform"}),n})();function Tee(){return Ie(kB)}let kB=(()=>{class n extends Tf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Kc().getBaseHref(this._doc)}onPopState(t){const i=Kc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Kc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){FB()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){FB()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({factory:Mee,token:n,providedIn:"platform"}),n})();function FB(){return!!window.history.pushState}function Mee(){return new kB(Ie(fn))}function SD(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function LB(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Wu(n){return n&&"?"!==n[0]?"?"+n:n}let Ng=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:Dee,token:n,providedIn:"root"}),n})();function Dee(n){const e=Ie(fn).location;return new BB(Ie(Tf),e&&e.origin||"")}const CD=new Ht("appBaseHref");let BB=(()=>{class n extends Ng{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return SD(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Wu(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Wu(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Wu(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Tf),Ie(CD,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),kg=(()=>{class n{constructor(t,i){this._subject=new ln,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=LB(VB(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Wu(i))}normalize(t){return n.stripTrailingSlash(function(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,VB(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._platformStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Wu(i)),r)}replaceState(t,i="",r=null){this._platformStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Wu(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ng),Ie(Tf))},n.normalizeQueryParams=Wu,n.joinWithSlash=SD,n.stripTrailingSlash=LB,n.\u0275prov=We({factory:Oee,token:n,providedIn:"root"}),n})();function Oee(){return new kg(Ie(Ng),Ie(Tf))}function VB(n){return n.replace(/\/index.html$/,"")}var ms=(()=>((ms=ms||{})[ms.Zero=0]="Zero",ms[ms.One=1]="One",ms[ms.Two=2]="Two",ms[ms.Few=3]="Few",ms[ms.Many=4]="Many",ms[ms.Other=5]="Other",ms))();const Vee=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=uL(e);if(t)return t;const i=e.split("-")[0];if(t=uL(i),t)return t;if("en"===i)return iX;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[un.PluralCase]};class ZE{}let pte=(()=>{class n extends ZE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(Vee(i||this.locale)(t)){case ms.Zero:return"zero";case ms.One:return"one";case ms.Two:return"two";case ms.Few:return"few";case ms.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Gu))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function YB(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class mte{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Yu=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=[];t.forEachOperation((r,s,o)=>{if(null==r.previousIndex){const a=this._viewContainer.createEmbeddedView(this._template,new mte(null,this._ngForOf,-1,-1),null===o?void 0:o),l=new XB(r,a);i.push(l)}else if(null==o)this._viewContainer.remove(null===s?void 0:s);else if(null!==s){const a=this._viewContainer.get(s);this._viewContainer.move(a,o);const l=new XB(r,a);i.push(l)}});for(let r=0;r<i.length;r++)this._perViewChange(i[r].view,i[r].record);for(let r=0,s=this._viewContainer.length;r<s;r++){const o=this._viewContainer.get(r);o.context.index=r,o.context.count=s,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{this._viewContainer.get(r.currentIndex).context.$implicit=r.item})}_perViewChange(t,i){t.context.$implicit=i.item}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(Ce(Rs),Ce(Go),Ce(xg))},n.\u0275dir=Nt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class XB{constructor(e,t){this.record=e,this.view=t}}let ac=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new yte,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){KB("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){KB("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(Ce(Rs),Ce(Go))},n.\u0275dir=Nt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class yte{constructor(){this.$implicit=null,this.ngIf=null}}function KB(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${rt(e)}'.`)}class Ete{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class xte{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const Ste=new xte,Cte=new Ete;let g0=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(yg(t))return Ste;if(x2(t))return Cte;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(Ce(Mr,16))},n.\u0275pipe=js({name:"async",type:n,pure:!1}),n})(),fr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[{provide:ZE,useClass:pte}]}),n})();const iV="browser";function Af(n){return n===iV}class oV{}class BD extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){zE||(zE=n)}(new BD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(m0=m0||document.querySelector("base"),m0?m0.getAttribute("href"):null);return null==t?null:function(n){ex=ex||document.createElement("a"),ex.setAttribute("href",n);const e=ex.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){m0=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return YB(document.cookie,e)}}let ex,m0=null;const aV=new Ht("TRANSITION_ID"),Xte=[{provide:Ef,useFactory:function(n,e,t){return()=>{t.get(Og).donePromise.then(()=>{const i=Kc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[aV,fn,Hn],multi:!0}];class VD{static init(){!function(n){oD=n}(new VD)}addToWindow(e){Zn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Zn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Zn.getAllAngularRootElements=()=>e.getAllRootElements(),Zn.frameworkStabilizers||(Zn.frameworkStabilizers=[]),Zn.frameworkStabilizers.push(i=>{const r=Zn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Kc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Kte=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const _0=new Ht("EventManagerPlugins");let nx=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Ie(_0),Ie(pn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class jD{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Kc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let cV=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),y0=(()=>{class n extends cV{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(uV),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(uV))}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function uV(n){Kc().remove(n)}const UD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},zD=/%COMP%/g;function ix(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?ix(n,r,t):(r=r.replace(zD,n),t.push(r))}return t}function fV(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let rx=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new HD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Xt.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new dne(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Xt.ShadowDom:return new hne(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=ix(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Ie(nx),Ie(y0),Ie(a0))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class HD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(UD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=UD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=UD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Uo.DashCase|Uo.Important)?e.style.setProperty(t,i,r&Uo.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Uo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,fV(i)):this.eventManager.addEventListener(e,t,fV(i))}}class dne extends HD{constructor(e,t,i,r){super(e),this.component=i;const s=ix(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(zD,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(zD,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class hne extends HD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=ix(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let fne=(()=>{class n extends jD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const mV=["alt","control","meta","shift"],vne={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_V={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},wne={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Ene=(()=>{class n extends jD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Kc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(mV.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&_V.hasOwnProperty(e)&&(e=_V[e]))}return vne[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),mV.forEach(s=>{s!=r&&wne[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Mf=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return Ie($D)},token:n,providedIn:"root"}),n})(),$D=(()=>{class n extends Mf{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case si.NONE:return i;case si.HTML:return sa(i,"HTML")?Gs(i):$_(this._doc,String(i)).toString();case si.STYLE:return sa(i,"Style")?Gs(i):i;case si.SCRIPT:if(sa(i,"Script"))return Gs(i);throw new Error("unsafe value used in a script context");case si.URL:return jc(i),sa(i,"URL")?Gs(i):jo(String(i));case si.RESOURCE_URL:if(sa(i,"ResourceURL"))return Gs(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function(n){return new L_(n)}(t)}bypassSecurityTrustStyle(t){return function(n){return new B_(n)}(t)}bypassSecurityTrustScript(t){return function(n){return new jp(n)}(t)}bypassSecurityTrustUrl(t){return function(n){return new Wd(n)}(t)}bypassSecurityTrustResourceUrl(t){return function(n){return new kn(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({factory:function(){return function(n){return new $D(n.get(fn))}(Ie(Vu))},token:n,providedIn:"root"}),n})();const Ine=sB(vJ,"browser",[{provide:Xc,useValue:iV},{provide:X3,useValue:function(){BD.makeCurrent(),VD.init()},multi:!0},{provide:fn,useFactory:function(){return function(n){Yi=n}(document),document},deps:[]}]),One=[[],{provide:ju,useValue:"root"},{provide:la,useFactory:function(){return new la},deps:[]},{provide:_0,useClass:fne,multi:!0,deps:[fn,pn,Xc]},{provide:_0,useClass:Ene,multi:!0,deps:[fn]},[],{provide:rx,useClass:rx,deps:[nx,y0,a0]},{provide:yf,useExisting:rx},{provide:cV,useExisting:y0},{provide:y0,useClass:y0,deps:[fn]},{provide:sD,useClass:sD,deps:[pn]},{provide:nx,useClass:nx,deps:[_0,pn]},{provide:oV,useClass:Kte,deps:[]},[]];let WD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:a0,useValue:t.appId},{provide:aV,useExisting:a0},Xte]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:One,imports:[fr,AJ]}),n})();"undefined"!=typeof window&&window;class Vne extends C{constructor(e,t){super()}schedule(e,t=0){return this}}class sx extends Vne{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let bV=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class cc extends bV{constructor(e,t=bV.now){super(e,()=>cc.delegate&&cc.delegate!==this?cc.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return cc.delegate&&cc.delegate!==this?cc.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const zne=new class extends cc{}(class extends sx{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Qc=new O(n=>n.complete());function b0(n){return n?function(n){return new O(e=>n.schedule(()=>e.complete()))}(n):Qc}function sn(...n){let e=n[n.length-1];return Te(e)?(n.pop(),ke(n,e)):In(n)}function Fg(n,e){return new O(e?t=>e.schedule(Gne,0,{error:n,subscriber:t}):t=>t.error(n))}function Gne({error:n,subscriber:e}){e.error(n)}class ga{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return sn(this.value);case"E":return Fg(this.error);case"C":return b0()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new ga("N",e):ga.undefinedValueNotification}static createError(e){return new ga("E",void 0,e)}static createComplete(){return ga.completeNotification}}ga.completeNotification=new ga("C"),ga.undefinedValueNotification=new ga("N",void 0);class ox extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(ox.dispatch,this.delay,new Wne(e,this.destination)))}_next(e){this.scheduleMessage(ga.createNext(e))}_error(e){this.scheduleMessage(ga.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(ga.createComplete()),this.unsubscribe()}}class Wne{constructor(e,t){this.notification=e,this.destination=t}}class Df extends oe{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new qne(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new $;if(this.isStopped||this.hasError?o=C.EMPTY:(this.observers.push(e),o=new Z(this,e)),r&&e.add(e=new ox(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||zne).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class qne{constructor(e,t){this.time=e,this.value=t}}function is(n,e){return"function"==typeof e?t=>t.pipe(is((i,r)=>je(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new Yne(n))}class Yne{constructor(e){this.project=e}call(e,t){return t.subscribe(new Xne(e,this.project))}}class Xne extends we{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new _t(this),r=this.destination;r.add(i),this.innerSubscription=N(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const ax={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return ax.schedule(n,0);if(void 0===window.requestAnimationFrame)return ax.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let YD;function sie(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!YD){const t=Element.prototype;YD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&YD.call(n,e)}(n,r)||(i=s,0))),i}class aie{constructor(e,t){this.componentFactory=t.get(El).resolveComponentFactory(e)}create(e){return new lie(this.componentFactory,e)}}class lie{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new Df(1),this.events=this.eventEmitters.pipe(is(i=>Nn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(pn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=ax.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=Hn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=sie(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(Mr),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(sh).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(me(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=ax.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new c_(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class cie extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const die={initialConfig:{},parse:{},rename:{}};class hie{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},die),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,u=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(u)try{i[l]=u(c)}catch(h){console.warn(`Failed to parse ${e} = ${c}`,h.message)}else i[l]=c}}let fie=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new hie(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=Nt({type:n,features:[Fi]}),n})();const XD={boolean:n=>"false"!=`${n}`,json:n=>"string"==typeof n?JSON.parse(n):n,function:n=>{if("function"!=typeof n)throw new Error("Expected a javascript function");return n}};var KD;const If={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://r5i95k35v5.us-east-2.awsapprunner.com/v1/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/ccf-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"",hubmapPortalUrl:"",hubmapDataUrl:"",hubmapAssetsUrl:"",hubmapToken:null!==(KD=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==KD?KD:"",useRemoteApi:!1,remoteApiEndpoint:"https://r5i95k35v5.us-east-2.awsapprunner.com/v1"},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function Ei(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function wV(n,e){return function(t,i){e(t,i,n)}}function uc(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Bi(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function SV(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function ZD(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||SV()}const CV="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",cx=ZD();class _ie{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function JD(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const TV={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function AV(n){return"string"==typeof n?TV[n.toUpperCase()]||TV.WHITE:n}function ux(n,e){if(!n)throw new Error(e||"Assertion failed")}const dc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},v0=dc.window||dc.self||dc.global,MV=dc.process||{};function Lg(){let n;if(cx&&v0.performance)n=v0.performance.now();else if(MV.hrtime){const e=MV.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const Bg={debug:cx&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Sie={enabled:!0,level:0};function Al(){}const DV={},IV={once:!0};function Cie(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let eI=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=CV,this._startTs=Lg(),this._deltaTs=Lg(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new _ie("__probe-".concat(this.id,"__"),Sie),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Lg()-this._startTs).toPrecision(10))}getDelta(){return Number((Lg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){ux(t,i)}warn(t){return this._getLogFunction(0,t,Bg.warn,arguments,IV)}error(t){return this._getLogFunction(0,t,Bg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,Bg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,Bg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,Bg.debug||Bg.info,arguments,IV)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||Al,r&&[r],{tag:Cie(i)}):Al}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?cx?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=JD(r,e,t);console.log(...s)},r.src=n,Al}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...JD(n,e,t)),Al;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...JD(r,e,t)),r.src=n.toDataURL(),Al}return Al}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=et(5307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):Al}({image:r,message:s,scale:o}):Al}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||Al)}group(t,i,r={collapsed:!1}){r=RV({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Al)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=OV(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=RV({logLevel:t,message:i,args:s,opts:o}),ux(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Lg();const a=o.tag||o.message;if(o.once){if(DV[a])return Al;DV[a]=Lg()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!cx&&"string"==typeof n&&(e&&(e=AV(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=AV(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return Al}}return n.VERSION=CV,n})();function OV(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return ux(Number.isFinite(e)&&e>=0),e}function RV(n){const{logLevel:e,message:t}=n;n.logLevel=OV(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return ux("string"===r||"object"===r),Object.assign(n,n.opts)}const Ri=new eI({id:"deck"}),Vi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Vi,"IDENTITY",{get:()=>Ri.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Zc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},PV={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},mn=new eI({id:"luma.gl"});function qo(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function dx(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function Ci(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function hx(n){return qo(dx(n),"Invalid WebGLRenderingContext"),n}function Ao(n){return qo(Ci(n),"Requires WebGL2"),n}const w0={};const E0=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(E0.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Of=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(w0[i]=!0)}while(0!==i);for(i in w0)if(w0[i])return delete w0[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const h=t.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const f=h.attribs[s];return f.buffer=t.currentArrayBuffer,f.size=o,f.type=a,f.normalized=l,f.stride=c,f.offset=u,f.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Of.prototype.VERTEX_ARRAY_BINDING_OES=34229,Of.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new E0(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Of.prototype.createVertexArrayOES=function(){const e=new E0(this);return this.vertexArrayObjects.push(e),e},Of.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Of.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof E0&&e.hasBeenBound&&e.ext===this)},Of.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){w0[n]=!0,void 0!==e&&function(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let h=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),h=!0),(h||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const NV="OES_element_index",kV="WEBGL_draw_buffers",FV="WEBGL_debug_renderer_info",br=n=>Ci(n)?void 0:0,Wie={3074:n=>Ci(n)?void 0:36064,35723:n=>Ci(n)?void 0:4352,35977:br,32937:br,36795:(n,e)=>{const t=Ci(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(FV);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(FV);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:br,35071:br,37447:br,36063:(n,e)=>{if(!Ci(n)){const t=n.getExtension(kV);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:br,35374:br,35377:br,34852:n=>{if(!Ci(n)){const e=n.getExtension(kV);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(NV)?2147483647:65535,33001:n=>n.getExtension(NV)?16777216:65535,33e3:n=>16777216,37157:br,35373:br,35657:br,36183:br,37137:br,34045:br,35978:br,35979:br,35968:br,35376:br,35375:br,35659:br,37154:br,35371:br,35658:br,35076:br,35077:br,35380:br},LV="ANGLE_instanced_arrays",BV={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{qo(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[LV]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){qo(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{qo(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{qo(!1)},deleteQuery:()=>{qo(!1)},beginQuery:()=>{qo(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},tI={readBuffer:(n,e,t)=>{Ci(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:Ci(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!Ci(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!Ci(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=Wie[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function rre(n,{extension:e,target:t,target2:i}){const r=BV[e];qo(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let u=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?u=(...h)=>a[c](...h):"function"==typeof r[l]&&(u=r[l].bind(t))),u&&(t[l]=u,i[l]=u)}}globalThis.polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Of(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&rre(n,{extension:t,target:n.luma,target2:n})}(n,BV),function(n,{target:e,target2:t}){Object.keys(tI).forEach(i=>{if("function"==typeof tI[i]){const r=n[i]?n[i].bind(n):()=>{},s=tI[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const nI={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},lh=(n,e,t)=>e?n.enable(t):n.disable(t),VV=(n,e,t)=>n.hint(t,e),ja=(n,e,t)=>n.pixelStorei(t,e);function x0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const are={3042:lh,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:lh,2885:(n,e)=>n.cullFace(e),2929:lh,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:lh,35723:VV,36006:(n,e)=>{const t=Ci(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:VV,2849:(n,e)=>n.lineWidth(e),32823:lh,32824:"polygonOffset",10752:"polygonOffset",35977:lh,32938:"sampleCoverage",32939:"sampleCoverage",3089:lh,3088:(n,e)=>n.scissor(...e),2960:lh,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:ja,3317:ja,37440:ja,37441:ja,37443:ja,3330:ja,3332:ja,3331:ja,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:ja,32878:ja,3316:ja,3315:ja,32877:ja,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=x0(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=x0(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=x0(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=x0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=x0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function rs(n,e,t){return void 0!==e[n]?e[n]:t[n]}const lre={blendEquation:(n,e,t)=>n.blendEquationSeparate(rs(32777,e,t),rs(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(rs(32969,e,t),rs(32968,e,t),rs(32971,e,t),rs(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(rs(32824,e,t),rs(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(rs(32938,e,t),rs(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,rs(2962,e,t),rs(2967,e,t),rs(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,rs(34816,e,t),rs(36003,e,t),rs(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,rs(2964,e,t),rs(2965,e,t),rs(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,rs(34817,e,t),rs(34818,e,t),rs(34819,e,t))},jV={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Jc=(n,e)=>n.isEnabled(e),UV={3042:Jc,2884:Jc,2929:Jc,3024:Jc,32823:Jc,32926:Jc,32928:Jc,3089:Jc,2960:Jc,35977:Jc};function zV(n){for(const e in n)return!1;return!0}function cre(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function HV(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache&&n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function ure(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class hre{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||nI)){const r=e,s=UV[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=UV[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},nI),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){qo(this.stateStack.length>0),Xu(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){qo(void 0!==s);const o=e[s],a=this.cache[s];cre(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function GV(n,e={}){const{enable:t=!0,copyState:i}=e;if(qo(void 0!==i),!n.state){const{polyfillContext:r}=globalThis;r&&r(n),n.state=new hre(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const s in jV)ure(n,s,jV[s]);HV(n,"getParameter"),HV(n,"isEnabled")}return n.state.enable=t,n}function $V(n){qo(n.state),n.state.pop()}function Xu(n,e){if(qo(dx(n),"setParameters requires a WebGL context"),zV(e))return;const t={};for(const r in e){const s=Number(r),o=are[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)lre[r](n,e,i)}function hc(n,e,t){if(zV(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||GV(n,{copyState:!1}),n.state.push()}(n),Xu(n,e),i)r=t(n),$V(n);else try{r=t(n)}finally{$V(n)}return r}function fx(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}()}function Vg(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function iI(n,e,t=!0){return function(n,e,t,i,r){const s=WV(n[0],e,t);let o=qV(n[1],e,i,r),a=WV(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=qV(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,Vg(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function WV(n,e,t){return Math.min(Math.round(n*e),t-1)}function qV(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const rI=fx(),bre=rI&&"undefined"!=typeof document,YV={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function XV(n={}){qo(rI,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},YV,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(bre&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=sI(r,n),function(n){const e=Ci(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);mn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function sI(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},YV,e);const{manageState:t,debug:i}=e;return t&&GV(n,{copyState:!1,log:(...r)=>mn.log(1,...r)()}),rI&&i&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),mn.level=Math.max(mn.level,1)):mn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function KV(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class QV{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=KV(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(KV()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class oI{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof QV?e:new QV(t,i)),this.stats[t]}}const S0="8.5.12",Rf=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new oI({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==S0)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${S0}`);function on(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function aI(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return on(void 0!==i,`Accessing undefined constant GL.${e}`),i}function ch(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}globalThis.luma||(fx()&&mn.log(1,`luma.gl ${S0} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=globalThis.luma||{VERSION:S0,version:S0,log:mn,stats:Rf,globals:{modules:{},nodeIO:{}}}),globalThis;const lI={};function ma(n="id"){return lI[n]=lI[n]||1,`${n}-${lI[n]++}`}function ZV(n){return on("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function jg(n){let e=!0;for(const t in n){e=!1;break}return e}function JV(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw mn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Ug="Resource subclass must define virtual methods";class Ku{get[Symbol.toStringTag](){return"Resource"}constructor(e,t={}){hx(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||ma(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){on(e=aI(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=Ci(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=Ci(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const h=i?ch(this.gl,l):l;o[h]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[h]=ch(this.gl,o[h]))}}return o}setParameter(e,t){on(e=aI(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=Ci(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=aI(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return JV(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Ug)}_deleteHandle(){throw new Error(Ug)}_bindHandle(e){throw new Error(Ug)}_getOptsFromHandle(){throw new Error(Ug)}_getParameter(e,t){throw new Error(Ug)}_setParameter(e,t){throw new Error(Ug)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=Rf.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Rf.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const i=Rf.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=Rf.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function cI(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function C0(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Ore({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function uI(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&mn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&mn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];mn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Rre={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Pre={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class _a{static getBytesPerElement(e){return C0(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return on(e.size),C0(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new _a(...[Rre,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return _a.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return _a.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=uI("Accessor",e,Pre)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const tj={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Nre={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:tj},kre={removedProps:tj};class lr extends Ku{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/_a.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/_a.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=uI("Buffer",e,Nre),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=uI("Buffer",e,kre))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new _a(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;on(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Ao(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return Ao(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){Ao(this.gl);const s=C0(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return on((r=r||u)<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(on(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){on(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=cI(e);return on(s),this.setAccessor(new _a(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){on(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/C0(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new _a(this.accessor,{type:cI(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return mn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return mn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return mn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return mn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new _a(this.accessor,e),this}}const dI={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},nj={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},ij={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},Bre=[9729,9728],rj=globalThis.WebGLBuffer||function(){};class Pf extends Ku{get[Symbol.toStringTag](){return"Texture"}static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=dI[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=Ci(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=dI[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=ma("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(D=>this.initialize(Object.assign({},e,{pixels:D,data:D}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:h,height:f,dataFormat:g,type:m,compressed:v=!1,mipmaps:x=!0}=e;const{depth:U=0}=e;return({width:h,height:f,compressed:v,dataFormat:g,type:m}=this._deduceParameters({format:s,type:m,dataFormat:g,compressed:v,data:t,width:h,height:f})),this.width=h,this.height=f,this.depth=U,this.format=s,this.type=m,this.dataFormat=g,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),x&&this._isNPOT()&&(mn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),x=!1,this._updateForNPOT(l)),this.mipmaps=x,this.setImageData({data:t,width:h,height:f,depth:U,format:s,type:m,dataFormat:g,border:o,mipmaps:x,parameters:c,compressed:v}),x&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(mn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),hc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:h=this.width,height:f=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=e;c||(c=i),({type:u,dataFormat:g,compressed:m,width:h,height:f}=this._deduceParameters({format:s,type:u,dataFormat:g,compressed:m,data:c,width:h,height:f}));const{gl:v}=this;v.bindTexture(this.target,this.handle);let x=null;({data:c,dataType:x}=this._getDataType({data:c,compressed:m}));let U,D=0;return hc(this.gl,l,()=>{switch(x){case"null":v.texImage2D(t,r,s,h,f,o,g,u,c);break;case"typed-array":v.texImage2D(t,r,s,h,f,o,g,u,c,a);break;case"buffer":U=Ao(v),U.bindBuffer(35052,c.handle||c),U.texImage2D(t,r,s,h,f,o,g,u,a),U.bindBuffer(35052,null);break;case"browser-object":Ci(v)?v.texImage2D(t,r,s,h,f,o,g,u,c):v.texImage2D(t,r,s,g,u,c);break;case"compressed":for(const[ie,_e]of c.entries())v.compressedTexImage2D(t,ie,_e.format,_e.width,_e.height,o,_e.data),D+=_e.levelSize;break;default:on(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===x?D:c&&c.byteLength?c.byteLength:this.width*this.height*(nj[this.dataFormat]||4)*(ij[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:g=0,border:m=this.border,parameters:v={}}){if(({type:u,dataFormat:h,compressed:f,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:f,data:i,width:o,height:a})),on(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const x=i;i=x.data,o=x.shape[0],a=x.shape[1]}i instanceof lr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),hc(this.gl,v,()=>{if(f)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,h,u,i,g);else if(i instanceof rj){const x=Ao(this.gl);x.bindBuffer(35052,i),x.texSubImage2D(e,l,r,s,o,a,h,u,g),x.bindBuffer(35052,null)}else Ci(this.gl)?Ao(this.gl).texSubImage2D(e,l,r,s,o,a,h,u,i):this.gl.texSubImage2D(e,l,r,s,h,u,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return mn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof lr?{data:e.handle,dataType:"buffer"}:e instanceof rj?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=dI[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},on(r,"Could not deduced texture size"),on(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),on(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:on(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(Ci(this.gl)||!this.width||!this.height||ZV(this.width)&&ZV(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===Bre.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function Vre(n,e){return on("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class ya extends Pf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Pf.isSupported(e,t)}constructor(e,t={}){hx(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:Vre(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Nf="EXT_color_buffer_float",sj={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Nf,bpp:2},33327:{gl2:Nf,bpp:4},34842:{gl2:Nf,bpp:8},33326:{gl2:Nf,bpp:4},33328:{gl2:Nf,bpp:8},34836:{gl2:Nf,bpp:16},35898:{gl2:Nf,bpp:4}};class zg extends Ku{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=Ci(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,sj)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return on(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&Ci(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*sj[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const uj="clear: bad arguments";function fI(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),on(0!==o,uj),hc(n,s,()=>{n.clear(o)})}function dj(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function li(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){dj(s,i,r,o,a,"next",l)}function a(l){dj(s,i,r,o,a,"throw",l)}o(void 0)})}}const pI=[34069,34070,34071,34072,34073,34074];let Wre=(()=>{class n extends Pf{get[Symbol.toStringTag](){return"TextureCube"}constructor(t,i={}){hx(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return li(function*(){const{gl:u}=c,h=r||s,f=yield Promise.all(pI.map(g=>{const m=h[g];return Promise.all(Array.isArray(m)?m:[m])}));c.bind(),pI.forEach((g,m)=>{f[m].length>1&&!1!==c.opts.mipmaps&&mn.warn(`${c.id} has mipmap and multiple LODs.`)(),f[m].forEach((v,x)=>{t&&i?u.texImage2D(g,x,a,t,i,o,a,l,v):u.texImage2D(g,x,a,a,l,v)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:h}=this,f=o||a;return this.bind(),f instanceof Promise?f.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?h.texImage2D(i,0,c,r,s,l,c,u,f):h.texImage2D(i,0,c,c,u,f),this}}return n.FACES=pI,n})();class qre extends Pf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Ci(e)}constructor(e,t={}){Ao(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),hc(this.gl,h,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,u),u instanceof lr&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*this.depth*(nj[this.dataFormat]||4)*(ij[this.type]||1),"Texture"),this.loaded=!0,this}}function hj(n,e){on(n instanceof ya||n instanceof Wre||n instanceof qre);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e))}function Yre(n,e){const{gl:t,width:i,height:r,id:s}=n;return new ks(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function px(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=T0(n);on(u);const{gl:f,handle:g,attachments:m}=u;a=a||u.width,l=l||u.height,36064===s&&null===g&&(s=1028),on(m[s]),c=c||m[s].type,o=function(n,e,t,i,r){if(n)return n;return new(C0(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return on(!1),0}}(t))}(o,c,r,a,l),c=c||cI(o);const v=f.bindFramebuffer(36160,g);return f.readPixels(t,i,a,l,r,c,o),f.bindFramebuffer(36160,v||null),h&&u.delete(),o}function gI(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=px(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Ore({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}function T0(n){return n instanceof ks?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:Yre(n),deleteFramebuffer:!0}}const fj="Multiple render targets not supported";class ks extends Ku{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new ks(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ao(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ao(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(on(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const u in i){const h=i[u];(Array.isArray(h)?h[0]:h).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return on(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&mn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){on(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof zg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,h=0,f=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:h,level:f})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(ks.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&fI(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){Ao(n),hc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:on(!1,uj)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return mn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return mn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return mn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return mn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return mn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return mn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=Ao(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=ch(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?ch(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?ch(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(gI(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>mn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=gI(this,{targetMaxHeight:100});return mn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new ya(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new zg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new zg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&on(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof zg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Ao(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:on(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return Ci(n)?n:null}(this.gl);t?t.readBuffer(e):on(36064===e||1029===e,fj),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Ao(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):on(1===e.length&&(36064===e[0]||1029===e[0]),fj)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in pj)void 0===n.luma.caps[e]&&(n.luma.caps[e]=mj(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}ks.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const pj={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new ya(n,{format:6408,type:5126,dataFormat:6408}),t=new ks(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function mI(n,e){return gj(n,e)}function gj(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>mj(n,t))}function mj(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=pj[e];let i;on(t,e);const r=Ci(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:on(!1);return i}(n,e)),n.luma.caps[e]||mn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class _I{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ot(ot({},this.source.getAccessor()),this.opts)}}const A0=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h;l&&(h=l*i+s);const f=this._allocate(c,u,a,h);return e&&o?f.set(e):a||f.fill(0,0,4),this._release(e),f}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},ose=1/Math.PI*180,ase=1/180*Math.PI,Dr={};function cse(n,{precision:e=Dr.precision||4}={}){return n=function(n){return Math.round(n/Dr.EPSILON)*Dr.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function uh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Qu(n,e,t){if(uh(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function _j(n){return function(n,e){return Qu(n,t=>t*ase,void 0)}(n)}function dse(n){return function(n,e){return Qu(n,t=>t*ose,void 0)}(n)}function Ua(n,e,t){return Qu(n,i=>Math.max(e,Math.min(t,i)))}function gx(n,e,t){return uh(n)?n.map((i,r)=>gx(i,e[r],t)):t*e+(1-t)*n}function M0(n,e,t){const i=Dr.EPSILON;t&&(Dr.EPSILON=t);try{if(n===e)return!0;if(uh(n)&&uh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!M0(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Dr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Dr.EPSILON=i}}function Zu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Dr.EPSILON=1e-12,Dr.debug=!1,Dr.precision=4,Dr.printTypes=!1,Dr.printDegrees=!1,Dr.printRowMajor=!0;class mx extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Zu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:uh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Dr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+cse(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!M0(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Dr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function nr(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function _x(n,e,t=""){if(Dr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const yj={};function yI(n,e){yj[n]||(yj[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class _se extends mx{get ELEMENTS(){return Zu(!1),0}copy(e){return Zu(!1),this}get x(){return this[0]}set x(e){this[0]=nr(e)}get y(){return this[1]}set y(e){this[1]=nr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return nr(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return nr(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Zu(e>=0&&e<this.ELEMENTS,"index is out of range"),nr(this[e])}setComponent(e,t){return Zu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var eu=1e-6,ba="undefined"!=typeof Float32Array?Float32Array:Array;function bj(){var n=new ba(3);return ba!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function vj(n,e,t){var i=new ba(3);return i[0]=n,i[1]=e,i[2]=t,i}function wj(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function D0(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function bI(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function vI(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function Ej(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,h=s*a-i*c,f=i*l-r*a,g=r*f-s*h,m=s*u-i*f,v=i*h-r*u,x=2*t[3];return h*=x,f*=x,m*=2,v*=2,n[0]=a+(u*=x)+(g*=2),n[1]=l+h+m,n[2]=c+f+v,n}function xj(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Sj(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Cj(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Tj(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&wj(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function Aj(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}bj();const wI=[0,0,0],Mj={};class Mo extends _se{static get ZERO(){return Mj.ZERO=Mj.ZERO||Object.freeze(new Mo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&uh(e)?this.copy(e):(Dr.debug&&(nr(e),nr(t),nr(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Dr.debug&&(nr(e.x),nr(e.y),nr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=nr(e)}angle(e){return Tj(this,e)}cross(e){return D0(this,this,e),this.check()}rotateX({radians:e,origin:t=wI}){return xj(this,this,t,e),this.check()}rotateY({radians:e,origin:t=wI}){return Sj(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=wI}){return Cj(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return bI(this,this,e),this.check()}transformAsVector(e){return Aj(this,this,e),this.check()}transformByMatrix3(e){return vI(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return Ej(this,this,e),this.check()}}const Dj=new Mo;function Hg(n,e,t,i){Dj.set(n,e,t);const r=Dj.len();return{distance:i/r,normal:new Mo(-n/r,-e/r,-t/r)}}function Ise(n){return n-Math.fround(n)}let O0;function EI(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;O0=A0.allocate(O0,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];O0[o+a]=l,O0[o+a+e]=Ise(l)}o+=2*e}return O0.subarray(0,r*e*2)}function yx(n){return n.stride||n.size*n.bytesPerElement}function Ij(n,e){e.offset&&Ri.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=yx(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return Sn(ot({},e),{offset:s,stride:t})}function fc(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const Oj=[],Rj=[];function bx(n,e=0,t=1/0){let i=Oj;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(Rj.length=n.length,i=Rj):i=Oj,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function Pj(n){return n&&n[Symbol.asyncIterator]}function xI(n,e=(()=>!0)){return Array.isArray(n)?Nj(n,e,[]):e(n)?[n]:[]}function Nj(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?Nj(r,e,t):e(r)&&t.push(r)}return t}function Nse({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const kse=[],vx=[[0,1/0]];function SI({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let u=0;u<r;u++)e[t+l]=c[u]||0,l++}}const Bse={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function kj(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ot(ot(ot({},Bse[n.type]),e),n)):null}function Fj(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Lj(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function Bj(n){n.push(n.shift())}function CI(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function Vj({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,h=CI(t,e),f=t.state.constant;if(!u&&i>=h)return;const g=f?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!f){const U=s;s=(D,ie)=>t._normalizeConstant(U(D,ie))}const m=f?(U,D)=>s(g,D):(U,D)=>s(g.subarray(U,U+a),D),v=n.getData({length:i}),x=new Float32Array(h);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return SI({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,h)=>i(u+a,h)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const h=r[u]*t,f=s[u]*t;SI({source:n.subarray(o,h),target:e,start:a,end:f,size:t,getData:l}),o=h,a=f}a<e.length&&SI({source:[],target:e,start:a,size:t,getData:l})})({source:v,target:x,sourceStartIndices:r,targetStartIndices:c,size:a,getData:m}),n.byteLength<x.byteLength+l&&n.reallocate(x.byteLength+l),n.subData({data:x,offset:l})}class TI extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&mI(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new lr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*yx(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),A0.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=Ij(n,e);return{high:t,low:Sn(ot({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new _I(this,s.high),i["".concat(e,"64Low")]=r?new _I(this,s.low):new Float32Array(this.size),i}if(t){const i=Ij(this.getAccessor(),t);return{[e]:new _I(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof lr&&(e={buffer:e});const i=ot(ot({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=yx(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=yx(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=EI(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?EI(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=A0.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?EI(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Ri.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:vx,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return kj(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===vx||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=vx}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=kse}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==vx}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,f=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:f})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(fc(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(u,{index:h,target:f})=>{if(!r){const x=h*a+l;for(let U=0;U<e;U++)f[U]=n[x+U];return f}const g=r[h],m=r[h+1]||c;let v;if(s){v=new Array(m-g);for(let x=g;x<m;x++){const U=x*a+l;f=new Array(e);for(let D=0;D<e;D++)f[D]=n[U+D];v[x-g]=f}}else if(a===e)v=n.subarray(g*e+l,m*e+l);else{v=new n.constructor((m-g)*e);let x=0;for(let U=g;U<m;U++){const D=U*a+l;for(let ie=0;ie<e;ie++)v[x++]=n[D+ie]}}return v}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:f,transform:g}=a,m=l.binaryAccessor||("function"==typeof f?f:s[f]);fc("function"==typeof m,'accessor "'.concat(f,'" is not a function'));let v=e.getVertexOffset(i);const{iterable:x,objectInfo:U}=bx(t,i,r);for(const D of x){U.index++;let ie=m(D,U);if(g&&(ie=g.call(this,ie)),h){const _e=(U.index<h.length-1?h[U.index+1]:o)-h[U.index];if(ie&&Array.isArray(ie[0])){let Pe=v;for(const Ne of ie)e._normalizeValue(Ne,c,Pe),Pe+=u}else ie&&ie.length>u?c.set(ie,v):(e._normalizeValue(ie,U.target,0),Nse({target:c,source:U.target,start:v,count:_e}));v+=_e*u}else e._normalizeValue(ie,c,v),v+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let AI={};function Do(n){Ri.level>0&&AI[n]&&AI[n].call(...arguments)}function za(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const jj="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Use=`#version 300 es\n${jj}`;function Uj(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function zj(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?Use:e>300?`#version ${e}\n${jj}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return za(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class Hj extends Ku{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Ci(e)}constructor(e,t={}){Ao(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,jg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,mn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof lr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class $se{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof lr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&on(Ci(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new Hj(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],on(i[s]instanceof lr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new lr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function Gj(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const R0="vs",Yse={[R0]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},wx="__LUMA_INJECT_DECLARATIONS__",$j=/void\s+main\s*\([^)]*\)\s*\{\n?/,Wj=/}\n?[^{}]*$/,DI=[];function qj(n,e,t,i=!1){const r=e===R0;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),DI.length=o.length;for(let l=0,c=o.length;l<c;++l)DI[l]=o[l].injection;const a=`${DI.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(wx,a));break;case"vs:#main-start":r&&(n=n.replace($j,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(Wj,l=>a+l));break;case"fs:#decl":r||(n=n.replace(wx,a));break;case"fs:#main-start":r||(n=n.replace($j,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(Wj,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(wx,""),i&&(n=n.replace(/\}\s*$/,s=>s+Yse[e])),n}function II(n){const e={};return za(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const Xse={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},Ex="transform_uSize_",Yj="transform_position";const ioe={10241:9728,10240:9728,10242:33071,10243:33071};class soe{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap)a[h]=i[this.samplerTextureMap[h]];this._setSourceTextureParameters();const u=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${Ex}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${Ex}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=px(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return za(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof ya)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new lr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new ks(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(ioe)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=hj(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const u=l.split("\n"),h=u.slice();if(u.forEach((f,g,m)=>{if(s>0){const v=function(n,e){const t={},i=function(n){return Uj(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${Ex}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),h=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return za(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":h},samplerTextureMap:t}}return null}(f,e);if(v){const{updatedLine:x,inject:U}=v;h[g]=x,c=II([c,U]),Object.assign(a,v.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=Uj(n,["varying","out"]);return t&&t.name===e?t.type:null}(f,t))}),t){on(i);const f=`${Ex}${t}`;c=II([c,{"vs:#decl":`uniform vec2 ${f};\n`,"vs:#main-start":`     vec2 ${Yj} = transform_getPos(${f});\n     gl_Position = vec4(${Yj}, 0, 1.);\n`}])}l=h.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=II([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||zj({version:Gj(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Xse].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const OI={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function aoe(n){let e=Xj(n);return"object"===e?n?"type"in n?Object.assign({},n,OI[n.type]):"value"in n?(e=Xj(n.value),Object.assign({type:e},n,OI[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},OI[e])}function Xj(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class RI{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}){za("string"==typeof e),this.name=e,this.vs=t||u,this.fs=i||h,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=aoe(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:za(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&za(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function doe(n){return function(n){const e={},t={};return PI({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(Qj(n))}function PI({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&PI({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function Qj(n,e){return n.map(t=>(t instanceof RI||(za("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),za(t.name,"shader module has no name"),(t=new RI(t)).dependencies=Qj(t.dependencies)),t))}const NI={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},kf={};function boe(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(NI).forEach(n=>{kf[n]=n});const kI={};function Zj(n,e,t={}){const i=NI[e];if(za(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in kI)return kI[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),kI[e]=l,l}function xx(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=NI[e];za(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return za(!1===r||!0===r),r}(n,t))}function Gg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const Jj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],xoe=[...Jj,[Gg("attribute"),"in $1"],[Gg("varying"),"out $1"]],Soe=[...Jj,[Gg("varying"),"in $1"]],eU=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Coe=[...eU,[Gg("in"),"attribute $1"],[Gg("out"),"varying $1"]],Toe=[...eU,[Gg("in"),"varying $1"]],FI="gl_FragColor",LI=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Aoe=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Sx(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const Ooe=`\n\n${wx}\n\n`,tU={[R0]:"vertex",fs:"fragment"};function nU(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){za("string"==typeof t,"shader source must be a string");const h=i===R0,f=t.split("\n");let g=100,m="",v=t;0===f[0].indexOf("#version ")?(g=300,m=f[0],v=f.slice(1).join("\n")):m=`#version ${g}`;const x={};r.forEach(Ne=>{Object.assign(x,Ne.getDefines())}),Object.assign(x,s);let U=c?`${m}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${tU[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${tU[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:boe(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return xx(n,kf.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),xx(n,kf.GLSL_DERIVATIVES)&&Zj(n,kf.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),xx(n,kf.GLSL_FRAG_DATA)&&Zj(n,kf.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),xx(n,kf.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(x)}\n${h?"":"precision highp float;\n\n"}\n`:`${m}\n`;const D=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),ie={},_e={},Pe={};for(const Ne in a){const Ve="string"==typeof a[Ne]?{injection:a[Ne],order:0}:a[Ne],bt=Ne.match(/^(v|f)s:(#)?([\w-]+)$/);if(bt){const At=bt[3];bt[2]?"decl"===At?_e[Ne]=[Ve]:Pe[Ne]=[Ve]:ie[Ne]=[Ve]}else Pe[Ne]=[Ve]}for(const Ne of r){u&&Ne.checkDeprecations(v,u),U+=Ne.getModuleSource(i,g);const bt=Ne.injections[i];for(const xt in bt){const At=xt.match(/^(v|f)s:#([\w-]+)$/);if(At){const Wt="decl"===At[2]?_e:Pe;Wt[xt]=Wt[xt]||[],Wt[xt].push(bt[xt])}else ie[xt]=ie[xt]||[],ie[xt].push(bt[xt])}}return U+=Ooe,U=qj(U,i,_e),U+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(D[i],ie),U+=v,U=qj(U,i,Pe),U=function(n,e,t){switch(e){case 300:return t?Sx(n,xoe):function(n){const e=(n=Sx(n,Soe)).match(LI);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${FI}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(Aoe,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${FI}\\b`,"g"),t)}return n}(n);case 100:return t?Sx(n,Coe):function(n){const e=(n=Sx(n,Toe)).match(LI);if(e){const t=e[1];n=n.replace(LI,"").replace(new RegExp(`\\b${t}\\b`,"g"),FI)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(U,l?100:g,h),U}function Noe(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const joe={5126:Ir.bind(null,"uniform1fv",Ha,1,Io),35664:Ir.bind(null,"uniform2fv",Ha,2,Io),35665:Ir.bind(null,"uniform3fv",Ha,3,Io),35666:Ir.bind(null,"uniform4fv",Ha,4,Io),5124:Ir.bind(null,"uniform1iv",dh,1,Io),35667:Ir.bind(null,"uniform2iv",dh,2,Io),35668:Ir.bind(null,"uniform3iv",dh,3,Io),35669:Ir.bind(null,"uniform4iv",dh,4,Io),35670:Ir.bind(null,"uniform1iv",dh,1,Io),35671:Ir.bind(null,"uniform2iv",dh,2,Io),35672:Ir.bind(null,"uniform3iv",dh,3,Io),35673:Ir.bind(null,"uniform4iv",dh,4,Io),35674:Ir.bind(null,"uniformMatrix2fv",Ha,4,Ju),35675:Ir.bind(null,"uniformMatrix3fv",Ha,9,Ju),35676:Ir.bind(null,"uniformMatrix4fv",Ha,16,Ju),35678:oo,35680:oo,5125:Ir.bind(null,"uniform1uiv",Cx,1,Io),36294:Ir.bind(null,"uniform2uiv",Cx,2,Io),36295:Ir.bind(null,"uniform3uiv",Cx,3,Io),36296:Ir.bind(null,"uniform4uiv",Cx,4,Io),35685:Ir.bind(null,"uniformMatrix2x3fv",Ha,6,Ju),35686:Ir.bind(null,"uniformMatrix2x4fv",Ha,8,Ju),35687:Ir.bind(null,"uniformMatrix3x2fv",Ha,6,Ju),35688:Ir.bind(null,"uniformMatrix3x4fv",Ha,12,Ju),35689:Ir.bind(null,"uniformMatrix4x2fv",Ha,8,Ju),35690:Ir.bind(null,"uniformMatrix4x3fv",Ha,12,Ju),35678:oo,35680:oo,35679:oo,35682:oo,36289:oo,36292:oo,36293:oo,36298:oo,36299:oo,36300:oo,36303:oo,36306:oo,36307:oo,36308:oo,36311:oo},Uoe={},zoe={},Hoe={},iU=[0];function BI(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(iU[0]=n,n=iU);const r=n.length;if(r%e&&mn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Ha(n,e){return BI(n,e,Float32Array,Uoe)}function dh(n,e){return BI(n,e,Int32Array,zoe)}function Cx(n,e){return BI(n,e,Uint32Array,Hoe)}function rU(n,e,t){const i=joe[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function Goe(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function Woe(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Pf||n instanceof zg)||n instanceof ks&&Boolean(n.texture)}function qoe(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function oo(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Ir(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),s=u,h=!0;else{on(s===u,"Uniform length cannot change.");for(let f=0;f<u;++f)if(c[f]!==r[f]){h=!0;break}}return h&&(i(o,n,a,c),r.set(c)),h}}function Io(n,e,t,i){n[e](t,i)}function Ju(n,e,t,i){n[e](t,!1,i)}function Tx(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function oU(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=aU(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function aU(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class P0 extends Ku{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return on(!1),"unknown"}}constructor(e,t){hx(e),on("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:Tx(t.source,null)||t.id||ma(`unnamed ${P0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=Tx(e,null);t&&(this.id=ma(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${P0.getTypeName(this.shaderType)}:${this.id}`}getName(){return Tx(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||Tx(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let u=0;u<r.length;u++){const h=r[u];if(h.length<=1)continue;const f=h.split(":"),g=f[0],m=parseInt(f[2],10);if(isNaN(m))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[m]=h:o[m]=h}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return aU(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:oU(s,c),warnings:oU(o,c)}}(i,this.source,this.shaderType,this.id);throw mn.error(`GLSL compilation errors in ${r}\n${s}`)(),mn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class VI extends P0{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class jI extends P0{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Fs=5126,N0=5124,k0=5125,UI={[Fs]:[Fs,1,"float"],35664:[Fs,2,"vec2"],35665:[Fs,3,"vec3"],35666:[Fs,4,"vec4"],[N0]:[N0,1,"int"],35667:[N0,2,"ivec2"],35668:[N0,3,"ivec3"],35669:[N0,4,"ivec4"],[k0]:[k0,1,"uint"],36294:[k0,2,"uvec2"],36295:[k0,3,"uvec3"],36296:[k0,4,"uvec4"],35670:[Fs,1,"bool"],35671:[Fs,2,"bvec2"],35672:[Fs,3,"bvec3"],35673:[Fs,4,"bvec4"],35674:[Fs,8,"mat2"],35685:[Fs,8,"mat2x3"],35686:[Fs,8,"mat2x4"],35675:[Fs,12,"mat3"],35687:[Fs,12,"mat3x2"],35688:[Fs,12,"mat3x4"],35676:[Fs,16,"mat4"],35689:[Fs,16,"mat4x2"],35690:[Fs,16,"mat4x3"]};function fU(n){const e=UI[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function pU(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Fs}for(const t in UI){const[i,r,s]=UI[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class Aae{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Ci(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=fU(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new _a(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=fU(i),l={location:e,name:t,accessor:new _a({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Mae=35981,Dae=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class mU extends Ku{get[Symbol.toStringTag](){return"Program"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",Dae),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=Mae}=e;return this.hash=t||"",this.vs="string"==typeof i?new VI(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new jI(this.gl,{id:`${e.id}-fs`,source:r}):r,on(this.vs instanceof VI),on(this.fs instanceof jI),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Ao(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Aae(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:f,framebuffer:g,parameters:m={},uniforms:v,samplers:x}){if((v||x)&&(mn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(v||{})),mn.priority>=e){const U=g?g.id:"default",D=`mode=${ch(this.gl,t)} verts=${i} instances=${c} indexType=${ch(this.gl,l)} isInstanced=${u} isIndexed=${a} Framebuffer=${U}`;mn.log(e,D)()}return on(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),f){const U=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return on(!1),0}}(t);f.begin(U)}this._bindTextures(),hc(this.gl,m,()=>{a&&u?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&Ci(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):u?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),f&&f.end()}),0))}setUniforms(e={}){mn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!Woe(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof ks&&(s=s.texture),s instanceof Pf)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&qoe(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new VI({handle:r});break;case 35632:i.fs=new jI({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=ma(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),mn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),mn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||mn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=Goe(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=rU(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=rU(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class F0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new F0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),h=this._getHash(i),f=c.map(ie=>this._getHash(ie.name)).sort(),g=o.map(ie=>this._getHash(ie)),m=Object.keys(r).sort(),v=Object.keys(s).sort(),x=[],U=[];for(const ie of m)x.push(this._getHash(ie)),x.push(this._getHash(r[ie]));for(const ie of v)U.push(this._getHash(ie)),U.push(this._getHash(s[ie]));const D=`${u}/${h}D${x.join("/")}M${f.join("/")}I${U.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[D]){const ie=function(n,e){const{vs:t,fs:i}=e,r=doe(e.modules||[]);return{gl:n,vs:nU(n,Object.assign({},e,{source:t,type:R0,modules:r})),fs:nU(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:Noe(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[D]=new mU(this.gl,{hash:D,vs:ie.vs,fs:ie.fs,varyings:o,bufferMode:a}),this._getUniforms[D]=ie.getUniforms||(_e=>{}),this._useCounts[D]=0}return this._useCounts[D]++,this._programCache[D]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let Mx=null;class Ga extends Ku{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e,t={}){return!t.constantAttributeZero||Ci(e)||"Chrome"===function(n){if(!ZD())return"Node";if(SV(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":v0.chrome?"Chrome":v0.safari?"Safari":v0.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ga(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ga.MAX_ATTRIBUTES=Ga.MAX_ATTRIBUTES||e.getParameter(34921),Ga.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Ga._setConstantFloatArray(e,t,i);break;case Int32Array:Ga._setConstantIntArray(e,t,i);break;case Uint32Array:Ga._setConstantUintArray(e,t,i);break;default:on(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ga.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return on(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:h,gl2:f}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,t.handle),c?(on(Ci(h)),f.vertexAttribIPointer(e,r,s,o,a)):h.vertexAttribPointer(e,r,s,l,o,a),h.enableVertexAttribArray(e),f.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!Ga.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new lr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!Mx||Mx.byteLength<n)&&(Mx=new ArrayBuffer(n)),Mx}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:on(!1)}}static _setConstantIntArray(e,t,i){switch(on(Ci(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:on(!1)}}static _setConstantUintArray(e,t,i){switch(on(Ci(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:on(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return on(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const Fae=/^(.+)__LOCATION_([0-9]+)$/,Lae=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Bae{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ga(e),JV(this,"VertexArray","v6.0",Lae),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new lr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof lr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof lr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,mn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=_a.resolve(l.accessor,this.accessors[o]||{},i,r),{size:h,type:f}=u;return on(Number.isFinite(h)&&Number.isFinite(f)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=Fae.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof lr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof lr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof lr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Ga.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Ga.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof lr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return mn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function L0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=L0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function _U(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,h,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof lr){const f=e,{data:g,changed:m}=f.getDebugData();let v;return u=m?"*":"",h=g,l=f.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?v=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${ch(r,s)})`:(c=!0,v=`${l} bytes`),{[i]:`${u}${L0(h,{size:o,isInteger:c})}`,"Format ":v}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${L0(h,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function Uae(n,e){const{type:t,size:i}=e,r=pU(t,i);return r?`${n} (${r.name})`:n}function yU({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){on(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const f of l)!f.match(".*_.*")&&!f.match(s)&&zI({table:a,header:n,uniforms:t,uniformName:f,undefinedOnly:i})&&c++;for(const f of l)f.match(s)&&zI({table:a,header:n,uniforms:t,uniformName:f,undefinedOnly:i})&&c++;for(const f of l)a[f]||zI({table:a,header:n,uniforms:t,uniformName:f,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const f in t){const g=t[f];a[f]||(u++,h[f]={Type:`NOT USED: ${g}`,[n]:L0(g)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function zI({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?L0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function bU(n){const{type:e,size:t}=n.accessor,i=pU(e,t);return i?`${i.name} ${n.name}`:n.name}const Gae={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Wae(n,e){const{attributeMap:t=Gae}=e||{};return t&&t[n]||n}function qae(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}on(Number.isFinite(e.size),`attribute ${n} needs size`)}const vU=()=>{},Kae={};class Yg{constructor(e,t={}){const{id:i=ma("model")}=t;on(dx(e)),this.id=i,this.gl=e,this.id=t.id||ma("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||F0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},on(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return on(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return on(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=Wae(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ot({},o);delete c.value,i[a]=[new lr(n,l),c],qae(s,c)}}if(r){const s=r.value||r;on(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new lr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(jg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return fI(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),mn.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:f=u.indexType,indexOffset:g=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&mn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:v,instanceCount:x}=this,{onBeforeRender:U=vU,onAfterRender:D=vU}=this.props;U(),this.program.setUniforms(this.uniforms);const ie=this.program.draw(Object.assign(Kae,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:f,isInstanced:v,instanceCount:x,offset:h?g:0}));return D(),mn.priority>=2&&this._logDrawCallEnd(c,l,i),ie}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return mn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}on(t instanceof mU,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Bae(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof lr&&t.delete()}}_setAnimationProps(e){this.animated&&on(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(jg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new Hj(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),mn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:mn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=_U(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${Uae(s.name,a)}`),t[o]=_U(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=yU({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=yU({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&mn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&mn.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${bU(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${bU(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);mn.table(e,s)(),mn.table(e,o)(),mn.table(e+1,h)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),mn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class HI{static isSupported(e){return Ci(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();on(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Yg(t,Object.assign({},e,{fs:e.fs||zj({version:Gj(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(jg(n.feedbackBuffers)&&jg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new $se(e,t)),function(n){return!(jg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new soe(e,t)),on(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function Dx(){}const Jae={onStart:Dx,onUpdate:Dx,onInterrupt:Dx,onEnd:Dx};class B0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ot(ot({},Jae),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const ale={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new B0(i),this.attribute=t,this.attributeInTransition=new TI(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=Lj(e.size);return new HI(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new lr(e,r),new lr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;Bj(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)Vj(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=CI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:Fj(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new B0(i),this.attribute=t,this.attributeInTransition=new TI(e,Sn(ot({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new ya(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new ks(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=Lj(e.size);return new HI(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new lr(e,r),new lr(e,r),new lr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)Vj(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=CI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:Fj(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Bj(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),px(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class lle{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=HI.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Ri.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=ale[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Ri.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const wU="attributeManager.invalidate";class ple{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new lle(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);Do(wU,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Do(wU,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;Do("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=i,s[c]&&Ri.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(o[h],e.startIndices)||!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=u.needsRedraw()}l&&Do("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ot({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Ri.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=Sn(ot({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new TI(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;Do("attribute.updateStart",t),t.allocate(i)&&Do("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,Do("attribute.updateEnd",t,i))}}function xU(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function SU(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const yle={interpolation:class extends B0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=gx(t,i,o)}},spring:class extends B0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=xU(n[o],e[o],t[o],i,r);return s}return xU(n,e,t,i,r)}(s,o,t,i,r);const l=SU(a,t),c=SU(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class ble{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=kj(r)))return;const o=yle[r.type];if(!o)return void Ri.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(Sn(ot({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const Ix={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:vle}=Ix;function xle(n,e){if(!n.transitions)return null;const t={},i=$I(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&GI(n[r],e[r],s)&&(t[r]=!0)}return t}function CU({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=GI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=GI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function GI(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Tle(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function TU(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,CU({oldProps:r,newProps:i,triggerName:t})}function $I(n){const e=n[vle],t=e&&e.constructor;return t?t._propTypes:{}}function Rle(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function Ox(n){let t,e={};return i=>{for(const r in i)if(!Rle(i[r],e[r])){t=n(i),e=i;break}return t}}function Ple(n,e){if(!e)return n;const t=ot(ot({},n),e);if("defines"in e&&(t.defines=ot(ot({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ot({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function WI(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],m=e[12],v=e[13],x=e[14],U=e[15],D=t*a-i*o,ie=t*l-r*o,_e=t*c-s*o,Pe=i*l-r*a,Ne=i*c-s*a,Ve=r*c-s*l,bt=u*v-h*m,xt=u*x-f*m,At=u*U-g*m,Bt=h*x-f*v,Wt=h*U-g*v,gt=f*U-g*x,mt=D*gt-ie*Wt+_e*Bt+Pe*At-Ne*xt+Ve*bt;return mt?(n[0]=(a*gt-l*Wt+c*Bt)*(mt=1/mt),n[1]=(r*Wt-i*gt-s*Bt)*mt,n[2]=(v*Ve-x*Ne+U*Pe)*mt,n[3]=(f*Ne-h*Ve-g*Pe)*mt,n[4]=(l*At-o*gt-c*xt)*mt,n[5]=(t*gt-r*At+s*xt)*mt,n[6]=(x*_e-m*Ve-U*ie)*mt,n[7]=(u*Ve-f*_e+g*ie)*mt,n[8]=(o*Wt-a*At+c*bt)*mt,n[9]=(i*At-t*Wt-s*bt)*mt,n[10]=(m*Ne-v*_e+U*D)*mt,n[11]=(h*_e-u*Ne-g*D)*mt,n[12]=(a*xt-o*Bt-l*bt)*mt,n[13]=(t*Bt-i*xt+r*bt)*mt,n[14]=(v*ie-m*Pe-x*D)*mt,n[15]=(u*Pe-h*ie+f*D)*mt,n):null}function Ff(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],g=e[10],m=e[11],v=e[12],x=e[13],U=e[14],D=e[15],ie=t[0],_e=t[1],Pe=t[2],Ne=t[3];return n[0]=ie*i+_e*a+Pe*h+Ne*v,n[1]=ie*r+_e*l+Pe*f+Ne*x,n[2]=ie*s+_e*c+Pe*g+Ne*U,n[3]=ie*o+_e*u+Pe*m+Ne*D,n[4]=(ie=t[4])*i+(_e=t[5])*a+(Pe=t[6])*h+(Ne=t[7])*v,n[5]=ie*r+_e*l+Pe*f+Ne*x,n[6]=ie*s+_e*c+Pe*g+Ne*U,n[7]=ie*o+_e*u+Pe*m+Ne*D,n[8]=(ie=t[8])*i+(_e=t[9])*a+(Pe=t[10])*h+(Ne=t[11])*v,n[9]=ie*r+_e*l+Pe*f+Ne*x,n[10]=ie*s+_e*c+Pe*g+Ne*U,n[11]=ie*o+_e*u+Pe*m+Ne*D,n[12]=(ie=t[12])*i+(_e=t[13])*a+(Pe=t[14])*h+(Ne=t[15])*v,n[13]=ie*r+_e*l+Pe*f+Ne*x,n[14]=ie*s+_e*c+Pe*g+Ne*U,n[15]=ie*o+_e*u+Pe*m+Ne*D,n}function Rx(n,e,t){var o,a,l,c,u,h,f,g,m,v,x,U,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],g=e[7],m=e[8],v=e[9],x=e[10],U=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=f,n[7]=g,n[8]=m,n[9]=v,n[10]=x,n[11]=U,n[12]=o*i+u*r+m*s+e[12],n[13]=a*i+h*r+v*s+e[13],n[14]=l*i+f*r+x*s+e[14],n[15]=c*i+g*r+U*s+e[15]),n}function Px(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function AU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+h*i,n[7]=l*r+f*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=h*r-a*i,n[11]=f*r-l*i,n}function MU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+h*i,n[3]=l*r+f*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=h*r-a*i,n[7]=f*r-l*i,n}function IU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function Nx(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}function OU(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,h=c*r+l*i-o*s,f=c*s+o*r-a*i,g=-o*i-a*r-l*s;return n[0]=u*c+g*-o+h*-l-f*-a,n[1]=h*c+g*-a+f*-o-u*-l,n[2]=f*c+g*-l+u*-a-h*-o,n[3]=e[3],n}!function(){var n=new ba(4);ba!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const RU=[0,0,0,0],rce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],sce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],oce=[0,0,0],ace=[0,0,0],lce=Ox(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=RU,l=RU,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:f}=PU(n,e,t);return f&&(l=n.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Nx([],l,o),s=i||s,o=Ff([],r,s),o=Ff([],o,rce)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),h=[n.width*e,n.height*e],f=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:oce,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const m=n.getDistanceScales(c);switch(t){case Vi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case Vi.LNGLAT:case Vi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case Vi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]]}}return g});function PU(n,e,t=ace){let r,i=t,s=!0;switch(r=e===Vi.LNGLAT_OFFSETS||e===Vi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Zc.WEB_MERCATOR:(e===Vi.LNGLAT||e===Vi.CARTESIAN)&&(s=!1);break;case Zc.WEB_MERCATOR_AUTO_OFFSET:e===Vi.LNGLAT?i=r:e===Vi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Zc.IDENTITY:i=n.position.map(Math.fround);break;case Zc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class hce extends mx{get ELEMENTS(){return Zu(!1),0}get RANK(){return Zu(!1),0}toString(){let e="[";if(Dr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=nr(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function kx(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function NU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function kU(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}!function(){var n=new ba(2);ba!=Float32Array&&(n[0]=0,n[1]=0)}();const FU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),mce=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),_ce=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Kg={};class qn extends hce{static get IDENTITY(){return Kg.IDENTITY=Kg.IDENTITY||Object.freeze(new qn(FU)),Kg.IDENTITY}static get ZERO(){return Kg.ZERO=Kg.ZERO||Object.freeze(new qn(mce)),Kg.ZERO}get INDICES(){return _ce}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,h,f,g,m,v,x){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=f,this[12]=g,this[13]=m,this[14]=v,this[15]=x,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,h,f,g,m,v,x){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=u,this[7]=m,this[8]=i,this[9]=a,this[10]=h,this[11]=v,this[12]=r,this[13]=l,this[14]=f,this[15]=x,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(FU)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,f=r*o,g=r*a,m=r*l,v=s*o,x=s*a,U=s*l;n[0]=1-h-m,n[1]=u+U,n[2]=f-x,n[3]=0,n[4]=u-U,n[5]=1-c-m,n[6]=g+v,n[7]=0,n[8]=f+x,n[9]=g-v,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?qn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),u=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,u,h,f,g,m=e[0],v=e[1],x=e[2],U=i[0],D=i[1],ie=i[2],_e=t[0],Pe=t[1],Ne=t[2];Math.abs(m-_e)<eu&&Math.abs(v-Pe)<eu&&Math.abs(x-Ne)<eu?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=m-_e,h=v-Pe,f=x-Ne,r=D*(f*=g=1/Math.hypot(u,h,f))-ie*(h*=g),s=ie*(u*=g)-U*f,o=U*h-D*u,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=h*o-f*s,l=f*r-u*o,c=u*s-h*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=f,n[11]=0,n[12]=-(r*m+s*v+o*x),n[13]=-(a*m+l*v+c*x),n[14]=-(u*m+h*v+f*x),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new qn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],h=n[10],f=n[11],g=n[12],m=n[13],v=n[14],x=n[15];return(e*o-t*s)*(h*x-f*v)-(e*a-i*s)*(u*x-f*m)+(e*l-r*s)*(u*v-h*m)+(t*a-i*o)*(c*x-f*g)-(t*l-r*o)*(c*v-h*g)+(i*l-r*a)*(c*m-u*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return WI(this,this),this.check()}multiplyLeft(e){return Ff(this,e,this),this.check()}multiplyRight(e){return Ff(this,this,e),this.check()}rotateX(e){return AU(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-h*i,n[3]=l*r-f*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+h*r,n[11]=l*i+f*r}(this,this,e),this.check()}rotateZ(e){return MU(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,u,h,f,g,m,v,x,U,D,ie,_e,Pe,Ne,Ve,bt,xt,At,Bt,Wt,gt,mt,jt,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<eu||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),f=e[1],g=e[2],m=e[3],x=e[5],U=e[6],D=e[7],_e=e[9],Pe=e[10],Ne=e[11],At=r*s*(u=1-c)-o*l,Bt=s*s*u+c,Wt=o*s*u+r*l,gt=r*o*u+s*l,mt=s*o*u-r*l,jt=o*o*u+c,n[0]=(h=e[0])*(Ve=r*r*u+c)+(v=e[4])*(bt=s*r*u+o*l)+(ie=e[8])*(xt=o*r*u-s*l),n[1]=f*Ve+x*bt+_e*xt,n[2]=g*Ve+U*bt+Pe*xt,n[3]=m*Ve+D*bt+Ne*xt,n[4]=h*At+v*Bt+ie*Wt,n[5]=f*At+x*Bt+_e*Wt,n[6]=g*At+U*Bt+Pe*Wt,n[7]=m*At+D*Bt+Ne*Wt,n[8]=h*gt+v*mt+ie*jt,n[9]=f*gt+x*mt+_e*jt,n[10]=g*gt+U*mt+Pe*jt,n[11]=m*gt+D*mt+Ne*jt,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?Px(this,this,e):Px(this,this,[e,e,e]),this.check()}translate(e){return Rx(this,this,e),this.check()}transform(e,t){return 4===e.length?(_x(t=Nx(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=bI(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _x(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=Aj(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _x(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return yI("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return yI("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return yI("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Qg(n,e){const t=Nx([],e,n);return IU(t,t,1/t[3]),t}function LU(n,e){const t=n%e;return t<0?e+t:t}function BU(n,e,t){return n<e?e:n>t?t:n}const qI=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function ed(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const pc=Math.PI,VU=pc/4,gc=pc/180,YI=180/pc,XI=4003e4,Fx=85.051129;function Lx([n,e]){return ed(Number.isFinite(n)),ed(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*gc+pc)/(2*pc),512*(pc+Math.log(Math.tan(VU+e*gc*.5)))/(2*pc)]}function Zg([n,e]){const t=n/512*(2*pc)-pc,i=2*(Math.atan(Math.exp(e/512*(2*pc)-pc))-VU);return[t*YI,i*YI]}function KI({latitude:n,longitude:e,highPrecision:t=!1}){ed(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*gc),o=512/360,a=o/s,l=512/XI/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=gc*Math.tan(n*gc)/s,h=512/XI*c,f=h/a*l;i.unitsPerDegree2=[0,o*c/2,h],i.unitsPerMeter2=[f,0,f]}return i}function jU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=KI({longitude:t,latitude:i,highPrecision:!0}),u=Lx(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=Zg(u),f=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],f]:h}function zU(n){return 2*Math.atan(.5/n)*YI}function HU(n,e){const[t,i,r=0]=n;return ed(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Qg(e,[t,i,r,1])}function j0(n,e,t=0){const[i,r,s]=n;if(ed(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Qg(e,[i,r,s,1]);const o=Qg(e,[i,r,0,1]),a=Qg(e,[i,r,1,1]),l=o[2],c=a[2];return kU([],o,a,l===c?0:((t||0)-l)/(c-l))}const GU=Math.PI/180;function $U(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Qg(i,[e,0,1,1]),s=Qg(i,[e,n.height,1,1]),c=Zg(kU([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}const Dce=Math.PI/180,Ice=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ZI=[0,0,0],Rce={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let Jg=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Zc.WEB_MERCATOR:Zc.WEB_MERCATOR_AUTO_OFFSET:Zc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&M0(t.projectionMatrix,this.projectionMatrix)&&M0(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=HU(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,u=j0([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[h,f,g]=this.unprojectPosition(u);return Number.isFinite(a)?[h,f,g]:Number.isFinite(r)?[h,f,r]:[h,f]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?Lx(t):t}unprojectFlat(t){return this.isGeospatial?Zg(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?KI({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Hg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Hg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Hg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Hg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Hg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Hg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new qn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new qn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Ice,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){ed(Number.isFinite(n));const e=Math.cos(n*gc);return function(n){return qI(n)}(XI*e)-9}({latitude:s})+Math.log2(c):0);const h=Math.pow(2,this.zoom);this.scale=h,this.distanceScales=this.isGeospatial?KI({latitude:s,longitude:r}):u||Rce,this.focalDistance=c,this.distanceScales.metersPerUnit=new Mo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new Mo(this.distanceScales.unitsPerMeter),this.position=ZI,this.meterOffset=ZI,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new qn).multiplyRight(this.viewMatrixUncentered).translate(new Mo(this.center||ZI).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new Mo(this.projectPosition([t,i,0]));if(r){const a=new Mo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*Dce,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ff(t,t,this.projectionMatrix),Ff(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=WI([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Px(i,i,[this.width/2,-this.height/2,1]),Rx(i,i,[1,-1,0]),Ff(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=WI([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ri.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),KU=(()=>{class n extends Jg{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:u=!1,repeat:h=!1,worldOffset:f=0}=t;let{width:g,height:m,altitude:v=1.5}=t;const x=Math.pow(2,s);g=g||1,m=m||1,v=Math.max(.75,v);const{fov:U,aspect:D,focalDistance:ie,near:_e,far:Pe}=function({width:n,height:e,fovy:t=zU(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=zU(i));const a=.5*t*gc,l=function(n){return.5/Math.tan(.5*n*gc)}(t),c=r*gc,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*u+l)*o}}({width:g,height:m,pitch:o,altitude:v,nearZMultiplier:l,farZMultiplier:c});let Ne=function({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return Rx(o,o,[0,0,-i]),AU(o,o,-e*gc),MU(o,o,t*gc),Px(o,o,[r/=n,r,r]),s&&Rx(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}({height:m,pitch:o,bearing:a,scale:x,altitude:v});f&&(Ne=(new qn).translate([512*f,0,0]).multiplyLeft(Ne)),super(Sn(ot({},t),{width:g,height:m,viewMatrix:Ne,longitude:r,latitude:i,zoom:s,orthographic:u,fovyRadians:U,aspect:D,focalDistance:ie,near:_e,far:Pe})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=v,this.orthographic=u,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(Sn(ot({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return jU(t,i)}panByPosition(t,i){const r=j0(i,this.pixelUnprojectionMatrix),o=kx([],this.projectFlat(t),NU([],r)),a=kx([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=function(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*GU:Math.atan(.5/n.altitude))>(90-n.pitch)*GU-.01?(l=$U(n,0,e),c=$U(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=function({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,u]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:ed(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=Lx([a,BU(u,-Fx,Fx)]),f=Lx([c,BU(l,-Fx,Fx)]),g=[Math.max(Math.abs(f[0]-h[0]),i),Math.max(Math.abs(f[1]-h[1]),i)],m=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];ed(m[0]>0&&m[1]>0);const v=m[0]/g[0],x=m[1]/g[1],_e=Zg([(f[0]+h[0])/2+(s.right-s.left)/2/v,(f[1]+h[1])/2+(s.bottom-s.top)/2/x]),Pe=Math.min(r,qI(Math.abs(Math.min(v,x))));return ed(Number.isFinite(Pe)),{longitude:_e[0],latitude:_e[1],zoom:Pe}}(ot({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function JI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof KU){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function QU(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=Nx([],[o,a,l,1],t)),i){case Vi.LNGLAT:return JI([o,a,l],e,s);case Vi.LNGLAT_OFFSETS:return JI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Vi.METER_OFFSETS:return JI(jU(r,[o,a,l]),e,s);case Vi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const kce={10241:9987,10240:9729,10242:33071,10243:33071},eO={},Bce={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||z0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>tO(n,e)},accessor:{validate(n,e){const t=Bx(n);return"function"===t||t===Bx(e.value)},equal:(n,e,t)=>"function"==typeof e||tO(n,e)},array:{validate:(n,e)=>e.optional&&!n||z0(n),equal:(n,e,t)=>t.compare?tO(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof ya)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new ya(t,Sn(ot({},e),{parameters:ot(ot(ot({},kce),i),n.props.textureParameters)}));return eO[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof ya)||eO[n.id]&&(n.delete(),delete eO[n.id])}(n)}}};function tO(n,e){if(n===e)return!0;if(!z0(n)||!z0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function jce(n,e){switch(Bx(e)){case"object":return U0(n,e);case"array":return U0(n,{type:"array",value:e,compare:!1});case"boolean":return U0(n,{type:"boolean",value:e});case"number":return U0(n,{type:"number",value:e});case"function":return U0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function U0(n,e){return"type"in e?ot(ot({name:n},Bce[e.type]),e):"value"in e?ot({name:n,type:Bx(e.value)},e):{name:n,type:"object",value:e}}function z0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function Bx(n){return z0(n)?"array":null===n?"null":typeof n}const{COMPONENT:nO,ASYNC_ORIGINAL:Vx,ASYNC_RESOLVED:H0,ASYNC_DEFAULTS:jx}=Ix;function Uce(){const n=this,e=ZU(n.constructor),t=Object.create(e);t[nO]=n,t[Vx]={},t[H0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function ZU(n){return Ux(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=ZU(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=jce(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(Ux(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=Ux(n,"layerName")||Ux(n,"componentName");return e||Ri.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ot(ot({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=Wce(o))}n[jx]=t,n[Vx]={},Object.defineProperties(n,i)}(o,a);const l=ot(ot({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])JU(this,s)||(this[s]=i);Ri.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function Wce(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||Pj(e)?this[Vx][n]=e:this[H0][n]=e},get(){if(this[H0]){if(n in this[H0])return this[H0][n]||this[jx][n];if(n in this[Vx]){const e=this[nO]&&this[nO].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[jx][n]}}return this[jx][n]}}}function JU(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ux(n,e){return JU(n,e)&&n[e]}function iO(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:Yce,ASYNC_RESOLVED:Xce,ASYNC_DEFAULTS:Kce}=Ix,Qce=Object.freeze({});class ez{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=Qce,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[Xce]||{},i=e[Yce]||e,r=e[Kce]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(Pj(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return li(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var h,c=!0,u=!1;try{for(var g,m,f=iO(t);c=(g=yield f.next()).done,m=yield g.value,!c;c=!0){const x=m,{dataTransform:U}=i.component?i.component.props:{};a=U?U(x,a):a.concat(x),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(x){u=!0,h=x}finally{try{!c&&null!=f.return&&(yield f.return())}finally{if(u)throw h}}const v=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;v&&v(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:tz,ASYNC_RESOLVED:nz,ASYNC_DEFAULTS:Zce}=Ix,Jce={};let eue=0,tue=(()=>{class n{constructor(){this.props=Uce.apply(this,arguments),this.id=this.props.id,this.count=eue++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[Zce])s in i[nz]?r[s]=i[nz][s]:s in i[tz]&&(r[s]=i[tz][s]);return new this.constructor(ot(ot(ot({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new ez({})}}return n.componentName="Component",n.defaultProps=Jce,n})();class nue extends ez{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const mc=n=>"function"==typeof n,hh=n=>null!==n&&"object"==typeof n,rz=n=>hh(n)&&n.constructor==={}.constructor,iue=n=>n&&"function"==typeof n[Symbol.iterator],rue=n=>n&&"function"==typeof n[Symbol.asyncIterator],G0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,em=n=>"undefined"!=typeof Blob&&n instanceof Blob,sz=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||hh(n)&&mc(n.tee)&&mc(n.cancel)&&mc(n.getReader))(n)||(n=>hh(n)&&mc(n.read)&&mc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function Lf(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function rO(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function sO(n){var e,t;let i;return Lf(n,"null loader"),Lf(rO(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=Sn(ot({},n=n[0]),{options:ot(ot({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const tu={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},oO=tu.global||tu.self||tu.window||{},uue="object"!=typeof process||"[object process]"!==String(process)||process.browser,oz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);oz&&parseFloat(oz[1]);const lO={};function due(n){for(const e in lO)n.startsWith(e)&&(n=n.replace(e,lO[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const hue=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,fue=/^([-\w.]+\/[-\w.+]+)/;function pue(n){const e=fue.exec(n);return e?e[1]:n}function az(n){const e=hue.exec(n);return e?e[1]:""}const gue=/\?.*/;function zx(n){if(G0(n)){const e=cO(n.url||"");return{url:e,type:pue(n.headers.get("content-type")||"")||az(e)}}return em(n)?{url:cO(n.name||""),type:n.type||""}:"string"==typeof n?{url:cO(n),type:az(n)}:{url:"",type:""}}function mue(n){return G0(n)?n.headers["content-length"]||-1:em(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function cO(n){return n.replace(gue,"")}function lz(n){return uO.apply(this,arguments)}function uO(){return(uO=li(function*(n){if(G0(n))return n;const e={},t=mue(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=zx(n);r&&(e["content-type"]=r);const s=yield bue(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function _ue(n){return dO.apply(this,arguments)}function dO(){return(dO=li(function*(n){if(!n.ok){const e=yield yue(n);throw new Error(e)}})).apply(this,arguments)}function yue(n){return hO.apply(this,arguments)}function hO(){return(hO=li(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function bue(n){return fO.apply(this,arguments)}function fO(){return(fO=li(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${vue(n.slice(0,5))}`:null})).apply(this,arguments)}function vue(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function cz(n,e){return pO.apply(this,arguments)}function pO(){return(pO=li(function*(n,e){if("string"==typeof n){n=due(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield lz(n)})).apply(this,arguments)}function Kn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const uz=new eI({id:"loaders.gl"});class wue{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const dz={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Kn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},xue={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function gO(){oO.loaders=oO.loaders||{};const{loaders:n}=oO;return n._state=n._state||{},n._state}const mO=()=>{const n=gO();return n.globalOptions=n.globalOptions||ot({},dz),n.globalOptions};function Sue(n,e,t,i){return t=t||[],function(n,e){fz(n,null,dz,xue,e);for(const t of e)fz(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ot({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new wue),gz(r,mO()),gz(r,e),r}(e,n,i)}function hz(n,e){const t=mO(),i=n||t;return"function"==typeof i.fetch?i.fetch:hh(i.fetch)?r=>cz(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:cz}function fz(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&hh(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)uz.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const h=Tue(a,r);uz.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}function Tue(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function gz(n,e){for(const t in e)t in e&&(n[t]=rz(e[t])&&rz(n[t])?ot(ot({},n[t]),e[t]):e[t])}function nu(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function Due(n,e="3.0.12"){return nu(n,"no worker provided"),!(!e||!n.version)}const iu={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Iue=iu.global||iu.self||iu.window||{},_O="object"!=typeof process||"[object process]"!==String(process)||process.browser,yO="function"==typeof importScripts,Oue="undefined"!=typeof window&&void 0!==window.orientation,mz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),bO=(mz&&parseFloat(mz[1]),new Map);function _z(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function yz(n,e=!0,t){const i=t||new Set;if(n)if(bz(n))i.add(n);else if(bz(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)yz(n[r],e,i);return void 0===t?Array.from(i):[]}function bz(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const vO=()=>{};class vz{static isSupported(){return"undefined"!=typeof Worker}constructor(e){Kn(this,"name",void 0),Kn(this,"source",void 0),Kn(this,"url",void 0),Kn(this,"terminated",!1),Kn(this,"worker",void 0),Kn(this,"onMessage",void 0),Kn(this,"onError",void 0),Kn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;nu(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=vO,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=vO,this.onError=vO,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||yz(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){nu(n.source&&!n.url||!n.source&&n.url);let e=bO.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?_z(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),bO.set(n.url,e)),n.source&&(e=_z(n.source),bO.set(n.source,e))),nu(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class kue{constructor(e,t){Kn(this,"name",void 0),Kn(this,"workerThread",void 0),Kn(this,"isRunning",void 0),Kn(this,"result",void 0),Kn(this,"_resolve",void 0),Kn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){nu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){nu(this.isRunning),this.isRunning=!1,this._reject(e)}}class Fue{constructor(e){Kn(this,"name","unnamed"),Kn(this,"source",void 0),Kn(this,"url",void 0),Kn(this,"maxConcurrency",1),Kn(this,"maxMobileConcurrency",1),Kn(this,"onDebug",()=>{}),Kn(this,"reuseWorkers",!0),Kn(this,"props",{}),Kn(this,"jobQueue",[]),Kn(this,"idleQueue",[]),Kn(this,"count",0),Kn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ot(ot({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return li(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return li(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new kue(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new vz({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Oue?this.maxMobileConcurrency:this.maxConcurrency}}const Lue={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class td{static isSupported(){return vz.isSupported()}static getWorkerFarm(e={}){return td._workerFarm=td._workerFarm||new td({}),td._workerFarm.setProps(e),td._workerFarm}constructor(e){Kn(this,"props",void 0),Kn(this,"workerPools",new Map),this.props=ot({},Lue),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ot(ot({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new Fue({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function Vue(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return nu(r),r}function jue(n,e){return!!td.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function Uue(n,e,t,i,r){return wO.apply(this,arguments)}function wO(){return(wO=li(function*(n,e,t,i,r){const s=n.id,o=Vue(n,t),l=td.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",zue.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function zue(n,e,t,i){return EO.apply(this,arguments)}function EO(){return(EO=li(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}Kn(td,"_workerFarm",void 0);var Ez=et(9521);function xz(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return Ez.toArrayBuffer?Ez.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function Wue(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function Sz(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function que(n){return SO.apply(this,arguments)}function SO(){return(SO=li(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=iO(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return Wue(...e)})).apply(this,arguments)}const Kue=262144;function Cz(n){this.wrapped=n}function $0(n){return new Cz(n)}function W0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof Cz;Promise.resolve(u?c.wrapped:c).then(function(h){u?r("return"===o?"return":"next",h):s(l.done?"return":"normal",h)},function(h){r("throw",h)})}catch(h){s("throw",h)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function TO(n){return function(){return new W0(n.apply(this,arguments))}}function AO(){return(AO=TO(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield $0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function Tz(n,e){return uue?function(n,e){return MO.apply(this,arguments)}(n,e):function(n,e){return DO.apply(this,arguments)}(n,e)}function MO(){return(MO=TO(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield $0(r);if(s)return;yield xz(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function DO(){return(DO=TO(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=iO(n);t=(o=yield $0(s.next())).done,a=yield $0(o.value),!t;t=!0)yield xz(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield $0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function nde(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=Kue}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(em(n))return function(n,e){return AO.apply(this,arguments)}(n,e);if(sz(n))return Tz(n,e);if(G0(n))return Tz(n.body,e);throw new Error("makeIterator")}W0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},W0.prototype.next=function(n){return this._invoke("next",n)},W0.prototype.throw=function(n){return this._invoke("throw",n)},W0.prototype.return=function(n){return this._invoke("return",n)};const IO="Cannot convert supplied data type";function ide(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(IO)}function rde(n,e,t){return OO.apply(this,arguments)}function OO(){return(OO=li(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return ide(n,e);if(em(n)&&(n=yield lz(n)),G0(n)){const r=n;return yield _ue(r),e.binary?yield r.arrayBuffer():yield r.text()}if(sz(n)&&(n=nde(n,t)),iue(n)||rue(n))return que(n);throw new Error(IO)})).apply(this,arguments)}function ode(n,e,t=null){if(t)return t;const i=ot({fetch:hz(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function ade(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const Az=()=>{const n=gO();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function Mz(n){const e=Az();n=Array.isArray(n)?n:[n];for(const t of n){const i=sO(t);e.find(r=>i===r)||e.unshift(i)}}const cde=/\.([^.]+)$/;function ude(n){return NO.apply(this,arguments)}function NO(){return(NO=li(function*(n,e=[],t,i){if(!Iz(n))return null;let r=Dz(n,e,Sn(ot({},t),{nothrow:!0}),i);if(r)return r;if(em(n)&&(r=Dz(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(Oz(n));return r})).apply(this,arguments)}function Dz(n,e=[],t,i){if(!Iz(n))return null;if(e&&!Array.isArray(e))return sO(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...Az()),function(n){for(const e of n)sO(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=zx(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=kO(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&cde.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||kO(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(mde(e,t))return t}else if(ArrayBuffer.isView(e)){if(Rz(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&Rz(e,0,t))return t;return null}(e,n),a=a||kO(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(Oz(n));return s}function Iz(n){return!(n instanceof Response&&204===n.status)}function Oz(n){const{url:e,type:t}=zx(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?FO(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?FO(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function kO(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function mde(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function Rz(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===FO(n,e,i.length);default:return!1}}(n,e,t,r))}function FO(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Hx(n,e,t,i){return LO.apply(this,arguments)}function LO(){return(LO=li(function*(n,e,t,i){nu(!i||"object"==typeof i),e&&!Array.isArray(e)&&!rO(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=zx(n),o=ade(e,i),a=yield ude(n,o,t);return a?(i=ode({url:r,parse:Hx,loaders:o},t=Sue(t,a,o,r),i),yield bde(a,n,t,i)):null})).apply(this,arguments)}function bde(n,e,t,i){return BO.apply(this,arguments)}function BO(){return(BO=li(function*(n,e,t,i){if(Due(n),e=yield rde(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(jue(n,t))return yield Uue(n,e,t,i,Hx);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw nu(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function q0(n,e,t,i){return VO.apply(this,arguments)}function VO(){return(VO=li(function*(n,e,t,i){!Array.isArray(e)&&!rO(e)&&(t=e,e=void 0);const r=hz(t);let s=n;return"string"==typeof n&&(s=yield r(n)),em(n)&&(s=yield r(n)),yield Hx(s,e,t)})).apply(this,arguments)}const Pz=Er(2,24)-1,Cde=Object.freeze([]),Tde=Ox(({oldViewport:n,viewport:e})=>n.equals(e));let ru=new Uint8ClampedArray(0);const Ade={data:{type:"data",value:Cde,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=Sn(ot({},r),{fetch:Sn(ot({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:q0(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):q0(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Vi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let Y0=(()=>{class n extends tue{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=QU(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=HU(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ot({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Vi.DEFAULT&&(t=i.isGeospatial?Vi.LNGLAT:Vi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=PU(t,i,r),h=QU(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(h,h,t.projectPosition(l||c));return h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Vi.DEFAULT||t===Vi.LNGLAT||t===Vi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){fc(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=Ple(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const u of c)o.invalidateAll(u);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:u}=o.attributes,h=c||u;h&&(l&&h.constant&&(h.constant=!1,o.invalidate(h.id)),!h.value&&!l&&(h.constant=!0,h.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!Tde({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(ru.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>Pz&&Ri.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ru=A0.allocate(ru,i,{size:3,copy:!0,maxCount:Math.max(i,Pz)});const s=Math.floor(ru.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),ru[3*a+0]=o[0],ru[3*a+1]=o[1],ru[3*a+2]=o[2]}t.value=ru.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==ru.buffer&&(r.value=ru.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){Do("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();Do("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){Do("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Xu(this.context.gl,{polygonOffset:l}),hc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&Do("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=CU({newProps:n,oldProps:e,propTypes:$I(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&TU(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&TU(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Tle(n,e),transitionsChanged:xle(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=$I(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new ple(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){fc(!this.internalState&&!this.state),fc(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new nue({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ri.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new ble(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){Do("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=Ade,n})(),Nz=(()=>{class n extends Y0{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:g,positionFormat:m,modelMatrix:v,extensions:x,fetch:U,_subLayerProps:D}=this.props,ie={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:f,wrapLongitude:g,positionFormat:m,modelMatrix:v,extensions:x,fetch:U},_e=D&&D[t.id],Pe=_e&&_e.updateTriggers,Ne=t.id||"sublayer";if(_e){const Ve=this.constructor._propTypes,bt=t.type?t.type._propTypes:{};for(const xt in _e){const At=bt[xt]||Ve[xt];At&&"accessor"===At.type&&(_e[xt]=this.getSubLayerAccessor(_e[xt]))}}Object.assign(ie,t,_e),ie.id="".concat(this.props.id,"-").concat(Ne),ie.updateTriggers=ot(ot({all:this.props.updateTriggers.all},t.updateTriggers),Pe);for(const Ve of x){const bt=Ve.getSubLayerProps.call(this,Ve);bt&&Object.assign(ie,bt,{updateTriggers:Object.assign(ie.updateTriggers,bt.updateTriggers)})}return ie}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=xI(t,Boolean),this.internalState.subLayers=t),Do("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const Dde=/([0-9]+\.?[0-9]*)(%|px)/;function Gx(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(Dde);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function $x(n,e){return n.relative?Math.round(n.position*e):n.position}function X0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&X0(i,r)))return!1}return!0}class jO{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:u=1e3,modelMatrix:h=null,viewportInstance:f=null,type:g=Jg}=e;fc(!f||f instanceof Jg),this.viewportInstance=f,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=Sn(ot({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:u,modelMatrix:h}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):X0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ot({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:$x(this._x,e),y:$x(this._y,t),width:$x(this._width,e),height:$x(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ot(ot({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ot(ot(ot({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=Gx(e),this._y=Gx(t),this._width=Gx(i),this._height=Gx(r)}}const K0=()=>{},kz={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:K0,onTransitionInterrupt:K0,onTransitionEnd:K0};class Ide{constructor(e,t={}){this.ControllerState=e,this.props=ot(ot({},kz),t),this.propsInTransition=null,this.transition=new B0(t.timeline),this.onViewStateChange=t.onViewStateChange||K0,this.onStateChange=t.onStateChange||K0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ot(ot({},kz),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ot(ot({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ot(ot({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const Fz=["longitude","latitude","zoom","bearing","pitch"],Rde=["longitude","latitude","zoom"];class Lz extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!M0(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];fc(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:Fz,extract:Fz,required:Rde}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=gx(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ot(ot({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,gx(e.around,t.around,i)))}return r}}const fh={transitionDuration:0},Pde={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},qx=n=>1-(1-n)*(1-n),tm_WHEEL=["wheel"],tm_PAN=["panstart","panmove","panend"],tm_PINCH=["pinchstart","pinchmove","pinchend"],tm_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],tm_DOUBLE_TAP=["doubletap"],tm_KEYBOARD=["keydown"];class UO{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Ide(e,Sn(ot({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&Sn(ot({},Pde),{transitionInterpolator:new Lz({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(tm_WHEEL,u&&i),this.toggleEvents(tm_PAN,u&&(r||s)),this.toggleEvents(tm_PINCH,u&&(a||l)),this.toggleEvents(tm_TRIPLE_PAN,u&&l),this.toggleEvents(tm_DOUBLE_TAP,u&&o),this.toggleEvents(tm_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ot(ot({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,fh,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,fh,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,Sn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:qx}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,fh,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,Sn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:qx}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,Sn(ot({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,fh,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,fh,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,Sn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:qx}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,fh,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,fh,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,Sn(ot({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:qx}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?Sn(ot({},t),{transitionInterpolator:new Lz(Sn(ot({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:fh}}class Bz{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const ph_target=[0,0,0];class Yx extends Bz{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=ph_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-(1/0),maxZoom:h=Infinity,startPanPosition:f,startRotatePos:g,startRotationX:m,startRotationOrbit:v,startZoomPosition:x,startZoom:U}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:f,startRotatePos:g,startRotationX:m,startRotationOrbit:v,startZoomPosition:x,startZoom:U},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(Sn(ot({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ot({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),Ua(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new Yx(ot(ot(ot({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Ua(r,i,t),e.rotationX=Ua(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class kde extends UO{constructor(e){super(Yx,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class Fde extends UO{constructor(e){e.dragMode=e.dragMode||"pan",super(Yx,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const Lde=(new qn).lookAt({eye:[0,0,1]});function Bde({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new qn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class Vde extends Jg{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(Sn(ot({},e),{longitude:null,position:a,viewMatrix:Lde.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:Bde({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=kx([],e,NU([],j0(t,this.pixelUnprojectionMatrix)));return{target:kx([],this.center,r)}}}let jde=(()=>{class n extends jO{constructor(t){super(Sn(ot({},t),{type:Vde}))}get controller(){return this._getControllerProps({type:Fde})}}return n.displayName="OrthographicView",n})();const Xx=Math.PI/180;function Ude({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*Xx/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new qn).lookAt({eye:l,up:a});c.rotateX(i*Xx),"Z"===t?c.rotateZ(r*Xx):c.rotateY(r*Xx);const u=Math.pow(2,s)/(n||1);return c.scale(u),c}class zde extends Jg{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(Sn(ot({},e),{longitude:null,viewMatrix:Ude({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=j0([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let Hde=(()=>{class n extends jO{constructor(t={}){const{orbitAxis:i="Z"}=t;super(Sn(ot({},t),{orbitAxis:i,type:zde}))}get controller(){return this._getControllerProps({type:kde})}}return n.displayName="OrbitView",n})();const Gde=[255,255,255],$de=1;let Wde=0;class Vz{constructor(e={}){const{color:t=Gde}=e,{intensity:i=$de}=e;this.id=e.id||"ambient-".concat(Wde++),this.color=t,this.intensity=i,this.type="ambient"}}const qde=[255,255,255],Yde=1,Xde=[0,0,-1];let Kde=0;class jz{constructor(e={}){const{color:t=qde}=e,{intensity:i=Yde}=e,{direction:r=Xde}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Kde++),this.color=t,this.intensity=i,this.type="directional",this.direction=new Mo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class Uz{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ot({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class zO extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ot({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Xu(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Xu(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,u=i&&i[c.id];r(c);const h=this._getDrawLayerParams(c,e);e.view=u;const f=c.subViewports||[c];for(const g of f){e.viewport=g;const m=this._drawLayersInViewport(o,e,h);a.push(m)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=zz(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let u=0;u<t.length;u++){const h=t[u],f=this._shouldDrawLayer(h,c,r),m={shouldDrawLayer:f,layerRenderIndex:l(h,f)};f&&(m.moduleParameters=this._getModuleParameters(h,s,i,o),m.layerParameters=this.getLayerParameters(h,u)),a[u]=m}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=Vg(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;hc(e,{scissorTest:!0,scissor:a},()=>fI(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Xu(e,{viewport:a});for(let c=0;c<t.length;c++){const u=t[c],{shouldDrawLayer:h,layerRenderIndex:f,moduleParameters:g,layerParameters:m}=o[c];if(h&&u.props.pickable&&l.pickableCount++,u.isComposite)l.compositeCount++;else if(h){l.visibleCount++,g.viewport=r;try{u.drawLayer({moduleParameters:g,uniforms:{layerIndex:f},parameters:m})}catch(v){u.raiseError(v,"drawing ".concat(u," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Vg(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function zz(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||zz(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class ehe extends zO{constructor(e,t){super(e,t),this.shadowMap=new ya(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new zg(e,{format:33189,width:1,height:1}),this.fbo=new ks(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;hc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Vg(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(Sn(ot({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const nhe=Object.keys(Vi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Vi[n],";")).join(""),ihe=Object.keys(Zc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Zc[n],";")).join(""),rhe="".concat(nhe,"\n").concat(ihe,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),she={},HO={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:rhe,getUniforms:function(n=she){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Vi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Vi.DEFAULT&&(i=n.isGeospatial?Vi.LNGLAT:Vi.CARTESIAN);const o=lce({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||sce,o}(n):{}}},che=Ox(function({viewport:n,center:e}){return new qn(n.viewProjectionMatrix).invert().transform(e)}),uhe=Ox(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=j0([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new Mo(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new qn).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),dhe=[0,0,0,1],hhe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],GO={name:"shadow",dependencies:[HO],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||dhe,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=che({viewport:n.viewport,center:e.project_uCenter}),r=[],s=uhe({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new Mo(n.viewport.center).negate());e.project_uCoordinateSystem===Vi.LNGLAT&&e.project_uProjectionMode===Zc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(hhe),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},_he={color:[255,255,255],intensity:1},Hz=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],yhe=[0,0,0,200/255];class $O extends Uz{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=yhe,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=F0.getDefaultProgramManager(e),GO&&this.programManager.addDefaultModule(GO)),this.dummyShadowMap||(this.dummyShadowMap=new ya(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(GO),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new qn).lookAt({eye:new Mo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new ehe(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new Vz(_he),this.directionalLights.push(new jz(Hz[0]),new jz(Hz[1])))}}let bhe=1,vhe=1;class Gz{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=bhe++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=vhe++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class whe{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=q0(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Ehe{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new whe(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const xhe=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},HO],She=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Che(n){const e=F0.getDefaultProgramManager(n);for(const t of xhe)e.addDefaultModule(t);for(const t of She)e.addShaderHook(t);return e}const Mhe=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Dhe{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Ehe({gl:e,protocol:"deck://"}),this.context=Sn(ot({},Mhe),{layerManager:this,gl:e,deck:t,programManager:e&&Che(e),stats:i||new oI({id:"deck.gl"}),viewport:r||new Jg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new Gz,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Do("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=xI(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return Do("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Ri.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Ri.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Ihe{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=xI(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!X0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ri.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ot({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=Sn(ot(ot(ot({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let u=r[a.id];a.controller&&!u&&(s=!0),(s||!a.controller)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,l,c,u),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class Rhe extends Bz{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:u=20,minZoom:h=0,maxPitch:f=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:v,startRotatePos:x,startBearing:U,startPitch:D,startZoom:ie,normalize:_e}={}){fc(Number.isFinite(s)),fc(Number.isFinite(r)),fc(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:u,minZoom:h,maxPitch:f,minPitch:g,normalize:_e}),this._state={startPanLngLat:m,startZoomLngLat:v,startRotatePos:x,startBearing:U,startPitch:D,startZoom:ie},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(Sn(ot({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(Sn(ot({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ot({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ot(ot(ot({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=Ua(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Ua(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=LU(t+180,360)-180),(o<-180||o>180)&&(o=LU(o+180,360)-180);const a=qI(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Zg([0,l])[1];if(i<c)i=c;else{const u=Zg([0,512-l])[1];i>u&&(i=u)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Ua(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=Ua(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let u=0;return r>0?Math.abs(l-o)>5&&(u=r/(o-l)*1.2):r<0&&o>5&&(u=1-s/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:c,deltaScaleY:u}}}class Phe extends UO{constructor(e){e.dragMode=e.dragMode||"pan",super(Rhe,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let Nhe=(()=>{class n extends jO{constructor(t){super(Sn(ot({},t),{type:KU}))}get controller(){return this._getControllerProps({type:Phe})}}return n.displayName="MapView",n})();const khe=new $O;class Fhe{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!X0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof $O)||this._internalEffects.push(khe)}}class Lhe extends zO{}const Wz={blendFunc:[1,0,32771,0],blendEquation:32774};class qz extends zO{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},pass:h="picking",redrawReason:f,pickZ:g}){const m=this.gl;return this.pickZ=g,hc(m,Sn(ot({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},Wz),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:h,redrawReason:f})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:Sn(ot({},Wz),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ot(ot({},e.props.parameters),i)}}class Vhe{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Lhe(e),this.pickLayersPass=new qz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||ks.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(Sn(ot({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,Do("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new ks(this.gl),new ks(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const jhe={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function Uhe({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let u=r*r,h=-1,f=0;for(let g=0;g<c;g++){const m=g+a-i,v=m*m;if(v>u)f+=4*l;else for(let x=0;x<l;x++){if(n[f+3]-1>=0){const D=x+o-t,ie=D*D+v;ie<=u&&(u=ie,h=f)}f+=4}}if(h>=0){const g=n[h+3]-1,m=n.slice(h,h+4),v=e[g];if(v){const x=v.decodePickingColor(m),U=Math.floor(h/4/l);return{pickedColor:m,pickedLayer:v,pickedObjectIndex:x,pickedX:o+(h/4-U*l),pickedY:a+U}}Ri.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return jhe}function Yz({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,u=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(f=>i({layer:l,viewport:f,isPicking:!0,renderPass:"picking:".concat(e)}))),h=u&&u.unproject([s-u.x,o-u.y],{targetZ:a});return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:h,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function Hhe(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const h=t.index,f=t.layerId,g=o&&o.props.id;if(g!==f||a!==h){if(g!==f){const m=r.find(v=>v.props.id===f);m&&l.unshift(m)}t.layerId=g,t.index=a,t.info=null}}const c=Yz(n),u=new Map;return u.set(null,c),l.forEach(h=>{let f=ot({},c);h===o&&(f.color=s,f.index=a,f.picked=!0),f=Xz({layer:h,info:f,mode:i}),h===o&&"hover"===i&&(t.info=f),u.set(f.layer.id,f),"hover"===i&&f.layer.updateAutoHighlight(f)}),u}function Xz({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class $he{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new qz(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(f=>f.id===o):null,c=a&&r.find(f=>f.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),h={x:e,y:t,viewport:c,coordinate:u,layer:l};return l?ot(ot({},s),h):Object.assign(h,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new ks(e),ks.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new ks(e),this.depthFBO.attach({36064:new ya(e,{format:Ci(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Ri.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:Yz({viewports:i,x:r,y:s})};this._resizeBuffer();const h=Vg(this.gl),f=iI(this.gl,[r,s],!0),g=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],m=Math.round(o*h),{width:v,height:x}=this.pickingFBO,U=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:v,deviceHeight:x});let D;const ie=[],_e={};for(let Pe=0;Pe<a;Pe++){const Ve=Uhe({pickedColors:U&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:U,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:U});let bt;if(Ve.pickedLayer&&c&&this.depthFBO&&(bt=this._drawAndSample({layers:[Ve.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:Ve.pickedX,y:Ve.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),Ve.pickedColor&&Pe+1<a){const xt=Ve.pickedColor[3]-1;_e[xt]=!0,e[xt].disablePickingIndex(Ve.pickedObjectIndex)}D=Hhe({pickInfo:Ve,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:bt,pixelRatio:h});for(const xt of D.values())xt.layer&&ie.push(xt);if(!Ve.pickedColor)break}for(const Pe in _e)e[Pe].restorePickingColors();return{result:ie,emptyInfo:D&&D.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const h=Vg(this.gl),f=iI(this.gl,[r,s],!0),g=f.x,m=f.y+f.height,v=iI(this.gl,[r+o,s+a],!0),U=v.y,_e=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Ri.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:U,width:v.x+v.width-g,height:m-U},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Pe=new Map,Ne=Number.isFinite(c);for(let Ve=0;Ve<_e.length&&!(Ne&&Pe.size>=c);Ve++){const bt=_e[Ve];let xt={color:bt.pickedColor,layer:null,index:bt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:h};xt=Xz({layer:bt.pickedLayer,info:xt,mode:l}),Pe.has(xt.object)||Pe.set(xt.object,xt)}return Array.from(Pe.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:u,y:h,width:f,height:g}=s,m=new(l?Float32Array:Uint8Array)(f*g*4);return px(c,{sourceX:u,sourceY:h,sourceWidth:f,sourceHeight:g,target:m}),m}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Whe={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class qhe{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Whe),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function Kz(n,e){if(!n)throw new Error(e)}const su={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Qz=su.global||su.self||su.window,Xhe="object"!=typeof process||"[object process]"!==String(process)||process.browser,Zz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:Khe}=(Zz&&parseFloat(Zz[1]),Qz),WO="undefined"!=typeof Image,qO="undefined"!=typeof ImageBitmap,Qhe=Boolean(Khe),YO=!!Xhe||Qhe;function Jz(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function e4(n){switch(Jz(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const efe=/^data:image\/svg\+xml/,tfe=/\.svg((\?|#).*)?$/;function XO(n){return n&&(efe.test(n)||tfe.test(n))}function nfe(n,e){if(XO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return n4(n,e)}function n4(n,e){if(XO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function i4(n,e,t){return KO.apply(this,arguments)}function KO(){return(KO=li(function*(n,e,t){const i=nfe(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield ife(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function ife(n,e){return QO.apply(this,arguments)}function QO(){return(QO=li(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const rfe={};let r4=!0;function sfe(n,e,t){return ZO.apply(this,arguments)}function ZO(){return(ZO=li(function*(n,e,t){let i;i=XO(t)?yield i4(n,e,t):n4(n,t);const r=e&&e.imagebitmap;return yield ofe(i,r)})).apply(this,arguments)}function ofe(n){return JO.apply(this,arguments)}function JO(){return(JO=li(function*(n,e=null){if((afe(e)||!r4)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),r4=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function afe(n){for(const e in n||rfe)return!1;return!0}const ou=!1,Q0=!0;function eR(n){const e=Z0(n);return function(n){const e=Z0(n);return e.byteLength>=24&&2303741511===e.getUint32(0,ou)?{mimeType:"image/png",width:e.getUint32(16,ou),height:e.getUint32(20,ou)}:null}(e)||function(n){const e=Z0(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,ou)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,ou);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,ou),width:e.getUint16(s+7,ou)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,ou)}return null}(e)||function(n){const e=Z0(n);return e.byteLength>=10&&1195984440===e.getUint32(0,ou)?{mimeType:"image/gif",width:e.getUint16(6,Q0),height:e.getUint16(8,Q0)}:null}(e)||function(n){const e=Z0(n);return e.byteLength>=14&&16973===e.getUint16(0,ou)&&e.getUint32(2,Q0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Q0),height:e.getUint32(22,Q0)}:null}(e)}function Z0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function ffe(n,e){const{mimeType:t}=eR(n)||{},{_parseImageNode:i}=Qz;return Kz(i),i(n,t,e)}function tR(){return(tR=li(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(gfe(r)){case"imagebitmap":a=yield sfe(n,e,s);break;case"image":a=yield i4(n,e,s);break;case"data":a=yield ffe(n,e);break;default:Kz(!1)}return"data"===r&&(a=e4(a)),a})).apply(this,arguments)}function gfe(n){switch(n){case"auto":case"data":return function(){if(qO)return"imagebitmap";if(WO)return"image";if(YO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return qO||WO||YO;case"imagebitmap":return qO;case"image":return WO;case"data":return YO;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const nR={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return tR.apply(this,arguments)},tests:[n=>Boolean(eR(new DataView(n)))],options:{image:{type:"auto",decode:!0}}};var nm=et(4761);const _fe={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},J0="8.5.8",Kx=nm.CO.deck&&nm.CO.deck.VERSION;if(Kx&&Kx!==J0)throw new Error("deck.gl - multiple versions detected: ".concat(Kx," vs ").concat(J0));Kx||(Ri.log(1,"deck.gl ".concat(J0))(),nm.CO.deck=Object.assign(nm.CO.deck||{},{VERSION:J0,version:J0,log:Ri,_registerLoggers:function(n){AI=n}}),Mz([_fe,[nR,{imagebitmap:{premultiplyAlpha:"none"}}]]));const yfe=nm.CO.deck;class Qx extends Ku{get[Symbol.toStringTag](){return"Query"}static isSupported(e,t=[]){const i=Ci(e),r=gj(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:on(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Qx.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const s4=fx()&&"undefined"!=typeof document;let Mfe=0;class Dfe{constructor(e={}){const{onCreateContext:t=(x=>XV(x)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:f=!0,autoResizeDrawingBuffer:g=!0,stats:m=Rf.get("animation-loop-"+Mfe++)}=e;let{useDevicePixels:v=!0}=e;"useDevicePixelRatio"in e&&(mn.deprecated("useDevicePixelRatio","useDevicePixels")(),v=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:f,autoResizeDrawingBuffer:g,useDevicePixels:v}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return on("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Qx.isSupported(this.gl,["timers"])?new Qx(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return li(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return mn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=s4?new Promise((e,t)=>{s4&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?sI(this.props.gl,e):this.onCreateContext(e),!dx(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Xu(n,nI)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(mn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(mn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ks(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Ife=et(1524),Zx=et.n(Ife);const Ofe={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(Zx().PointerEventInput),function(n){n.prototype.handler=function(t){let i=Ofe[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(Zx().MouseInput);const kfe=Zx().Manager,au=Zx(),Ffe=au?[[au.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[au.Rotate,{enable:!1}],[au.Pinch,{enable:!1}],[au.Swipe,{enable:!1}],[au.Pan,{threshold:0,enable:!1}],[au.Press,{enable:!1}],[au.Tap,{event:"doubletap",taps:2,enable:!1}],[au.Tap,{event:"anytap",enable:!1}],[au.Tap,{enable:!1}]]:null,l4={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Lfe={doubletap:["tap"]},Bfe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},rR={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Vfe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},c4={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},jfe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",im="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let u4=!1;try{const n={get passive(){return u4=!0,!0}};im.addEventListener("test",n,n),im.removeEventListener("test",n,n)}catch(n){}const Ufe=-1!==jfe.indexOf("firefox"),{WHEEL_EVENTS:zfe}=rR,h4=4.000244140625;class $fe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=zfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!u4&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;im.WheelEvent&&(Ufe&&e.deltaMode===im.WheelEvent.DOM_DELTA_PIXEL&&(t/=im.devicePixelRatio),e.deltaMode===im.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%h4==0&&(t=Math.floor(t/h4)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:Wfe}=rR,f4="pointermove",p4="pointerover",g4="pointerout",m4="pointerleave";class qfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Wfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===f4&&(this.enableMoveEvent=t),e===p4&&(this.enableOverEvent=t),e===g4&&(this.enableOutEvent=t),e===m4&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:p4,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:g4,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:m4,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:f4,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:Yfe}=rR,_4="keydown";class Xfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Yfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===_4&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:_4,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const b4="contextmenu";class Kfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===b4&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:b4,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const Qfe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},v4={srcElement:"root",priority:0};class cpe{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},v4,i):v4;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:h}=i[l];if(u(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),h&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=Qfe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const upe={events:null,recognizers:null,recognizerOptions:{},Manager:kfe,touchAction:"none",tabIndex:0};class dpe{constructor(e=null,t={}){this.options=Object.assign({},upe,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||Ffe}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(l4).forEach(r=>{const s=this.manager.get(r);s&&l4[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new $fe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new qfe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Xfe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Kfe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=Lfe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=c4[e]||e;let c=a.get(l);c||(c=new cpe(this),a.set(l,c),c.recognizerName=Vfe[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(c4[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=Bfe[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function Vf(){}const w4={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Vf,onResize:Vf,onViewStateChange:Vf,onInteractionStateChange:Vf,onBeforeRender:Vf,onAfterRender:Vf,onLoad:Vf,onError:(n,e)=>Ri.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class eS{constructor(e){e=ot(ot({},w4),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Ri.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,nm.qs)()&&Ri.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new oI({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&A0.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ri.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ri.removed("onLayerClick","onClick")(),e.initialViewState&&!X0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ot({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),fc(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u,autoResizeDrawingBuffer:h}=e;return new Dfe({width:t,height:i,useDevicePixels:u,autoResizeDrawingBuffer:h,autoResizeViewport:!1,gl:r,onCreateContext:f=>XV(Sn(ot(ot({},s),f),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Nhe({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,sI(e,{enable:!0,copyState:!0})),this.tooltip=new qhe(this.canvas),Xu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new Gz;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new dpe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in PV)this.eventManager.on(r,this._onEvent);this.viewManager=new Ihe({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Dhe(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new Fhe,this.deckRenderer=new Vhe(e),this.deckPicker=new $he(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Xu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ot({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Ri.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=Sn(ot({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=PV[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Rf.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}eS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(Uz)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},eS.defaultProps=w4,eS.VERSION=yfe.VERSION;const tS={name:"project32",dependencies:[HO],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},gpe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},nS=ot({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=gpe){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),E4={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class gh{static get DRAW_MODE(){return E4}constructor(e={}){const{id:t=ma("geometry"),drawMode:i=E4.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ot({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,on(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(on(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return on(Number.isFinite(i)),i}}const x4=()=>{},wpe={10241:9987,10240:9729,10242:33071,10243:33071};function Epe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function xpe(n,e,t,i){return t===e.width&&i===e.height?e:(n.canvas.height=i,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.canvas)}function eb(n){return n&&(n.id||n.url)}function S4(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];n[eb(r)]=Sn(ot({},r),{x:s,y:t})}}class Ape{constructor(e,{onUpdate:t=x4,onError:i=x4}){this.gl=e,this.onUpdate=t,this.onError=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?eb(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,data:s,getIcon:o}){e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),o&&(this._getIcon=o),r&&(this._mapping=r),i&&this._updateIconAtlas(i),this._autoPacking&&(s||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(s))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(e){var t;null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=e,this.onUpdate()}_updateAutoPacking(e){const t=Object.values(function(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=bx(n);for(const o of r){s.index++;const a=e(o,s),l=eb(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[l]&&(!t[l]||a.url!==t[l].url)&&(i[l]=Sn(ot({},a),{source:o,sourceIndex:s.index}))}return i}(e,this._getIcon,this._mapping)||{});if(t.length>0){const{mapping:i,xOffset:r,yOffset:s,rowHeight:o,canvasHeight:a}=function({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<n.length;l++){const c=n[l];if(!t[eb(c)]){const{height:h,width:f}=c;i+f+e>o&&(S4(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:c,xOffset:i}),i=i+f+e,s=Math.max(s,h)}}return a.length>0&&S4(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:Epe(s+r+e)}}({icons:t,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=r,this._yOffset=s,this._canvasHeight=a,this._texture||(this._texture=new ya(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:wpe})),this._texture.height!==this._canvasHeight&&(this._texture=function(n,e,t,i){const r=e.width,s=e.height,o=hj(e,{width:t,height:i});return function(n,e,t={}){const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=t;const{framebuffer:f,deleteFramebuffer:g}=T0(n);on(f);const{gl:m,handle:v}=f,x=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const U=m.bindFramebuffer(36160,v);on(e);let D=null;if(e instanceof Pf&&(D=e,u=Number.isFinite(u)?u:D.width,h=Number.isFinite(h)?h:D.height,D.bind(0),e=D.target),x)switch(e){case 3553:case 34067:m.copyTexSubImage2D(e,s,a,l,i,r,u,h);break;case 35866:case 32879:Ao(m).copyTexSubImage3D(e,s,a,l,c,i,r,u,h)}else m.copyTexImage2D(e,s,o,i,r,u,h,0);D&&D.unbind(),m.bindFramebuffer(36160,U||null),g&&f.delete()}(e,o,{targetY:0,width:r,height:s}),e.delete(),o}(0,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(t)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,q0(i.url,nR,this._loadOptions).then(r=>{const s=eb(i),{x:o,y:a,width:l,height:c}=this._mapping[s],u=xpe(t,r,l,c);this._texture.setSubImageData({data:u,x:o,y:a,width:l,height:c}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const C4=[0,0,0,255],Mpe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:C4},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};let Dpe=(()=>{class n extends Y0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[tS,nS]})}initializeState(){this.state={iconManager:new Ape(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:C4},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:i,changeFlags:r}){super.updateState({props:i,oldProps:t,changeFlags:r});const s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c}=i,{iconManager:u}=this.state;u.setProps({loadOptions:i.loadOptions});let h=!1;if(o||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==i.iconAtlas&&u.setProps({iconAtlas:o,autoPacking:!1}),t.iconMapping!==i.iconMapping&&(u.setProps({iconMapping:a}),h=!0)):u.setProps({autoPacking:!0}),(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.setProps({data:l,getIcon:c}),h&&(s.invalidate("instanceOffsets"),s.invalidate("instanceIconFrames"),s.invalidate("instanceColorModes")),r.extensionsChanged){var g;const{gl:m}=this.context;null===(g=this.state.model)||void 0===g||g.delete(),this.state.model=this._getModel(m),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:i,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:o,billboard:a,alphaCutoff:l}=this.props,{iconManager:c}=this.state,{viewport:u}=this.context,h=c.getTexture();h&&this.state.model.setUniforms(t).setUniforms({iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeScale:i*("pixels"===o?u.metersPerPixel:1),sizeMinPixels:r,sizeMaxPixels:s,billboard:a,alphaCutoff:l}).draw()}_getModel(t){return new Yg(t,Sn(ot({},this.getShaders()),{id:this.props.id,geometry:new gh({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:i}=this.getCurrentLayer().props;i?i(t):Ri.error(t.error)()}getInstanceOffset(t){const i=this.state.iconManager.getIconMapping(t);return[i.width/2-i.anchorX||0,i.height/2-i.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const i=this.state.iconManager.getIconMapping(t);return[i.x||0,i.y||0,i.width||0,i.height||0]}}return n.layerName="IconLayer",n.defaultProps=Mpe,n})();const A4=[],Ope={getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};let Rpe=(()=>{class n extends Dpe{getShaders(){return Sn(ot({},super.getShaders()),{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(i,{index:r,target:s})=>this.encodePickingColor(r,s)}})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;let{outlineColor:s}=i;s!==r.outlineColor&&(s=s.map(o=>o/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!i.sdf&&i.outlineWidth&&Ri.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:i,smoothing:r,outlineWidth:s}=this.props,{outlineColor:o}=this.state;t.uniforms=Sn(ot({},t.uniforms),{buffer:.75,outlineBuffer:s?Math.max(r,.75*(1-s)):-1,gamma:r,sdf:Boolean(i),outlineColor:o}),super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map(i=>super.getInstanceOffset(i)):A4}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map(i=>super.getInstanceIconFrame(i)):A4}}return n.layerName="MultiIconLayer",n.defaultProps=Ope,n})();var Ppe=et(1002),Npe=et.n(Ppe);const Fpe=[];function Lpe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function M4(n,e,t,i){let r=0;for(let s=e;s<t;s++){const o=n[s];let a=null;const l=i&&i[o];l&&(a=l.width),r+=a}return r}function D4(n,e,t,i,r,s){let o=e,a=0;for(let l=e;l<t;l++){const c=M4(n,l,l+1,r);a+c>i&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function jpe(n,e,t,i,r=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?D4(n,r,s,t,i,o):function(n,e,t,i,r,s){let o=e,a=e,l=e,c=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(l=u+1),l>a){let h=M4(n,a,l,r);c+h>i&&(o<a&&(s.push(a),o=a,c=0),h>i&&(h=D4(n,a,l,i,r,s),o=s[s.length-1])),a=l,c+=h}}(n,r,s,t,i,o),o}function Upe(n,e,t,i,r,s){let o=0,a=0;for(let l=e;l<t;l++){const c=n[l],u=i[c];u?(a||(a=u.height),r[l]=o+u.width/2,o+=u.width):(Ri.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),r[l]=o,o+=32)}s[0]=o,s[1]=a}function I4(n,e,t,i,r){const s=(n=Array.from(n)).length,o=new Array(s),a=new Array(s),l=new Array(s),c=("break-word"===t||"break-all"===t)&&isFinite(i)&&i>0,u=[0,0],h=[];let f=0,g=0,m=0;for(let v=0;v<=s;v++){const x=n[v];if(("\n"===x||v===s)&&(m=v),m>g){const U=c?jpe(n,t,i,r,g,m):Fpe;for(let D=0;D<=U.length;D++){const ie=0===D?g:U[D-1],_e=D<U.length?U[D]:m;Upe(n,ie,_e,r,o,h);for(let Pe=ie;Pe<_e;Pe++)a[Pe]=f+h[1]/2,l[Pe]=h[0];f+=h[1]*e,u[0]=Math.max(u[0],h[0])}g=m}"\n"===x&&(o[g]=0,a[g]=0,l[g]=0,g++)}return u[1]=f,{x:o,y:a,rowWidth:l,size:u}}const O4=function(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),R4="Monaco, monospace",aR=new class{constructor(e=5){this.limit=e,this.clear()}clear(){this._cache={},this._order=[]}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}_deleteCache(e){delete this._cache[e]}_deleteOrder(e){const t=this._order.findIndex(i=>i===e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}(3),qpe=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Xpe(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function j4(n,e,t,i){n.font="".concat(i," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="baseline",n.textAlign="left"}class Kpe{constructor(){this.props={fontFamily:R4,fontWeight:"normal",characterSet:O4,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){qpe.forEach(o=>{o in e&&(this.props[o]=e[o])});const t=this._key;this._key=this._getKey();const i=function(n,e){const t=aR.get(n);if(!t)return e;const i=[];let s=Object.keys(t.mapping);s=new Set(s);let o=e;return o instanceof Array&&(o=new Set(o)),o.forEach(a=>{s.has(a)||i.push(a)}),i}(this._key,this.props.characterSet),r=aR.get(this._key);if(r&&0===i.length)return void(this._key!==t&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,aR.set(this._key,s)}_generateFontAtlas(e,t,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:c,cutoff:u}=this.props;let h=i&&i.data;h||(h=document.createElement("canvas"),h.width=1024);const f=h.getContext("2d");j4(f,r,o,s);const{mapping:g,canvasHeight:m,xOffset:v,yOffset:x}=function({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o,u=0;for(const f of n)if(!s[f]){const g=e(f,u++);c+g+2*i>r&&(c=0,l++),s[f]={x:c+i,y:a+l*(t+2*i)+i,width:g,height:t},c+=g+2*i}const h=t+2*i;return{mapping:s,xOffset:c,yOffset:a+l*h,canvasHeight:Lpe(a+(l+1)*h)}}(ot({getFontWidth:U=>f.measureText(U).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}));if(h.height!==m){const U=f.getImageData(0,0,h.width,h.height);h.height=m,f.putImageData(U,0,0)}if(j4(f,r,o,s),l){const U=new(Npe())(o,a,c,u,r,s),D=f.getImageData(0,0,U.size,U.size);for(const ie of t)Xpe(U.draw(ie),D),f.putImageData(D,g[ie].x-a,g[ie].y+a)}else for(const U of t)f.fillText(U,g[U].x,g[U].y+.9*o);return{xOffset:v,yOffset:x,mapping:g,data:h,width:h.width,height:h.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(i," ").concat(r)}}const Jpe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};let ege=(()=>{class n extends Y0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[tS,nS]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),r.extensionsChanged){var s;const{gl:o}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(o),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:i}=this.context,{billboard:r,sizeScale:s,sizeUnits:o,sizeMinPixels:a,sizeMaxPixels:l,getLineWidth:c}=this.props;let{padding:u}=this.props;const h="pixels"===o?i.metersPerPixel:1;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:r,stroked:Boolean(c),padding:u,sizeScale:s*h,sizeMinPixels:a,sizeMaxPixels:l}).draw()}_getModel(t){return new Yg(t,Sn(ot({},this.getShaders()),{id:this.props.id,geometry:new gh({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}return n.layerName="TextBackgroundLayer",n.defaultProps=Jpe,n})();const U4={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},z4={start:1,middle:0,end:-1},H4={top:1,center:0,bottom:-1},lR=[0,0,0,255],nge=["fontSize","buffer","sdf","radius","cutoff"],ige={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:lR},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:O4},fontFamily:R4,fontWeight:"normal",lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:lR},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:lR},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};let rge=(()=>{class n extends Nz{initializeState(){this.state={styleVersion:0,fontAtlasManager:new Kpe}}updateState({props:t,oldProps:i,changeFlags:r}){const o=this.state.characterSet;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();const a=o!==this.state.characterSet||this._fontChanged(i,t);a&&this._updateFontAtlas(i,t),(a||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,i){const{fontSettings:r,fontFamily:s,fontWeight:o}=i,{fontAtlasManager:a,characterSet:l}=this.state;a.setProps(Sn(ot(ot({},U4),r),{characterSet:l,fontFamily:s,fontWeight:o}))}_fontChanged(t,i){if(t.fontFamily!==i.fontFamily||t.fontWeight!==i.fontWeight)return!0;if(t.fontSettings===i.fontSettings)return!1;const r=t.fontSettings||{},s=i.fontSettings||{};return nge.some(o=>r[o]!==s[o])}_updateText(){const{data:t,characterSet:i}=this.props,r=t.attributes&&t.attributes.getText;let a,{getText:s}=this.props,{startIndices:o}=t;const l="auto"===i&&new Set;if(r&&o){const{texts:c,characterCount:u}=function({value:n,length:e,stride:t,offset:i,startIndices:r,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,l=i?i/o:0,c=r[e]||Math.ceil((n.length-l)/a),u=s&&new Set,h=new Array(e);let f=n;if(a>1||l>0){f=new n.constructor(c);for(let g=0;g<c;g++)f[g]=n[g*a+l]}for(let g=0;g<e;g++){const x=f.subarray(r[g],r[g+1]||c);h[g]=String.fromCodePoint.apply(null,x),u&&x.forEach(u.add,u)}if(u)for(const g of u)s.add(String.fromCodePoint(g));return{texts:h,characterCount:c}}(Sn(ot({},ArrayBuffer.isView(r)?{value:r}:r),{length:t.length,startIndices:o,characterSet:l}));a=u,s=(h,{index:f})=>c[f]}else{const{iterable:c,objectInfo:u}=bx(t);o=[0],a=0;for(const h of c){u.index++;const f=Array.from(s(h,u)||"");l&&f.forEach(l.add,l),a+=f.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||i})}getBoundingRect(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{size:[f,g]}=I4(h,l,o,a,r);return[(z4["function"==typeof c?c(t,i):c]-1)*f/2,(H4["function"==typeof u?u(t,i):u]-1)*g/2,f,g]}getIconOffsets(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{x:f,y:g,rowWidth:m,size:[v,x]}=I4(h,l,o,a,r),U=z4["function"==typeof c?c(t,i):c],D=H4["function"==typeof u?u(t,i):u],ie=f.length,_e=new Array(2*ie);let Pe=0;for(let Ne=0;Ne<ie;Ne++)_e[Pe++]=(U-1)*v/2+(1-U)*(v-m[Ne])/2+f[Ne],_e[Pe++]=(D-1)*x/2+g[Ne];return _e}renderLayers(){const{startIndices:t,numInstances:i,getText:r,fontAtlasManager:{scale:s,texture:o,mapping:a},styleVersion:l}=this.state,{data:c,_dataDiff:u,getPosition:h,getColor:f,getSize:g,getAngle:m,getPixelOffset:v,getBackgroundColor:x,getBorderColor:U,getBorderWidth:D,backgroundPadding:ie,background:_e,billboard:Pe,fontSettings:Ne,outlineWidth:Ve,outlineColor:bt,sizeScale:xt,sizeUnits:At,sizeMinPixels:Bt,sizeMaxPixels:Wt,transitions:gt,updateTriggers:mt}=this.props,jt=this.getSubLayerClass("characters",Rpe),ft=this.getSubLayerClass("background",ege);return[_e&&new ft({getFillColor:x,getLineColor:U,getLineWidth:D,padding:ie,getPosition:h,getSize:g,getAngle:m,getPixelOffset:v,billboard:Pe,sizeScale:xt/this.state.fontAtlasManager.props.fontSize,sizeUnits:At,sizeMinPixels:Bt,sizeMaxPixels:Wt,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getSize:gt.getSize,getFillColor:gt.getBackgroundColor,getLineColor:gt.getBorderColor,getLineWidth:gt.getBorderWidth,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:mt.getPosition,getAngle:mt.getAngle,getSize:mt.getSize,getFillColor:mt.getBackgroundColor,getLineColor:mt.getBorderColor,getLineWidth:mt.getBorderWidth,getPixelOffset:mt.getPixelOffset,getBoundingRect:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c.attributes?{length:c.length,attributes:c.attributes.background||{}}:c,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new jt({sdf:Ne.sdf,smoothing:Number.isFinite(Ne.smoothing)?Ne.smoothing:U4.smoothing,outlineWidth:Ve,outlineColor:bt,iconAtlas:o,iconMapping:a,getPosition:h,getColor:f,getSize:g,getAngle:m,getPixelOffset:v,billboard:Pe,sizeScale:xt*s,sizeUnits:At,sizeMinPixels:Bt*s,sizeMaxPixels:Wt*s,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getColor:gt.getColor,getSize:gt.getSize,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:mt.getText,getPosition:mt.getPosition,getAngle:mt.getAngle,getColor:mt.getColor,getSize:mt.getSize,getPixelOffset:mt.getPixelOffset,getIconOffsets:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c,_dataDiff:u,startIndices:t,numInstances:i,getIconOffsets:this.getIconOffsets.bind(this),getIcon:r})]}}return n.layerName="TextLayer",n.defaultProps=ige,n})();const G4="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",sge={lightSources:{}};function cR({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const uR={name:"lights",vs:G4,fs:G4,getUniforms:function $4(n=sge){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?cR(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=cR(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=cR(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return $4({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},age={};const cge={name:"phong-lighting",dependencies:[uR],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=age){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},dR=Math.PI/180,iS=new Float32Array(16),Y4=new Float32Array(12);function X4(n,e,t){const i=e[0]*dR,r=e[1]*dR,s=e[2]*dR,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),u=Math.cos(i),h=Math.cos(r),f=t[0],g=t[1],m=t[2];n[0]=f*h*u,n[1]=f*l*u,n[2]=f*-a,n[3]=g*(-l*c+h*a*o),n[4]=g*(h*c+l*a*o),n[5]=g*u*o,n[6]=m*(l*o+h*a*c),n[7]=m*(-h*o+l*a*c),n[8]=m*u*c}function K4(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const Q4={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,u=Array.isArray(s),h=Array.isArray(r),f=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:h&&u&&f;const m=n.value;if(n.constant){let v;g?(iS.set(a),v=K4(iS)):(v=Y4,X4(v,r,s),v.set(o,9)),n.value=new Float32Array(v)}else{let v=e*n.size;const{iterable:x,objectInfo:U}=bx(i,e,t);for(const D of x){let ie;U.index++,g?(iS.set(c?a:a(D,U)),ie=K4(iS)):(ie=Y4,X4(ie,h?r:r(D,U),u?s:s(D,U)),ie.set(f?o:o(D,U),9)),m[v++]=ie[0],m[v++]=ie[1],m[v++]=ie[2],m[v++]=ie[3],m[v++]=ie[4],m[v++]=ie[5],m[v++]=ie[6],m[v++]=ie[7],m[v++]=ie[8],m[v++]=ie[9],m[v++]=ie[10],m[v++]=ie[11]}}}};function Z4(n,e){return e===Vi.CARTESIAN||e===Vi.METER_OFFSETS||e===Vi.DEFAULT&&!n.isGeospatial}function J4(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Ri.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function hge(n,e){if(n.attributes)return J4(n.attributes,e),n instanceof gh?n:new gh(n);if(n.positions||n.POSITION)return J4(n,e),new gh({attributes:n});throw Error("Invalid mesh")}const fge={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let pge=(()=>{class n extends Y0{getShaders(){const t=!Ci(this.context.gl),i={};return mI(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[tS,cge,nS],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Q4}),this.setState({emptyTexture:new ya(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||Z4(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new Yg(this.context.gl,Sn(ot({},this.getShaders()),{id:this.props.id,geometry:hge(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=fge,n})();const eH={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[uR]};class rm{constructor(e={}){const{id:t}=e;this.id=t||ma(this.constructor.name),this.display=!0,this.position=new Mo,this.rotation=new Mo,this.scale=new Mo(1,1,1),this.matrix=new qn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return on(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return on(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return on(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){on(e),t=t||this.matrix;const i=new qn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class tb extends rm{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;mn.assert(t.every(i=>i instanceof rm),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new qn}={}){const i=new qn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof tb?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function tH(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=t[0],g=t[1],m=t[2],v=t[3],x=t[4],U=t[5],D=t[6],ie=t[7],_e=t[8];return n[0]=f*i+g*o+m*c,n[1]=f*r+g*a+m*u,n[2]=f*s+g*l+m*h,n[3]=v*i+x*o+U*c,n[4]=v*r+x*a+U*u,n[5]=v*s+x*l+U*h,n[6]=D*i+ie*o+_e*c,n[7]=D*r+ie*a+_e*u,n[8]=D*s+ie*l+_e*h,n}function nH(n,e,t){var i=t[0],r=t[1];return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=r*e[3],n[4]=r*e[4],n[5]=r*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function iH(){var n=new ba(4);return ba!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function rH(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function hR(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function rS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}function sH(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a,n}function oH(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a,n}function aH(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a,n}function lH(n,e){var t=e[0],i=e[1],r=e[2];return n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r)),n}function nb(n,e,t,i){var f,g,m,v,x,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],h=t[3];return(g=r*l+s*c+o*u+a*h)<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>eu?(f=Math.acos(g),m=Math.sin(f),v=Math.sin((1-i)*f)/m,x=Math.sin(i*f)/m):(v=1-i,x=i),n[0]=v*r+x*l,n[1]=v*s+x*c,n[2]=v*o+x*u,n[3]=v*a+x*h,n}function cH(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;return n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a,n}function uH(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function fR(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}var dH=function(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},pR=IU,gR=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},hH=function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a),n},fH=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},pH=function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r},mH=function(){var n=bj(),e=vj(1,0,0),t=vj(0,1,0);return function(i,r,s){var o=wj(r,s);return o<-.999999?(D0(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&D0(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),hR(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(D0(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();iH(),iH(),function(){var n=new ba(9);ba!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const Sge=[0,0,0,1];class mR extends mx{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return fR(this,e),this.check()}identity(){return rH(this),this.check()}fromAxisRotation(e,t){return hR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=nr(e)}get y(){return this[1]}set y(e){this[1]=nr(e)}get z(){return this[2]}set z(e){this[2]=nr(e)}get w(){return this[3]}set w(e){this[3]=nr(e)}len(){return fH(this)}lengthSquared(){return pH(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return gR(this,e)}rotationTo(e,t){return mH(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return dH(this,this,e),this.check()}calculateW(){return lH(this,this),this.check()}conjugate(){return uH(this,this),this.check()}invert(){return cH(this,this),this.check()}lerp(e,t,i){return hH(this,e,t,i),this.check()}multiplyRight(e,t){return Zu(!t),rS(this,this,e),this.check()}multiplyLeft(e,t){return Zu(!t),rS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return sH(this,this,e),this.check()}rotateY(e){return oH(this,this,e),this.check()}rotateZ(e){return aH(this,this,e),this.check()}scale(e){return pR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=Sge,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return nb(this,e,t,i),this.check()}transformVector4(e,t=e){return OU(t,e,this),_x(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const Cge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Tge={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function _H(n){if(!n._animation){const e=Tge[n.componentType],t=Cge[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const Age=new qn,_R=new mR;class Pge{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(f=>f>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:mn.warn(`Bad animation path ${s}`)()}on(r[s].length===i[c].length);const u=e[c],h=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":h>u&&function(n,e,t,i,r){if("rotation"===e){_R.slerp({start:t,target:i,ratio:r});for(let s=0;s<_R.length;s++)n[e][s]=_R[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-u)/(h-u));break;case"CUBICSPLINE":h>u&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,u=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*u}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:h-u,ratio:(a-u)/(h-u)});break;default:mn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=Age.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class Nge{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:_H(e.accessors[a]),interpolation:l,output:_H(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new Pge({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class kge extends rm{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof Yg?(this.model=e,this._setModelNodeProps(t)):this.model=new Yg(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class Fge{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},mI(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new ya(this.gl,ot({id:e.name||e.id,parameters:ot(ot({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(mn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function yH(n,e){return Ci(n)?`#version 300 es\n${e}`:e}const jge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Uge={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class zge{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Uge,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Nge(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new tb({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new tb({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new qn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new tb({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){mn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new Fge(n,e);mn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(u=>u.buffer));const c=new kge(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[eH],defines:a.defines,parameters:a.parameters,vs:yH(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:yH(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),mn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new lr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new _a({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:jge[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function bH(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function $a(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function vH(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function wH(n,e,t){const i=n.bufferViews[t];$a(i);const s=e[i.buffer];return $a(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const EH={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class sm{constructor(e,t){Kn(this,"fields",void 0),Kn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new sm(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new sm(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof sm){const o=e;t=o.fields,i=xH(xH(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new sm(s,i)}}function xH(n,e){return new Map([...n||new Map,...e||new Map])}let kr,SH,CH,TH,AH,MH,DH,IH;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(kr||(kr={}));class yR{static isNull(e){return e&&e.typeId===kr.Null}static isInt(e){return e&&e.typeId===kr.Int}static isFloat(e){return e&&e.typeId===kr.Float}static isBinary(e){return e&&e.typeId===kr.Binary}static isUtf8(e){return e&&e.typeId===kr.Utf8}static isBool(e){return e&&e.typeId===kr.Bool}static isDecimal(e){return e&&e.typeId===kr.Decimal}static isDate(e){return e&&e.typeId===kr.Date}static isTime(e){return e&&e.typeId===kr.Time}static isTimestamp(e){return e&&e.typeId===kr.Timestamp}static isInterval(e){return e&&e.typeId===kr.Interval}static isList(e){return e&&e.typeId===kr.List}static isStruct(e){return e&&e.typeId===kr.Struct}static isUnion(e){return e&&e.typeId===kr.Union}static isFixedSizeBinary(e){return e&&e.typeId===kr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===kr.FixedSizeList}static isMap(e){return e&&e.typeId===kr.Map}static isDictionary(e){return e&&e.typeId===kr.Dictionary}get typeId(){return kr.NONE}compareTo(e){return this===e}}Symbol,Symbol,SH=Symbol.toStringTag;class om extends yR{constructor(e,t){super(),Kn(this,"isSigned",void 0),Kn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return kr.Int}get[SH](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class Zge extends om{constructor(){super(!0,8)}}class Jge extends om{constructor(){super(!0,16)}}class eme extends om{constructor(){super(!0,32)}}class tme extends om{constructor(){super(!1,8)}}class nme extends om{constructor(){super(!1,16)}}class ime extends om{constructor(){super(!1,32)}}CH=Symbol.toStringTag;class OH extends yR{constructor(e){super(),Kn(this,"precision",void 0),this.precision=e}get typeId(){return kr.Float}get[CH](){return"Float"}toString(){return`Float${this.precision}`}}class rme extends OH{constructor(){super(32)}}class sme extends OH{constructor(){super(64)}}Symbol,Symbol,TH=Symbol.toStringTag,AH=Symbol.toStringTag,MH=Symbol.toStringTag,DH=Symbol.toStringTag,IH=Symbol.toStringTag;class ome extends yR{constructor(e,t){super(),Kn(this,"listSize",void 0),Kn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return kr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[IH](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class sS{constructor(e,t,i=!1,r=new Map){Kn(this,"name",void 0),Kn(this,"type",void 0),Kn(this,"nullable",void 0),Kn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new sS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function RH(n,e,t){const i=t?PH(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new Zge;case Uint8Array:return new tme;case Int16Array:return new Jge;case Uint16Array:return new nme;case Int32Array:return new eme;case Uint32Array:return new ime;case Float32Array:return new rme;case Float64Array:return new sme;default:throw new Error("array type not supported")}}(e.value);return new sS(n,new ome(e.size,new sS("value",r)),!1,i)}function PH(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const NH={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},ume={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class hme{constructor(e){Kn(this,"draco",void 0),Kn(this,"decoder",void 0),Kn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const f=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(f)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const u=a[c],h=a[c+1],f=a[c+2];e=u<e?u:e,t=h<t?h:t,i=f<i?f:i,r=u>r?u:r,s=h>s?h:s,o=f>o?f:o}return[[e,t,i],[r,s,o]]}(l.attributes),u=function(n,e,t){const i=PH(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=RH(o,n[o],s[o]);r.push(l)}if(t){const o=RH("indices",t);r.push(o)}return new sm(r,i)}(l.attributes,a,l.indices);return Sn(ot({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:u})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=ume[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,l,a,u),c=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in NH)if(this.draco[o]===r)return NH[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var oS=et(9125);const ER={};function xR(n){return SR.apply(this,arguments)}function SR(){return(SR=li(function*(n,e=null,t={}){return e&&(n=_me(n,e,t)),ER[n]=ER[n]||yme(n),yield ER[n]})).apply(this,arguments)}function _me(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:_O?t.CDN?(nu(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):yO?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function yme(n){return CR.apply(this,arguments)}function CR(){return(CR=li(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():_O?yO?importScripts(n):bme(yield(yield fetch(n)).text(),n):oS.requireFromFile&&(yield oS.requireFromFile(n))})).apply(this,arguments)}function bme(n,e){if(!_O)return oS.requireFromString&&oS.requireFromString(n,e);if(yO)return eval.call(Iue,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const vme="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",wme="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",Eme="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let ib;function Sme(n){return TR.apply(this,arguments)}function TR(){return(TR=li(function*(n){const e=n.modules||{};return ib=e.draco3d?ib||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):ib||Cme(n),yield ib})).apply(this,arguments)}function Cme(n){return MR.apply(this,arguments)}function MR(){return(MR=li(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield xR(vme,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield xR(wme,"draco",n),yield xR(Eme,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield Tme(e,t)})).apply(this,arguments)}function Tme(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(Sn(ot({},t),{onModuleLoaded:r=>i({draco:r})}))})}const IR=Sn(ot({},EH),{parse:function(n,e){return OR.apply(this,arguments)}});function OR(){return(OR=li(function*(n,e){const{draco:t}=yield Sme(e),i=new hme(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function sb(n,e){return Lf(n>=0),Lf(e>0),n+(e-1)&~(e-1)}function Dme(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+sb(i.byteLength,4)}const kH=["SCALAR","VEC2","VEC3","VEC4"],Ime=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Ome=new Map(Ime),Rme={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Pme={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Nme={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function FH(n){return kH[n-1]||kH[0]}function LH(n){const e=Ome.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function BH(n,e){const t=Nme[n.componentType],i=Rme[n.type],s=n.count*i,o=n.count*i*Pme[n.componentType];return $a(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const kme={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class _h{constructor(e){Kn(this,"gltf",void 0),Kn(this,"sourceBuffers",void 0),Kn(this,"byteLength",void 0),this.gltf=e||{json:ot({},kme),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return $a(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=BH(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return $a(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return $a(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=eR(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;$a(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=sb(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:FH(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:LH(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=Dme(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const VH="KHR_binary_glTF",ob="KHR_draco_mesh_compression",am="KHR_lights_punctual",lS="KHR_materials_unlit",cS="KHR_techniques_webgl";function Bme(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=jH(i);e[t]=r}}return e}function jH(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:FH(t),componentType:LH(e)}}function Ume(n,e,t){return RR.apply(this,arguments)}function RR(){return(RR=li(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new _h(n),s=[];for(const o of Wme(r))r.getObjectExtension(o,ob)&&s.push(Hme(r,o,e,t));yield Promise.all(s),r.removeExtension(ob)})).apply(this,arguments)}function zme(n,e={}){const t=new _h(n);for(const i of t.json.meshes||[])Gme(i),t.addRequiredExtension(ob)}function Hme(n,e,t,i){return PR.apply(this,arguments)}function PR(){return(PR=li(function*(n,e,t,i){const r=n.getObjectExtension(e,ob);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=Sz(s.buffer,s.byteOffset),{parse:a}=i,l=ot({},t);delete l["3d-tiles"];const c=yield a(o,IR,l,i),u=Bme(c.attributes);for(const[h,f]of Object.entries(u))if(h in e.attributes){const m=n.getAccessor(e.attributes[h]);null!=m&&m.min&&null!=m&&m.max&&(f.min=m.min,f.max=m.max)}e.attributes=u,c.indices&&(e.indices=jH(c.indices)),$me(e)})).apply(this,arguments)}function Gme(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[ob]:{bufferView:c,attributes:l}}}]}}function $me(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Wme(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function qme(n){return NR.apply(this,arguments)}function NR(){return(NR=li(function*(n){const e=new _h(n),{json:t}=e;e.removeExtension(lS);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,lS)})).apply(this,arguments)}function Yme(n){const e=new _h(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,lS,{}),e.addExtension(lS))}function Xme(n){return kR.apply(this,arguments)}function kR(){return(kR=li(function*(n){const e=new _h(n),{json:t}=e,i=e.getExtension(am);i&&(e.json.lights=i.lights,e.removeExtension(am));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,am);s&&(r.light=s.light),e.removeObjectExtension(r,am)}})).apply(this,arguments)}function Kme(n){return FR.apply(this,arguments)}function FR(){return(FR=li(function*(n){const e=new _h(n),{json:t}=e;if(t.lights){const i=e.addExtension(am);$a(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,am,i);delete e.json.lights}})).apply(this,arguments)}function Qme(n){return LR.apply(this,arguments)}function LR(){return(LR=li(function*(n){const e=new _h(n),{json:t}=e,i=e.getExtension(cS);if(i){const r=Jme(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,cS);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=e_e(s.technique,e)),e.removeObjectExtension(s,cS)}e.removeExtension(cS)}})).apply(this,arguments)}function Zme(n,e){return BR.apply(this,arguments)}function BR(){return(BR=li(function*(n,e){})).apply(this,arguments)}function Jme(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function e_e(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const UH={KHR_draco_mesh_compression:yt,KHR_materials_unlit:ee,KHR_lights_punctual:Dt,KHR_techniques_webgl:dt};function t_e(n){return VR.apply(this,arguments)}function VR(){return(VR=li(function*(n,e={},t){for(const r in UH){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield UH[r].decode(n,e,t))}})).apply(this,arguments)}const zH={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},i_e={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class r_e{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new _h(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,VH);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(VH)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in zH)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in zH)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=i_e[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function s_e(n,e={}){return(new r_e).normalize(n,e)}const o_e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},a_e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ml={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},l_e={magFilter:Ml.TEXTURE_MAG_FILTER,minFilter:Ml.TEXTURE_MIN_FILTER,wrapS:Ml.TEXTURE_WRAP_S,wrapT:Ml.TEXTURE_WRAP_T},c_e={[Ml.TEXTURE_MAG_FILTER]:Ml.LINEAR,[Ml.TEXTURE_MIN_FILTER]:Ml.NEAREST_MIPMAP_LINEAR,[Ml.TEXTURE_WRAP_S]:Ml.REPEAT,[Ml.TEXTURE_WRAP_]:Ml.REPEAT};class h_e{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return $a(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ot({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ot({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ot({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ot({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ot({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ot({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ot({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return a_e[n]}(e.componentType),e.components=function(n){return o_e[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=BH(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):c_e,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return l_e[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function f_e(n,e){return(new h_e).postProcess(n,e)}const HH=1735152710,lm=!0;function UR(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),sb(i,4)}function zR(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),sb(i,4)}function C_e(n,e){return HR.apply(this,arguments)}function HR(){return(HR=li(function*(n,e,t=0,i,r){var s,o,a,l;T_e(n,e,t,i),s_e(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield A_e(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const h=M_e(n,i,r);c.push(h)}const u=t_e(n,i,r);return c.push(u),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?f_e(n,i):n})).apply(this,arguments)}function T_e(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=HH}=t,s=i.getUint32(e,!1);return s===r||s===HH}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?bH(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?bH(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,lm),a=r.getUint32(t+8,lm);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){Lf(n.header.byteLength>20);const i=e.getUint32(t+0,lm),r=e.getUint32(t+4,lm);return t+=8,Lf(0===r),UR(n,e,t,i),(t+=i)+zR(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return Lf(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,lm),s=e.getUint32(t+4,lm);switch(t+=8,s){case 1313821514:UR(n,e,t,r);break;case 5130562:zR(n,e,t,r);break;case 0:i.strict||UR(n,e,t,r);break;case 1:i.strict||zR(n,e,t,r)}t+=sb(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),$a("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else $a(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function A_e(n,e,t){return GR.apply(this,arguments)}function GR(){return(GR=li(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;$a(a);const l=vH(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),u=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}}})).apply(this,arguments)}function M_e(n,e,t){return $R.apply(this,arguments)}function $R(){return($R=li(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(D_e(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function D_e(n,e,t,i,r){return WR.apply(this,arguments)}function WR(){return(WR=li(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=vH(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=wH(n.json,n.buffers,e.bufferView);a=Sz(c.buffer,c.byteOffset,c.byteLength)}$a(a,"glTF image has no data");const l=yield o(a,nR,{},r);n.images[t]=l})).apply(this,arguments)}const cm={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return qR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function qR(){return(qR=li(function*(n,e={},t){(e=ot(ot({},cm.options),e)).gltf=ot(ot({},cm.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield C_e({},n,i,e,t)})).apply(this,arguments)}function YR(){return(YR=li(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield R_e(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function R_e(n){return XR.apply(this,arguments)}function XR(){return(XR=li(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const GH=[255,255,255,255],k_e={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:GH},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[cm]};let F_e=(()=>{class n extends Y0{getShaders(){const t=[tS,nS];return"pbr"===this.props._lighting&&t.push(eH),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:GH,transition:!0},instanceModelMatrix:Q4})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof rm)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new zge(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ot({gltf:l},c),function(n){return YR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Ri.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof rm?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Ri.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Ri.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Ri.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof rm&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ot({isInstanced:!0,transpileToGLSL100:!Ci(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:u}=this.props,h=this.getNumInstances();this.state.scenegraph.traverse((f,{worldMatrix:g})=>{f.model.setInstanceCount(h),f.updateModuleSettings(t),f.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:Z4(s,u),sceneModelMatrix:g,u_Camera:f.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=k_e,n})();class L_e extends gh{constructor(e={}){const{id:t=ma("sphere-geometry")}=e,{indices:i,attributes:r}=function(n){const{nlat:e=10,nlong:t=10}=n;let{radius:i=1}=n;const o=Math.PI-0,c=2*Math.PI-0,u=(e+1)*(t+1);if("number"==typeof i){const U=i;i=(D,ie,_e,Pe,Ne)=>U}const h=new Float32Array(3*u),f=new Float32Array(3*u),g=new Float32Array(2*u),v=new(u>65535?Uint32Array:Uint16Array)(e*t*6);for(let U=0;U<=e;U++)for(let D=0;D<=t;D++){const ie=D/t,_e=U/e,Pe=D+U*(t+1),Ne=2*Pe,Ve=3*Pe,bt=c*ie,xt=o*_e,At=Math.sin(bt),Bt=Math.cos(bt),Wt=Math.sin(xt),mt=Bt*Wt,jt=Math.cos(xt),ft=At*Wt,Yt=i(mt,jt,ft,ie,_e);h[Ve+0]=Yt*mt,h[Ve+1]=Yt*jt,h[Ve+2]=Yt*ft,f[Ve+0]=mt,f[Ve+1]=jt,f[Ve+2]=ft,g[Ne+0]=ie,g[Ne+1]=1-_e}const x=t+1;for(let U=0;U<t;U++)for(let D=0;D<e;D++){const ie=6*(U*e+D);v[ie+0]=D*x+U,v[ie+1]=D*x+U+1,v[ie+2]=(D+1)*x+U,v[ie+3]=(D+1)*x+U,v[ie+4]=D*x+U+1,v[ie+5]=(D+1)*x+U+1}return{indices:{size:1,value:v},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:f},TEXCOORD_0:{size:2,value:g}}}}(e);super(Sn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}const V_e={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class $H extends gh{constructor(e={}){const{id:t=ma("truncated-code-geometry")}=e,{indices:i,attributes:r}=function(n){const{bottomRadius:e=0,topRadius:t=0,height:i=1,nradial:r=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:l=!1}=n,c=(a?2:0)+(l?2:0),u=(r+1)*(s+1+c),h=Math.atan2(e-t,i),f=Math.sin,g=Math.cos,m=Math.PI,v=g(h),x=f(h),U=a?-2:0,D=s+(l?2:0),ie=r+1,_e=new Uint16Array(r*(s+c)*6),Pe=V_e[o],Ne=new Float32Array(3*u),Ve=new Float32Array(3*u),bt=new Float32Array(2*u);let xt=0,At=0;for(let Bt=U;Bt<=D;Bt++){let mt,Wt=Bt/s,gt=i*Wt;Bt<0?(gt=0,Wt=1,mt=e):Bt>s?(gt=i,Wt=1,mt=t):mt=e+Bt/s*(t-e),(-2===Bt||Bt===s+2)&&(mt=0,Wt=0),gt-=i/2;for(let jt=0;jt<ie;jt++){const ft=f(jt*m*2/r),Yt=g(jt*m*2/r);Ne[xt+Pe[0]]=ft*mt,Ne[xt+Pe[1]]=gt,Ne[xt+Pe[2]]=Yt*mt,Ve[xt+Pe[0]]=Bt<0||Bt>s?0:ft*v,Ve[xt+Pe[1]]=Bt<0?-1:Bt>s?1:x,Ve[xt+Pe[2]]=Bt<0||Bt>s?0:Yt*v,bt[At+0]=jt/r,bt[At+1]=Wt,At+=2,xt+=3}}for(let Bt=0;Bt<s+c;Bt++)for(let Wt=0;Wt<r;Wt++){const gt=6*(Bt*r+Wt);_e[gt+0]=ie*(Bt+0)+0+Wt,_e[gt+1]=ie*(Bt+0)+1+Wt,_e[gt+2]=ie*(Bt+1)+1+Wt,_e[gt+3]=ie*(Bt+0)+0+Wt,_e[gt+4]=ie*(Bt+1)+1+Wt,_e[gt+5]=ie*(Bt+1)+0+Wt}return{indices:_e,attributes:{POSITION:{size:3,value:Ne},NORMAL:{size:3,value:Ve},TEXCOORD_0:{size:2,value:bt}}}}(e);super(Sn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}class U_e extends $H{constructor(e={}){const{id:t=ma("cone-geometry"),radius:i=1,cap:r=!0}=e;super(Sn(ot({},e),{id:t,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:i}))}}class z_e extends $H{constructor(e={}){const{id:t=ma("cylinder-geometry"),radius:i=1}=e;super(Sn(ot({},e),{id:t,bottomRadius:i,topRadius:i}))}}const H_e=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),G_e=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),$_e=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),W_e=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),q_e={POSITION:{size:3,value:new Float32Array(G_e)},NORMAL:{size:3,value:new Float32Array($_e)},TEXCOORD_0:{size:2,value:new Float32Array(W_e)}};class Y_e extends gh{constructor(e={}){const{id:t=ma("cube-geometry")}=e;super(Sn(ot({},e),{id:t,indices:{size:1,value:new Uint16Array(H_e)},attributes:ot(ot({},q_e),e.attributes)}))}}class lu{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new ce){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new ce){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new lu){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],f=i[6],g=i[7],m=i[8],v=r[0],x=r[1],U=r[2],D=r[3],ie=r[4],_e=r[5],Pe=r[6],Ne=r[7],Ve=r[8];return s[0]=o*v+a*D+l*Pe,s[1]=o*x+a*ie+l*Ne,s[2]=o*U+a*_e+l*Ve,s[3]=c*v+u*D+h*Pe,s[4]=c*x+u*ie+h*Ne,s[5]=c*U+u*_e+h*Ve,s[6]=f*v+g*D+m*Pe,s[7]=f*x+g*ie+m*Ne,s[8]=f*U+g*_e+m*Ve,t}scale(e,t=new lu){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new ce){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let u,f;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){u=4;do{f=4-u,s[f+4*o]+=s[f+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];u=4;do{f=4-u,s[f+4*a]=f<=o?0:s[f+4*a]-s[f+4*o]*g}while(--u)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new lu){const r=X_e;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,h;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{h=6-c,r[h+6*s]+=r[h+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const f=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=h<=s?0:r[h+6*o]-r[h+6*s]*f}while(--c)}}while(--a);s=2;do{o=s-1;do{const f=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=r[h+6*o]-r[h+6*s]*f}while(--c)}while(o--)}while(--s);s=2;do{const f=1/r[s+6*s];c=6;do{h=6-c,r[h+6*s]=r[h+6*s]*f}while(--c)}while(s--);s=2;do{o=2;do{if(h=r[3+o+6*s],isNaN(h)||h===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,h)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,u=t*a,h=t*l,f=i*a,g=i*l,m=r*l,v=s*o,x=s*a,U=s*l,D=this.elements;return D[0]=1-(f+m),D[1]=u-U,D[2]=h+x,D[3]=u+U,D[4]=1-(c+m),D[5]=g-v,D[6]=h-x,D[7]=g+v,D[8]=1-(c+f),this}transpose(e=new lu){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const X_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class ce{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new ce){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new ce(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new ce(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new lu([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new ce){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new ce){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new ce){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new ce){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new ce){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=K_e,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=Q_e;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(WH),WH.almostEquals(e,t)}clone(){return new ce(this.x,this.y,this.z)}}ce.ZERO=void 0,ce.UNIT_X=void 0,ce.UNIT_Y=void 0,ce.UNIT_Z=void 0,ce.ZERO=new ce(0,0,0),ce.UNIT_X=new ce(1,0,0),ce.UNIT_Y=new ce(0,1,0),ce.UNIT_Z=new ce(0,0,1);const K_e=new ce,Q_e=new ce,WH=new ce;class pr{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new ce,this.upperBound=new ce,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,qH),c=qH),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new pr).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=YH;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let f=0;8!==f;f++){const g=i[f];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=YH;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let f=0;8!==f;f++){const g=i[f];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,h=(this.lowerBound.z-i.z)*o,f=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(h,f)),m=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(h,f));return!(m<0||g>m)}}const qH=new ce,YH=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];class us{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new ce){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=J_e;e.tangents(i,eye),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(Er(e.length(),2)*Er(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new us){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+o*a+r*c-s*l,t.y=r*u+o*l+s*a-i*c,t.z=s*u+o*c+i*l-r*a,t.w=o*u-i*a-r*l-s*c,t}inverse(e=new us){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new us){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new ce){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,h=c*r+l*i-o*s,f=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=u*c+g*-o+h*-l-f*-a,t.y=h*c+g*-a+f*-o-u*-l,t.z=f*c+g*-l+u*-a-h*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const h=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*h-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"YXZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"ZXY"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"ZYX"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"YZX"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):"XZY"===r&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new us(this.x,this.y,this.z,this.w)}slerp(e,t,i=new us){const r=this.x,s=this.y,o=this.z,a=this.w;let f,g,m,v,x,l=e.x,c=e.y,u=e.z,h=e.w;return g=r*l+s*c+o*u+a*h,g<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>1e-6?(f=Math.acos(g),m=Math.sin(f),v=Math.sin((1-t)*f)/m,x=Math.sin(t*f)/m):(v=1-t,x=t),i.x=v*r+x*l,i.y=v*s+x*c,i.z=v*o+x*u,i.w=v*a+x*h,i}integrate(e,t,i,r=new us){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,h=this.w,f=.5*t;return r.x+=f*(s*h+o*u-a*c),r.y+=f*(o*h+a*l-s*u),r.z+=f*(a*h+s*c-o*l),r.w+=f*(-s*l-o*c-a*u),r}}const J_e=new ce,eye=new ce,tye={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let _n=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=tye,n})();class $i{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new ce,this.quaternion=new us,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return $i.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return $i.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new ce){return i.vsub(e,r),t.conjugate(KH),KH.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new ce){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new ce){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new ce){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const KH=new us;class jf extends _n{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:_n.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new ce;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let u=!1;for(let h=0;h!==i.length;h++)if(i[h].almostEquals(r)||i[h].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new ce;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];jf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new ce,o=new ce;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const u=new ce;let h=-1,f=-Number.MAX_VALUE;for(let m=0;m<i.faces.length;m++){u.copy(i.faceNormals[m]),s.vmult(u,u);const v=u.dot(o);v>f&&(f=v,h=m)}const g=[];for(let m=0;m<i.faces[h].length;m++){const v=i.vertices[i.faces[h][m]],x=new ce;x.copy(v),s.vmult(x,x),r.vadd(x,x),g.push(x)}h>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new ce,u=new ce,h=new ce,f=new ce,g=new ce,m=new ce;let v=Number.MAX_VALUE;const x=this;if(x.uniqueAxes)for(let U=0;U!==x.uniqueAxes.length;U++){i.vmult(x.uniqueAxes[U],c);const D=x.testSepAxis(c,e,t,i,r,s);if(!1===D)return!1;D<v&&(v=D,o.copy(c))}else{const U=a?a.length:x.faces.length;for(let D=0;D<U;D++){c.copy(x.faceNormals[a?a[D]:D]),i.vmult(c,c);const _e=x.testSepAxis(c,e,t,i,r,s);if(!1===_e)return!1;_e<v&&(v=_e,o.copy(c))}}if(e.uniqueAxes)for(let U=0;U!==e.uniqueAxes.length;U++){s.vmult(e.uniqueAxes[U],u);const D=x.testSepAxis(u,e,t,i,r,s);if(!1===D)return!1;D<v&&(v=D,o.copy(u))}else{const U=l?l.length:e.faces.length;for(let D=0;D<U;D++){u.copy(e.faceNormals[l?l[D]:D]),s.vmult(u,u);const _e=x.testSepAxis(u,e,t,i,r,s);if(!1===_e)return!1;_e<v&&(v=_e,o.copy(u))}}for(let U=0;U!==x.uniqueEdges.length;U++){i.vmult(x.uniqueEdges[U],f);for(let D=0;D!==e.uniqueEdges.length;D++)if(s.vmult(e.uniqueEdges[D],g),f.cross(g,m),!m.almostZero()){m.normalize();const ie=x.testSepAxis(m,e,t,i,r,s);if(!1===ie)return!1;ie<v&&(v=ie,o.copy(m))}}return r.vsub(t,h),h.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){jf.project(this,e,i,r,KR),jf.project(t,e,s,o,QR);const l=KR[0],c=KR[1],u=QR[0],h=QR[1];if(l<h||u<c)return!1;const f=l-h,g=u-c;return f<g?f:g}calculateLocalInertia(e,t){const i=new ce,r=new ce;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new ce,c=new ce,u=new ce,h=new ce,f=new ce,g=new ce,m=new ce,v=new ce,x=this,D=r,ie=[];let _e=-1,Pe=Number.MAX_VALUE;for(let At=0;At<x.faces.length;At++){l.copy(x.faceNormals[At]),i.vmult(l,l);const Bt=l.dot(e);Bt<Pe&&(Pe=Bt,_e=At)}if(_e<0)return;const Ne=x.faces[_e];Ne.connectedFaces=[];for(let At=0;At<x.faces.length;At++)for(let Bt=0;Bt<x.faces[At].length;Bt++)-1!==Ne.indexOf(x.faces[At][Bt])&&At!==_e&&-1===Ne.connectedFaces.indexOf(At)&&Ne.connectedFaces.push(At);const Ve=Ne.length;for(let At=0;At<Ve;At++){const Bt=x.vertices[Ne[At]];Bt.vsub(x.vertices[Ne[(At+1)%Ve]],c),u.copy(c),i.vmult(u,u),t.vadd(u,u),h.copy(this.faceNormals[_e]),i.vmult(h,h),t.vadd(h,h),u.cross(h,f),f.negate(f),g.copy(Bt),i.vmult(g,g),t.vadd(g,g);const gt=Ne.connectedFaces[At];m.copy(this.faceNormals[gt]);const mt=this.getPlaneConstantOfFace(gt);v.copy(m),i.vmult(v,v);const jt=mt-v.dot(t);for(this.clipFaceAgainstPlane(D,ie,v,jt);D.length;)D.shift();for(;ie.length;)D.push(ie.shift())}m.copy(this.faceNormals[_e]);const bt=this.getPlaneConstantOfFace(_e);v.copy(m),i.vmult(v,v);const xt=bt-v.dot(t);for(let At=0;At<D.length;At++){let Bt=v.dot(D[At])+xt;if(Bt<=s&&(console.log("clamped: depth="+Bt+" to minDist="+s),Bt=s),Bt<=o){const Wt=D[At];Bt<=1e-6&&a.push({point:Wt,normal:v,depth:Bt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let u=0;u<a;u++){if(c=e[u],o=i.dot(c)+r,s<0)if(o<0){const h=new ce;h.copy(c),t.push(h)}else{const h=new ce;l.lerp(c,s/(s-o),h),t.push(h)}else if(o<0){const h=new ce;l.lerp(c,s/(s-o),h),t.push(h),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new ce);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new ce);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,u,h,f=new ce;for(let g=0;g<s.length;g++){f.copy(s[g]),t.vmult(f,f),e.vadd(f,f);const m=f;(void 0===o||m.x<o)&&(o=m.x),(void 0===c||m.x>c)&&(c=m.x),(void 0===a||m.y<a)&&(a=m.y),(void 0===u||m.y>u)&&(u=m.y),(void 0===l||m.z<l)&&(l=m.z),(void 0===h||m.z>h)&&(h=m.z)}i.set(o,a,l),r.set(c,u,h)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new ce){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new ce;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new ce;e.vsub(l,c);const u=a.dot(c),h=new ce;s.vsub(l,h);const f=a.dot(h);if(u<0&&f>0||u>0&&f<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=nye;let l=0,c=0;const u=iye,h=e.vertices;u.setZero(),$i.vectorToLocalFrame(i,r,t,a),$i.pointToLocalFrame(i,r,u,u);const f=u.dot(a);c=l=h[0].dot(a);for(let g=1;g<o;g++){const m=h[g].dot(a);m>l&&(l=m),m<c&&(c=m)}if(c-=f,l-=f,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const KR=[],QR=[],nye=new ce,iye=new ce;class dS extends _n{constructor(e){super({type:_n.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=ce,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new jf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new ce){return dS.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)yh.set(s[o][0],s[o][1],s[o][2]),t.vmult(yh,yh),e.vadd(yh,yh),i(yh.x,yh.y,yh.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;cu[0].set(s.x,s.y,s.z),cu[1].set(-s.x,s.y,s.z),cu[2].set(-s.x,-s.y,s.z),cu[3].set(-s.x,-s.y,-s.z),cu[4].set(s.x,-s.y,-s.z),cu[5].set(s.x,s.y,-s.z),cu[6].set(-s.x,s.y,-s.z),cu[7].set(s.x,-s.y,s.z);const o=cu[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=cu[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,u=l.y,h=l.z;c>r.x&&(r.x=c),u>r.y&&(r.y=u),h>r.z&&(r.z=h),c<i.x&&(i.x=c),u<i.y&&(i.y=u),h<i.z&&(i.z=h)}}}const yh=new ce,cu=[new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce];class yn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=yn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new ce,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new ce,this.previousPosition=new ce,this.interpolatedPosition=new ce,this.initPosition=new ce,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new ce,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new ce,this.force=new ce;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?yn.STATIC:yn.DYNAMIC,typeof e.type==typeof yn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=yn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new ce,this.quaternion=new us,this.initQuaternion=new us,this.previousQuaternion=new us,this.interpolatedQuaternion=new us,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new ce,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new ce,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new ce,this.invInertia=new ce,this.invInertiaWorld=new lu,this.invMassSolve=0,this.invInertiaSolve=new ce,this.invInertiaWorldSolve=new lu,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new ce(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new ce(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new pr,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new ce,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=yn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===yn.SLEEPING&&this.dispatchEvent(yn.wakeupEvent)}sleep(){this.sleepState=yn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=Er(this.sleepSpeedLimit,2);t===yn.AWAKE&&i<r?(this.sleepState=yn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(yn.sleepyEvent)):t===yn.SLEEPY&&i>r?this.wakeUp():t===yn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(yn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===yn.SLEEPING||this.type===yn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new ce){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new ce){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new ce){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new ce,s=new us;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=rye,o=sye,a=this.quaternion,l=this.aabb,c=oye;for(let u=0;u!==r;u++){const h=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),h.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===u?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=aye,r=lye;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new ce){if(this.type!==yn.DYNAMIC)return;this.sleepState===yn.SLEEPING&&this.wakeUp();const i=cye;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new ce){if(this.type!==yn.DYNAMIC)return;const i=uye,r=dye;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===yn.DYNAMIC&&(this.sleepState===yn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new ce){if(this.type!==yn.DYNAMIC)return;this.sleepState===yn.SLEEPING&&this.wakeUp();const i=t,r=hye;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=fye;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new ce){if(this.type!==yn.DYNAMIC)return;const i=pye,r=gye;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=mye;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),dS.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new ce;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==yn.DYNAMIC&&this.type!==yn.KINEMATIC||this.sleepState===yn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,h=this.invInertiaWorld,f=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*f.x,r.y+=a.y*g*f.y,r.z+=a.z*g*f.z;const m=h.elements,v=this.angularFactor,x=l.x*v.x,U=l.y*v.y,D=l.z*v.z;s.x+=e*(m[0]*x+m[1]*U+m[2]*D),s.y+=e*(m[3]*x+m[4]*U+m[5]*D),s.z+=e*(m[6]*x+m[7]*U+m[8]*D),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}yn.idCounter=0,yn.COLLIDE_EVENT_NAME="collide",yn.DYNAMIC=1,yn.STATIC=2,yn.KINEMATIC=4,yn.AWAKE=0,yn.SLEEPY=1,yn.SLEEPING=2,yn.wakeupEvent={type:"wakeup"},yn.sleepyEvent={type:"sleepy"},yn.sleepEvent={type:"sleep"};const rye=new ce,sye=new us,oye=new pr,aye=new lu,lye=new lu,cye=new ce,uye=new ce,dye=new ce,hye=new ce,fye=new ce,pye=new ce,gye=new ce,mye=new ce;new ce,new ce;class hS{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new ce,this.rayToWorld=new ce,this.hitNormalWorld=new ce,this.hitPointWorld=new ce,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let QH,ZH,JH,e8,t8,n8,i8;QH=_n.types.SPHERE,ZH=_n.types.PLANE,JH=_n.types.BOX,e8=_n.types.CYLINDER,t8=_n.types.CONVEXPOLYHEDRON,n8=_n.types.HEIGHTFIELD,i8=_n.types.TRIMESH;class ys{get[QH](){return this._intersectSphere}get[ZH](){return this._intersectPlane}get[JH](){return this._intersectBox}get[e8](){return this._intersectConvex}get[t8](){return this._intersectConvex}get[n8](){return this._intersectHeightfield}get[i8](){return this._intersectTrimesh}constructor(e=new ce,t=new ce){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new ce,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=ys.ANY,this.result=new hS,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||ys.ANY,this.result=t.result||new hS,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(r8),tP.length=0,e.broadphase.aabbQuery(e,r8,tP),this.intersectBodies(tP),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=xye,s=Sye;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,Uf);const i=Uf.dot(e);return e.scale(i,pS),pS.vadd(n,pS),t.distanceTo(pS)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new ce(0,0,1);t.vmult(c,c);const u=new ce;o.vsub(i,u);const h=u.dot(c);if(a.vsub(i,u),h*u.dot(c)>0||o.distanceTo(a)<h)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const m=new ce,v=new ce,x=new ce;o.vsub(i,m);const U=-c.dot(m)/g;l.scale(U,v),o.vadd(v,x),this.reportIntersection(c,x,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=Cye;o.from.copy(this.from),o.to.copy(this.to),$i.pointToLocalFrame(i,t,o.from,o.from),$i.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=Tye;let l,c,u,h;l=c=0,u=h=e.data.length-1;const f=new pr;o.getAABB(f),e.getIndexOfPosition(f.lowerBound.x,f.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(f.upperBound.x,f.upperBound.y,a,!0),u=Math.min(u,a[0]+1),h=Math.min(h,a[1]+1);for(let g=l;g<u;g++)for(let m=c;m<h;m++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,m,f),f.overlapsRay(o)){if(e.getConvexTrianglePillar(g,m,!1),$i.pointToWorldFrame(i,t,e.pillarOffset,fS),this._intersectConvex(e.pillarConvex,t,fS,r,s,s8),this.result.shouldStop)return;e.getConvexTrianglePillar(g,m,!0),$i.pointToWorldFrame(i,t,e.pillarOffset,fS),this._intersectConvex(e.pillarConvex,t,fS,r,s,s8)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=Er(a.x-o.x,2)+Er(a.y-o.y,2)+Er(a.z-o.z,2),u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=Er(o.x-i.x,2)+Er(o.y-i.y,2)+Er(o.z-i.z,2)-Er(l,2),f=Er(u,2)-4*c*h,g=Aye,m=Mye;if(!(f<0))if(0===f)o.lerp(a,f,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1);else{const v=(-u-Math.sqrt(f))/(2*c),x=(-u+Math.sqrt(f))/(2*c);if(v>=0&&v<=1&&(o.lerp(a,v,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1)),this.result.shouldStop)return;x>=0&&x<=1&&(o.lerp(a,x,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=Dye,l=o8,c=o&&o.faceList||null,u=e.faces,h=e.vertices,f=e.faceNormals,g=this.direction,m=this.from,x=m.distanceTo(this.to),U=c?c.length:u.length,D=this.result;for(let ie=0;!D.shouldStop&&ie<U;ie++){const _e=c?c[ie]:ie,Pe=u[_e],Ne=f[_e],Ve=t,bt=i;l.copy(h[Pe[0]]),Ve.vmult(l,l),l.vadd(bt,l),l.vsub(m,l),Ve.vmult(Ne,a);const xt=g.dot(a);if(Math.abs(xt)<this.precision)continue;const At=a.dot(l)/xt;if(!(At<0)){g.scale(At,va),va.vadd(m,va),_c.copy(h[Pe[0]]),Ve.vmult(_c,_c),bt.vadd(_c,_c);for(let Bt=1;!D.shouldStop&&Bt<Pe.length-1;Bt++){uu.copy(h[Pe[Bt]]),du.copy(h[Pe[Bt+1]]),Ve.vmult(uu,uu),Ve.vmult(du,du),bt.vadd(uu,uu),bt.vadd(du,du);const Wt=va.distanceTo(m);!ys.pointInTriangle(va,_c,uu,du)&&!ys.pointInTriangle(va,uu,_c,du)||Wt>x||this.reportIntersection(a,va,s,r,_e)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=Iye,l=Fye,c=Lye,u=o8,h=Oye,f=Rye,g=Pye,m=kye,v=Nye,x=e.indices,U=this.from,D=this.to,ie=this.direction;c.position.copy(i),c.quaternion.copy(t),$i.vectorToLocalFrame(i,t,ie,h),$i.pointToLocalFrame(i,t,U,f),$i.pointToLocalFrame(i,t,D,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,f.x*=e.scale.x,f.y*=e.scale.y,f.z*=e.scale.z,g.vsub(f,h),h.normalize();const _e=f.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Pe=0,Ne=l.length;!this.result.shouldStop&&Pe!==Ne;Pe++){const Ve=l[Pe];e.getNormal(Ve,a),e.getVertex(x[3*Ve],_c),_c.vsub(f,u);const bt=h.dot(a),xt=a.dot(u)/bt;if(xt<0)continue;h.scale(xt,va),va.vadd(f,va),e.getVertex(x[3*Ve+1],uu),e.getVertex(x[3*Ve+2],du);const At=va.distanceSquared(f);!ys.pointInTriangle(va,uu,_c,du)&&!ys.pointInTriangle(va,_c,uu,du)||At>_e||($i.vectorToWorldFrame(t,a,v),$i.pointToWorldFrame(i,t,va,m),this.reportIntersection(v,m,s,r,Ve))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case ys.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case ys.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case ys.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Uf),i.vsub(t,ab),e.vsub(t,nP);const s=Uf.dot(Uf),o=Uf.dot(ab),a=Uf.dot(nP),l=ab.dot(ab),c=ab.dot(nP);let u,h;return(u=l*a-o*c)>=0&&(h=s*c-o*a)>=0&&u+h<s*l-o*o}}ys.CLOSEST=1,ys.ANY=2,ys.ALL=4;const r8=new pr,tP=[],ab=new ce,nP=new ce,xye=new ce,Sye=new us,va=new ce,_c=new ce,uu=new ce,du=new ce,s8={faceList:[0]},fS=new ce,Cye=new ys,Tye=[],Aye=new ce,Mye=new ce,Dye=new ce,o8=new ce,Iye=new ce,Oye=new ce,Rye=new ce,Pye=new ce,Nye=new ce,kye=new ce;new pr;const Fye=[],Lye=new $i,Uf=new ce,pS=new ce;let w8,E8,x8,S8,C8,T8,A8,M8,D8,I8,O8,R8,P8,N8,k8,F8,L8,B8,V8,j8,U8,z8,H8,G8,$8;new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ys,new ce,new ce,new ce(1,0,0),new ce(0,1,0),new ce(0,0,1),new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new pr,new ce,new pr,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new pr,new ce,new $i,new pr;const Or={sphereSphere:_n.types.SPHERE,spherePlane:_n.types.SPHERE|_n.types.PLANE,boxBox:_n.types.BOX|_n.types.BOX,sphereBox:_n.types.SPHERE|_n.types.BOX,planeBox:_n.types.PLANE|_n.types.BOX,convexConvex:_n.types.CONVEXPOLYHEDRON,sphereConvex:_n.types.SPHERE|_n.types.CONVEXPOLYHEDRON,planeConvex:_n.types.PLANE|_n.types.CONVEXPOLYHEDRON,boxConvex:_n.types.BOX|_n.types.CONVEXPOLYHEDRON,sphereHeightfield:_n.types.SPHERE|_n.types.HEIGHTFIELD,boxHeightfield:_n.types.BOX|_n.types.HEIGHTFIELD,convexHeightfield:_n.types.CONVEXPOLYHEDRON|_n.types.HEIGHTFIELD,sphereParticle:_n.types.PARTICLE|_n.types.SPHERE,planeParticle:_n.types.PLANE|_n.types.PARTICLE,boxParticle:_n.types.BOX|_n.types.PARTICLE,convexParticle:_n.types.PARTICLE|_n.types.CONVEXPOLYHEDRON,cylinderCylinder:_n.types.CYLINDER,sphereCylinder:_n.types.SPHERE|_n.types.CYLINDER,planeCylinder:_n.types.PLANE|_n.types.CYLINDER,boxCylinder:_n.types.BOX|_n.types.CYLINDER,convexCylinder:_n.types.CONVEXPOLYHEDRON|_n.types.CYLINDER,heightfieldCylinder:_n.types.HEIGHTFIELD|_n.types.CYLINDER,particleCylinder:_n.types.PARTICLE|_n.types.CYLINDER,sphereTrimesh:_n.types.SPHERE|_n.types.TRIMESH,planeTrimesh:_n.types.PLANE|_n.types.TRIMESH};w8=Or.sphereSphere,E8=Or.spherePlane,x8=Or.boxBox,S8=Or.sphereBox,C8=Or.planeBox,T8=Or.convexConvex,A8=Or.sphereConvex,M8=Or.planeConvex,D8=Or.boxConvex,I8=Or.sphereHeightfield,O8=Or.boxHeightfield,R8=Or.convexHeightfield,P8=Or.sphereParticle,N8=Or.planeParticle,k8=Or.boxParticle,F8=Or.convexParticle,L8=Or.cylinderCylinder,B8=Or.sphereCylinder,V8=Or.planeCylinder,j8=Or.boxCylinder,U8=Or.convexCylinder,z8=Or.heightfieldCylinder,H8=Or.particleCylinder,G8=Or.sphereTrimesh,$8=Or.planeTrimesh,new ce,new ce,new ce,new ce,new ce,new us,new us,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new pr,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new us,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new ce,new pr,new ys;const Ks=globalThis.performance||{};if(!Ks.now){let n=Date.now();Ks.timing&&Ks.timing.navigationStart&&(n=Ks.timing.navigationStart),Ks.now=()=>Date.now()-n}var $f=et(4517);class Fr extends oe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $;return this._value}next(e){super.next(this._value=e)}}function fm(n,e,t){e||(e=new qn(qn.IDENTITY));const i=new qn(qn.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new qn(qn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new qn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===fm(s,r,t))return!1;return!0}function Q8(){Mz([EH,cm])}function Z8(n,e){var t;const i=null===(t=e.nodes)||void 0===t?void 0:t.find(r=>r.name===n);if(i){let r=!1;for(const s of e.scenes)r||fm(s,new qn(qn.IDENTITY),(o,a)=>o!==i||(o.matrix=a,o.translation=void 0,o.rotation=void 0,o.scale=void 0,r=!0,!1));return e.scene={id:n,name:n,nodes:[i]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function sP(n,e){return Bi(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield Hx(i,cm,{DracoLoader:IR,gltf:{decompressMeshes:!0,postProcess:!0}});return r.nodes||console.log("WARNING: Empty Scene",t,r),Z8(n.scenegraphNode,r)})}function Bve(n,e){return Bi(this,void 0,void 0,function*(){return Z8(n,yield e)})}function oP(n,e,t){if(e&&0!==e.length){let i;switch(t.geometry){case"sphere":i=new L_e;break;case"cone":i=new U_e;break;case"cylinder":i=new z_e;break;case"cube":default:i=new Y_e}return new pge(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Vi.CARTESIAN,data:e,mesh:i,wireframe:!1,getTransformMatrix:r=>r.transformMatrix,getColor:r=>r.color||[255,255,255,229.5]},t))}}function J8(n,e,t){if(e&&0!==e.length)return new rge(Object.assign({id:n,pickable:!0,data:e.map(i=>Object.assign(Object.assign({},i),{position:new qn(i.transformMatrix).getTranslation()})),getText:i=>i.text,getPosition:i=>i.position,getColor:i=>i.color},t))}let jve=(()=>{class n extends Nz{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),Q8()}renderLayers(){var t,i;const r=this.state,s={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const l of r.data){const c=null!==(t=l.geometry)&&void 0!==t?t:"cube";l.scenegraph?s.scenegraph.push(l):void 0!==s[c]&&s[c].push(l)}const o={};for(const l of s.scenegraph)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(o,l.scenegraph)&&(o[l.scenegraph]=sP({scenegraph:l.scenegraph},n.gltfCache));const a=[];for(const[l,c]of Object.entries(s))if("scenegraph"===l)for(const u of c)a.push(new F_e({id:"models-"+u["@id"],opacity:u.zoomBasedOpacity?r.zoomOpacity:void 0!==u.opacity?u.opacity:1,pickable:!u.unpickable,coordinateSystem:Vi.CARTESIAN,data:[u],scenegraph:u.scenegraphNode?Bve(u.scenegraphNode,o[u.scenegraph]):u.scenegraph,_lighting:u._lighting,getTransformMatrix:u.transformMatrix,getColor:null!==(i=u.color)&&void 0!==i?i:[0,255,0,127.5],parameters:{depthMask:!u.zoomBasedOpacity&&(void 0===u.opacity||1===u.opacity)}}));else"text"===l?(a.push(J8("text",c.filter(u=>u.unpickable),{pickable:!1})),a.push(J8("textPickable",c.filter(u=>!u.unpickable),{pickable:!0}))):"wireframe"===l?a.push(oP(l,c,{wireframe:!0,pickable:!1,geometry:l})):(a.push(oP(l,c.filter(u=>u.unpickable),{wireframe:!1,pickable:!1,geometry:l})),a.push(oP(`${l}Pickable`,c.filter(u=>!u.unpickable),{wireframe:!1,pickable:!0,geometry:l})));return r.doCollisions&&function(n){Bi(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new qn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new pr({lowerBound:new ce(...l.map((u,h)=>Math.min(u,c[h]))),upperBound:new ce(...c.map((u,h)=>Math.max(u,l[h])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield q0(o.scenegraph,cm,{DracoLoader:IR,decompress:!0,postProcess:!0});for(const l of a.scenes)fm(l,new qn(o.transformMatrix),(c,u)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const h of c.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const f=u.transformAsPoint(h.attributes.POSITION.min,[]),g=u.transformAsPoint(h.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new pr({lowerBound:new ce(...f.map((m,v)=>Math.min(m,g[v]))),upperBound:new ce(...g.map((m,v)=>Math.max(m,f[v])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(r.data),a.filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function e5(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),e5(t,e);return e}let zve=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new jve({}),this.nodeClickSubject=new oe,this.nodeHoverStartSubject=new oe,this.nodeHoverStopSubject=new oe,this.sceneRotationSubject=new Fr([0,0]),this.nodeDragStartSubject=new oe,this.nodeDragSubject=new oe,this.nodeDragEndSubject=new oe,this.nodeClick$=this.nodeClickSubject.pipe(ws()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(ws()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(ws()),this.sceneRotation$=this.sceneRotationSubject.pipe(ws()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(ws()),this.nodeDrag$=this.nodeDragSubject.pipe(ws()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(ws());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new jde({flipY:!1,near:-1e3}):new Hde({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var u;return null!==(u=this.cursor)&&void 0!==u?u:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new $O({ambientLight:new Vz({color:[255,255,255],intensity:10})})]),this.deck=new eS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Bi(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new qn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t,i){return Bi(this,void 0,void 0,function*(){Q8();const r=yield sP({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"},undefined),s={},o=[];for(const a of r.scenes)fm(a,e=new qn(e||qn.IDENTITY),(l,c)=>{const u={"@id":l.name||l.id,"@type":"ProcessedNode",transformMatrix:new qn(c),geometry:"wireframe",node:l};if(o.push({"@id":`GLTF:${u["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:u["@id"],transformMatrix:new qn(e||qn.IDENTITY),tooltip:l.name||l.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:l}),l.mesh&&l.mesh.primitives&&l.mesh.primitives.length>0)for(const h of l.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const f=c.transformAsPoint(h.attributes.POSITION.min,[]),g=c.transformAsPoint(h.attributes.POSITION.max,[]);u.bbox=new pr({lowerBound:new ce(...f.map((m,v)=>Math.min(m,g[v]))),upperBound:new ce(...g.map((m,v)=>Math.max(m,f[v])))})}return s[u["@id"]]=u,!0});for(const a of Object.values(s).filter(l=>!l.bbox)){for(const l of e5(a.node).map(c=>s[c]).filter(c=>c.bbox))a.bbox?a.bbox.extend(l.bbox):a.bbox=l.bbox.clone();a.bbox||delete s[a["@id"]]}for(const a of Object.values(s)){const l=a.bbox.lowerBound,h=(a.size=a.bbox.upperBound.clone().vsub(l)).clone().vmul(new ce(.5,.5,.5)),f=a.center=l.clone().vadd(h);a.transformMatrix=new qn(qn.IDENTITY).translate(f.toArray()).scale(h.toArray())}for(const a of o)s[a["@id"]]=a;return s})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new qn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Ei([$f.ZP],n.prototype,"_onHover",null),Ei([$f.ZP],n.prototype,"_onClick",null),Ei([$f.ZP],n.prototype,"_onViewStateChange",null),Ei([$f.ZP],n.prototype,"_onDragStart",null),Ei([$f.ZP],n.prototype,"_onDrag",null),Ei([$f.ZP],n.prototype,"_onDragEnd",null),n})();class t5 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class Hve extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function n5(n,e,t,i,r=new Hve(n,t,i)){if(!r.closed)return e instanceof O?e.subscribe(r):Me(e)(r)}const i5={};function yc(...n){let e,t;return Te(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&k(n[0])&&(n=n[0]),In(n,t).lift(new r5(e))}class r5{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Gve(e,this.resultSelector))}}class Gve extends t5{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(i5),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(n5(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===i5?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function Wve(n,e){return n===e}function qve(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function wS(n,e=Wve){let t=null,i=null;function r(){return qve(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const Xve=wS(function(){const n=lD();if(!n)return!1;const e=n.injector.get(Z3,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let aP=(()=>{class n{constructor(){this.bootstrap$=new Df(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const lP=new Ht("INITIAL_STATE_TOKEN");let Kve=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const s5=new Ht("Internals.StateContextFactory"),o5=new Ht("Internals.StateFactory");function fb(...n){if(1===n.length){const e=n[0];if(k(e))return ES(e,null);if(Q(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return ES(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return ES(n=1===n.length&&k(n[0])?n[0]:n,null).pipe(me(t=>e(...t)))}return ES(n,null)}function ES(n,e){return new O(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=je(n[a]);let c=!1;t.add(l.subscribe({next:u=>{c||(c=!0,o++),r[a]=u},error:u=>t.error(u),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((u,h,f)=>(u[h]=r[f],u),{}):r),t.complete())}}))}})}function Ki(n,e){return function(i){return i.lift(new Qve(n,e))}}class Qve{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new Zve(e,this.predicate,this.thisArg))}}class Zve extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function Wa(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(u){let h;s++,!r||a?(a=!1,r=new Df(n,e,i),h=r.subscribe(this),o=u.subscribe({next(f){r.next(f)},error(f){a=!0,r.error(f)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):h=r.subscribe(this),this.add(()=>{s--,h.unsubscribe(),h=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const a5=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function qr(n){return e=>0===n?b0():e.lift(new ewe(n))}class ewe{constructor(e){if(this.total=e,this.total<0)throw new a5}call(e,t){return t.subscribe(new twe(e,this.total))}}class twe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function l5(n,e){return e?t=>t.pipe(l5((i,r)=>je(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new nwe(n))}class nwe{constructor(e){this.project=e}call(e,t){return t.subscribe(new iwe(e,this.project))}}class iwe extends we{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function xS(n=null){return e=>e.lift(new rwe(n))}class rwe{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new swe(e,this.defaultValue))}}class swe extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function bc(n){return function(t){const i=new owe(n),r=t.lift(i);return i.caught=r}}class owe{constructor(e){this.selector=e}call(e,t){return t.subscribe(new awe(e,this.selector,this.caught))}}class awe extends we{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new _t(this);this.add(i);const r=N(t,i);r!==i&&this.add(r)}}}function gr(n){return e=>e.lift(new lwe(n))}class lwe{constructor(e){this.notifier=e}call(e,t){const i=new cwe(e),r=N(this.notifier,new _t(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class cwe extends we{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function bh(){}function cr(n,e,t){return function(r){return r.lift(new uwe(n,e,t))}}class uwe{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new dwe(e,this.nextOrObserver,this.error,this.complete))}}class dwe extends y{constructor(e,t,i,r){super(e),this._tapNext=bh,this._tapError=bh,this._tapComplete=bh,this._tapError=i||bh,this._tapComplete=r||bh,Y(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||bh,this._tapError=t.error||bh,this._tapComplete=t.complete||bh)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function ld(n,e){return t=>t.lift(new hwe(n,e))}class hwe{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new fwe(e,this.compare,this.keySelector))}}class fwe extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const qa={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let c5=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return pn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return pn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof pn||console.warn(qa.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Ie(pn),Ie(Xc))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const u5=new Ht("ROOT_STATE_TOKEN"),d5=new Ht("FEATURE_STATE_TOKEN"),h5=new Ht("NGXS_PLUGINS"),f5=new Ht("NG_TEST_MODE"),p5=new Ht("NG_DEV_MODE"),cd="NGXS_META",g5="NGXS_OPTIONS_META",cP="NGXS_SELECTOR_META";let Wf=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=c5}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class pwe{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const m5=new Ht("NGXS_EXECUTION_STRATEGY");function qf(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const _5=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},SS=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),uP=n=>n&&"object"==typeof n&&!Array.isArray(n),dP=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(uP(n)&&uP(t))for(const i in t)uP(t[i])?(n[i]||Object.assign(n,{[i]:{}}),dP(n[i],t[i])):Object.assign(n,{[i]:t[i]});return dP(n,...e)};function hP(n){if(!n.hasOwnProperty(cd)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,cd,{value:e})}return pb(n)}function pb(n){return n[cd]}function pP(n){return n[cP]}function y5(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}function b5(n,e){const t=SS(e.currentAppState,n.path),i=SS(e.newAppState,n.path);return new pwe(t,i,!n.isInitialised)}function Ewe(...n){return function(n,e,t=Cwe){const i=function(n){return n.reduce((e,t)=>(e[qf(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return Ki(t=>{const i=qf(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function Cwe(){return me(n=>n.action)}function CS(n){return e=>new O(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let TS=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(m5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Mwe extends oe{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let AS=(()=>{class n extends Mwe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Dwe=(()=>{class n extends O{constructor(t,i){super(r=>{const s=t.pipe(CS(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Ie(AS),Ie(TS))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const v5=n=>(...e)=>n.shift()(...e,(...i)=>v5(n)(...i));let MS=(()=>{class n extends Fr{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),gP=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(h5,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),mP=(()=>{class n extends oe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),w5=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(la),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(CS(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?sn(this._stateStream.getValue()):fb(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!qf(t))return Fg(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return v5([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(Wa())}getActionResultStream(t){return this._actionResults.pipe(Ki(i=>i.action===t&&"DISPATCHED"!==i.status),qr(1),Wa())}createDispatchObservable(t){return t.pipe(l5(i=>{switch(i.status){case"SUCCESSFUL":return sn(this._stateStream.getValue());case"ERRORED":return Fg(i.error);default:return Qc}})).pipe(Wa())}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn),Ie(AS),Ie(mP),Ie(gP),Ie(MS),Ie(TS))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const E5=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&E5(n[i])}),n};let x5=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Ie(p5),Ie(f5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),S5=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(qa.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(qa.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Ie(x5),Ie(Wf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),gm=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=E5(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Ie(MS),Ie(w5),Ie(Wf),Ie(S5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),DS=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return SS(l,t.path)}function s(l,c){const u=_5(l,t.path,c),h=t.instance;if(h.ngxsOnChanges){const f=b5(t,{currentAppState:l,newAppState:u});h.ngxsOnChanges(f)}return i.setState(u),u}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(qa.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(qa.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(gm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class IS{static stateNameErrorMessage(e){return qa.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(qa.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(qa.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=pb(e);if(!t)throw new Error(qa.STATE_DECORATOR());return t}}IS.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let mm=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=wS(()=>{const c=this;function u(f){const g=c.statePaths[f];return g?y5(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(f){let g=u(f);return g||((...m)=>(g||(g=u(f)),g?g(...m):void 0))},getSelectorOptions:f=>Object.assign({},c._config.selectorOptions,f||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(IS.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[cd].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[cd];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[cd].name]=t,e),{})}(i),l=[];for(const c of s){const u=a[c],h=o[c],f=u[cd];this.addRuntimeInfoToMeta(f,h);const g={name:c,path:h,isInitialised:!1,actions:f.actions,instance:this._injector.get(u),defaults:n.cloneDefaults(f.defaults)};this.hasBeenMountedAndBootstrapped(c,h)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>_5(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Ki(t=>"DISPATCHED"===t.status),V(({action:t})=>this.invokeActions(this._actions,t).pipe(me(()=>({action:t,status:"SUCCESSFUL"})),xS({action:t,status:"CANCELED"}),bc(i=>sn({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=qf(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let u=o.instance[l.fn](c,i);u instanceof Promise&&(u=je(u)),u instanceof O?(u=u.pipe(xS({})),l.options.cancelUncompleted&&(u=u.pipe(gr(t.pipe(Ewe(i)))))):u=sn({}).pipe(Wa()),s.push(u)}catch(u){s.push(Fg(u))}}}return s.length||s.push(sn({})),fb(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=IS.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==SS(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn),Ie(Wf),Ie(n,12),Ie(AS),Ie(mP),Ie(DS),Ie(lP,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),_P=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(Ki(()=>!!i),cr(()=>this.invokeInit(i.states)),V(()=>this.bootstrapper.appBootstrapped$),Ki(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=b5(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(gm),Ie(DS),Ie(aP))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const OS_getOptions=n=>n&&n.NGXS_SELECTOR_OPTIONS_META||{};function Owe(n,e,t){const i=t&&t.containerClass,s=wS(function(...c){const u=e.apply(i,c);return u instanceof Function?wS.apply(null,[u]):u});Object.setPrototypeOf(s,e);const o=function(n,e){const t=function(n){return n.hasOwnProperty(cP)||Object.defineProperty(n,cP,{value:{makeRootSelector:null,originalFn:null,containerClass:null,selectorName:null,getSelectorOptions:()=>({})}}),pP(n)}(n);t.originalFn=n;let i=()=>({});e&&(t.containerClass=e.containerClass,t.selectorName=e.selectorName,i=e.getSelectorOptions||i);const r=Object.assign({},t);return t.getSelectorOptions=()=>function(n,e){return Object.assign({},OS_getOptions(n.containerClass)||{},OS_getOptions(n.originalFn)||{},n.getSelectorOptions()||{},e)}(r,i()),t}(e,t);return o.makeRootSelector=l=>{const{argumentSelectorFunctions:c,selectorOptions:u}=function(n,e,t=[]){const i=e.getSelectorOptions(),r=n.getSelectorOptions(i);return{selectorOptions:r,argumentSelectorFunctions:function(n=[],e,t){const i=[];return t&&(0===n.length||e.injectContainerState)&&pb(t)&&i.push(t),n&&i.push(...n),i}(t,r,e.containerClass).map(a=>T5(a)(n))}}(l,o,n);return function(f){const g=c.map(m=>m(f));try{return s(...g)}catch(m){if(m instanceof TypeError&&u.suppressErrors)return;throw m}}},s}function T5(n){const e=pP(n)||pb(n);return e&&e.makeRootSelector||(()=>n)}let hu=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(me(i),bc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?sn(void 0):Fg(r)}),ld(),CS(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(qr(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(CS(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return T5(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(MS),Ie(gm),Ie(Wf),Ie(TS),Ie(mm),Ie(lP,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),gb=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Ie(hu),Ie(Wf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class Fwe{static get type(){return"@@INIT"}}class Lwe{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const RS=new Df(1);let Vwe=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&fa();RS.next(t)}catch(n){RS.next(!1)}finally{RS.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new Fwe,l)}}return n.\u0275fac=function(t){return new(t||n)(Ie(mm),Ie(gm),Ie(hu),Ie(gb),Ie(u5,8),Ie(_P))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})(),jwe=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new Lwe(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Ie(hu),Ie(gm),Ie(mm),Ie(d5,8),Ie(_P))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})();class Yo{static forRoot(e=[],t={}){return{ngModule:Vwe,providers:[mm,DS,Dwe,AS,aP,S5,x5,_P,w5,mP,gm,TS,hu,MS,gb,gP,...e,...Yo.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:jwe,providers:[mm,gP,...e,{provide:d5,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:f5,useValue:Xve},{provide:p5,useValue:fa},{provide:m5,useClass:t.executionStrategy||c5},{provide:u5,useValue:e},{provide:Yo.ROOT_OPTIONS,useValue:t},{provide:Wf,useFactory:Yo.ngxsConfigFactory,deps:[Yo.ROOT_OPTIONS]},{provide:IE,useFactory:Yo.appBootstrapListenerFactory,multi:!0,deps:[aP]},{provide:lP,useFactory:Yo.getInitialState},{provide:s5,useExisting:DS},{provide:o5,useExisting:mm}]}static ngxsConfigFactory(e){return dP(new Wf,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return Kve.pop()}}function yP(n,e){return(t,i)=>{if(t.hasOwnProperty("prototype"))throw new Error(qa.ACTION_DECORATOR());const s=hP(t.constructor);Array.isArray(n)||(n=[n]);for(const o of n){const a=o.type;s.actions[a]||(s.actions[a]=[]),s.actions[a].push({fn:i,options:e||{},type:a})}}}function A5(n){return i=>{!function(n){RS.subscribe(e=>{e&&(n.\u0275prov||console.warn(qa.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=hP(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[g5]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,u="string"==typeof c?c:c&&c.getName()||null;IS.checkCorrectStateName(u),s.hasOwnProperty(cd)&&(r.actions=Object.assign({},r.actions,(s[cd]||{}).actions)),r.children=a,r.defaults=l,r.name=u})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[g5]=a}}function PS(n,...e){return function(t,i){const r=i.toString(),s=`__${r}__selector`,o=function(n,e,t=[]){return"string"==typeof(e=e||function(n){const e=n.length-1;return 36===n.charCodeAt(e)?n.slice(0,e):n}(n))?y5(t.length?[e,...t]:e.split("."),gb.config):e}(r,n,e);Object.defineProperties(t,{[s]:{writable:!0,enumerable:!1,configurable:!0},[r]:{enumerable:!0,configurable:!0,get(){return this[s]||(this[s]=function(n){if(!gb.store)throw new Error(qa.SELECT_FACTORY_NOT_CONNECTED());return gb.store.select(n)}(o))}}})}}function _m(n){return(e,t,i)=>{if(!i||null===i.value)throw new Error(qa.SELECTOR_DECORATOR());const s=i.value,o=Owe(n,s,{containerClass:e,selectorName:t.toString(),getSelectorOptions:()=>({})}),a={configurable:!0,get:()=>o};return a.originalFn=s,a}}Yo.\u0275fac=function(e){return new(e||Yo)},Yo.\u0275mod=tn({type:Yo}),Yo.\u0275inj=St({}),Yo.ROOT_OPTIONS=new Ht("ROOT_OPTIONS");const Xo=new Ht("NgValueAccessor");function Dl(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}const qS=new cc(sx);class YEe{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new XEe(e,this.dueTime,this.scheduler))}}class XEe extends y{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(KEe,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function KEe(n){n.debouncedNext()}class QEe{constructor(e){this.total=e}call(e,t){return t.subscribe(new ZEe(e,this.total))}}class ZEe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}function bi(n){return null!=n&&"false"!=`${n}`}function Ya(n,e=0){return function(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function YS(n){return Array.isArray(n)?n:[n]}function bs(n){return null==n?"":"string"==typeof n?n:`${n}px`}function dd(n){return n instanceof gn?n.nativeElement:n}let zP;try{zP="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){zP=!1}let Cb,Xf,HP,Qi=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Af(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!zP)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(Ie(Xc))},n.\u0275prov=We({factory:function(){return new n(Ie(Xc))},token:n,providedIn:"root"}),n})(),Sb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})();function vm(n){return function(){if(null==Cb&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Cb=!0}))}finally{Cb=Cb||!1}return Cb}()?n:!!n.capture}function F6(){if(null==Xf){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Xf=!1,Xf;if("scrollBehavior"in document.documentElement.style)Xf=!0;else{const n=Element.prototype.scrollTo;Xf=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Xf}function KS(){let n="undefined"!=typeof document&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Kf(n){return n.composedPath?n.composedPath()[0]:n.target}let GP=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return new n},token:n,providedIn:"root"}),n})(),L6=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=dd(t);return new O(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new oe,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(GP))},n.\u0275prov=We({factory:function(){return new n(Ie(GP))},token:n,providedIn:"root"}),n})(),$P=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new ln,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=bi(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=Ya(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(n,e=qS){return t=>t.lift(new YEe(n,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(Ce(L6),Ce(gn),Ce(pn))},n.\u0275dir=Nt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),QS=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[GP]}),n})(),$6=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function(n){try{return n.frameElement}catch(e){return null}}(function(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===q6(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=q6(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function(n){return!function(n){return function(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function(n){return function(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||W6(n))}(t)&&!this.isDisabled(t)&&((null==i?void 0:i.ignoreVisibility)||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Qi))},n.\u0275prov=We({factory:function(){return new n(Ie(Qi))},token:n,providedIn:"root"}),n})();function W6(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function q6(n){if(!W6(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class yxe{constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),t&&(t.removeEventListener("focus",this.endAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);for(let i=0;i<t.length;i++)t[i].hasAttribute(`cdk-focus-${e}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[i]):t[i].hasAttribute(`cdk-focus-region-${e}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[i]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return null==i||i.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let i=0;i<t.length;i++){let r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let i=t.length-1;i>=0;i--){let r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(qr(1)).subscribe(e)}}let Y6=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new yxe(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(Ie($6),Ie(pn),Ie(fn))},n.\u0275prov=We({factory:function(){return new n(Ie($6),Ie(pn),Ie(fn))},token:n,providedIn:"root"}),n})();function X6(n){return 0===n.offsetX&&0===n.offsetY}function K6(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}"undefined"!=typeof Element&&Element;const Q6=new Ht("cdk-input-modality-detector-options"),xxe={ignoreKeys:[18,17,224,91,16]},wm=vm({passive:!0,capture:!0});let J6=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Fr(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Kf(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(X6(o)?"keyboard":"mouse"),this._mostRecentTarget=Kf(o))},this._onTouchstart=o=>{K6(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Kf(o))},this._options=Object.assign(Object.assign({},xxe),s),this.modalityDetected=this._modality.pipe(function(n){return e=>e.lift(new QEe(n))}(1)),this.modalityChanged=this.modalityDetected.pipe(ld()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,wm),r.addEventListener("mousedown",this._onMousedown,wm),r.addEventListener("touchstart",this._onTouchstart,wm)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,wm),document.removeEventListener("mousedown",this._onMousedown,wm),document.removeEventListener("touchstart",this._onTouchstart,wm))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Qi),Ie(pn),Ie(fn),Ie(Q6,8))},n.\u0275prov=We({factory:function(){return new n(Ie(Qi),Ie(pn),Ie(fn),Ie(Q6,8))},token:n,providedIn:"root"}),n})();const nG=new Ht("cdk-focus-monitor-default-options"),eC=vm({passive:!0,capture:!0});let vc=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new oe,this._rootNodeFocusAndBlurListener=a=>{const l=Kf(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=dd(t);if(!this._platform.isBrowser||1!==r.nodeType)return sn(null);const s=function(n){if(function(){if(null==HP){const n="undefined"!=typeof document?document.head:null;HP=!(!n||!n.createShadowRoot&&!n.attachShadow)}return HP}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new oe,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=dd(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=dd(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,i,r){r?t.classList.add(i):t.classList.remove(i)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){this._toggleClass(t,"cdk-focused",!!i),this._toggleClass(t,"cdk-touch-focused","touch"===i),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===i),this._toggleClass(t,"cdk-mouse-focused","mouse"===i),this._toggleClass(t,"cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Kf(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,eC),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,eC)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(gr(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,eC),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,eC),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(Ie(pn),Ie(Qi),Ie(J6),Ie(fn,8),Ie(nG,8))},n.\u0275prov=We({factory:function(){return new n(Ie(pn),Ie(Qi),Ie(J6),Ie(fn,8),Ie(nG,8))},token:n,providedIn:"root"}),n})();const iG="cdk-high-contrast-black-on-white",rG="cdk-high-contrast-white-on-black",qP="cdk-high-contrast-active";let sG=(()=>{class n{constructor(t,i){this._platform=t,this._document=i}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(qP),t.remove(iG),t.remove(rG),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?(t.add(qP),t.add(iG)):2===i&&(t.add(qP),t.add(rG))}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Qi),Ie(fn))},n.\u0275prov=We({factory:function(){return new n(Ie(Qi),Ie(fn))},token:n,providedIn:"root"}),n})();const oG=new Ht("cdk-dir-doc",{providedIn:"root",factory:function(){return Bc(fn)}});let Il=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new ln,t){const r=t.documentElement?t.documentElement.dir:null,s=(t.body?t.body.dir:null)||r;this.value="ltr"===s||"rtl"===s?s:"ltr"}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(Ie(oG,8))},n.\u0275prov=We({factory:function(){return new n(Ie(oG,8))},token:n,providedIn:"root"}),n})(),Ab=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})();const aG=new Hu("12.2.5");function tC(...n){return kt(1)(sn(...n))}function Oo(...n){const e=n[n.length-1];return Te(e)?(n.pop(),t=>tC(n,t,e)):t=>tC(n,t)}function Em(n,e){return{type:7,name:n,definitions:e,options:{}}}function fd(n,e=null){return{type:4,styles:e,timings:n}}function ds(n){return{type:6,styles:n,offset:null}}function wc(n,e,t){return{type:0,name:n,styles:e,options:t}}function pd(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function uG(n){Promise.resolve(null).then(n)}class xm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){uG(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function hG(){return"undefined"!=typeof window&&void 0!==window.document}function XP(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let JP=(n,e)=>!1,eN=(n,e)=>!1,gG=(n,e,t)=>[];const mG=XP();(mG||"undefined"!=typeof Element)&&(JP=hG()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),eN=(()=>{if(mG||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):eN}})(),gG=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let Qf=null,_G=!1;function tN(n){Qf||(Qf=("undefined"!=typeof document?document.body:null)||{},_G=!!Qf.style&&"WebkitAppearance"in Qf.style);let e=!0;return Qf.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Qf.style,!e&&_G&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Qf.style)),e}const nN=eN,iN=JP,rN=gG;let bG=(()=>{class n{validateStyleProperty(t){return tN(t)}matchesElement(t,i){return nN(t,i)}containsElement(t,i){return iN(t,i)}query(t,i,r){return rN(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new xm(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class nC{}nC.NOOP=new bG;function xG(n,e,t){return t?e+":"+t+";":""}function SG(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=xG(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=xG(0,Bxe(t),n.style[t]));n.setAttribute("style",e)}function pu(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=cN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),XP()&&SG(n))}function Jf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=cN(t);n.style[i]=""}),XP()&&SG(n))}const Lxe=/-+([a-z0-9])/g;function cN(n){return n.replace(Lxe,(...e)=>e[1].toUpperCase())}function Bxe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class Tm{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=Tm.initialStylesByElement.get(e);r||Tm.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&pu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(pu(this._element,this._initialStyles),this._endStyles&&(pu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(Tm.initialStylesByElement.delete(this._element),this._startStyles&&(Jf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Jf(this._element,this._endStyles),this._endStyles=null),pu(this._element,this._initialStyles),this._state=3)}}Tm.initialStylesByElement=new WeakMap;const Qa=new Ht("AnimationModuleType"),l$=new Hu("12.2.5"),sCe=new Ht("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let tp,ji=(()=>{class n{constructor(t,i,r){this._hasDoneGlobalChecks=!1,this._document=r,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=i,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checkIsEnabled(t){return!(!fa()||this._isTestEnv())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const i=getComputedStyle(t);i&&"none"!==i.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&l$.full!==aG.full&&console.warn("The Angular Material version ("+l$.full+") does not match the Angular CDK version ("+aG.full+").\nPlease ensure the versions of these two packages exactly match.")}}return n.\u0275fac=function(t){return new(t||n)(Ie(sG),Ie(sCe,8),Ie(fn))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[Ab],Ab]}),n})();function Am(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=bi(e)}}}function Mm(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function Ch(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=bi(e)}}}function wC(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?Ya(t):this.defaultTabIndex}}}try{tp="undefined"!=typeof Intl}catch(n){tp=!1}class yCe{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const p$={enterDuration:225,exitDuration:150},SN=vm({passive:!0}),g$=["mousedown","touchstart"],m$=["mouseup","mouseleave","touchend","touchcancel"];class vCe{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=dd(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},p$),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u),function(n){window.getComputedStyle(n).getPropertyValue("opacity")}(u),u.style.transform="scale(1)";const h=new yCe(this,u,i);return h.state=0,this._activeRipples.add(h),i.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone(()=>{const f=h===this._mostRecentTransientRipple;h.state=1,!i.persistent&&(!f||!this._isPointerDown)&&h.fadeOut()},c),h}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,r=Object.assign(Object.assign({},p$),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.parentNode.removeChild(i)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=dd(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(g$))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(m$),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=X6(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!K6(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,SN)})})}_removeTriggerEvents(){this._triggerElement&&(g$.forEach(e=>{this._triggerElement.removeEventListener(e,this,SN)}),this._pointerUpEventsRegistered&&m$.forEach(e=>{this._triggerElement.removeEventListener(e,this,SN)}))}}const xCe=new Ht("mat-ripple-global-options");let gu=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new vCe(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(Ce(gn),Ce(pn),Ce(Qi),Ce(xCe,8),Ce(Qa,8))},n.\u0275dir=Nt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&ai("mat-ripple-unbounded",i.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),n})(),Dm=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[ji,Sb],ji]}),n})();function gd(n,e,t,i){return Y(t)&&(i=t,t=void 0),i?gd(n,e,t).pipe(me(r=>k(r)?i(...r):i(r))):new O(r=>{E$(n,e,function(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function E$(n,e,t,i,r){let s;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)E$(n[o],e,t,i,r)}i.add(s)}new class extends cc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends sx{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let FCe=1;const LCe=Promise.resolve(),SC={};function x$(n){return n in SC&&(delete SC[n],!0)}const S$={setImmediate(n){const e=FCe++;return SC[e]=!0,LCe.then(()=>x$(e)&&n()),e},clearImmediate(n){x$(n)}};new class extends cc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends sx{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=S$.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(S$.clearImmediate(t),e.scheduled=void 0)}});function Im(n){return!!n&&(n instanceof O||"function"==typeof n.lift&&"function"==typeof n.subscribe)}class zCe{constructor(e){this.durationSelector=e}call(e,t){return t.subscribe(new HCe(e,this.durationSelector))}}class HCe extends we{constructor(e,t){super(e),this.durationSelector=t,this.hasValue=!1}_next(e){if(this.value=e,this.hasValue=!0,!this.throttled){let t;try{const{durationSelector:r}=this;t=r(e)}catch(r){return this.destination.error(r)}const i=N(t,new _t(this));!i||i.closed?this.clearThrottle():this.add(this.throttled=i)}}clearThrottle(){const{value:e,hasValue:t,throttled:i}=this;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),t&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))}notifyNext(){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function C$(n){return!k(n)&&n-parseFloat(n)+1>=0}function $Ce(n){const{index:e,period:t,subscriber:i}=n;if(i.next(e),!i.closed){if(-1===t)return i.complete();n.index=e+1,this.schedule(n,t)}}function CC(n,e=qS){return function(n){return function(t){return t.lift(new zCe(n))}}(()=>function(n=0,e,t){let i=-1;return C$(e)?i=Number(e)<1?1:Number(e):Te(e)&&(t=e),Te(t)||(t=qS),new O(r=>{const s=C$(n)?n:+n-t.now();return t.schedule($Ce,s,{index:0,period:i,subscriber:r})})}(n,e))}let A$=(()=>{class n{constructor(){this._listeners=[]}notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:function(){return new n},token:n,providedIn:"root"}),n})(),Om=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new oe,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new O(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(CC(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):sn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Ki(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=dd(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>gd(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(Ie(pn),Ie(Qi),Ie(fn,8))},n.\u0275prov=We({factory:function(){return new n(Ie(pn),Ie(Qi),Ie(fn,8))},token:n,providedIn:"root"}),n})(),Rm=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new oe,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(CC(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Qi),Ie(pn),Ie(fn,8))},n.\u0275prov=We({factory:function(){return new n(Ie(Qi),Ie(pn),Ie(fn,8))},token:n,providedIn:"root"}),n})();class MN{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class AC extends MN{constructor(e,t,i,r){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r}}class Pm extends MN{constructor(e,t,i){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class l1e extends MN{constructor(e){super(),this.element=e instanceof gn?e.nativeElement:e}}class MC{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof AC?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof Pm?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof l1e?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class c1e extends MC{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context);return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let np=(()=>{class n extends MC{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new ln,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)(Ce(El),Ce(Rs),Ce(fn))},n.\u0275dir=Nt({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[En]}),n})();const N$=F6();class f1e{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=bs(-this._previousScrollPosition.left),e.style.top=bs(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),N$&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),N$&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class p1e{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class k${enable(){}disable(){}attach(){}}function DN(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function F$(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class g1e{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();DN(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let m1e=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new k$,this.close=o=>new p1e(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new f1e(this._viewportRuler,this._document),this.reposition=o=>new g1e(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(Ie(Om),Ie(Rm),Ie(pn),Ie(fn))},n.\u0275prov=We({factory:function(){return new n(Ie(Om),Ie(Rm),Ie(pn),Ie(fn))},token:n,providedIn:"root"}),n})();class IC{constructor(e){if(this.scrollStrategy=new k$,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class _1e{constructor(e,t,i,r,s){this.offsetX=i,this.offsetY=r,this.panelClass=s,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}}class y1e{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let L$=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({factory:function(){return new n(Ie(fn))},token:n,providedIn:"root"}),n})(),b1e=(()=>{class n extends L${constructor(t){super(t),this._keydownListener=i=>{const r=this._attachedOverlays;for(let s=r.length-1;s>-1;s--)if(r[s]._keydownEvents.observers.length>0){r[s]._keydownEvents.next(i);break}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn))},n.\u0275prov=We({factory:function(){return new n(Ie(fn))},token:n,providedIn:"root"}),n})(),v1e=(()=>{class n extends L${constructor(t,i){super(t),this._platform=i,this._cursorStyleIsSet=!1,this._clickListener=r=>{const s=Kf(r),o=this._attachedOverlays.slice();for(let a=o.length-1;a>-1;a--){const l=o[a];if(!(l._outsidePointerEvents.observers.length<1)&&l.hasAttached()){if(l.overlayElement.contains(s))break;l._outsidePointerEvents.next(r)}}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn),Ie(Qi))},n.\u0275prov=We({factory:function(){return new n(Ie(fn),Ie(Qi))},token:n,providedIn:"root"}),n})();const Th="undefined"!=typeof window?window:{},B$=void 0!==Th.__karma__&&!!Th.__karma__||void 0!==Th.jasmine&&!!Th.jasmine||void 0!==Th.jest&&!!Th.jest||void 0!==Th.Mocha&&!!Th.Mocha;let Ob=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||B$){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].parentNode.removeChild(r[s])}const i=this._document.createElement("div");i.classList.add(t),B$?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn),Ie(Qi))},n.\u0275prov=We({factory:function(){return new n(Ie(fn),Ie(Qi))},token:n,providedIn:"root"}),n})();class w1e{constructor(e,t,i,r,s,o,a,l,c){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._backdropElement=null,this._backdropClick=new oe,this._attachments=new oe,this._detachments=new oe,this._locationChanges=C.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._keydownEvents=new oe,this._outsidePointerEvents=new oe,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){let t=this._portalOutlet.attach(e);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(qr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Object.assign(Object.assign({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Object.assign(Object.assign({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=bs(this._config.width),e.height=bs(this._config.height),e.minWidth=bs(this._config.minWidth),e.minHeight=bs(this._config.minHeight),e.maxWidth=bs(this._config.maxWidth),e.maxHeight=bs(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(!e)return;let t,i=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",i),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",i)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(i,500))}_toggleClasses(e,t,i){const r=e.classList;YS(t).forEach(s=>{s&&(i?r.add(s):r.remove(s))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(gr(Nn(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}}const V$="cdk-overlay-connected-position-bounding-box",E1e=/([A-Za-z%]+)$/;class j${constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new oe,this._resizeSubscription=C.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(V$),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=[];let s;for(let o of this._preferredPositions){let a=this._getOriginPoint(e,o),l=this._getOverlayPoint(a,t,o),c=this._getOverlayFit(l,t,i,o);if(c.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(o,a);this._canFitWithFlexibleDimensions(c,l,i)?r.push({position:o,origin:a,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(a,o)}):(!s||s.overlayFit.visibleArea<c.visibleArea)&&(s={overlayFit:c,overlayPoint:l,originPoint:a,position:o,overlayRect:t})}if(r.length){let o=null,a=-1;for(const l of r){const c=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);c>a&&(a=c,o=l)}return this._isPushed=!1,void this._applyPosition(o.position,o.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(s.position,s.originPoint);this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ip(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(V$),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const e=this._lastPosition||this._preferredPositions[0],t=this._getOriginPoint(this._originRect,e);this._applyPosition(e,t)}}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t){let i,r;if("center"==t.originX)i=e.left+e.width/2;else{const s=this._isRtl()?e.right:e.left,o=this._isRtl()?e.left:e.right;i="start"==t.originX?s:o}return r="center"==t.originY?e.top+e.height/2:"top"==t.originY?e.top:e.bottom,{x:i,y:r}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=z$(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let f=0-a,g=a+s.height-i.height,m=this._subtractOverflows(s.width,0-o,o+s.width-i.width),v=this._subtractOverflows(s.height,f,g),x=m*v;return{visibleArea:x,isCompletelyWithinViewport:s.width*s.height===x,fitsInViewportVertically:v===s.height,fitsInViewportHorizontally:m==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=U$(this._overlayRef.getConfig().minHeight),a=U$(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportHorizontally||null!=a&&a<=s;return(e.fitsInViewportVertically||null!=o&&o<=r)&&c}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=z$(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-i.top-e.y,0),c=Math.max(s.left-i.left-e.x,0);let u=0,h=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,h=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:h},{x:e.x+u,y:e.y+h}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new y1e(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,h,f;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const g=Math.min(i.bottom-e.y+i.top,e.y),m=this._lastBoundingBoxSize.height;s=2*g,o=e.y-g,s>m&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-m/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)f=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)h=e.x,u=i.right-e.x;else{const g=Math.min(i.right-e.x+i.left,e.x),m=this._lastBoundingBoxSize.width;u=2*g,h=e.x-g,u>m&&!this._isInitialRender&&!this._growAfterOpen&&(h=e.x-m/2)}return{top:o,left:h,bottom:a,right:f,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=bs(i.height),r.top=bs(i.top),r.bottom=bs(i.bottom),r.width=bs(i.width),r.left=bs(i.left),r.right=bs(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=bs(s)),o&&(r.maxWidth=bs(o))}this._lastBoundingBoxSize=i,ip(this._boundingBox.style,r)}_resetBoundingBoxStyles(){ip(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ip(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();ip(i,this._getExactOverlayY(t,e,u)),ip(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=bs(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=bs(o.maxWidth):s&&(i.maxWidth="")),ip(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i));let o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return s.y-=o,"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=bs(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=bs(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:F$(e,i),isOriginOutsideView:DN(e,i),isOverlayClipped:F$(t,i),isOverlayOutsideView:DN(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&YS(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof gn)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function ip(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function U$(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(E1e);return t&&"px"!==t?null:parseFloat(e)}return n||null}function z$(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}class x1e{constructor(e,t,i,r,s,o,a){this._preferredPositions=[],this._positionStrategy=new j$(i,r,s,o,a).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(e,t),this.onPositionChange=this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(e){this._overlayRef=e,this._positionStrategy.attach(e),this._direction&&(e.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(e){this._positionStrategy.withScrollableContainers(e)}withFallbackPosition(e,t,i,r){const s=new _1e(e,t,i,r);return this._preferredPositions.push(s),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(e){return this._overlayRef?this._overlayRef.setDirection(e):this._direction=e,this}withOffsetX(e){return this._positionStrategy.withDefaultOffsetX(e),this}withOffsetY(e){return this._positionStrategy.withDefaultOffsetY(e),this}withLockedPosition(e){return this._positionStrategy.withLockedPosition(e),this}withPositions(e){return this._preferredPositions=e.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(e){return this._positionStrategy.setOrigin(e),this}}const H$="cdk-global-overlay-wrapper";class S1e{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(H$),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._justifyContent="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a);e.position=this._cssPosition,e.marginLeft=l?"0":this._leftOffset,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,l?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(H$),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let C1e=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new S1e}connectedTo(t,i,r){return new x1e(i,r,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new j$(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Rm),Ie(fn),Ie(Qi),Ie(Ob))},n.\u0275prov=We({factory:function(){return new n(Ie(Rm),Ie(fn),Ie(Qi),Ie(Ob))},token:n,providedIn:"root"}),n})(),T1e=0,Ec=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,h,f){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=h,this._outsideClickDispatcher=f}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new IC(t);return o.direction=o.direction||this._directionality.value,new w1e(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+T1e++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(sh)),new c1e(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(Ie(m1e),Ie(Ob),Ie(El),Ie(C1e),Ie(b1e),Ie(Hn),Ie(pn),Ie(fn),Ie(Il),Ie(kg),Ie(v1e))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class rTe{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new PN(e,this.delay,this.scheduler))}}class PN extends y{constructor(e,t,i){super(e),this.delay=t,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,i=t.queue,r=e.scheduler,s=e.destination;for(;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(s);if(i.length>0){const o=Math.max(0,i[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(PN.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,i=new sTe(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(ga.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(ga.createComplete()),this.unsubscribe()}}class sTe{constructor(e,t){this.time=e,this.notification=t}}function oW(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>me(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}function NN(n){return e=>e.lift(new WTe(n))}et(7266);class WTe{constructor(e){this.callback=e}call(e,t){return t.subscribe(new qTe(e,this.callback))}}class qTe extends y{constructor(e,t){super(e),this.add(new C(t))}}class fW{}class pW{}class mu{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof mu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new mu;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof mu?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class YTe{encodeKey(e){return gW(e)}encodeValue(e){return gW(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const KTe=/%(\d[a-f0-9])/gi,QTe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function gW(n){return encodeURIComponent(n).replace(KTe,(e,t)=>{var i;return null!==(i=QTe[t])&&void 0!==i?i:e})}function mW(n){return`${n}`}class Lr{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new YTe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Lr({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(mW(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(mW(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Zs{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function _W(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function yW(n){return"undefined"!=typeof Blob&&n instanceof Blob}function bW(n){return"undefined"!=typeof FormData&&n instanceof FormData}class Rb{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new mu),this.context||(this.context=new Zs),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Lr,this.urlWithParams=t}serializeBody(){return null===this.body?null:_W(this.body)||yW(this.body)||bW(this.body)||function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Lr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||bW(this.body)?null:yW(this.body)?this.body.type||null:_W(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Lr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const h=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((f,g)=>f.set(g,e.setHeaders[g]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((f,g)=>f.set(g,e.setParams[g]),u)),new Rb(i,r,o,{params:u,headers:c,context:h,reportProgress:l,responseType:s,withCredentials:a})}}var vs=(()=>((vs=vs||{})[vs.Sent=0]="Sent",vs[vs.UploadProgress=1]="UploadProgress",vs[vs.ResponseHeader=2]="ResponseHeader",vs[vs.DownloadProgress=3]="DownloadProgress",vs[vs.Response=4]="Response",vs[vs.User=5]="User",vs))();class kN{constructor(e,t=200,i="OK"){this.headers=e.headers||new mu,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class FN extends kN{constructor(e={}){super(e),this.type=vs.ResponseHeader}clone(e={}){return new FN({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class RC extends kN{constructor(e={}){super(e),this.type=vs.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new RC({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class vW extends kN{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function LN(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let _u=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Rb)s=t;else{let l,c;l=r.headers instanceof mu?r.headers:new mu(r.headers),r.params&&(c=r.params instanceof Lr?r.params:new Lr({fromObject:r.params})),s=new Rb(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=sn(s).pipe(function(n,e){return V(n,e,1)}(l=>this.handler.handle(l)));if(t instanceof Rb||"events"===r.observe)return o;const a=o.pipe(Ki(l=>l instanceof RC));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(me(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(me(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Lr).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,LN(r,i))}post(t,i,r={}){return this.request("POST",t,LN(r,i))}put(t,i,r={}){return this.request("PUT",t,LN(r,i))}}return n.\u0275fac=function(t){return new(t||n)(Ie(fW))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class wW{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const EW=new Ht("HTTP_INTERCEPTORS");let eAe=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const tAe=/^\)\]\}',?\n/;let xW=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new O(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((g,m)=>r.setRequestHeader(g,m.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const g=t.detectContentTypeHeader();null!==g&&r.setRequestHeader("Content-Type",g)}if(t.responseType){const g=t.responseType.toLowerCase();r.responseType="json"!==g?g:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const g=1223===r.status?204:r.status,m=r.statusText||"OK",v=new mu(r.getAllResponseHeaders()),x=function(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new FN({headers:v,status:g,statusText:m,url:x}),o},l=()=>{let{headers:g,status:m,statusText:v,url:x}=a(),U=null;204!==m&&(U=void 0===r.response?r.responseText:r.response),0===m&&(m=U?200:0);let D=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof U){const ie=U;U=U.replace(tAe,"");try{U=""!==U?JSON.parse(U):null}catch(_e){U=ie,D&&(D=!1,U={error:_e,text:U})}}D?(i.next(new RC({body:U,headers:g,status:m,statusText:v,url:x||void 0})),i.complete()):i.error(new vW({error:U,headers:g,status:m,statusText:v,url:x||void 0}))},c=g=>{const{url:m}=a(),v=new vW({error:g,status:r.status||0,statusText:r.statusText||"Unknown Error",url:m||void 0});i.error(v)};let u=!1;const h=g=>{u||(i.next(a()),u=!0);let m={type:vs.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===t.responseType&&!!r.responseText&&(m.partialText=r.responseText),i.next(m)},f=g=>{let m={type:vs.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),i.next(m)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",h),null!==s&&r.upload&&r.upload.addEventListener("progress",f)),r.send(s),i.next({type:vs.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",h),null!==s&&r.upload&&r.upload.removeEventListener("progress",f)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(Ie(oV))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const BN=new Ht("XSRF_COOKIE_NAME"),VN=new Ht("XSRF_HEADER_NAME");class SW{}let iAe=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=YB(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(Ie(fn),Ie(Xc),Ie(BN))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),jN=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(SW),Ie(VN))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),rAe=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(EW,[]);this.chain=i.reduceRight((r,s)=>new wW(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(pW),Ie(Hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),sAe=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:jN,useClass:eAe}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:BN,useValue:t.cookieName}:[],t.headerName?{provide:VN,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[jN,{provide:EW,useExisting:jN,multi:!0},{provide:SW,useClass:iAe},{provide:BN,useValue:"XSRF-TOKEN"},{provide:VN,useValue:"X-XSRF-TOKEN"}]}),n})(),CW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[_u,{provide:fW,useClass:rAe},xW,{provide:pW,useExisting:xW}],imports:[[sAe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})();const oAe=["*"];function TW(n){return Error(`Unable to find icon with the name "${n}"`)}function AW(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function MW(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class rp{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let PC=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new rp(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(si.HTML,r);if(!o)throw MW(r);return this._addSvgIconConfig(t,i,new rp("",o,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new rp(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(si.HTML,i);if(!s)throw MW(i);return this._addSvgIconSetConfig(t,new rp("",s,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(si.RESOURCE_URL,t);if(!i)throw AW(t);const r=this._cachedIconsByUrl.get(i);return r?sn(NC(r)):this._loadSvgIconFromConfig(new rp(t,null)).pipe(cr(s=>this._cachedIconsByUrl.set(i,s)),me(s=>NC(s)))}getNamedSvgIcon(t,i=""){const r=DW(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):Fg(TW(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?sn(NC(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(me(i=>NC(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?sn(r):fb(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(bc(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(si.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),sn(null)})))).pipe(me(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw TW(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(cr(i=>t.svgText=i),me(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?sn(null):this._fetchIcon(t).pipe(cr(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString("<svg></svg>");return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString("<svg></svg>"),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){var i;const{url:r,options:s}=t,o=null!==(i=null==s?void 0:s.withCredentials)&&void 0!==i&&i;if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const a=this._sanitizer.sanitize(si.RESOURCE_URL,r);if(!a)throw AW(r);const l=this._inProgressUrlFetches.get(a);if(l)return l;const c=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(NN(()=>this._inProgressUrlFetches.delete(a)),ws());return this._inProgressUrlFetches.set(a,c),c}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(DW(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return cAe(s)?new rp(s.url,null,s.options):new rp(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(_u,8),Ie(Mf),Ie(fn,8),Ie(la))},n.\u0275prov=We({factory:function(){return new n(Ie(_u,8),Ie(Mf),Ie(fn,8),Ie(la))},token:n,providedIn:"root"}),n})();function NC(n){return n.cloneNode(!0)}function DW(n,e){return n+":"+e}function cAe(n){return!(!n.url||!n.options)}const uAe=Mm(class{constructor(n){this._elementRef=n}}),dAe=new Ht("mat-icon-location",{providedIn:"root",factory:function(){const n=Bc(fn),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),IW=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],pAe=IW.map(n=>`[${n}]`).join(", "),gAe=/^url\(['"]?#(.*?)['"]?\)$/;let Fm=(()=>{class n extends uAe{constructor(t,i,r,s,o){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=o,this._inline=!1,this._currentIconFetch=C.EMPTY,r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=bi(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=t.querySelectorAll("style");for(let s=0;s<i.length;s++)i[s].textContent+=" ";const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&t.removeChild(r)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();i!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),i&&t.classList.add(i),this._previousFontSetClass=i),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(pAe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)IW.forEach(o=>{const a=i[s],l=a.getAttribute(o),c=l?l.match(gAe):null;if(c){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(qr(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(Ce(gn),Ce(PC),yo("aria-hidden"),Ce(dAe),Ce(la))},n.\u0275cmp=rn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,i){2&t&&(Ii("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet),ai("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[En],ngContentSelectors:oAe,decls:1,vars:0,template:function(t,i){1&t&&(Hr(),oi(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),n})();function TAe(n,e){}class zN{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const AAe={dialogContainer:Em("dialogContainer",[wc("void, exit",ds({opacity:0,transform:"scale(0.7)"})),wc("enter",ds({transform:"none"})),pd("* => enter",fd("150ms cubic-bezier(0, 0, 0.2, 1)",ds({transform:"none",opacity:1}))),pd("* => void, * => exit",fd("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",ds({opacity:0})))])};let MAe=(()=>{class n extends MC{constructor(t,i,r,s,o,a){super(),this._elementRef=t,this._focusTrapFactory=i,this._changeDetectorRef=r,this._config=o,this._focusMonitor=a,this._animationStateChanged=new ln,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=l=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(l)),this._ariaLabelledBy=o.ariaLabelledBy||null,this._document=s}_initializeWithAttachedContent(){this._setupFocusTrap(),this._capturePreviouslyFocusedElement(),this._focusDialogContainer()}attachComponentPortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||(!this._config.autoFocus||!this._focusTrap.focusInitialElement())&&this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const i=KS(),r=this._elementRef.nativeElement;(!i||i===this._document.body||i===r||r.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(t,this._closeInteractionType),this._closeInteractionType=null):t.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)}_capturePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=KS())}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=KS();return t===i||t.contains(i)}}return n.\u0275fac=function(t){return new(t||n)(Ce(gn),Ce(Y6),Ce(Mr),Ce(fn,8),Ce(zN),Ce(vc))},n.\u0275dir=Nt({type:n,viewQuery:function(t,i){if(1&t&&hr(np,7),2&t){let r;Gn(r=$n())&&(i._portalOutlet=r.first)}},features:[En]}),n})(),DAe=(()=>{class n extends MAe{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:t,totalTime:i}){"enter"===t?(this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:i})):"exit"===t&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:i}))}_onAnimationStart({toState:t,totalTime:i}){"enter"===t?this._animationStateChanged.next({state:"opening",totalTime:i}):("exit"===t||"void"===t)&&this._animationStateChanged.next({state:"closing",totalTime:i})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275cmp=rn({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,i){1&t&&uE("@dialogContainer.start",function(s){return i._onAnimationStart(s)})("@dialogContainer.done",function(s){return i._onAnimationDone(s)}),2&t&&(qc("id",i._id),Ii("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledBy)("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),fE("@dialogContainer",i._state))},features:[En],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,i){1&t&&wi(0,TAe,0,0,"ng-template",0)},directives:[np],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[AAe.dialogContainer]}}),n})(),IAe=0;class kC{constructor(e,t,i="mat-dialog-"+IAe++){this._overlayRef=e,this._containerInstance=t,this.id=i,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new oe,this._afterClosed=new oe,this._beforeClosed=new oe,this._state=0,t._id=i,t._animationStateChanged.pipe(Ki(r=>"opened"===r.state),qr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(Ki(r=>"closed"===r.state),qr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),e.keydownEvents().pipe(Ki(r=>27===r.keyCode&&!this.disableClose&&!Dl(r))).subscribe(r=>{r.preventDefault(),HN(this,"keyboard")}),e.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():HN(this,"mouse")})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Ki(t=>"closing"===t.state),qr(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(e){let t=this._getPositionStrategy();return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(e="",t=""){return this._overlayRef.updateSize({width:e,height:t}),this._overlayRef.updatePosition(),this}addPanelClass(e){return this._overlayRef.addPanelClass(e),this}removePanelClass(e){return this._overlayRef.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function HN(n,e,t){return void 0!==n._containerInstance&&(n._containerInstance._closeInteractionType=e),n.close(t)}const PW=new Ht("MatDialogData"),OAe=new Ht("mat-dialog-default-options"),NW=new Ht("mat-dialog-scroll-strategy");let NAe=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._dialogRefConstructor=l,this._dialogContainerType=c,this._dialogDataToken=u,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new oe,this._afterOpenedAtThisLevel=new oe,this._ariaHiddenElements=new Map,this.afterAllClosed=function(n){return new O(e=>{let t;try{t=n()}catch(r){return void e.error(r)}return(t?je(t):b0()).subscribe(e)})}(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Oo(void 0))),this._scrollStrategy=a}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(t,i){(i=function(n,e){return Object.assign(Object.assign({},e),n)}(i,this._defaultOptions||new zN)).id&&this.getDialogById(i.id);const r=this._createOverlay(i),s=this._attachDialogContainer(r,i),o=this._attachDialogContent(t,s,r,i);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(o),o.afterClosed().subscribe(()=>this._removeOpenDialog(o)),this.afterOpened.next(o),s._initializeWithAttachedContent(),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const i=this._getOverlayConfig(t);return this._overlay.create(i)}_getOverlayConfig(t){const i=new IC({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachDialogContainer(t,i){const s=Hn.create({parent:i&&i.viewContainerRef&&i.viewContainerRef.injector||this._injector,providers:[{provide:zN,useValue:i}]}),o=new AC(this._dialogContainerType,i.viewContainerRef,s,i.componentFactoryResolver);return t.attach(o).instance}_attachDialogContent(t,i,r,s){const o=new this._dialogRefConstructor(r,i,s.id);if(t instanceof Go)i.attachTemplatePortal(new Pm(t,null,{$implicit:s.data,dialogRef:o}));else{const a=this._createInjector(s,o,i),l=i.attachComponentPortal(new AC(t,s.viewContainerRef,a));o.componentInstance=l.instance}return o.updateSize(s.width,s.height).updatePosition(s.position),o}_createInjector(t,i,r){const s=t&&t.viewContainerRef&&t.viewContainerRef.injector,o=[{provide:this._dialogContainerType,useValue:r},{provide:this._dialogDataToken,useValue:t.data},{provide:this._dialogRefConstructor,useValue:i}];return t.direction&&(!s||!s.get(Il,null,xn.Optional))&&o.push({provide:Il,useValue:{value:t.direction,change:sn()}}),Hn.create({parent:s||this._injector,providers:o})}_removeOpenDialog(t){const i=this.openDialogs.indexOf(t);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((r,s)=>{r?s.setAttribute("aria-hidden",r):s.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){let s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}}return n.\u0275fac=function(t){return new(t||n)(Ce(Ec),Ce(Hn),Ce(void 0),Ce(void 0),Ce(Ob),Ce(void 0),Ce(Du),Ce(Du),Ce(Ht))},n.\u0275dir=Nt({type:n}),n})(),Nb=(()=>{class n extends NAe{constructor(t,i,r,s,o,a,l){super(t,i,s,a,l,o,kC,DAe,PW)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Ec),Ie(Hn),Ie(kg,8),Ie(OAe,8),Ie(NW),Ie(n,12),Ie(Ob))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),FAe=0,kW=(()=>{class n{constructor(t,i,r){this._dialogRef=t,this._elementRef=i,this._dialog=r,this.id="mat-dialog-title-"+FAe++}ngOnInit(){this._dialogRef||(this._dialogRef=function(n,e){let t=n.nativeElement.parentElement;for(;t&&!t.classList.contains("mat-dialog-container");)t=t.parentElement;return t?e.find(i=>i.id===t.id):null}(this._elementRef,this._dialog.openDialogs)),this._dialogRef&&Promise.resolve().then(()=>{const t=this._dialogRef._containerInstance;t&&!t._ariaLabelledBy&&(t._ariaLabelledBy=this.id)})}}return n.\u0275fac=function(t){return new(t||n)(Ce(kC,8),Ce(gn),Ce(Nb))},n.\u0275dir=Nt({type:n,selectors:[["","mat-dialog-title",""],["","matDialogTitle",""]],hostAttrs:[1,"mat-dialog-title"],hostVars:1,hostBindings:function(t,i){2&t&&qc("id",i.id)},inputs:{id:"id"},exportAs:["matDialogTitle"]}),n})(),FW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Nt({type:n,selectors:[["","mat-dialog-content",""],["mat-dialog-content"],["","matDialogContent",""]],hostAttrs:[1,"mat-dialog-content"]}),n})();const $N=new Ht("CdkAccordion");let VAe=0,UAe=(()=>{class n{constructor(t,i,r){this.accordion=t,this._changeDetectorRef=i,this._expansionDispatcher=r,this._openCloseAllSubscription=C.EMPTY,this.closed=new ln,this.opened=new ln,this.destroyed=new ln,this.expandedChange=new ln,this.id="cdk-accordion-child-"+VAe++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=r.listen((s,o)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===o&&this.id!==s&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(t){t=bi(t),this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){this._disabled=bi(t)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}}return n.\u0275fac=function(t){return new(t||n)(Ce($N,12),Ce(Mr),Ce(A$))},n.\u0275dir=Nt({type:n,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[Vn([{provide:$N,useValue:void 0}])]}),n})();const HAe=["body"];function GAe(n,e){}const $Ae=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],WAe=["mat-expansion-panel-header","*","mat-action-row"];function qAe(n,e){1&n&&ni(0,"span",2),2&n&&Jt("@indicatorRotate",_i()._getExpandedState())}const YAe=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],XAe=["mat-panel-title","mat-panel-description","*"],WN=new Ht("MAT_ACCORDION"),BW="225ms cubic-bezier(0.4,0.0,0.2,1)",VW={indicatorRotate:Em("indicatorRotate",[wc("collapsed, void",ds({transform:"rotate(0deg)"})),wc("expanded",ds({transform:"rotate(180deg)"})),pd("expanded <=> collapsed, void => collapsed",fd(BW))]),bodyExpansion:Em("bodyExpansion",[wc("collapsed, void",ds({height:"0px",visibility:"hidden"})),wc("expanded",ds({height:"*",visibility:"visible"})),pd("expanded <=> collapsed, void => collapsed",fd(BW))])};let KAe=(()=>{class n{constructor(t){this._template=t}}return n.\u0275fac=function(t){return new(t||n)(Ce(Go))},n.\u0275dir=Nt({type:n,selectors:[["ng-template","matExpansionPanelContent",""]]}),n})(),QAe=0;const jW=new Ht("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let UW=(()=>{class n extends UAe{constructor(t,i,r,s,o,a,l){super(t,i,r),this._viewContainerRef=s,this._animationMode=a,this._hideToggle=!1,this.afterExpand=new ln,this.afterCollapse=new ln,this._inputChanges=new oe,this._headerId="mat-expansion-panel-header-"+QAe++,this._bodyAnimationDone=new oe,this.accordion=t,this._document=o,this._bodyAnimationDone.pipe(ld((c,u)=>c.fromState===u.fromState&&c.toState===u.toState)).subscribe(c=>{"void"!==c.fromState&&("expanded"===c.toState?this.afterExpand.emit():"collapsed"===c.toState&&this.afterCollapse.emit())}),l&&(this.hideToggle=l.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=bi(t)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this.opened.pipe(Oo(null),Ki(()=>this.expanded&&!this._portal),qr(1)).subscribe(()=>{this._portal=new Pm(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,i=this._body.nativeElement;return t===i||i.contains(t)}return!1}}return n.\u0275fac=function(t){return new(t||n)(Ce(WN,12),Ce(Mr),Ce(A$),Ce(Rs),Ce(fn),Ce(Qa,8),Ce(jW,8))},n.\u0275cmp=rn({type:n,selectors:[["mat-expansion-panel"]],contentQueries:function(t,i,r){if(1&t&&function(n,e,t,i){const r=Si();if(r.firstCreatePass){const s=as();I3(r,new A3(e,t,i),s.index),function(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}D3(r,Vt(),t)}(r,KAe,5),2&t){let s;Gn(s=$n())&&(i._lazyContent=s.first)}},viewQuery:function(t,i){if(1&t&&hr(HAe,5),2&t){let r;Gn(r=$n())&&(i._body=r.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(t,i){2&t&&ai("mat-expanded",i.expanded)("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-expansion-panel-spacing",i._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[Vn([{provide:WN,useValue:void 0}]),En,Fi],ngContentSelectors:WAe,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(t,i){1&t&&(Hr($Ae),oi(0),wt(1,"div",0,1),Tn("@bodyExpansion.done",function(s){return i._bodyAnimationDone.next(s)}),wt(3,"div",2),oi(4,1),wi(5,GAe,0,0,"ng-template",3),Et(),oi(6,2),Et()),2&t&&(zt(1),Jt("@bodyExpansion",i._getExpandedState())("id",i.id),Ii("aria-labelledby",i._headerId),zt(4),Jt("cdkPortalOutlet",i._portal))},directives:[np],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[VW.bodyExpansion]},changeDetection:0}),n})();class JAe{}const eMe=wC(JAe);let zW=(()=>{class n extends eMe{constructor(t,i,r,s,o,a,l){super(),this.panel=t,this._element=i,this._focusMonitor=r,this._changeDetectorRef=s,this._animationMode=a,this._parentChangeSubscription=C.EMPTY;const c=t.accordion?t.accordion._stateChanges.pipe(Ki(u=>!(!u.hideToggle&&!u.togglePosition))):Qc;this.tabIndex=parseInt(l||"")||0,this._parentChangeSubscription=Nn(t.opened,t.closed,c,t._inputChanges.pipe(Ki(u=>!!(u.hideToggle||u.disabled||u.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(Ki(()=>t._containsFocus())).subscribe(()=>r.focusVia(i,"program")),o&&(this.expandedHeight=o.expandedHeight,this.collapsedHeight=o.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:Dl(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t,i){t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return n.\u0275fac=function(t){return new(t||n)(Ce(UW,1),Ce(gn),Ce(vc),Ce(Mr),Ce(jW,8),Ce(Qa,8),yo("tabindex"))},n.\u0275cmp=rn({type:n,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(t,i){1&t&&Tn("click",function(){return i._toggle()})("keydown",function(s){return i._keydown(s)}),2&t&&(Ii("id",i.panel._headerId)("tabindex",i.tabIndex)("aria-controls",i._getPanelId())("aria-expanded",i._isExpanded())("aria-disabled",i.panel.disabled),zy("height",i._getHeaderHeight()),ai("mat-expanded",i._isExpanded())("mat-expansion-toggle-indicator-after","after"===i._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===i._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===i._animationMode))},inputs:{tabIndex:"tabIndex",expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},features:[En],ngContentSelectors:XAe,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(t,i){1&t&&(Hr(YAe),wt(0,"span",0),oi(1),oi(2,1),oi(3,2),Et(),wi(4,qAe,1,1,"span",1)),2&t&&(zt(4),Jt("ngIf",i._showToggle()))},directives:[ac],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-keyboard-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-program-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:hover:not([aria-disabled=true])::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;border:3px solid;border-radius:4px;content:""}\n'],encapsulation:2,data:{animation:[VW.indicatorRotate]},changeDetection:0}),n})();var HW=et(5478);Object.create(Error.prototype);const sMe=["*"];var LC=(()=>(function(n){n.LineHighlight="line-highlight",n.LineNumbers="line-numbers"}(LC||(LC={})),LC))();class aMe{}const $W=new Ht("SECURITY_CONTEXT");let qN=(()=>{class n{constructor(t,i,r,s,o){this.platform=t,this.securityContext=i,this.http=r,this.sanitizer=o,this.initialMarkedOptions={renderer:new HW.Renderer},this.options=s}get options(){return this._options}set options(t){this._options=Object.assign(Object.assign({},this.initialMarkedOptions),t)}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}compile(t,i=!1,r=!1,s=this.options){const o=this.trimIndentation(t),a=i?this.decodeHtml(o):o,l=r?this.renderEmoji(a):a,c=HW.parse(l,s);return this.sanitizer.sanitize(this.securityContext,c)||""}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe(me(i=>this.handleExtension(t,i)))}highlight(t){if(Af(this.platform)&&"undefined"!=typeof Prism){t||(t=document);const i=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(i,r=>r.classList.add("language-none")),Prism.highlightAllUnder(t)}}renderKatex(t,i){if(!Af(this.platform))return t;if("undefined"==typeof katex||void 0===katex.renderToString)throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");return t.replace(/\$([^\s][^$]*?[^\s])\$/gm,(r,s)=>katex.renderToString(s,i))}decodeHtml(t){if(!Af(this.platform))return t;const i=document.createElement("textarea");return i.innerHTML=t,i.value}handleExtension(t,i){const r=t?t.split("?")[0].split(".").splice(-1).join():"";return"md"!==r?"```"+r+"\n"+i+"\n```":i}renderEmoji(t){if(!Af(this.platform))return t;if("undefined"==typeof joypixels||void 0===joypixels.shortnameToUnicode)throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}trimIndentation(t){if(!t)return"";let i;return t.split("\n").map(r=>{let s=i;return r.length>0&&(s=isNaN(s)?r.search(/\S|$/):Math.min(r.search(/\S|$/),s)),isNaN(i)&&(i=s),s?r.substring(s):r}).join("\n")}}return n.\u0275fac=function(t){return new(t||n)(Ie(Xc),Ie($W),Ie(_u,8),Ie(aMe,8),Ie(Mf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),WW=(()=>{class n{constructor(t,i){this.element=t,this.markdownService=i,this.error=new ln,this.load=new ln,this.ready=new ln,this._emoji=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}ngOnChanges(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion()}render(t,i=!1){let r=this.markdownService.compile(t,i,this.emoji);r=this.katex?this.markdownService.renderKatex(r,this.katexOptions):r,this.element.nativeElement.innerHTML=r,this.handlePlugins(),this.markdownService.highlight(this.element.nativeElement),this.ready.emit()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe(t=>{this.render(t),this.load.emit(t)},t=>this.error.emit(t))}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,LC.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++){const o=i instanceof Array?i:[i];r.item(s).classList.add(...o)}}setPluginOptions(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++)Object.keys(i).forEach(o=>{const a=i[o];if(a){const l=this.toLispCase(o);r.item(s).setAttribute(l,a.toString())}})}toLispCase(t){const i=t.match(/([A-Z])/g);if(!i)return t;let r=t.toString();for(let s=0,o=i.length;s<o;s++)r=r.replace(new RegExp(i[s]),"-"+i[s].toLowerCase());return"-"===r.slice(0,1)&&(r=r.slice(1)),r}}return n.\u0275fac=function(t){return new(t||n)(Ce(gn),Ce(qN))},n.\u0275cmp=rn({type:n,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start"},outputs:{error:"error",load:"load",ready:"ready"},features:[Fi],ngContentSelectors:sMe,decls:1,vars:0,template:function(t,i){1&t&&(Hr(),oi(0))},encapsulation:2}),n})();function qW(n,e,t){return t?qW(n,e).pipe(me(i=>k(i)?t(...i):t(i))):new O(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o);let s;try{s=n(r)}catch(o){return void i.error(o)}if(Y(e))return()=>e(r,s)})}function YN(...n){return e=>{let t;return"function"==typeof n[n.length-1]&&(t=n.pop()),e.lift(new pMe(n,t))}}class pMe{constructor(e,t){this.observables=e,this.project=t}call(e,t){return t.subscribe(new gMe(e,this.observables,this.project))}}class gMe extends t5{constructor(e,t,i){super(e),this.observables=t,this.project=i,this.toRespond=[];const r=t.length;this.values=new Array(r);for(let s=0;s<r;s++)this.toRespond.push(s);for(let s=0;s<r;s++)this.add(n5(this,t[s],void 0,s))}notifyNext(e,t,i){this.values[i]=t;const r=this.toRespond;if(r.length>0){const s=r.indexOf(i);-1!==s&&r.splice(s,1)}}notifyComplete(){}_next(e){if(0===this.toRespond.length){const t=[e,...this.values];this.project?this._tryProject(t):this.destination.next(t)}}_tryProject(e){let t;try{t=this.project.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}class mMe{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new _Me(e,this.accumulator,this.seed,this.hasSeed))}}class _Me extends y{constructor(e,t,i,r){super(e),this.accumulator=t,this._seed=i,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(r){this.destination.error(r)}this.seed=i,this.destination.next(i)}}class vMe{constructor(e){this.predicate=e}call(e,t){return t.subscribe(new wMe(e,this.predicate))}}class wMe extends y{constructor(e,t){super(e),this.predicate=t,this.skipping=!0,this.index=0}_next(e){const t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)}tryCallPredicate(e){try{const t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(t){this.destination.error(t)}}}const EMe=["youtubeContainer"];let KW=(()=>{class n{constructor(t,i){this._ngZone=t,this._youtubeContainer=new oe,this._destroyed=new oe,this._playerChanges=new Fr(void 0),this._videoId=new Fr(void 0),this._height=new Fr(390),this._width=new Fr(640),this._startSeconds=new Fr(void 0),this._endSeconds=new Fr(void 0),this._suggestedQuality=new Fr(void 0),this._playerVars=new Fr(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=Af(i)}get videoId(){return this._videoId.value}set videoId(t){this._videoId.next(t)}get height(){return this._height.value}set height(t){this._height.next(t||390)}get width(){return this._width.value}set width(t){this._width.next(t||640)}set startSeconds(t){this._startSeconds.next(t)}set endSeconds(t){this._endSeconds.next(t)}set suggestedQuality(t){this._suggestedQuality.next(t)}get playerVars(){return this._playerVars.value}set playerVars(t){this._playerVars.next(t)}ngOnInit(){if(!this._isBrowser)return;let t=sn(!0);if(!window.YT||!window.YT.Player){const r=new oe;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},t=r.pipe(qr(1),Oo(!1))}const i=function(n,e,t,i,r,s,o){const a=yc([e,s]).pipe(YN(yc([i,r])),me(([l,c])=>{const[u,h]=l,[f,g]=c;return u?{videoId:u,playerVars:h,width:f,height:g}:void 0}));return yc([n,a,sn(o)]).pipe(function(n){return ue(function(...n){let e=null;return"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&k(n[0])&&(n=n[0].slice()),t=>t.lift.call(je([t,...n]),new r5(e))}(n),function(n){return e=>e.lift(new vMe(n))}(([e,t])=>!t),me(([e])=>e))}(t),function(n,e){let t=!1;return arguments.length>=2&&(t=!0),function(r){return r.lift(new mMe(n,e,t))}}(MMe,void 0),ld())}(this._youtubeContainer,this._videoId,t,this._width,this._height,this._playerVars,this._ngZone).pipe(cr(r=>{this._playerChanges.next(r)}),V(e=>e?QW(e)?sn(e):new O(t=>{let i=!1,r=!1;const s=o=>{r=!0,i||(o.target.removeEventListener("onReady",s),t.next(o.target))};return e.addEventListener("onReady",s),()=>{i=!0,r||(r=>{QW(r)||r.destroy()})(e)}}).pipe(qr(1),Oo(void 0)):sn(void 0)),gr(this._destroyed),xa(new oe));i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function(n,e,t){yc([n,e,t]).subscribe(([i,r,s])=>i&&i.setSize(r,s))}(i,this._width,this._height),function(n,e){yc([n,e]).subscribe(([t,i])=>t&&i&&t.setPlaybackQuality(i))}(i,this._suggestedQuality),function(n,e,t,i,r,s){const o=yc([t,i]).pipe(me(([u,h])=>({startSeconds:u,endSeconds:h}))),a=o.pipe(KN(n,u=>!!u&&!function(n){const e=n.getPlayerState();return e!==YT.PlayerState.UNSTARTED&&e!==YT.PlayerState.CUED}(u))),l=e.pipe(KN(n,(u,h)=>!!u&&u.videoId!==h));Nn(n.pipe(KN(yc([e,o]),([u,h],f)=>!(!f||u==f.videoId&&!h.startSeconds&&!h.endSeconds))),l,a).pipe(YN(yc([n,e,o,r])),me(([u,h])=>h),gr(s)).subscribe(([u,h,f,g])=>{!h||!u||(u.videoId=h,u.cueVideoById(Object.assign({videoId:h,suggestedQuality:g},f)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}createEventsBoundInZone(){return{}}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(t,i){this._player?this._player.seekTo(t,i):this._getPendingState().seek={seconds:t,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(t){this._player?this._player.setVolume(t):this._getPendingState().volume=t}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(t){if(this._player)return this._player.setPlaybackRate(t);this._getPendingState().playbackRate=t}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(t,i){const{playbackState:r,playbackRate:s,volume:o,muted:a,seek:l}=i;switch(r){case YT.PlayerState.PLAYING:t.playVideo();break;case YT.PlayerState.PAUSED:t.pauseVideo();break;case YT.PlayerState.CUED:t.stopVideo()}null!=s&&t.setPlaybackRate(s),null!=o&&t.setVolume(o),null!=a&&(a?t.mute():t.unMute()),null!=l&&t.seekTo(l.seconds,l.allowSeekAhead)}_getLazyEmitter(t){return this._playerChanges.pipe(is(i=>i?qW(r=>{i.addEventListener(t,r)},r=>{try{i.removeEventListener&&i.removeEventListener(t,r)}catch(s){}}):sn()),i=>new O(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),gr(this._destroyed))}}return n.\u0275fac=function(t){return new(t||n)(Ce(pn),Ce(Xc))},n.\u0275cmp=rn({type:n,selectors:[["youtube-player"]],viewQuery:function(t,i){if(1&t&&hr(EMe,5),2&t){let r;Gn(r=$n())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(t,i){1&t&&ni(0,"div",null,0)},encapsulation:2,changeDetection:0}),n})();function MMe(n,[e,t,i]){if(n&&t&&n.playerVars!==t.playerVars)n.destroy();else{if(!t)return void(n&&n.destroy());if(n)return n}const r=i.runOutsideAngular(()=>new YT.Player(e,t));return r.videoId=t.videoId,r.playerVars=t.playerVars,r}function QW(n){return"getPlayerStatus"in n}function KN(n,e){return ue(YN(n),Ki(([t,i])=>e(i,t)),me(([t])=>t))}let BMe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Nt({type:n,selectors:[["","mat-card-sm-image",""],["","matCardImageSmall",""]],hostAttrs:[1,"mat-card-sm-image"]}),n})();function Fb(n){return!0===n}function Za(n){return null==n}function Ja(n){return!Za(n)}function QN(n){return Boolean(n)}function t7(n){return Za(n)?n:JSON.parse(JSON.stringify(n))}const VC=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&VC(n[o])}),n};function n7(n){return Ja(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const s7="NGXS_DATA_META",JN="NGXS_META",o7="NGXS_ARGUMENT_REGISTRY_META";let a7=(()=>{class n{constructor(t){this.sequence$=new Fr(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Ie(hu,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function Lb(n){return n[s7]}let el=(()=>{class n{constructor(t,i,r){n.store=t.get(hu),n.ngZone=t.get(pn),n.factory=i,n.context=r,n.computed=t.get(a7)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Ie(Hn),Ie(o5),Ie(s5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class hs{constructor(){hs.statesCachedMeta.clear()}static createStateContext(e){return el.context.createStateContext(e)}static ensureMappedState(e){if(Za(el.factory)||Za(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Ja(e.name)?hs.statesCachedMeta.get(e.name):null)||hs.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=Lb(hs.getStateClassByInstance(e)))&&void 0!==t?t:null;if(Za(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=hs.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);Ja(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=hs.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=Ja(e.name)?null===(t=el.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return Ja(i)&&Ja(e.name)&&hs.statesCachedMeta.set(e.name,i),i}}hs.statesCachedMeta=new Map,hs.\u0275fac=function(e){return new(e||hs)},hs.\u0275prov=We({token:hs,factory:hs.\u0275fac}),new Df(1);class sDe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Ja(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function l7(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function c7(n){var e;const t=l7(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=t7(void 0===t.defaults?{}:t.defaults);if(i.length){if(n7(s))return function(n,e){return e.reduce((t,i)=>{const r=l7(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=c7(i),t},null!=n?n:{})}(s,i);throw new sDe(s)}return s}function d7(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function h7(){var n,e;return null!==(e=null===(n=null==el?void 0:el.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function cDe(n){let e=!1;return Im(n)&&(e=!0),e}function ek(n){return n[o7]}class uDe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class dDe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(QN(this.argumentMap.has(e))||QN(this.payloadMap.has(e)))throw new uDe(e,t)}}function _De(n){return{enumerable:!0,configurable:!0,get(){const e=Lb(n),t=hs.ensureMappedState(e.stateMeta);return hs.createStateContext(t)}}}function f7(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(n7(i))for(;null!==i;){if(Fb(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return Za(d7(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),d7(n)}(this),o=null==s?void 0:s.get(i);if(Fb(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(Za(o)||o.sequenceId!==h7()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:h7(),isObservable:cDe(l)}),l}return o.value},t}}const xDe={cancelUncompleted:!0,insideZone:!1};function tk(n=xDe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=hs.getRepositoryByInstance(a),u=c.operations;let h=u[s];const f=c.stateMeta,g=ek(r);if(Za(h)){const D=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),ie=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)Ja(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):Ja(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:f.path,methodName:s,argumentsNames:D,argumentRegistry:g});h=u[s]={type:ie,options:{cancelUncompleted:n.cancelUncompleted}},f.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}hs.ensureMappedState(f).instance[h.type]=()=>{var D;return Fb(n.insideZone)?null===(D=el.ngZone)||void 0===D||D.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),Im(l)?sn(null).pipe(me(()=>l)):l};const x=hs.createAction(h,o,g),U=el.store.dispatch(x);return Im(l)?function(n,e){return fb([n,e]).pipe(me(t=>t.pop()))}(U,l):l},i}}function p7(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return Za(ek(t))&&Object.defineProperties(t,{[o7]:{enumerable:!0,configurable:!0,value:new dDe}}),ek(t)})(e,t).createPayloadType(r,t,i)}}function CDe(){return n=>{const e=function(n){if(function(n){return!QN(n)}(n.hasOwnProperty(JN))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,JN,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[JN]}(n)}(n);if(Za(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=Lb(n))&&void 0!==e?e:null;return(Za(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,s7,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),Lb(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>t7(t)},context:_De(n)})}(n,e,c7(n)),function(n){var e,t;const i=Lb(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(Ja(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Ja(this[s]))return this[s];if(Za(el.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=el.store.select(n).pipe(me(o=>fa()?VC(o):o),Wa({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let ADe=(()=>{class n{constructor(){this.browserStorageEvents$=new oe,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),MDe=(()=>{class n extends ADe{get snapshot(){return function(n){return fa()?VC(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>fa()?VC(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Ei([f7(),uc("design:type",Object),uc("design:paramtypes",[])],n.prototype,"snapshot",null),Ei([tk(),wV(0,p7("patchValue")),uc("design:type",Function),uc("design:paramtypes",[Object]),uc("design:returntype",void 0)],n.prototype,"patchState",null),Ei([tk(),wV(0,p7("stateValue")),uc("design:type",Function),uc("design:paramtypes",[Object]),uc("design:returntype",void 0)],n.prototype,"setState",null),Ei([tk(),uc("design:type",Function),uc("design:paramtypes",[]),uc("design:returntype",void 0)],n.prototype,"reset",null),n})(),g9=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Nt({type:n,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),n})();const zm=new Ht("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),Sk=new Ht("ngx-window",{providedIn:"root",factory:()=>function(n){return Af(n)?window:null}(Bc(Xc))}),jOe=new Ht("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Bc(Sk))}),Ck=new Ht("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Bc(Sk),Bc(jOe))});let qb=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){(this.settings.enableTracing||fa())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o){try{const a=new Map;i&&a.set("event_category",i),r&&a.set("event_label",r),s&&a.set("value",s),void 0!==o&&a.set("interaction",o);const l=this.toKeyValue(a);l?this.gtag("event",t,l):this.gtag("event",t)}catch(a){this.throw(a)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,l])=>o.set(a,l)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(zm),Ie(fn),Ie(Ck))},n.\u0275prov=We({factory:function(){return new n(Ie(zm),Ie(fn),Ie(Ck))},token:n,providedIn:"root"}),n})(),m9=(()=>{class n{constructor(t,i,r,s){this.gaCategoryDirective=t,this.gaService=i,this.settings=r,this.el=s,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=gd(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){(fa()||this.settings.enableTracing)&&console&&console.warn&&console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)(Ce(g9,8),Ce(qb),Ce(zm),Ce(gn))},n.\u0275dir=Nt({type:n,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),n})();const zOe={provide:Ef,multi:!0,useFactory:function(n,e,t){return()=>Bi(this,void 0,void 0,function*(){var i;if(!n.trackingCode)return void(fa()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!e)return void(fa()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));t||fa()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),n.uri=n.uri||`https://www.googletagmanager.com/gtag/js?id=${n.trackingCode}`,n.initCommands=null!==(i=null==n?void 0:n.initCommands)&&void 0!==i?i:[],n.initCommands.find(o=>"config"===o.command)||n.initCommands.unshift({command:"config",values:[n.trackingCode]}),n.initCommands.find(o=>"js"===o.command)||n.initCommands.unshift({command:"js",values:[new Date]});for(const o of n.initCommands)e(o.command,...o.values);const r=t.createElement("script");r.async=!0,r.src=n.uri,n.nonce&&r.setAttribute("nonce",n.nonce),t.getElementsByTagName("head")[0].appendChild(r)})},deps:[zm,Ck,fn]};new Ht("ngx-google-analytics-routing-settings",{factory:()=>({})});let r1=(()=>{class n{static forRoot(t,i=[],r,s,o){return{ngModule:n,providers:[{provide:zm,useValue:{trackingCode:t,initCommands:i,uri:r,enableTracing:s,nonce:o}},zOe]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[]]}),n})(),o1=(()=>{class n{constructor(){this.consent="not-set",this.consentChange=new Df(1),this.consentChange.next(this.consent)}ngOnDestroy(){this.consentChange.complete()}setConsent(t){this.consent!==t&&(this.consent=t,this.consentChange.next(t))}unsetConsent(){this.setConsent("not-set")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),tRe=(()=>{class n{constructor(t,i,{trackingCode:r}){this.window=i,this.subscriptions=new C,this.token=r,this.subscriptions.add(t.consentChange.subscribe(s=>this.toggleGoogleAnalytics("rescinded"===s)))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleGoogleAnalytics(t){this.window&&(this.window[`ga-disable-${this.token}`]=t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(o1),Ie(Sk),Ie(zm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const nRe=new Ht("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"}),S9=[o1,tRe,(()=>{class n{constructor(t,i){this.key=i,this.subscriptions=new C;try{this.storage=localStorage}catch(r){}t.setConsent(this.loadConsent()),this.subscriptions.add(t.consentChange.subscribe(r=>this.saveConsent(r)))}ngOnDestroy(){this.subscriptions.unsubscribe()}loadConsent(){var t,i;const r=null===(i=null===(t=this.storage)||void 0===t?void 0:t.getItem)||void 0===i?void 0:i.call(t,this.key);if(null==r)return"not-set";const s=r.trim().toLowerCase();switch(s){case"given":case"rescinded":return s;default:return"not-set"}}saveConsent(t){var i,r;null===(r=null===(i=this.storage)||void 0===i?void 0:i.setItem)||void 0===r||r.call(i,this.key,t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(o1),Ie(nRe))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})()];function rRe(n){return Object.entries(n).reduce((e,[t,i])=>(null!=i&&(e[t]=`${i}`),e),{})}let oRe=(()=>{class n{static forRoot(t){const{providers:i=[]}=r1.forRoot(t.gaToken,function(n){const{appName:e,projectName:t,developmentMode:i}=n;return[{command:"set",values:[rRe({appName:e,projectName:t,developmentMode:i})]}]}(t));return{ngModule:n,providers:i}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[...S9,{provide:Ef,multi:!0,useFactory:()=>()=>{},deps:S9}],imports:[[r1]]}),n})();const uRe=(n,e)=>JSON.stringify(n)===JSON.stringify(e),dRe=n=>n.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),xc={storageStrategy:class extends class{}{constructor(){super(...arguments),this.cachePairs=[]}add(e,t,i){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,t){Object.assign(this.cachePairs[e],t)}update(e,t){Object.assign(this.cachePairs[e],t)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},hRe=new oe;function Sc(n={}){return function(e,t,i){const r=n.cacheKey||e.constructor.name+"#"+t,s=i.value;if(i&&i.value){let o=n.storageStrategy?new n.storageStrategy:new xc.storageStrategy;const a=[];n.cacheModifier&&n.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(r,this)),r,this)),Nn(hRe.asObservable(),n.cacheBusterObserver?n.cacheBusterObserver:b0()).subscribe(u=>{o.removeAll(r,this),a.length=0}),n.cacheResolver=n.cacheResolver||xc.cacheResolver||uRe,n.cacheHasher=n.cacheHasher||xc.cacheHasher||dRe,i.value=function(...u){const h=o.getAll(r,this);let f=n.cacheHasher(u),g=h.find(v=>n.cacheResolver(v.parameters,f));const m=a.find(v=>n.cacheResolver(v.parameters,f));if((n.maxAge||xc.maxAge)&&g&&g.created&&((new Date).getTime()-new Date(g.created).getTime()>(n.maxAge||xc.maxAge)?(o.remove?o.remove(h.indexOf(g),g,r,this):o.removeAtIndex(h.indexOf(g),r,this),g=null):(n.slidingExpiration||xc.slidingExpiration)&&(g.created=new Date,o.update?o.update(h.indexOf(g),g,r,this):o.updateAtIndex(h.indexOf(g),g,r,this))),g){const v=sn(g.response);return n.async?v.pipe(function(n,e=qS){const i=function(n){return n instanceof Date&&!isNaN(+n)}(n)?+n-e.now():Math.abs(n);return r=>r.lift(new rTe(i,e))}(0)):v}if(m)return m.response;{const v=s.call(this,...u).pipe(NN(()=>{const x=a.find(U=>n.cacheResolver(U.parameters,f));a.splice(a.indexOf(x),1)}),cr(x=>{(!n.shouldCacheDecider||n.shouldCacheDecider(x))&&((!(n.maxCacheCount||xc.maxCacheCount)||1===(n.maxCacheCount||xc.maxCacheCount)||(n.maxCacheCount||xc.maxCacheCount)&&(n.maxCacheCount||xc.maxCacheCount)<h.length+1)&&(o.remove?o.remove(0,h[0],r,this):o.removeAtIndex(0,r,this)),o.add({parameters:f,response:x,created:n.maxAge||xc.maxAge?new Date:null},r,this))}),function(n,e,t,i){const s=new Df(1,void 0,i);return o=>xa(()=>s,undefined)(o)}(),Yn());return a.push({parameters:f,response:v,created:new Date}),v}}}return i}}class fRe{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const C9=new Ht("basePath");class Yb{constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}selectHeaderAccept(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const t=this.credentials[e];return"function"==typeof t?t():t}}let T9=(()=>{class n{constructor(t,i,r){this.httpClient=t,this.basePath="/v1",this.defaultHeaders=new mu,this.configuration=new Yb,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof i&&(i=this.basePath),this.configuration.basePath=i),this.encoder=this.configuration.encoder||new fRe}addToHttpParams(t,i,r){return this.addToHttpParamsRecursive(t,i,r)}addToHttpParamsRecursive(t,i,r){if(null==i)return t;if("object"==typeof i)if(Array.isArray(i))i.forEach(s=>t=this.addToHttpParamsRecursive(t,s,r));else if(i instanceof Date){if(null==r)throw Error("key may not be null if value is Date");t=t.append(r,i.toISOString().substr(0,10))}else Object.keys(i).forEach(s=>t=this.addToHttpParamsRecursive(t,i[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");t=t.append(r,i)}return t}aggregateResults(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,v=t.spatial,x=t.technologies,U=t.token;let D=new Lr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),v&&v.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),x&&x.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Pe=s&&s.context;void 0===Pe&&(Pe=new Zs);let Ne="json";return _e&&(Ne=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/aggregate-results`,{context:Pe,params:D,responseType:Ne,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}cellTypeTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,v=t.spatial,x=t.technologies,U=t.token;let D=new Lr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),v&&v.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),x&&x.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Pe=s&&s.context;void 0===Pe&&(Pe=new Zs);let Ne="json";return _e&&(Ne=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-term-occurences`,{context:Pe,params:D,responseType:Ne,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}cellTypeTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Zs);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-tree-model`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}dbStatus(t,i="body",r=!1,s){const o=t.token;let a=new Lr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Zs);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/db-status`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}getSpatialPlacement(t,i="body",r=!1,s){const o=t.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let c=s&&s.context;void 0===c&&(c=new Zs);const h=this.configuration.selectHeaderContentType(["application/json"]);void 0!==h&&(a=a.set("Content-Type",h));let f="json";return l&&(f=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/get-spatial-placement`,o,{context:c,responseType:f,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}gtexRuiLocations(t,i="body",r=!1,s){const o=t.cache;let a=new Lr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Zs);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}hubmapRuiLocations(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Zs);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/hubmap/rui_locations.jsonld`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}ontologyTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,v=t.spatial,x=t.technologies,U=t.token;let D=new Lr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),v&&v.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),x&&x.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Pe=s&&s.context;void 0===Pe&&(Pe=new Zs);let Ne="json";return _e&&(Ne=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-term-occurences`,{context:Pe,params:D,responseType:Ne,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}ontologyTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Zs);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-tree-model`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}providerNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Zs);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/provider-names`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}referenceOrganScene(t,i="body",r=!1,s){const o=t.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=t.age,l=t.ageRange,c=t.bmi,u=t.bmiRange,h=t.cache,f=t.ontologyTerms,g=t.cellTypeTerms,m=t.providers,v=t.sex,x=t.spatial,U=t.technologies,D=t.token;let ie=new Lr({encoder:this.encoder});null!=a&&(ie=this.addToHttpParams(ie,a,"age")),null!=l&&(ie=this.addToHttpParams(ie,l,"age-range")),null!=c&&(ie=this.addToHttpParams(ie,c,"bmi")),null!=u&&(ie=this.addToHttpParams(ie,u,"bmi-range")),null!=h&&(ie=this.addToHttpParams(ie,h,"cache")),f&&f.forEach(bt=>{ie=this.addToHttpParams(ie,bt,"ontology-terms")}),g&&g.forEach(bt=>{ie=this.addToHttpParams(ie,bt,"cell-type-terms")}),null!=o&&(ie=this.addToHttpParams(ie,o,"organ-iri")),m&&m.forEach(bt=>{ie=this.addToHttpParams(ie,bt,"providers")}),null!=v&&(ie=this.addToHttpParams(ie,v,"sex")),x&&x.forEach(bt=>{ie=this.addToHttpParams(ie,bt,"spatial")}),U&&U.forEach(bt=>{ie=this.addToHttpParams(ie,bt,"technologies")}),null!=D&&(ie=this.addToHttpParams(ie,D,"token"));let _e=this.defaultHeaders,Pe=s&&s.httpHeaderAccept;void 0===Pe&&(Pe=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Pe&&(_e=_e.set("Accept",Pe));let Ne=s&&s.context;void 0===Ne&&(Ne=new Zs);let Ve="json";return Pe&&(Ve=Pe.startsWith("text")?"text":this.configuration.isJsonMime(Pe)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organ-scene`,{context:Ne,params:ie,responseType:Ve,withCredentials:this.configuration.withCredentials,headers:_e,observe:i,reportProgress:r})}referenceOrgans(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Zs);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organs`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}scene(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,v=t.spatial,x=t.technologies,U=t.token;let D=new Lr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),v&&v.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),x&&x.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Pe=s&&s.context;void 0===Pe&&(Pe=new Zs);let Ne="json";return _e&&(Ne=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/scene`,{context:Pe,params:D,responseType:Ne,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}sparql(t,i="body",r=!1,s){const o=t.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=t.token,l=t.format;let c=new Lr({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"query")),null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let f=s&&s.context;void 0===f&&(f=new Zs);let g="json";return h&&(g=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/sparql`,{context:f,params:c,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}sparqlPost(t,i="body",r=!1,s){const o=t.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=t.token,l=t.format;let c=new Lr({encoder:this.encoder});null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let f=s&&s.context;void 0===f&&(f=new Zs);const m=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==m&&(u=u.set("Content-Type",m));let v="json";return h&&(v=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/sparql`,o,{context:f,params:c,responseType:v,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}technologyNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Lr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Zs);let f="json";return u&&(f=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/technology-names`,{context:h,params:l,responseType:f,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}tissueBlocks(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,f=t.cellTypeTerms,g=t.providers,m=t.sex,v=t.spatial,x=t.technologies,U=t.token;let D=new Lr({encoder:this.encoder});null!=o&&(D=this.addToHttpParams(D,o,"age")),null!=a&&(D=this.addToHttpParams(D,a,"age-range")),null!=l&&(D=this.addToHttpParams(D,l,"bmi")),null!=c&&(D=this.addToHttpParams(D,c,"bmi-range")),null!=u&&(D=this.addToHttpParams(D,u,"cache")),h&&h.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"ontology-terms")}),f&&f.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"cell-type-terms")}),g&&g.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"providers")}),null!=m&&(D=this.addToHttpParams(D,m,"sex")),v&&v.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"spatial")}),x&&x.forEach(Ve=>{D=this.addToHttpParams(D,Ve,"technologies")}),null!=U&&(D=this.addToHttpParams(D,U,"token"));let ie=this.defaultHeaders,_e=s&&s.httpHeaderAccept;void 0===_e&&(_e=this.configuration.selectHeaderAccept(["application/json"])),void 0!==_e&&(ie=ie.set("Accept",_e));let Pe=s&&s.context;void 0===Pe&&(Pe=new Zs);let Ne="json";return _e&&(Ne=_e.startsWith("text")?"text":this.configuration.isJsonMime(_e)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/tissue-blocks`,{context:Pe,params:D,responseType:Ne,withCredentials:this.configuration.withCredentials,headers:ie,observe:i,reportProgress:r})}}return n.\u0275fac=function(t){return new(t||n)(Ie(_u),Ie(C9,8),Ie(Yb,8))},n.\u0275prov=We({factory:function(){return new n(Ie(_u),Ie(C9,8),Ie(Yb,8))},token:n,providedIn:"root"}),n})(),pRe=(()=>{class n{constructor(t,i){if(t)throw new Error("CcfApiModule is already loaded. Import in your base AppModule only.");if(!i)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static forRoot(t){return{ngModule:n,providers:[{provide:Yb,useFactory:t}]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(_u,8))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[],imports:[[]]}),n})();function vu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let Ak;function Cc(){return Ak||(Ak=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),vu(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),Ak}function A9(n,e=Cc()){return e("readonly",t=>vu(t.get(n)))}var Un=et(1440);const a1="Unknown Euler angle order",Hm=.99999;class Zi extends mx{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return Zi.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(e){return Zi.RotationOrders[e]}get ELEMENTS(){return 4}constructor(e=0,t=0,i=0,r=Zi.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,t,i,r)}fromQuaternion(e){const[t,i,r,s]=e,o=i*i,a=-2*(o+r*r)+1,l=2*(t*i+s*r);let c=-2*(t*r-s*i);c=c>1?1:c,c=c<-1?-1:c;const f=Math.atan2(2*(i*r+s*t),-2*(t*t+o)+1),g=Math.asin(c),m=Math.atan2(l,a);return new Zi(f,g,m,Zi.RollPitchYaw)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,t=0,i=0,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return function(n){return n>=0&&n<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}toArray4(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=nr(e)}get y(){return this[1]}set y(e){this[1]=nr(e)}get z(){return this[2]}set z(e){this[2]=nr(e)}get alpha(){return this[0]}set alpha(e){this[0]=nr(e)}get beta(){return this[1]}set beta(e){this[1]=nr(e)}get gamma(){return this[2]}set gamma(e){this[2]=nr(e)}get phi(){return this[0]}set phi(e){this[0]=nr(e)}get theta(){return this[1]}set theta(e){this[1]=nr(e)}get psi(){return this[2]}set psi(e){this[2]=nr(e)}get roll(){return this[0]}set roll(e){this[0]=nr(e)}get pitch(){return this[1]}set pitch(e){this[1]=nr(e)}get yaw(){return this[2]}set yaw(e){this[2]=nr(e)}get order(){return this[3]}set order(e){this[3]=function(n){if(n<0&&n>=6)throw new Error(a1);return n}(e)}fromVector3(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}fromArray(e,t=0){return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,t,i){return this.set(e,t,i,Zi.ZYX)}fromRotationMatrix(e,t=Zi.DefaultOrder){return this._fromRotationMatrix(e,t),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new mR;switch(this[4]){case Zi.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Zi.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Zi.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Zi.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Zi.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Zi.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(a1)}}_fromRotationMatrix(e,t=Zi.DefaultOrder){const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],f=i[10];switch(t=t||this[3]){case Zi.XYZ:this[1]=Math.asin(Ua(o,-1,1)),Math.abs(o)<Hm?(this[0]=Math.atan2(-c,f),this[2]=Math.atan2(-s,r)):(this[0]=Math.atan2(h,l),this[2]=0);break;case Zi.YXZ:this[0]=Math.asin(-Ua(c,-1,1)),Math.abs(c)<Hm?(this[1]=Math.atan2(o,f),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-u,r),this[2]=0);break;case Zi.ZXY:this[0]=Math.asin(Ua(h,-1,1)),Math.abs(h)<Hm?(this[1]=Math.atan2(-u,f),this[2]=Math.atan2(-s,l)):(this[1]=0,this[2]=Math.atan2(a,r));break;case Zi.ZYX:this[1]=Math.asin(-Ua(u,-1,1)),Math.abs(u)<Hm?(this[0]=Math.atan2(h,f),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-s,l));break;case Zi.YZX:this[2]=Math.asin(Ua(a,-1,1)),Math.abs(a)<Hm?(this[0]=Math.atan2(-c,l),this[1]=Math.atan2(-u,r)):(this[0]=0,this[1]=Math.atan2(o,f));break;case Zi.XZY:this[2]=Math.asin(-Ua(s,-1,1)),Math.abs(s)<Hm?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-c,f),this[1]=0);break;default:throw new Error(a1)}return this[3]=t,this}_getRotationMatrix(e){const t=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=this.x,r=this.y,s=this.z,o=Math.cos(i),a=Math.cos(r),l=Math.cos(s),c=Math.sin(i),u=Math.sin(r),h=Math.sin(s);switch(this[3]){case Zi.XYZ:{const f=o*l,g=o*h,m=c*l,v=c*h;t[0]=a*l,t[4]=-a*h,t[8]=u,t[1]=g+m*u,t[5]=f-v*u,t[9]=-c*a,t[2]=v-f*u,t[6]=m+g*u,t[10]=o*a;break}case Zi.YXZ:{const f=a*l,g=a*h,m=u*l,v=u*h;t[0]=f+v*c,t[4]=m*c-g,t[8]=o*u,t[1]=o*h,t[5]=o*l,t[9]=-c,t[2]=g*c-m,t[6]=v+f*c,t[10]=o*a;break}case Zi.ZXY:{const f=a*l,g=a*h,m=u*l,v=u*h;t[0]=f-v*c,t[4]=-o*h,t[8]=m+g*c,t[1]=g+m*c,t[5]=o*l,t[9]=v-f*c,t[2]=-o*u,t[6]=c,t[10]=o*a;break}case Zi.ZYX:{const f=o*l,g=o*h,m=c*l,v=c*h;t[0]=a*l,t[4]=m*u-g,t[8]=f*u+v,t[1]=a*h,t[5]=v*u+f,t[9]=g*u-m,t[2]=-u,t[6]=c*a,t[10]=o*a;break}case Zi.YZX:{const f=o*a,g=o*u,m=c*a,v=c*u;t[0]=a*l,t[4]=v-f*h,t[8]=m*h+g,t[1]=h,t[5]=o*l,t[9]=-c*l,t[2]=-u*l,t[6]=g*h+m,t[10]=f-v*h;break}case Zi.XZY:{const f=o*a,g=o*u,m=c*a,v=c*u;t[0]=a*l,t[4]=-h,t[8]=u*l,t[1]=f*h+v,t[5]=o*l,t[9]=g*h-m,t[2]=m*h-g,t[6]=c*l,t[10]=v*h+f;break}default:throw new Error(a1)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}toQuaternion(){const e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),s=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new mR(e*r*s-t*i*o,e*i*o+t*r*s,t*i*s-e*r*o,e*i*s+t*r*o)}}var l1,ERe=et(698),xRe=et(7445),SRe=et.n(xRe),mr=et(3815),CRe=new Uint8Array(16);function TRe(){if(!l1&&!(l1="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l1(CRe)}const ARe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,DRe=function(n){return"string"==typeof n&&ARe.test(n)};for(var co=[],Dk=0;Dk<256;++Dk)co.push((Dk+256).toString(16).substr(1));const PRe=function(n,e,t){var i=(n=n||{}).random||(n.rng||TRe)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(co[n[e+0]]+co[n[e+1]]+co[n[e+2]]+co[n[e+3]]+"-"+co[n[e+4]]+co[n[e+5]]+"-"+co[n[e+6]]+co[n[e+7]]+"-"+co[n[e+8]]+co[n[e+9]]+"-"+co[n[e+10]]+co[n[e+11]]+co[n[e+12]]+co[n[e+13]]+co[n[e+14]]+co[n[e+15]]).toLowerCase();if(!DRe(t))throw TypeError("Stringified UUID is invalid");return t}(i)};var c1=et(1609);const Gm=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Rr=(Math,Math,{});function LRe(n,{precision:e=Rr.precision||4}={}){return n=function(n){return Math.round(n/Rr.EPSILON)*Rr.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function Mh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Xb(n,e,t){const i=Rr.EPSILON;t&&(Rr.EPSILON=t);try{if(n===e)return!0;if(Mh(n)&&Mh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Xb(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Rr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Rr.EPSILON=i}}function Tc(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}Rr.EPSILON=1e-12,Rr.debug=!1,Rr.precision=4,Rr.printTypes=!1,Rr.printDegrees=!1,Rr.printRowMajor=!0;class Ik extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Tc(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:Mh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Rr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+LRe(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Xb(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Rr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function uo(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function M9(n,e,t=""){if(Rr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}const D9={};function Ok(n,e){D9[n]||(D9[n]=!0,console.warn("".concat(n," has been removed in version ").concat(e,", see upgrade guide for more information")))}class $Re extends Ik{get ELEMENTS(){return Tc(!1),0}copy(e){return Tc(!1),this}get x(){return this[0]}set x(e){this[0]=uo(e)}get y(){return this[1]}set y(e){this[1]=uo(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return uo(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return uo(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Tc(e>=0&&e<this.ELEMENTS,"index is out of range"),uo(this[e])}setComponent(e,t){return Tc(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const Rk=[0,0,0],I9={};class Pn extends $Re{static get ZERO(){return I9.ZERO=I9.ZERO||Object.freeze(new Pn(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&Mh(e)?this.copy(e):(Rr.debug&&(uo(e),uo(t),uo(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Rr.debug&&(uo(e.x),uo(e.y),uo(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=uo(e)}angle(e){return Tj(this,e)}cross(e){return D0(this,this,e),this.check()}rotateX({radians:e,origin:t=Rk}){return xj(this,this,t,e),this.check()}rotateY({radians:e,origin:t=Rk}){return Sj(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=Rk}){return Cj(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return bI(this,this,e),this.check()}transformAsVector(e){return function(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o}(this,this,e),this.check()}transformByMatrix3(e){return vI(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return Ej(this,this,e),this.check()}}new Pn,new Pn;const Kb=new Pn,P9=new Pn;class Pk{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new Pn,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=Kb.from(t),this.center=(new Pn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new Pk(this.center,this.radius)}union(e){const t=this.center,i=this.radius,s=e.radius,o=Kb.copy(e.center).subtract(t),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const l=.5*(i+a+s);return P9.copy(o).scale((-i+l)/a).add(t),this.center.copy(P9),this.radius=l,this}expand(e){const t=(e=Kb.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(n,e){var s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(e[0],e[1],e[2]),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,c,u),n}(Kb,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=(e=Kb.from(e)).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const i=this.radius,s=e.normal.dot(this.center)+e.distance;return s<-i?Gm.OUTSIDE:s<i?Gm.INTERSECTING:Gm.INSIDE}}class KRe extends Ik{get ELEMENTS(){return Tc(!1),0}get RANK(){return Tc(!1),0}toString(){let e="[";if(Rr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=uo(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}const N9=Object.freeze([1,0,0,0,1,0,0,0,1]),QRe=Object.freeze([0,0,0,0,0,0,0,0,0]),ZRe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),$m={};class Zo extends KRe{static get IDENTITY(){return $m.IDENTITY=$m.IDENTITY||Object.freeze(new Zo(N9)),$m.IDENTITY}static get ZERO(){return $m.ZERO=$m.ZERO||Object.freeze(new Zo(QRe)),$m.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return ZRe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return function(n){var r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8];return n[0]*(c*s-o*l)+n[1]*(-c*r+o*a)+n[2]*(l*r-s*a)}(this)}identity(){return this.copy(N9)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,f=r*o,g=r*a,m=r*l,v=s*o,x=s*a,U=s*l;n[0]=1-h-m,n[3]=u-U,n[6]=f+x,n[1]=u+U,n[4]=1-c-m,n[7]=g-v,n[2]=f-x,n[5]=g+v,n[8]=1-c-h}(this,e),this.check()}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=i,n[7]=r}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8]}(this,this),this.check()}invert(){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l,m=t*h+i*f+r*g;m&&(n[0]=h*(m=1/m),n[1]=(-u*i+r*c)*m,n[2]=(a*i-r*o)*m,n[3]=f*m,n[4]=(u*t-r*l)*m,n[5]=(-a*t+r*s)*m,n[6]=g*m,n[7]=(-c*t+i*l)*m,n[8]=(o*t-i*s)*m)}(this,this),this.check()}multiplyLeft(e){return tH(this,e,this),this.check()}multiplyRight(e){return tH(this,this,e),this.check()}rotate(e){return function(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(t),g=Math.cos(t);n[0]=g*i+f*o,n[1]=g*r+f*a,n[2]=g*s+f*l,n[3]=g*o-f*i,n[4]=g*a-f*r,n[5]=g*l-f*s,n[6]=c,n[7]=u,n[8]=h}(this,this,e),this.check()}scale(e){return Array.isArray(e)?nH(this,this,e):nH(this,this,[e,e,e]),this.check()}translate(e){return function(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=t[0],g=t[1];n[0]=i,n[1]=r,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=f*i+g*o+c,n[7]=f*r+g*a+u,n[8]=f*s+g*l+h}(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}(t||[-0,-0],e,this);break;case 3:t=vI(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return M9(t,e.length),t}transformVector(e,t){return Ok("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return Ok("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return Ok("Matrix3.transformVector"),this.transform(e,t)}}const JRe=[0,0,0,1];class k9 extends Ik{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return fR(this,e),this.check()}identity(){return rH(this),this.check()}fromAxisRotation(e,t){return hR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=uo(e)}get y(){return this[1]}set y(e){this[1]=uo(e)}get z(){return this[2]}set z(e){this[2]=uo(e)}get w(){return this[3]}set w(e){this[3]=uo(e)}len(){return fH(this)}lengthSquared(){return pH(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return gR(this,e)}rotationTo(e,t){return mH(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return dH(this,this,e),this.check()}calculateW(){return lH(this,this),this.check()}conjugate(){return uH(this,this),this.check()}invert(){return cH(this,this),this.check()}lerp(e,t,i){return hH(this,e,t,i),this.check()}multiplyRight(e,t){return Tc(!t),rS(this,this,e),this.check()}multiplyLeft(e,t){return Tc(!t),rS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return sH(this,this,e),this.check()}rotateY(e){return oH(this,this,e),this.check()}rotateZ(e){return aH(this,this,e),this.check()}scale(e){return pR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=JRe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return nb(this,e,t,i),this.check()}transformVector4(e,t=e){return OU(t,e,this),M9(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const ePe=new Pn,tPe=new Pn,u1=new Pn,d1=new Pn,h1=new Pn,nPe=new Pn,iPe=new Pn;class Nk{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new Pn).from(e),this.halfAxes=new Zo(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Pn(e).len(),new Pn(t).len(),new Pn(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Pn(e).normalize(),s=new Pn(t).normalize(),o=new Pn(i).normalize();return(new k9).fromMatrix3(new Zo([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,t,i){const r=new k9(i),s=(new Zo).fromQuaternion(r);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=(new Pn).from(e),this.halfAxes=s,this}clone(){return new Nk(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new Pk){const t=this.halfAxes,i=t.getColumn(0,u1),r=t.getColumn(1,d1),s=t.getColumn(2,h1),o=ePe.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,l=Math.abs(s*r[0]+o*r[1]+a*r[2])+Math.abs(s*r[3]+o*r[4]+a*r[5])+Math.abs(s*r[6]+o*r[7]+a*r[8]),c=i.dot(t)+e.distance;return c<=-l?Gm.OUTSIDE:c>=l?Gm.INSIDE:Gm.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=tPe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,u1),s=i.getColumn(1,d1),o=i.getColumn(2,h1),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let h,u=0;return h=Math.abs(t.dot(r))-a,h>0&&(u+=h*h),h=Math.abs(t.dot(s))-l,h>0&&(u+=h*h),h=Math.abs(t.dot(o))-c,h>0&&(u+=h*h),u}computePlaneDistances(e,t,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,u1),c=a.getColumn(1,d1),u=a.getColumn(2,h1),h=nPe.copy(l).add(c).add(u).add(o),f=iPe.copy(h).subtract(e);let g=t.dot(f);return r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).add(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).add(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).add(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).add(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).subtract(u),f.copy(h).subtract(e),g=t.dot(f),r=Math.min(g,r),s=Math.max(g,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,u1);t.transformAsPoint(e);const i=this.halfAxes.getColumn(1,d1);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,h1);return r.transformAsPoint(e),this.halfAxes=new Zo([...t,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const F9=new Pn,L9=new Pn;class kk{constructor(e=[0,0,1],t=0){this.normal=new Pn,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return Tc(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=F9.from(e),this.normal.from(t).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,r){return this.normal.set(e,t,i),Tc(Xb(this.normal.len(),1)),this.distance=r,this}clone(e){return new kk(this.normal,this.distance)}equals(e){return Xb(this.distance,e.distance)&&Xb(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=L9.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=F9.from(e);const i=this.getPointDistance(e),r=L9.copy(this.normal).scale(i);return e.subtract(r).to(t)}}function*Uk(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,Un.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,c1.fromRdf)(s.object):s.object.id;yield[r,o]}}function dp(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,Un.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,c1.fromRdf)(a.object):a.object.id;r[o]=l}return r}new Pn([1,0,0]),new Pn([0,1,0]),new Pn([0,0,1]),new Pn,new Pn,new kk(new Pn(1,0,0),0),new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,new Pn,Math,new Zo,new Zo,new Zo,new Zo,new Zo,new Pn,new Pn,new Pn,new Pn,new Pn,new Zo,new Zo,new Zo;const ir=Un.Util.prefixes({base:"http://purl.org/ccf/latest/ccf.owl#",ccf:"http://purl.org/ccf/",fma:"http://purl.org/sig/ont/fma/fma",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/"},Un.DataFactory),U9={x:ir("rdf"),type:ir("rdf")("type")},dn=(ir("rdfs"),ir("rdfs")("label"),ir("rdfs")("comment"),ir("rdfs")("isDefinedBy"),ir("rdfs")("seeAlso"),ir("ccf")),vi={id:ir("ccf")("has_registration_location"),label:ir("rdfs")("label"),description:ir("rdfs")("comment"),link:dn("url"),sex:dn("sex"),age:dn("age"),bmi:dn("bmi"),Male:Un.DataFactory.literal("Male"),Female:Un.DataFactory.literal("Female"),consortiumName:dn("consortium_name"),providerName:dn("tissue_provider_name"),providerUUID:dn("tissue_provider_uuid"),donor:dn("comes_from"),sections:dn("subdivided_into_sections"),datasets:dn("generates_dataset"),sampleType:dn("sample_type"),TissueBlock:Un.DataFactory.literal("Tissue Block"),TissueSection:Un.DataFactory.literal("Tissue Section"),NonStandard:Un.DataFactory.literal("Non-standard"),sectionCount:dn("section_count"),sectionSize:dn("section_size"),sectionUnits:dn("section_size_unit"),sectionNumber:dn("section_number"),spatialEntity:dn("has_registration_location"),ontologyTerms:dn("has_ontology_term"),cellTypeTerms:dn("has_cell_type_term"),technology:dn("technology"),thumbnail:dn("thumbnail")},ki={x:dn,base:ir("base"),ontologyNode:{label:dn("ccf_pref_label"),parent:dn("ccf_part_of"),children:dn("ccf_part_of"),rui_rank:dn("rui_rank"),synonymLabels:Un.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:dn("ccf_part_of"),ct_is_a:dn("ccf_ct_isa"),located_in:dn("ccf_located_in"),characterizes:dn("ccf_characterizes")},spatial:{Female:ir("base")("VHFemale"),Male:ir("base")("VHMale"),BothSexes:ir("base")("VHBothSexes"),FemaleOrgans:ir("base")("VHFemaleOrgans"),MaleOrgans:ir("base")("VHMaleOrgans")},SpatialObjectReference:dn("spatial_object_reference"),SpatialEntity:dn("spatial_entity"),SpatialPlacement:dn("spatial_placement"),spatialObjectReference:{file:dn("file_url"),file_format:dn("file_format"),file_subpath:dn("file_subpath")},extractionSet:{label:ir("rdfs")("label"),rui_rank:dn("rui_rank")},spatialEntity:{label:ir("rdfs")("label"),description:ir("rdfs")("comment"),creator:ir("dcterms")("creator"),creator_first_name:dn("creator_first_name"),creator_last_name:dn("creator_last_name"),creator_orcid:dn("creator_orcid"),creation_date:ir("dcterms")("created"),updated_date:dn("updated_date"),ccf_annotations:dn("collides_with"),representation_of:dn("representation_of"),reference_organ:dn("has_reference_organ"),extraction_set_for:dn("extraction_set_for"),extraction_set:dn("has_extraction_set"),sex:dn("organ_owner_sex"),side:dn("organ_side"),rui_rank:dn("rui_rank"),slice_thickness:dn("slice_thickness"),slice_count:dn("slice_count"),x_dimension:dn("x_dimension"),y_dimension:dn("y_dimension"),z_dimension:dn("z_dimension"),dimension_units:dn("dimension_unit"),object:dn("has_object_reference")},spatialPlacement:{source:dn("placement_for"),target:dn("placement_relative_to"),placement_date:ir("dcterms")("created"),x_scaling:dn("x_scaling"),y_scaling:dn("y_scaling"),z_scaling:dn("z_scaling"),scaling_units:dn("scaling_unit"),x_rotation:dn("x_rotation"),y_rotation:dn("y_rotation"),z_rotation:dn("z_rotation"),w_rotation:dn("theta_rotation"),rotation_order:dn("rotation_order"),rotation_units:dn("rotation_unit"),x_translation:dn("x_translation"),y_translation:dn("y_translation"),z_translation:dn("z_translation"),translation_units:dn("translation_unit")}},di={x:ir("uberon"),body:ir("uberon")("0013702")},NPe={x:ir("cl"),cell:ir("cl")("0000000")},Zb={x:ir("fma")},vd=(ir("lmha"),{body:di.body,cell:NPe.cell,respiratory_system:di.x("0001004"),colon:di.x("0001155"),left_lung:di.x("0002168"),right_lung:di.x("0002167"),left_bronchus:di.x("0002178"),right_bronchus:di.x("0002177"),kidney:di.x("0002113"),ureter:di.x("0000056"),eye:di.x("0000970"),fallopian_tube:di.x("0003889"),knee:di.x("0001465"),ovary:di.x("0000992"),trachea:di.x("0003126"),aorta:di.x("0000947"),blood:di.x("0000178"),bone_marrow:di.x("0002371"),male_reproductive_system:di.x("0000079"),lymph_node:di.x("0000029"),blood_vasculature:di.x("0004537"),brain:di.x("0000955"),eye_left:di.x("0004548"),eye_right:Zb.x("54449"),fallopian_tube_left:di.x("0001303"),fallopian_tube_right:di.x("0001302"),heart:di.x("0000948"),kidney_left:di.x("0004538"),kidney_right:di.x("0004539"),knee_left:Zb.x("24978"),knee_right:Zb.x("24977"),large_intestine:di.x("0000059"),liver:di.x("0002107"),lungs:di.x("0002048"),mesenteric_lymph_node:di.x("0002509"),ovary_left:Zb.x("7214"),ovary_right:Zb.x("7213"),pancreas:di.x("0001264"),pelvis:di.x("0001270"),prostate_gland:di.x("0002367"),skin:di.x("0002097"),small_intestine:di.x("0002108"),spleen:di.x("0002106"),thymus:di.x("0002370"),ureter_left:di.x("0001223"),ureter_right:di.x("0001222"),urinary_bladder:di.x("0001255"),uterus:di.x("0000995")});function zk(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const p1={spatialObjectReference:zk(ki.spatialObjectReference),spatialEntity:zk(ki.spatialEntity),spatialPlacement:zk(ki.spatialPlacement)};function z9(n,e){const t=dp(n,e,"ExtractionSet",p1.spatialEntity);return t.extractionSites=(0,mr.sortBy)(n.getSubjects(ki.spatialEntity.extraction_set,e,null).map(i=>hp(n,i.id)),["rui_rank"]),t}function hp(n,e){const t=dp(n,e,"SpatialEntity",p1.spatialEntity);return t.object&&(t.object=function(n,e){return dp(n,e,"SpatialObjectReference",p1.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,ki.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,vi.spatialEntity,e,null),t}function VPe(n,e){const t=dp(n,e,"SpatialPlacement",p1.spatialPlacement);return t.source&&(t.source=hp(n,t.source)),t.target&&(t.target=hp(n,t.target)),t}function H9(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(_j),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class G9{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new ERe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},U9.type,ki.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},U9.type,ki.SpatialEntity,null);const t={};for(const i of(0,Un.readQuads)(e,null,ki.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,Un.readQuads)(e,null,ki.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new qn(qn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new qn(qn.IDENTITY),s=SRe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&H9(r,VPe(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}getSpatialPlacement(e,t){const i=this.graph.hasNode(e["@id"])?e["@id"]:void 0,r=(0,mr.get)(e,"placement[0]",(0,mr.get)(e,"placement",void 0));let s;if(r&&this.graph.hasNode(r.target)?(s=this.getTransformationMatrix(r.target,t),s&&(s=H9(s,r))):i&&(s=this.getTransformationMatrix(i,t)),s){const o=(new Zi).fromRotationMatrix(s,Zi.XYZ),a=s.getTranslation().map(u=>1e3*u),l=o.toVector3().map(dse),c=s.getScale().map(u=>u<1&&u>.999999?1:u);return{"@context":"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld","@id":`http://purl.org/ccf/1.5/${PRe()}_placement`,"@type":"SpatialPlacement",source:e["@id"],target:t,placement_date:(new Date).toISOString().split("T")[0],x_scaling:c[0],y_scaling:c[1],z_scaling:c[2],scaling_units:"ratio",x_rotation:l[0],y_rotation:l[1],z_rotation:l[2],rotation_order:"XYZ",rotation_units:"degree",x_translation:a[0],y_translation:a[1],z_translation:a[2],translation_units:"millimeter"}}}}class $9{constructor(e){this.db=e}getSpatialEntity(e){return hp(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,mr.sortBy)(n.getSubjects(ki.spatialEntity.extraction_set_for,e,null).map(t=>z9(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return z9(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,mr.sortBy)(n.getSubjects(ki.spatialEntity.reference_organ,e,null).map(t=>hp(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(hp(n,t.subject.id))},null,ki.spatialEntity.reference_organ,null,null),(0,mr.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=ki.spatial.Male.id;break;case"Female":t=ki.spatial.Female.id;break;case"Both":default:t=ki.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(ki.base("VHRightKidney").id),t,{color:[0,0,255,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(ki.base("VHLeftKidney").id),t,{color:[255,0,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(ki.base("VHSpleenCC1").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(ki.base("VHSpleenCC2").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(ki.base("VHSpleenCC3").id),t,{color:[0,255,0,127.5],geometry:"wireframe"})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=void 0!==(null==t?void 0:t.sex)&&"both"!==(null===(i=null==t?void 0:t.sex)||void 0===i?void 0:i.toLowerCase()),o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),u=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(h=>this.getSceneNode(h,a,{color:[255,255,255,229.5]}));return[c].concat(u).filter(h=>void 0!==h)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(l)u=new qn(qn.IDENTITY).rotateX(_j(90)).multiplyLeft(u);else{let h;switch(e.dimension_units){case"centimeter":h=.01;break;case"millimeter":h=.001;break;case"meter":default:h=1}const f=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*h/2);u.scale(f)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:u,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const g1="https://entity.api.hubmapconsortium.org/entities/",W9=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),UPe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},qm={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},q9={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class GPe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],u=(this.data.ancestors||[]).find(Ne=>"Donor"===Ne.entity_type);this.donor=this.getDonor(u,i);const h=this.getRuiLocation(e,this.donor);h?this.rui_location=h:this.bad=!0,qm[e.group_uuid]||(qm[e.group_uuid]=e.group_name);const f=new Date(e.last_modified_timestamp).toLocaleDateString(),g=qm[e.group_uuid]||e.group_name,m=e.created_by_user_displayname;this["@id"]=g1+e.uuid,this.label=`Registered ${f}, ${m}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const v={},x=[];this.sections=x;const U=[];this.datasets=U;for(const Ne of c.filter(Ve=>"Sample"===Ve.entity_type)){const Ve=this.getSection(Ne,e,i);v[Ne.submission_id]=Ve,x.push(Ve),Ve.section_number=null!==(s=Ve.section_number)&&void 0!==s?s:x.length}for(const Ne of c)if("Dataset"===Ne.entity_type){const Ve=this.getDataset(Ne,t,i,r),bt=(0,mr.get)(Ne,["ingest_metadata","metadata","tissue_id"]);v[bt]?null===(o=v[bt].datasets)||void 0===o||o.push(Ve):U.push(Ve)}const D=null!=h?h:{},ie=`${D.x_dimension} x ${D.y_dimension} x ${D.z_dimension} ${D.dimension_units}`;this.section_count=D.slice_count||x.length;const _e=parseFloat((D.slice_thickness||(D.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=_e;const Pe=D.dimension_units||"millimeter";this.section_units=Pe,this.description=`${ie}, ${_e} ${Pe}, ${e.specimen_type}, ${this.section_count} Sections`,x.forEach((Ne,Ve)=>{Ne.description=`${D.x_dimension} x ${D.y_dimension} x ${_e} ${Pe}, ${_e} ${Pe}, ${Ne.description}`,Ne.section_number=Ve+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":g1+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${qm[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=qm[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,mr.get)(e,["ingest_metadata","metadata","assay_type"],"")],u=c.join("|").toLowerCase();let h,f="assets/icons/ico-unknown.svg";return-1!==u.indexOf("10x")?(h="10x",f="assets/icons/ico-bulk-10x.svg"):-1!==u.indexOf("af")?(h="AF",f="assets/icons/ico-spatial-af.svg"):-1!==u.indexOf("codex")?(h="CODEX",f="assets/icons/ico-spatial-codex.svg"):-1!==u.indexOf("imc")?(h="IMC",f="assets/icons/ico-spatial-imc.svg"):-1!==u.indexOf("lc")&&-1===u.indexOf("af")?(h="LC",f="assets/icons/ico-bulk-lc.svg"):h=-1!==u.indexOf("maldi")?"MALDI":-1!==u.indexOf("pas")?"PAS":"OTHER",f=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:f,{"@id":g1+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:h,thumbnail:f}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,mr.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>W9.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(W9.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=UPe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,mr.toNumber)(s[1]));for(const f of(0,mr.get)(e,"metadata.organ_donor_data",(0,mr.get)(e,"metadata.living_donor_data",[])))"Feminine gender"===f.preferred_term||"Female"===f.preferred_term?r="Female":"Masculine gender"===f.preferred_term||"Male"===f.preferred_term?r="Male":"Current chronological age"===f.preferred_term||"Age"===f.preferred_term?o=(0,mr.toNumber)(f.data_value):"Body mass index"===f.preferred_term&&(a=(0,mr.toNumber)(f.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),u=qm[e.group_uuid]||e.group_name;return{"@id":g1+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${u}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:u,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;let r,s=e.rui_location;if(s&&("string"==typeof s&&(s=JSON.parse(s)),s.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):s["@id"]&&(r=s)),r){const o=null!==(i=(0,mr.get)(r,["placement","target"]))&&void 0!==i?i:"";o.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")?(0,mr.set)(r,["placement","target"],o.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")):("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===o||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===o)&&(0,mr.set)(r,["placement","target"],"Male"===t.sex?o.replace("#VH","#VHM")+"_Patch":o.replace("#VH","#VHF")+"_Patch")}return r}getTissueBlock(){return(0,mr.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const WPe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors.entity_type","ancestors.description","ancestors.metadata.organ_donor_data.preferred_term","ancestors.metadata.organ_donor_data.data_value","ancestors.metadata.living_donor_data.preferred_term","ancestors.metadata.living_donor_data.data_value","ancestors.last_modified_timestamp","ancestors.group_uuid","ancestors.group_name","ancestors.created_by_user_displayname","ancestors.uuid","descendants.entity_type","descendants.ingest_metadata.metadata.tissue_id","descendants.last_modified_timestamp","descendants.group_uuid","descendants.group_name","descendants.created_by_user_displayname","descendants.uuid","descendants.data_types","descendants.ingest_metadata.metadata.assay_type","descendants.thumbnail_file","descendants.metadata.files.rel_path","rui_location","specimen_type"],qPe={exists:{field:"rui_location"}};function Y9(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:qPe,_source:{includes:WPe}})}function Hk(n,e){return Bi(this,void 0,void 0,function*(){try{const t=yield fetch(n,e),i=yield t.text();return t.ok||i.startsWith("https")?i.startsWith("https")?yield fetch(i).then(s=>s.json()):JSON.parse(i):void 0}catch(t){return}})}function X9(n,e,t,i,r="",s=""){return Bi(this,void 0,void 0,function*(){let o;if("static"===e?o=yield Hk(n):"search-api"===e&&(o=yield function(n,e,t){return Bi(this,void 0,void 0,function*(){const i=1e4,r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=Y9(0,i,t),o=yield Hk(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=i)return o;const l=[];for(let h=i;h<a;h+=i)l.push(Hk(n,{method:"POST",headers:r,body:Y9(h,i,t)}));const c=yield Promise.all(l);if(c.some(h=>!h))return;const u=c.map(h=>h.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...u)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,mr.get)(n,"hits.hits",[]).map(c=>(0,mr.get)(c,"_source",{})).sort((c,u)=>c.uuid.localeCompare(u.uuid)).map(c=>new GPe(c,e,t,i).toJsonLd());for(const c of a){const u=c["@id"];o[u]?o[u].samples.push(c.samples[0]):o[u]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":q9},c)))),{"@context":q9,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function Jb(n,e,t){const i=new Set;for(const r of e)for(const s of(0,Un.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}const JPe={[ki.spatialEntity.x_dimension.id]:"x",[ki.spatialEntity.y_dimension.id]:"y",[ki.spatialEntity.z_dimension.id]:"z"};function tNe(n,e,t,i){const r=e.getTransformationMatrix(t,i);let s;if(r){const o=r.getTranslation(),a=function(n,e){const t=dp(n,e,"Dimensions",JPe);return[t.x,t.y,t.z]}(n,t).map(c=>c/1e3/2),l=(new Zi).fromRotationMatrix(r,Zi.XYZ).toQuaternion().normalize().calculateW();s=(new Nk).fromCenterHalfSizeQuaternion(o,a,l)}return s}function nNe(n,e,t,i){const{x:r,y:s,z:o,radius:a,target:l}=i,c=new Set,u=a/1e3*(a/1e3);for(const h of t){const f=tNe(n,e,h,l);f&&f.distanceSquaredTo([r,s,o].map(m=>m/1e3))<=u&&c.add(h)}return c}function m1(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Un.readQuads)(n,c,vi.donor,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function Gk(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Un.readQuads)(n,c,vi.spatialEntity,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function ev(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function K9(n,e,t){const i=new Set;for(const r of t){const s=Un.DataFactory.namedNode(r);n.forSubjects(ev(e,i),ki.spatialEntity.ccf_annotations,s,null)}return i}function Q9(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,Un.readQuads)(e,i,vi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,Un.readQuads)(e,r,ki.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function _Ne(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[ki.ontologyNode.label.id]:"label",[t]:"parent",[ki.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of Uk(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function Z9(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,Un.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=_Ne(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,J9(r),r}function J9(n,e,t=new Set){const i=n.nodes[null!=e?e:n.root];if(i){i.children=i.children.filter(r=>!t.has(r)),i.children.forEach(r=>t.add(r));for(const r of i.children)J9(n,r,t),n.nodes[r]&&(n.nodes[r].parent=i["@id"])}}const eq=(0,mr.memoize)(function(n){const e=Z9(n,vd.body.id,"body",ki.asctb.part_of.id);return e.nodes[vd.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0001911","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0001987","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0002240","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e},()=>""),_1={[vi.label.id]:"label",[vi.description.id]:"description",[vi.link.id]:"link"},vNe=Object.assign(Object.assign({},_1),{[vi.providerName.id]:"providerName"}),wNe=Object.assign(Object.assign({},_1),{[vi.technology.id]:"technology",[vi.thumbnail.id]:"thumbnail"}),ENe=Object.assign(Object.assign({},_1),{[vi.sampleType.id]:"sampleType",[vi.sectionNumber.id]:"sectionNumber",[vi.datasets.id]:"datasets"}),xNe=Object.assign(Object.assign({},_1),{[vi.sampleType.id]:"sampleType",[vi.sectionCount.id]:"sectionCount",[vi.sectionSize.id]:"sectionSize",[vi.sectionUnits.id]:"sectionUnits",[vi.donor.id]:"donor",[vi.spatialEntity.id]:"spatialEntityId",[vi.sections.id]:"sections",[vi.datasets.id]:"datasets"});function SNe(n,e){return dp(n,e,"Donor",vNe)}function tq(n,e){return dp(n,e,"Dataset",wNe)}function CNe(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of Uk(n,e,ENe))if("datasets"===i){const s=tq(n,r);t[i].push(s)}else t[i]=r;return t}class ANe{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>Bi(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const MNe={"@context":{"@base":"http://purl.org/ccf/","@vocab":"http://purl.org/ccf/",ccf:"http://purl.org/ccf/",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dcterms:"http://purl.org/dc/terms/",label:"rdfs:label",description:"rdfs:comment",link:"ccf:url",sex:"ccf:sex",age:"ccf:age",bmi:"ccf:bmi",consortium_name:"ccf:consortium_name",provider_name:"ccf:tissue_provider_name",provider_uuid:"ccf:tissue_provider_uuid",donor:{"@id":"ccf:comes_from","@type":"@id"},samples:{"@reverse":"donor"},sections:{"@id":"ccf:subdivided_into_sections","@type":"@id"},datasets:{"@id":"ccf:generates_dataset","@type":"@id"},sample_type:"ccf:sample_type",section_count:"ccf:section_count",section_size:"ccf:section_size",section_units:"ccf:section_size_unit",section_number:"ccf:section_number",rui_location:{"@id":"ccf:has_registration_location","@type":"@id"},ccf_annotations:{"@id":"ccf:collides_with","@type":"@id","@container":"@set"},representation_of:{"@id":"ccf:representation_of","@type":"@id"},reference_organ:{"@id":"ccf:has_reference_organ","@type":"@id"},extraction_set_for:{"@id":"ccf:extraction_set_for","@type":"@id"},extraction_set:{"@id":"ccf:has_extraction_set","@type":"@id"},organ_owner_sex:"ccf:organ_owner_sex",side:"ccf:organ_side",rui_rank:"ccf:rui_rank",slice_thickness:"ccf:slice_thickness",slice_count:"ccf:slice_count",object:{"@id":"ccf:has_object_reference","@type":"@id"},creation_date:"dcterms:created",updated_date:"ccf:updated_date",creator:"dcterms:creator",creator_first_name:"ccf:creator_first_name",creator_last_name:"ccf:creator_last_name",placement:{"@reverse":"ccf:placement_for"},placement_date:"dcterms:created",rotation_order:"ccf:rotation_order",dimension_units:"ccf:dimension_unit",rotation_units:"ccf:rotation_unit",scaling_units:"ccf:scaling_unit",translation_units:"ccf:translation_unit",source:{"@id":"ccf:placement_for","@type":"@id"},target:{"@id":"ccf:placement_relative_to","@type":"@id"},x_rotation:"ccf:x_rotation",y_rotation:"ccf:y_rotation",z_rotation:"ccf:z_rotation",x_scaling:"ccf:x_scaling",y_scaling:"ccf:y_scaling",z_scaling:"ccf:z_scaling",x_translation:"ccf:x_translation",y_translation:"ccf:y_translation",z_translation:"ccf:z_translation",x_dimension:"ccf:x_dimension",y_dimension:"ccf:y_dimension",z_dimension:"ccf:z_dimension",ontology_terms:{"@id":"ccf:has_ontology_term","@type":"@id"},technology:"ccf:technology",thumbnail:"ccf:thumbnail",file:"ccf:file_url",file_format:"ccf:file_format",file_subpath:"ccf:file_subpath"}};function $k(n){return JSON.parse(n,(e,t)=>"ccf_annotations"===e&&Array.isArray(t)?t.map(i=>(null==i?void 0:i.startsWith("http://purl.obolibrary.org/obo/FMA_"))?i.replace("http://purl.obolibrary.org/obo/FMA_","http://purl.org/sig/ont/fma/fma"):i):"@context"!==e||!t||"https://hubmapconsortium.github.io/hubmap-ontology/ccf-entity-context.jsonld"!==t&&"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld"!==t&&"https://hubmapconsortium.github.io/ccf-ontology/ccf-context.jsonld"!==t&&"http://purl.org/ccf/latest/ccf-entity.owl#"!==t["@base"]?t:MNe)}const INe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class ONe{constructor(e=INe){this.options=e,this.store=new Un.Store(void 0,{factory:Un.DataFactory}),this.graph=new G9(this),this.scene=new $9(this)}connect(e,t=!1){return Bi(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Bi(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield A9(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=Cc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),vu(t.transaction)))}([i,t]).catch(()=>{}):s=yield A9(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=Cc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),vu(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Bi(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,Un.deserializeN3Store)(s,Un.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,Un.deserializeN3Store)(o,Un.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(X9(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Bi(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Bi(this,void 0,void 0,function*(){"string"==typeof r?(r.startsWith("http")||r.startsWith("assets/"))&&r.includes("jsonld")?(r=$k(r=yield fetch(r).then(s=>s.text())),yield(0,Un.addJsonLdToStore)(r,i)):r.endsWith("n3")?yield(0,Un.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,Un.addRdfXmlToStore)(r,i):(r=$k(r),yield(0,Un.addJsonLdToStore)(r,i)):(r=$k(JSON.stringify(r)),yield(0,Un.addJsonLdToStore)(r,i))}))),this})}synchronize(){return Bi(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),function(n){var e,t,i;const r=eq(n),s=new Map;for(const{subject:o,object:a}of(0,Un.readQuads)(n,null,ki.spatialEntity.representation_of,null,null)){const l=new Set([a.id]);let c=null===(e=r.nodes[a.id])||void 0===e?void 0:e.parent;for(;c&&!l.has(c);)l.add(c),c=null===(t=r.nodes[c])||void 0===t?void 0:t.parent;s.set(o.id,[...l].map(u=>Un.DataFactory.namedNode(u)))}for(const{object:o}of(0,Un.readQuads)(n,null,vi.spatialEntity,null,null))for(const{subject:a}of(0,Un.readQuads)(n,null,ki.spatialPlacement.source,o,null))for(const{object:l}of(0,Un.readQuads)(n,a,ki.spatialPlacement.target,null,null))for(const c of null!==(i=s.get(l.id))&&void 0!==i?i:[])n.addQuad(Un.DataFactory.namedNode(o.id),ki.spatialEntity.ccf_annotations,c)}(this.store),this})}serialize(){return(0,Un.serializeN3Store)(this.store)}deserialize(e){return Bi(this,void 0,void 0,function*(){this.store=(0,Un.deserializeN3Store)(e,Un.DataFactory),this.graph=new G9(this),this.scene=new $9(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e,t){var i,r,s,o,a,l,c;let u=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),vi.spatialEntity,null,null),e}(n);if(u.size>0&&(u=function(n,e,t=!0){const i=new Set;if(n.forSubjects(ev(e,i),vi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,u)),u.size>0&&("Male"===t.sex||"Female"===t.sex)){const h=t.sex;u=m1(n,u,f=>function(n,e,t){const i=new Set;return n.forSubjects(ev(e,i),vi.sex,vi[t],null),i}(n,f,h))}if(u.size>0&&(null===(i=t.tmc)||void 0===i?void 0:i.length)>0&&(u=m1(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=Un.DataFactory.literal(r);n.forSubjects(ev(e,i),vi.providerName,s,null)}return i}(n,h,t.tmc))),u.size>0&&(null===(r=t.technologies)||void 0===r?void 0:r.length)>0&&(u=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const u of e)for(const h of(0,Un.readQuads)(n,u,vi.sections,null,null))a.add(h.object.id);for(const u of a)for(const h of(0,Un.readQuads)(n,u,vi.datasets,null,null))o.add(h.object.id),s.has(h.object.id)?null===(i=s.get(h.object.id))||void 0===i||i.push(u):s.set(h.object.id,[u]);const l=t(o),c=new Set;for(const u of l)for(const h of null!==(r=s.get(u))&&void 0!==r?r:[])c.add(h);return c}(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=Un.DataFactory.literal(r);n.forSubjects(ev(e,i),vi.technology,s,null)}return i}(n,h,t.technologies))),u.size>0&&(null===(s=t.spatialSearches)||void 0===s?void 0:s.length)>0&&(u=Gk(n,u,h=>function(n,e,t,i){const r=new Set;for(const s of i)nNe(n,e,t,s).forEach(a=>r.add(a));return r}(n,e,h,t.spatialSearches))),u.size>0&&(null===(o=t.ontologyTerms)||void 0===o?void 0:o.length)>0){const h=t.ontologyTerms;-1===h.indexOf(vd.body.id)&&(u=Gk(n,u,f=>K9(n,f,h)))}if(u.size>0&&(null===(a=t.cellTypeTerms)||void 0===a?void 0:a.length)>0){const h=t.cellTypeTerms;-1===h.indexOf(vd.cell.id)&&(u=Gk(n,u,f=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,ki.asctb.located_in,null),r===vd.cell.id&&i.add(vd.body.id);return K9(n,e,[...i])}(n,f,h)))}if(u.size>0&&2===(null===(l=t.ageRange)||void 0===l?void 0:l.length)&&(0,mr.isFinite)(t.ageRange[0])&&(0,mr.isFinite)(t.ageRange[1])){const h=Math.max(...t.ageRange),f=Math.min(...t.ageRange);1===f&&110===h||(u=m1(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Un.readQuads)(n,s,vi.age,null,null)){const a=(0,c1.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,f,h)))}if(u.size>0&&2===(null===(c=t.bmiRange)||void 0===c?void 0:c.length)&&(0,mr.isFinite)(t.bmiRange[0])&&(0,mr.isFinite)(t.bmiRange[1])){const h=Math.max(...t.bmiRange),f=Math.min(...t.bmiRange);13===f&&83===h||(u=m1(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Un.readQuads)(n,s,vi.bmi,null,null)){const a=(0,c1.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,f,h)))}return u}(this.store,this.graph,e)}get(e){return this.store.getQuads(Un.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(Un.DataFactory.namedNode(e),vi.spatialEntity,null);if(t.length>0)return hp(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return Bi(this,void 0,void 0,function*(){return this.status||(this.status=new ANe(this)),this.status.toJson()})}getDatasetTechnologyNames(){return Bi(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Un.readQuads)(n,null,vi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return Bi(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Un.readQuads)(n,null,vi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Bi(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of Uk(n,e,xNe))if("sections"===i){const s=CNe(n,r);t[i].push(s)}else if("datasets"===i){const s=tq(n,r);t[i].push(s)}else t[i]="donor"===i?SNe(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return Bi(this,void 0,void 0,function*(){return function(n,e){const t=Jb(e,n,vi.donor.id),i=Jb(e,t,vi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,Un.readQuads)(e,l,vi.spatialEntity,null,null))r.add(c.subject.id);const s=Jb(e,r,vi.sections.id),o=new Set([...Jb(e,r,vi.datasets.id),...Jb(e,s,vi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Bi(this,void 0,void 0,function*(){return function(n,e){const t={};return Q9(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return Bi(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=Q9(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,Un.readQuads)(e,null,ki.asctb.located_in,a,null)){const u=c.subject.id;if(s.has(u)){const h=s.get(u);l.forEach(f=>h.add(f))}else s.set(u,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[vd.cell.id]=null!==(i=null===(t=r.get(vd.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Bi(this,void 0,void 0,function*(){return eq(this.store)})}getCellTypeTreeModel(){return Bi(this,void 0,void 0,function*(){return function(n){return Z9(n,vd.cell.id,"cell",ki.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return Bi(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Bi(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Bi(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}getSpatialPlacement(e,t){return Bi(this,void 0,void 0,function*(){return this.graph.getSpatialPlacement(e,t)})}}class nq extends Error{constructor(){super(...arguments),this.message="NgxsDispatchPluginModule is not imported"}}function NNe(){throw new nq}function kNe(){throw new nq}function Wk(n,e,t){e.run(()=>n.dispatch(t))}function BNe(n,e,t,i){return yg(t)?function(n,e,t){return t.then(i=>(Wk(n,e,i),i))}(n,e,t):Im(t)?function(n,e,t,i){return null!==i&&(t=t.pipe(gr(i.cancelUncompleted$))),t.subscribe({next:r=>Wk(n,e,r)}),t}(n,e,t,i):(Wk(n,e,t),t)}class VNe{constructor(){this.cancelUncompleted$=new oe}cancelPreviousAction(){this.cancelUncompleted$.next()}}const qk="\u0275fac",iq=Symbol("InjectorInstance"),rq=Symbol("FactoryHasBeenDecorated");function sq(n,e){const t=n[iq];return t?t.get(e):null}const zNe={cancelUncompleted:!1};function oq(n=zNe){return(e,t,i)=>{let r;const s=function(n){return n?new VNe:null}(n.cancelUncompleted);function o(){null!==s&&s.cancelPreviousAction();const a=sq(this,hu)||NNe(),l=sq(this,pn)||kNe(),c=r.apply(this,arguments);return l.runOutsideAngular(()=>BNe(a,l,c,s))}"function"==typeof(null==i?void 0:i.value)?(r=i.value,i.value=o):Object.defineProperty(e,t,{set:a=>r=a,get:()=>o}),function(n){if(rq in n.constructor.prototype)return;const e=n.constructor;"function"==typeof e[qk]&&function(n){const e=n[qk];if("function"!=typeof e)return;const t=n.\u0275prov||n.\u0275pipe||n.\u0275cmp||n.\u0275dir,i=()=>{const r=e();return r[iq]=Ce(Vu),r};t&&(t.factory=i),Object.defineProperty(n,qk,{get:()=>i})}(e),n.constructor.prototype[rq]=!0}(e)}}const mke=["bodyCanvas"];let _ke=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new ln,this.nodeDrag=new ln,this.nodeClick=new ln,this.nodeHoverStart=new ln,this.nodeHoverStop=new ln,this.initialized=new ln,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Bi(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new zve({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.target&&this.bodyUI.setTarget(this.target),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=rn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&hr(mke,5,gn),2&t){let r;Gn(r=$n())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Va(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&ni(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),yke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[fr]]}),n})();new Ht("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const yq=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.org/sig/ont/fma/fma24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001911"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57991"},{src:"app:mammary-gland",organ:"Mammary Gland",name:"Mammary Gland, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma57987"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.org/sig/ont/fma/fma7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name));function Lke(n,e){if(1&n&&(wt(0,"div",16),ni(1,"youtube-player",17),Et()),2&n){const t=_i(3);zt(1),dE("videoId",t.videoID)}}function Bke(n,e){if(1&n&&(wt(0,"mat-expansion-panel",11),wt(1,"mat-expansion-panel-header"),wt(2,"h2",12),Jn(3),Et(),Et(),wt(4,"div",13),ni(5,"markdown",14),wi(6,Lke,2,1,"div",15),Et(),Et()),2&n){const t=_i(),i=t.index,r=t.$implicit;Jt("expanded",0===i),zt(3),gs(r.title),zt(2),ai("first",0===i),Jt("data",r.content),zt(1),Jt("ngIf",0===i)}}function Vke(n,e){if(1&n&&(wt(0,"div",9),wi(1,Bke,7,6,"mat-expansion-panel",10),Et()),2&n){const t=e.$implicit;zt(1),Jt("ngIf",t)}}yq.filter(n=>!0!==n.disabled);let bq=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.documentationContents=i.content||[],this.infoTitle=i.title||"",this.videoID=i.videoID}ngOnInit(){const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t)}close(){var t;null===(t=document.getElementsByClassName("modal-animated")[0])||void 0===t||t.classList.add("modal-animate-fade-out"),setTimeout(()=>{this.dialogRef.close()},250)}}return n.\u0275fac=function(t){return new(t||n)(Ce(kC),Ce(PW))},n.\u0275cmp=rn({type:n,selectors:[["ccf-info-dialog"]],decls:11,vars:2,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"header"],["mat-dialog-title","",1,"title"],[1,"close"],[1,"material-icons","close-icon",3,"click"],[1,"mat-typography","dialog-content"],["class","panel",4,"ngFor","ngForOf"],[1,"panel"],[3,"expanded",4,"ngIf"],[3,"expanded"],[1,"no-header-margin"],[1,"top-padding"],[1,"variable-binding",3,"data"],["class","video-player",4,"ngIf"],[1,"video-player"],[3,"videoId"]],template:function(t,i){1&t&&(wt(0,"div",0),wt(1,"div",1),wt(2,"div",2),wt(3,"div",3),wt(4,"h2",4),Jn(5),Et(),wt(6,"div",5),wt(7,"mat-icon",6),Tn("click",function(){return i.close()}),Jn(8,"clear"),Et(),Et(),Et(),wt(9,"mat-dialog-content",7),wi(10,Vke,2,1,"div",8),Et(),Et(),Et(),Et()),2&t&&(zt(5),gs(i.infoTitle),zt(5),Jt("ngForOf",i.documentationContents))},directives:[kW,Fm,FW,Yu,ac,UW,zW,WW,KW],styles:[".mat-dialog-container{padding:0}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:3rem;text-align:left}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;height:3rem;margin-bottom:2.25rem;position:relative}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5rem;margin-bottom:1rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{cursor:pointer;height:3rem;width:3rem;line-height:3rem;text-align:center;transition:.6s}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem;margin:0 auto;line-height:3rem;height:3rem;justify-self:center;display:flex}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-top:0;margin-bottom:.5rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{margin-bottom:1.5rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .no-header-margin[_ngcontent-%COMP%]{font-weight:300;margin-bottom:0}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]{display:flex}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .top-padding[_ngcontent-%COMP%]   markdown[_ngcontent-%COMP%]     ul{margin-top:0;padding-left:1.5rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{height:50rem;min-height:10rem}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]{font-weight:300;display:flex}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding.first[_ngcontent-%COMP%]{padding-right:1rem;width:73%}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     ul{margin:0}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .variable-binding[_ngcontent-%COMP%]     img{margin-left:1rem;float:right}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]{position:relative;width:50%}.rui-about.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]     iframe{width:100%;height:100%}"]}),n})(),vq=(()=>{class n{constructor(t){this.http=t,this.panelContent=new Fr({content:[],infoTitle:"",videoID:""})}updateData(t,i,r){this.http.get(t,{responseType:"text"}).subscribe(s=>{const o={content:this.parseMarkdown(s),infoTitle:r,videoID:i};this.panelContent.next(o)})}parseMarkdown(t){const i=[],r=t.split("# ");for(const s of r)if(s.length){const o=s.includes("\n\n")?"\n\n":"\r\n\r\n",a=s.split(o);i.push({title:a[0],content:a.splice(1).join(o)})}return i}}return n.\u0275fac=function(t){return new(t||n)(Ie(_u))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Uke=(()=>{class n{constructor(){this.clsName="ccf-call-to-action",this.callToActionClicked=new ln,this.closeClicked=new ln}close(){this.closeClicked.emit()}onDialogButtonClick(){this.callToActionClicked.emit()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=rn({type:n,selectors:[["ccf-call-to-action"]],hostVars:2,hostBindings:function(t,i){2&t&&Va(i.clsName)},inputs:{infoTitle:"infoTitle",imageUrl:"imageUrl",message:"message",callToAction:"callToAction"},outputs:{callToActionClicked:"callToActionClicked",closeClicked:"closeClicked"},decls:13,vars:4,consts:[[1,"rui-about","wrapper"],[1,"container"],[1,"content"],[1,"first-row"],["mat-dialog-title","",1,"title"],[1,"cta-mat-icon","material-icons","close-icon",3,"click"],["mat-card-sm-image","","alt","preview","layout-fill","",1,"cta-image",3,"src"],[1,"mat-typography","dialog-content"],[1,"message"],["mat-button","",1,"mat-button",3,"text","click"]],template:function(t,i){1&t&&(wt(0,"div",0),wt(1,"div",1),wt(2,"div",2),wt(3,"div",3),wt(4,"p",4),Jn(5),Et(),wt(6,"mat-icon",5),Tn("click",function(){return i.close()}),Jn(7,"clear"),Et(),Et(),ni(8,"img",6),wt(9,"mat-dialog-content",7),wt(10,"div",8),Jn(11),Et(),wt(12,"a",9),Tn("click",function(){return i.onDialogButtonClick()}),Et(),Et(),Et(),Et(),Et()),2&t&&(zt(5),gs(i.infoTitle),zt(3),Jt("src",i.imageUrl,sf),zt(3),xo(" ",i.message,""),zt(1),Jt("text",i.callToAction))},directives:[kW,Fm,BMe,FW],styles:["[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{display:block;align-content:center;padding-left:1.6rem;padding-right:1.6rem;border-radius:.25rem}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]{border-radius:.25rem;padding:.6rem;transition:.6s}[_nghost-%COMP%]   .info-button-wrapper[_ngcontent-%COMP%]   .ccf-info-button[_ngcontent-%COMP%]{cursor:pointer;transition:color .6s;font-size:1.2rem;vertical-align:sub}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]{display:flex;width:100%;line-height:.9rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding-right:7rem;padding-left:.2rem;font-size:.875rem;padding-top:.75rem}[_nghost-%COMP%]   .first-row[_ngcontent-%COMP%]   .cta-mat-icon[_ngcontent-%COMP%]{height:30%;line-height:3.4rem}[_nghost-%COMP%]   .message[_ngcontent-%COMP%]{padding:.5rem}[_nghost-%COMP%]   .cta-image[_ngcontent-%COMP%]{align-self:center;-o-object-fit:cover;object-fit:cover;width:100%;border-radius:.25rem}[_nghost-%COMP%]   .mat-button[_ngcontent-%COMP%]{background-color:#444a65;font-size:.75rem;position:relative;margin-bottom:1rem;width:100%;height:2rem;color:#fff}"],changeDetection:0}),n})(),Qm=(()=>{let n=class extends MDe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(Ki(n=>null!=n),Wa(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(oW(...t),ld(),Wa(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(oW(...t),ld(),Wa(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Ei([f7()],n.prototype,"config$",null),n=Ei([CDe(),A5({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}();class wq extends class{getDatabaseStatus(){return this.forwardCall("getDatabaseStatus")}getProviderNames(){return this.forwardCall("getProviderNames")}getDatasetTechnologyNames(){return this.forwardCall("getDatasetTechnologyNames")}getOntologyTreeModel(){return this.forwardCall("getOntologyTreeModel")}getCellTypeTreeModel(){return this.forwardCall("getCellTypeTreeModel")}getReferenceOrgans(){return this.forwardCall("getReferenceOrgans")}getTissueBlockResults(e){return this.forwardCall("getTissueBlockResults",e)}getAggregateResults(e){return this.forwardCall("getAggregateResults",e)}getOntologyTermOccurences(e){return this.forwardCall("getOntologyTermOccurences",e)}getCellTypeTermOccurences(e){return this.forwardCall("getCellTypeTermOccurences",e)}getScene(e){return this.forwardCall("getScene",e)}getReferenceOrganScene(e,t){return this.forwardCall("getReferenceOrganScene",e,t)}}{forwardCall(e,...t){return this.impl$.pipe(is(i=>i[e](...t)))}}let Eq=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Qk=new oe,nv={cacheBusterObserver:Qk},Zm={cacheBusterObserver:Qk,maxCacheCount:4};function xq(n,e,t){return n?{min:n[0]>e?n[0]:void 0,max:n[1]<t?n[1]:void 0}:void 0}function Sq(n){return n.map(e=>{var t;return Object.assign(Object.assign({},e),{transformMatrix:new qn(null!==(t=e.transformMatrix)&&void 0!==t?t:[])})})}let Xke=(()=>{class n{constructor(t,i){this.api=t,this.globalConfig=i,i.getOption("hubmapToken").subscribe(Qk)}getDatabaseStatus(){return this.doRequest(t=>this.api.dbStatus(t))}getProviderNames(){return this.doRequest(t=>this.api.providerNames(t))}getDatasetTechnologyNames(){return this.doRequest(t=>this.api.technologyNames(t))}getOntologyTreeModel(){return this.doRequest(t=>this.api.ontologyTreeModel(t),void 0,{},n=>n)}getCellTypeTreeModel(){return this.doRequest(t=>this.api.cellTypeTreeModel(t),void 0,{},n=>n)}getReferenceOrgans(){return this.doRequest(t=>this.api.referenceOrgans(t),void 0,{},n=>n)}getTissueBlockResults(t){return this.doRequest(i=>this.api.tissueBlocks(i),t,{},n=>n)}getAggregateResults(t){return this.doRequest(i=>this.api.aggregateResults(i),t)}getOntologyTermOccurences(t){return this.doRequest(i=>this.api.ontologyTermOccurences(i),t)}getCellTypeTermOccurences(t){return this.doRequest(i=>this.api.cellTypeTermOccurences(i),t)}getScene(t){return this.doRequest(i=>this.api.scene(i),t,{},Sq)}getReferenceOrganScene(t,i){return this.doRequest(r=>this.api.referenceOrganScene(r),i,{organIri:t},Sq)}doRequest(t,i,r,s){const{api:o,globalConfig:a}=this,l=Object.assign(Object.assign({},function(n){var e,t;return{age:xq(null==n?void 0:n.ageRange,1,110),bmi:xq(null==n?void 0:n.bmiRange,13,83),sex:null===(t=null===(e=null==n?void 0:n.sex)||void 0===e?void 0:e.toLowerCase)||void 0===t?void 0:t.call(e),ontologyTerms:null==n?void 0:n.ontologyTerms,cellTypeTerms:null==n?void 0:n.cellTypeTerms,providers:null==n?void 0:n.tmc,technologies:null==n?void 0:n.technologies,spatial:null==n?void 0:n.spatialSearches}}(i)),r);return yc([a.getOption("remoteApiEndpoint"),a.getOption("hubmapToken")]).pipe(qr(1),cr(([c,u])=>{o.configuration.basePath=c,u&&(l.token=u)}),is(()=>t(l)),me(c=>s?s(c):c))}}return n.\u0275fac=function(t){return new(t||n)(Ie(T9),Ie(Qm))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),Ei([Sc(nv)],n.prototype,"getProviderNames",null),Ei([Sc(nv)],n.prototype,"getDatasetTechnologyNames",null),Ei([Sc(nv)],n.prototype,"getOntologyTreeModel",null),Ei([Sc(nv)],n.prototype,"getCellTypeTreeModel",null),Ei([Sc(nv)],n.prototype,"getReferenceOrgans",null),Ei([Sc(Zm)],n.prototype,"getTissueBlockResults",null),Ei([Sc(Zm)],n.prototype,"getAggregateResults",null),Ei([Sc(Zm)],n.prototype,"getOntologyTermOccurences",null),Ei([Sc(Zm)],n.prototype,"getCellTypeTermOccurences",null),Ei([Sc(Zm)],n.prototype,"getScene",null),Ei([Sc(Zm)],n.prototype,"getReferenceOrganScene",null),n})(),Kke=(()=>{class n extends wq{constructor(t){super(),this.impl$=this.database$=t.config$.pipe(i=>i,Ki(i=>Object.keys(i).length>0),is(i=>function(n,e){return new O(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?je(r):Qc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDatabase(i),r=>this.connectDatabase(r,i))),me(i=>i.database),Wa(1))}connectDatabase(t,i){return Bi(this,void 0,void 0,function*(){const r=!fa();return yield t.database.connect(i,r),t})}}return n.\u0275fac=function(t){return new(t||n)(Ie(Qm))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Qke=(()=>{class n extends Kke{createDatabase(t){return{database:new ONe(t),unsubscribe:()=>{}}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Zke=(()=>{class n extends wq{constructor(t,i){super(),this.impl$=t.config$.pipe(r=>r,me(r=>this.selectToken(r)),ld(),me(r=>i.get(r)),Wa(1))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Qm),Ie(Hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Zk=(()=>{class n{}return n.type="[CallToAction] Learn More",n})(),Jk=(()=>{class n{}return n.type="[CallToAction] Open Dialog",n})(),eF=(()=>{class n{}return n.type="[CallToAction] Close Dialog",n})();var tF;class wa{get length(){var e,t;return null!==(t=null===(e=wa.storage)||void 0===e?void 0:e.length)&&void 0!==t?t:0}key(e){var t,i;return null!==(i=null===(t=wa.storage)||void 0===t?void 0:t.key(e))&&void 0!==i?i:null}getItem(e,t){var i,r,s;return null!==(s=null!==(r=null===(i=wa.storage)||void 0===i?void 0:i.getItem(e))&&void 0!==r?r:t)&&void 0!==s?s:null}setItem(e,t){var i;try{return null===(i=wa.storage)||void 0===i||i.setItem(e,t),!0}catch(r){return!1}}removeItem(e){var t;null===(t=wa.storage)||void 0===t||t.removeItem(e)}clear(){var e;null===(e=wa.storage)||void 0===e||e.clear()}}wa.storage=(()=>{let n;try{n=window.localStorage;const e="__storage_test__";return n.setItem(e,e),n.removeItem(e),n}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&n&&0!==n.length?n:void 0}})(),wa.\u0275fac=function(e){return new(e||wa)},wa.\u0275prov=We({token:wa,factory:wa.\u0275fac,providedIn:"root"});const Cq="callToActionPopupShown";let Ro=tF=class{constructor(e,t,i,r,s){this.dialog=e,this.ga=t,this.storage=i,this.infoService=r,this.http=s}static ctaDatePassed(e,t=Date.now){return+t()>+new Date(e)}ngxsOnInit(e){const{expirationDate:t,popupShown:i}=e.getState(),r=this.storage.getItem(Cq,`${i}`),s=tF.ctaDatePassed(t);"true"!==r&&!s&&e.dispatch(new Jk)}getDialogData(){return this.http.get("assets/docs/SPATIAL_SEARCH_README.md",{responseType:"text"}).pipe(me(e=>this.infoService.parseMarkdown(e)))}launchLearnMore(e){this.dialog.open(bq,{autoFocus:!1,panelClass:"modal-animated",width:"72rem",data:{title:"Spatial Search",content:e,videoID:"UfxMpzatowE"}})}learnMore(e){return this.dialog.closeAll(),this.ga.event("open_learn_more","call_to_action"),this.getDialogData().pipe(cr(t=>this.launchLearnMore(t)))}open(e){this.dialog.open(eFe,{autoFocus:!1,panelClass:"modal-animated",width:"30.75rem",height:"36.688rem"}),this.ga.event("open","call_to_action"),this.storage.setItem(Cq,"true"),e.patchState({popupShown:!0})}close(e){this.dialog.closeAll(),this.ga.event("close","call_to_action")}};Ro.\u0275fac=function(e){return new(e||Ro)(Ie(Nb),Ie(qb),Ie(wa),Ie(vq),Ie(_u))},Ro.\u0275prov=We({token:Ro,factory:Ro.\u0275fac}),Ei([yP(Zk)],Ro.prototype,"learnMore",null),Ei([yP(Jk)],Ro.prototype,"open",null),Ei([yP(eF)],Ro.prototype,"close",null),Ro=tF=Ei([A5({name:"callToAction",defaults:{title:"New to the Exploration User Interface",message:"Spatial Search has arrived!",callToAction:"Learn More",imageUrl:"assets/images/spatial_search.gif",expirationDate:"Dec 1, 2022",popupShown:!1}})],Ro);let E1=(()=>{class n{static title(t){return t.title}static message(t){return t.message}static callToAction(t){return t.callToAction}static imageUrl(t){return t.imageUrl}static expirationDate(t){return t.expirationDate}static popupShown(t){return t.popupShown}}return Ei([_m([Ro])],n,"title",null),Ei([_m([Ro])],n,"message",null),Ei([_m([Ro])],n,"callToAction",null),Ei([_m([Ro])],n,"imageUrl",null),Ei([_m([Ro])],n,"expirationDate",null),Ei([_m([Ro])],n,"popupShown",null),n})(),eFe=(()=>{class n{constructor(){this.close=()=>new eF,this.learnMore=()=>new Zk}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=rn({type:n,selectors:[["ccf-call-to-action-behavior"]],decls:5,vars:12,consts:[[3,"infoTitle","message","callToAction","imageUrl","callToActionClicked","closeClicked"]],template:function(t,i){1&t&&(wt(0,"ccf-call-to-action",0),Tn("callToActionClicked",function(){return i.learnMore()})("closeClicked",function(){return i.close()}),Ps(1,"async"),Ps(2,"async"),Ps(3,"async"),Ps(4,"async"),Et()),2&t&&Jt("infoTitle",To(1,4,i.title$))("message",To(2,6,i.message$))("callToAction",To(3,8,i.callToAction$))("imageUrl",To(4,10,i.imageUrl$))},directives:[Uke],pipes:[g0],styles:[""],changeDetection:0}),Ei([PS(E1.title)],n.prototype,"title$",void 0),Ei([PS(E1.message)],n.prototype,"message$",void 0),Ei([PS(E1.callToAction)],n.prototype,"callToAction$",void 0),Ei([PS(E1.imageUrl)],n.prototype,"imageUrl$",void 0),Ei([oq()],n.prototype,"close",void 0),Ei([oq()],n.prototype,"learnMore",void 0),n})(),iFe=(()=>{class n{constructor(t){this.source=t,this.organs=yq}getOrganInfo(t,i,r="Female"){let s=this.organs.find(a=>a.id===t);if(!s)return sn(void 0);const o=s.organ;return s.disabled&&(s=this.organs.find(a=>!a.disabled&&a.organ===o)),(null==s?void 0:s.side)&&i&&s.side!==i&&(s=this.organs.find(a=>!a.disabled&&a.organ===o&&a.side===i)),sn(s)}getOrgan(t,i="Both"){return this.source.getReferenceOrgans().pipe(me(r=>r.find(s=>s.representation_of===t.id&&("Both"===i||s.sex===i))))}getOrganScene(t,i="Female"){return t.id?this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:i}):sn([])}getOrganStats(t,i="Female"){return t.id?this.source.getAggregateResults({ontologyTerms:[t.id],sex:i}):sn([])}getBlocks(t,i="Female"){return t.id?this.source.getTissueBlockResults({ontologyTerms:[t.id],sex:i}):sn([])}}return n.\u0275fac=function(t){return new(t||n)(Ie(Eq))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rFe=["thumbContainer"],sFe=["toggleBar"],oFe=["input"],aFe=function(n){return{enterDuration:n}},lFe=["*"],cFe=new Ht("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let uFe=0;const dFe={provide:Xo,useExisting:ge(()=>Tq),multi:!0};class hFe{constructor(e,t){this.source=e,this.checked=t}}const fFe=wC(Mm(Ch(Am(class{constructor(n){this._elementRef=n}}))));let Tq=(()=>{class n extends fFe{constructor(t,i,r,s,o,a){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++uFe,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new ln,this.toggleChange=new ln,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=o.color||"accent",this._noopAnimations="NoopAnimations"===a}get required(){return this._required}set required(t){this._required=bi(t)}get checked(){return this._checked}set checked(t){this._checked=bi(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new hFe(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(Ce(gn),Ce(vc),Ce(Mr),yo("tabindex"),Ce(cFe),Ce(Qa,8))},n.\u0275cmp=rn({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&(hr(rFe,5),hr(sFe,5),hr(oFe,5)),2&t){let r;Gn(r=$n())&&(i._thumbEl=r.first),Gn(r=$n())&&(i._thumbBarEl=r.first),Gn(r=$n())&&(i._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,i){2&t&&(qc("id",i.id),Ii("tabindex",i.disabled?null:-1)("aria-label",null)("aria-labelledby",null),ai("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked",ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Vn([dFe]),En],ngContentSelectors:lFe,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(Hr(),wt(0,"label",0,1),wt(2,"div",2,3),wt(4,"input",4,5),Tn("change",function(s){return i._onChangeEvent(s)})("click",function(s){return i._onInputClick(s)}),Et(),wt(6,"div",6,7),ni(8,"div",8),wt(9,"div",9),ni(10,"div",10),Et(),Et(),Et(),wt(11,"span",11,12),Tn("cdkObserveContent",function(){return i._onLabelTextChange()}),wt(13,"span",13),Jn(14,"\xa0"),Et(),oi(15),Et(),Et()),2&t){const r=ih(1),s=ih(12);Ii("for",i.inputId),zt(2),ai("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),zt(2),Jt("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),Ii("name",i.name)("aria-checked",i.checked.toString())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),zt(5),Jt("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",function(n,e,t,i){return E3(Vt(),Cs(),n,e,t,i)}(18,aFe,i._noopAnimations?0:150))}},directives:[gu,$P],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),n})(),Aq=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})(),mFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[Aq,Dm,ji,QS],Aq,ji]}),n})(),_Fe=(()=>{class n{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new ln}get left(){const{value:t,labels:i}=this;return t!==i[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=rn({type:n,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(t,i){2&t&&Va(i.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(t,i){if(1&t){const r=wl();wt(0,"span",0),Tn("click",function(){_r(r);const o=ih(3);return i.left||o.toggle(),i.updateToggle(!0)}),Jn(1),Et(),wt(2,"mat-slide-toggle",1,2),Tn("change",function(o){return i.updateToggle(!o.checked)}),Et(),wt(4,"span",0),Tn("click",function(){_r(r);const o=ih(3);return i.left&&o.toggle(),i.updateToggle(!1)}),Jn(5),Et()}2&t&&(ai("disabled",i.disabled)("highlighted",i.left),zt(1),gs(i.labels[0].charAt(0).toUpperCase()+i.labels[0].slice(1)),zt(1),Jt("disabled",i.disabled)("checked",!i.left),zt(2),ai("disabled",i.disabled)("highlighted",!i.left),zt(1),gs(i.labels[1].charAt(0).toUpperCase()+i.labels[1].slice(1)))},directives:[Tq],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:#43476580}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),n})();const yFe=["bodyUI"],bFe=function(){return["Male","Female"]},vFe=function(){return["Left","Right"]};let wFe=(()=>{class n{constructor(t){this.ga=t,this.sexChange=new ln,this.sideChange=new ln}ngAfterViewChecked(){this.updateHighlighting()}updateHighlighting(){var t,i,r,s;const o=new Set(null!==(i=null===(t=this.filter)||void 0===t?void 0:t.tmc)&&void 0!==i?i:[]);this.filteredBlocks=null!==(s=null===(r=this.blocks)||void 0===r?void 0:r.filter(a=>o.has(a.donor.providerName)).map(a=>a["@id"]))&&void 0!==s?s:[],this.bodyUI.scene=this.bodyUI.scene.map(a=>{var l;return Object.assign(Object.assign({},a),{color:a.entityId&&this.highlightedNodeId===a["@id"]?[30,136,229,255]:this.filteredBlocks.includes(null!==(l=a.entityId)&&void 0!==l?l:"")?[173,255,47,229.5]:[255,255,255,229.5]})})}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.zoomToFitOrgan()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}zoomToFitOrgan(){const{bodyUI:t,organ:i}=this;if(i){const{x_dimension:r,y_dimension:s,z_dimension:o}=i;t.rotation=t.rotationX=0,t.bounds={x:1.25*r/1e3,y:1.25*s/1e3,z:1.25*o/1e3},t.target=[r/1e3/2,s/1e3/2,o/1e3/2]}}nodeClicked(t){this.ga.event("node_click","organ",t.node["@id"]),this.highlightedNodeId=this.highlightedNodeId&&this.highlightedNodeId===t.node["@id"]?"":t.node["@id"]}}return n.\u0275fac=function(t){return new(t||n)(Ce(qb))},n.\u0275cmp=rn({type:n,selectors:[["ccf-organ"]],viewQuery:function(t,i){if(1&t&&hr(yFe,7),2&t){let r;Gn(r=$n())&&(i.bodyUI=r.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side",blocks:"blocks",filter:"filter"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[Fi],decls:5,vars:10,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","initialized"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","hidden","valueChange"]],template:function(t,i){1&t&&(wt(0,"ccf-body-ui",0,1),Tn("nodeClick",function(s){return i.nodeClicked(s)})("initialized",function(){return i.zoomToFitOrgan()}),Et(),wt(2,"div",2),wt(3,"ccf-slide-toggle",3),Tn("valueChange",function(s){return i.updateSex(s)}),Et(),wt(4,"ccf-slide-toggle",3),Tn("valueChange",function(s){return i.updateSide(s)}),Et(),Et()),2&t&&(Jt("scene",i.scene)("interactive",!0),zt(3),Jt("labels",TE(8,bFe))("value",i.sex)("hidden",!i.sex),zt(1),Jt("labels",TE(9,vFe))("value",i.side)("hidden",!i.side))},directives:[_ke,_Fe],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0}),n})();function EFe(n,e){if(1&n&&(wt(0,"div",3),wt(1,"div",4),Jn(2),Et(),wt(3,"div",5),Jn(4),Et(),Et()),2&n){const t=e.$implicit;zt(2),gs(t.count),zt(2),gs(t.label)}}let xFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=rn({type:n,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(t,i){1&t&&(wt(0,"div",0),wt(1,"div",1),Jn(2),Et(),wi(3,EFe,5,2,"div",2),Et()),2&t&&(zt(2),xo(" ",i.statsLabel," "),zt(1),Jt("ngForOf",i.stats))},directives:[Yu],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),n})();function SFe(n,e){if(1&n){const t=wl();wt(0,"div",6),wt(1,"div",7),wt(2,"div",8),Jn(3),Et(),wt(4,"div",9),Tn("click",function(){const s=_r(t).$implicit;return _i().goToURL(s.buttonUrl)}),Jn(5),Et(),Et(),Et()}if(2&n){const t=e.$implicit;zt(3),gs(t.body),zt(1),Jt("gaLabel",t.buttonUrl),zt(1),xo(" ",t.buttonTitle,"")}}function CFe(n,e){if(1&n){const t=wl();wt(0,"div",10),Tn("click",function(){const s=_r(t).$implicit;return _i().goToURL(s.buttonUrl)}),Jn(1),Et()}if(2&n){const t=e.$implicit;Jt("gaLabel",t.buttonUrl),zt(1),gs(t.buttonTitle)}}let TFe=(()=>{class n{constructor(){this.linkCards=[{body:"Add tissue blocks using the HRA Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the HRA Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"HRA Portal",buttonUrl:"https://humanatlas.io"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.nature.com/articles/s41556-021-00788-6"}]}goToURL(t){window.open(t,"_blank")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=rn({type:n,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(t,i){1&t&&(wt(0,"div",0),wi(1,SFe,6,3,"div",1),Et(),wt(2,"div",2),wt(3,"div",3),Jn(4,"Human Reference Atlas (HRA) Deep Dive"),Et(),wt(5,"div",4),wi(6,CFe,2,2,"div",5),Et(),Et()),2&t&&(zt(1),Jt("ngForOf",i.linkCards),zt(5),Jt("ngForOf",i.deepDives))},directives:[g9,Yu,m9],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444A65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444A65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),n})();const AFe=["left"],MFe=["right"],DFe=function(){return[]},IFe=[{color:[0,0,0,0],opacity:.001}];let OFe=(()=>{class n{constructor(t,i,r){this.ga=i,this.configState=r,this.sex$=this.configState.getOption("sex"),this.side$=this.configState.getOption("side"),this.filter$=this.configState.getOption("highlightProviders").pipe(me(s=>({tmc:s}))),this.latestConfig={},this.organInfo$=r.config$.pipe(cr(s=>this.latestConfig=s),is(s=>{var o,a,l;return t.getOrganInfo(null!==(o=s.organIri)&&void 0!==o?o:"",null===(l=null===(a=s.side)||void 0===a?void 0:a.toLowerCase)||void 0===l?void 0:l.call(a),s.sex)}),cr(s=>this.logOrganLookup(s)),cr(s=>this.latestOrganInfo=s),Wa(1)),this.organ$=this.organInfo$.pipe(is(s=>s?t.getOrgan(s,s.hasSex?this.latestConfig.sex:void 0):sn(void 0)),cr(s=>{var o;if(s&&this.latestOrganInfo){const a=(null===(o=this.latestOrganInfo)||void 0===o?void 0:o.hasSex)?s.sex:void 0;a!==this.latestConfig.sex&&this.updateInput("sex",a),s.side!==this.latestConfig.side&&this.updateInput("side",s.side)}}),Wa(1)),this.scene$=this.organ$.pipe(is(s=>s&&this.latestOrganInfo?t.getOrganScene(this.latestOrganInfo,s.sex):sn(IFe))),this.stats$=this.organ$.pipe(is(s=>s&&this.latestOrganInfo?t.getOrganStats(this.latestOrganInfo,s.sex):sn([]))),this.statsLabel$=this.organ$.pipe(me(s=>this.makeStatsLabel(this.latestOrganInfo,null==s?void 0:s.sex)),Oo("Loading...")),this.blocks$=this.organ$.pipe(is(s=>s&&this.latestOrganInfo?t.getBlocks(this.latestOrganInfo,s.sex):sn([])))}ngAfterViewInit(){const{left:t,right:i}=this;t.nativeElement.style.height=`${i.nativeElement.offsetHeight}px`}updateInput(t,i){this.configState.patchConfig({[t]:i})}makeStatsLabel(t,i){let r=[`Unknown IRI: ${this.latestConfig.organIri}`];if(t){const s=t.side?t.side.charAt(0).toUpperCase()+t.side.slice(1):void 0;r=[i,t.organ,s]}return r.filter(s=>!!s).join(", ")}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.latestConfig.organIri} - Sex: ${this.latestConfig.sex} - Side: ${this.latestConfig.side}`)}}return n.\u0275fac=function(t){return new(t||n)(Ce(iFe),Ce(qb),Ce(Qm))},n.\u0275cmp=rn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&(hr(AFe,7,gn),hr(MFe,7,gn)),2&t){let r;Gn(r=$n())&&(i.left=r.first),Gn(r=$n())&&(i.right=r.first)}},decls:16,vars:25,consts:[[1,"container"],[1,"left"],["left",""],[3,"blocks","filter","sex","side","organ","scene","sexChange","sideChange"],[1,"right"],["right",""],[3,"statsLabel","stats"]],template:function(t,i){if(1&t&&(wt(0,"div",0),wt(1,"div",1,2),wt(3,"ccf-organ",3),Tn("sexChange",function(s){return i.updateInput("sex",s)})("sideChange",function(s){return i.updateInput("side",s)}),Ps(4,"async"),Ps(5,"async"),Ps(6,"async"),Ps(7,"async"),Ps(8,"async"),Ps(9,"async"),Et(),Et(),wt(10,"div",4,5),ni(12,"ccf-stats-list",6),Ps(13,"async"),Ps(14,"async"),ni(15,"ccf-link-cards"),Et(),Et()),2&t){let r;zt(3),Jt("blocks",To(4,8,i.blocks$))("filter",To(5,10,i.filter$))("sex",To(6,12,i.sex$))("side",To(7,14,i.side$))("organ",To(8,16,i.organ$))("scene",null!==(r=To(9,18,i.scene$))&&void 0!==r?r:TE(24,DFe)),zt(9),Jt("statsLabel",To(13,20,i.statsLabel$))("stats",To(14,22,i.stats$))}},directives:[wFe,xFe,TFe],pipes:[g0],styles:[".container[_ngcontent-%COMP%]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:29rem}"],changeDetection:0}),n})();function RFe(n,e){1&n&&ni(0,"ccf-root")}function PFe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){const i=XD.json(n);if(t(i))return i}else if(t(n))return n;throw new Error("Invalid data sources")}function NFe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){if(!(null==n?void 0:n.startsWith("[")))return[n];{const i=XD.json(n);if(t(i))return i}}else if(t(n))return n;throw new Error("Invalid data sources")}let kFe=(()=>{class n extends fie{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},If.dbOptions),globalThis.dbOptions),parse:{dataSources:PFe,highlightProviders:NFe,useRemoteApi:XD.boolean}}),this.sex="Female",this.side="Left"}}return n.\u0275fac=function(t){return new(t||n)(Ce(Qm),Ce(Mr))},n.\u0275cmp=rn({type:n,selectors:[["ccf-root-wc"]],inputs:{organIri:"organIri",sex:"sex",side:"side",dataSources:"dataSources",highlightProviders:"highlightProviders",hubmapDataService:"hubmapDataService",hubmapDataUrl:"hubmapDataUrl",hubmapAssetUrl:"hubmapAssetUrl",hubmapToken:"hubmapToken",hubmapPortalUrl:"hubmapPortalUrl",useRemoteApi:"useRemoteApi",remoteApiEndpoint:"remoteApiEndpoint"},features:[En],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,i){1&t&&wi(0,RFe,1,0,"ccf-root",0),2&t&&Jt("ngIf",i.initialized)},directives:[ac,OFe],encapsulation:2,changeDetection:0}),n})(),FFe=(()=>{class n extends Zke{selectToken(t){return t.useRemoteApi&&t.remoteApiEndpoint?Xke:Qke}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=zi(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),LFe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[hs,el,a7,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(hs,2),Ie(el,2))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})();const x1=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class jFe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=qf(this.action),i=function(n){return x1(n.getHours(),2)+":"+x1(n.getMinutes(),2)+":"+x1(n.getSeconds(),2)+"."+x1(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class UFe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const Mq=new Ht("NGXS_LOGGER_PLUGIN_OPTIONS");let zFe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new UFe(this._options),this._store=this._store||this._injector.get(hu);const s=new jFe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(cr(o=>{s.completed(o)}),bc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Ie(Mq),Ie(Hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Dq=new Ht("LOGGER_USER_OPTIONS");function HFe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let GFe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:h5,useClass:zFe,multi:!0},{provide:Dq,useValue:t},{provide:Mq,useFactory:HFe,deps:[Dq]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({}),n})();const $Fe=[Qm];let WFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[LFe.forRoot(),Yo.forRoot($Fe,{developmentMode:!If.production}),GFe.forRoot({disabled:If.production})]]}),n})(),qFe=(()=>{class n{constructor(t){if(t)throw new Error("The core module should only be imported once in the root module")}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[{provide:Eq,useExisting:FFe}],imports:[[CW,oRe.forRoot({gaToken:If.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!If.production}),pRe.forRoot(()=>new Yb({basePath:If.dbOptions.remoteApiEndpoint})),WFe]]}),n})(),YFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[fr,mFe]]}),n})(),XFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[fr,yke,YFe]]}),n})(),KFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[fr,r1]]}),n})(),QFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=tn({type:n}),n.\u0275inj=St({imports:[[fr]]}),n})(),ZFe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(El).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new aie(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends cie{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,u){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(kFe,{injector:this.injector});customElements.define("ccf-organ-info",t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn))},n.\u0275mod=tn({type:n}),n.\u0275inj=St({providers:[],imports:[[WD,qFe,KFe,QFe,XFe]]}),n})();If.production&&function(){if(iB)throw new Error("Cannot enable prod mode after platform setup.");nB=!1}(),Ine().bootstrapModule(ZFe).catch(n=>console.error(n))},1052:Ut=>{function it(yt,ee,Dt,dt,Y,Se,he){try{var W=yt[Se](he),j=W.value}catch(k){return void Dt(k)}W.done?ee(j):Promise.resolve(j).then(dt,Y)}Ut.exports=function(yt){return function(){var ee=this,Dt=arguments;return new Promise(function(dt,Y){var Se=yt.apply(ee,Dt);function he(j){it(Se,dt,Y,he,W,"next",j)}function W(j){it(Se,dt,Y,he,W,"throw",j)}he(void 0)})}},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},1948:Ut=>{Ut.exports=function(et){return et&&et.__esModule?et:{default:et}},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},4321:Ut=>{function it(et){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Ut.exports=it=function(ee){return typeof ee},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0):(Ut.exports=it=function(ee){return ee&&"function"==typeof Symbol&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0),it(et)}Ut.exports=it,Ut.exports.default=Ut.exports,Ut.exports.__esModule=!0},9082:Ut=>{function it(et){return Promise.resolve().then(()=>{var yt=new Error("Cannot find module '"+et+"'");throw yt.code="MODULE_NOT_FOUND",yt})}it.keys=()=>[],it.resolve=it,it.id=9082,Ut.exports=it},9521:()=>{},9125:()=>{},5307:()=>{}},Ut=>{Ut(Ut.s=2829)}]);