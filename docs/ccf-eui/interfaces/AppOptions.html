<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Application ccf-eui documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Application ccf-eui documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li
  >
  AppOptions</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>projects/ccf-eui/src/app/app.component.ts</code>
        </p>



            <p class="comment">
                <h3>Extends</h3>
            </p>
            <p class="comment">
                    <code>CCFDatabaseOptions</code>
            </p>

        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#header" 
>
                                            header
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#homeUrl" 
>
                                            homeUrl
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#loginEnabled" 
>
                                            loginEnabled
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#logoTooltip" 
>
                                            logoTooltip
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#theme" 
>
                                            theme
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="header"></a>
                                        <span class="name "><b>header</b>
                                            <a href="#header">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>header:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="homeUrl"></a>
                                        <span class="name "><b>homeUrl</b>
                                            <a href="#homeUrl">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>homeUrl:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="loginEnabled"></a>
                                        <span class="name "><b>loginEnabled</b>
                                            <a href="#loginEnabled">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>loginEnabled:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="logoTooltip"></a>
                                        <span class="name "><b>logoTooltip</b>
                                            <a href="#logoTooltip">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>logoTooltip:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="theme"></a>
                                        <span class="name "><b>theme</b>
                                            <a href="#theme">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>theme:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Injector, OnInit, ViewChild } from &#x27;@angular/core&#x27;;
import { MatSnackBar } from &#x27;@angular/material/snack-bar&#x27;;
import { CCFDatabaseOptions, OntologyTreeModel } from &#x27;ccf-database&#x27;;
import { DataSourceService, GlobalConfigState, TrackingPopupComponent } from &#x27;ccf-shared&#x27;;
import { ConsentService } from &#x27;ccf-shared/analytics&#x27;;
import { combineLatest, Observable, ReplaySubject } from &#x27;rxjs&#x27;;
import { map, pluck, shareReplay } from &#x27;rxjs/operators&#x27;;

import { BodyUiComponent } from &#x27;../../../ccf-shared/src/lib/components/body-ui/body-ui.component&#x27;;
import { environment } from &#x27;../environments/environment&#x27;;
import { OntologySelection } from &#x27;./core/models/ontology-selection&#x27;;
import { AppRootOverlayContainer } from &#x27;./core/services/app-root-overlay/app-root-overlay.service&#x27;;
import { ThemingService } from &#x27;./core/services/theming/theming.service&#x27;;
import { DataQueryState, DataState } from &#x27;./core/store/data/data.state&#x27;;
import { ListResultsState } from &#x27;./core/store/list-results/list-results.state&#x27;;
import { SceneState } from &#x27;./core/store/scene/scene.state&#x27;;
import { FiltersPopoverComponent } from &#x27;./modules/filters/filters-popover/filters-popover.component&#x27;;
import { DrawerComponent } from &#x27;./shared/components/drawer/drawer/drawer.component&#x27;;


interface AppOptions extends CCFDatabaseOptions {
  theme?: string;
  header?: boolean;
  homeUrl?: string;
  logoTooltip?: string;
  loginEnabled?: boolean;
}


/**
 * This is the main angular component that all the other components branch off from.
 * It is in charge of the header and drawer components who have many sub-components.
 */
@Component({
  selector: &#x27;ccf-root&#x27;,
  templateUrl: &#x27;./app.component.html&#x27;,
  styleUrls: [&#x27;./app.component.scss&#x27;],
  changeDetection: ChangeDetectionStrategy.OnPush,
})
export class AppComponent implements OnInit {
  @ViewChild(&#x27;bodyUI&#x27;, { static: false }) bodyUI: BodyUiComponent;

  /**
   * Used to keep track of the ontology label to be passed down to the
   * results-browser component.
   */
  ontologySelectionLabel &#x3D; &#x27;body&#x27;;

  cellTypeSelectionLabel &#x3D; &#x27;cell&#x27;;

  selectionLabel &#x3D; &#x27;body | cell&#x27;;

  /**
   * Whether or not organ carousel is open
   */
  organListVisible &#x3D; true;

  /**
   * Emitted url object from the results browser item
   */
  url &#x3D; &#x27;&#x27;;

  /**
   * Acceptable viewer domains (others will open in new window)
   */
  acceptableViewerDomains: string[] &#x3D; environment.acceptableViewerDomains || [];

  /**
   * Variable to keep track of whether the viewer is open
   * or not
   */
  viewerOpen &#x3D; false;

  get isLightTheme(): boolean {
    return this.theming.getTheme().endsWith(&#x27;light&#x27;);
  }

  /** Emits true whenever the overlay spinner should activate. */
  readonly spinnerActive$ &#x3D; this.data.queryStatus$.pipe(
    map(state &#x3D;&gt; state &#x3D;&#x3D;&#x3D; DataQueryState.Running)
  );

  readonly loadingMessage$ &#x3D; this.data.state$.pipe(pluck(&#x27;statusMessage&#x27;));

  readonly ontologyTerms$: Observable&lt;readonly string[]&gt;;
  readonly ontologyTreeModel$: Observable&lt;OntologyTreeModel&gt;;

  readonly cellTypeTerms$: Observable&lt;readonly string[]&gt;;
  readonly cellTypeTreeModel$: Observable&lt;OntologyTreeModel&gt;;

  readonly theme$ &#x3D; this.globalConfig.getOption(&#x27;theme&#x27;);
  readonly themeMode$ &#x3D; new ReplaySubject&lt;&#x27;light&#x27; | &#x27;dark&#x27;&gt;(1);

  readonly header$ &#x3D; this.globalConfig.getOption(&#x27;header&#x27;);
  readonly homeUrl$ &#x3D; this.globalConfig.getOption(&#x27;homeUrl&#x27;);
  readonly logoTooltip$ &#x3D; this.globalConfig.getOption(&#x27;logoTooltip&#x27;);
  readonly loginDisabled$ &#x3D; this.globalConfig.getOption(&#x27;loginDisabled&#x27;);

  /**
   * Creates an instance of app component.
   *
   * @param data The data state.
   */
  constructor(
    el: ElementRef&lt;HTMLElement&gt;, injector: Injector,
    readonly data: DataState, readonly theming: ThemingService,
    readonly scene: SceneState, readonly listResultsState: ListResultsState,
    readonly consentService: ConsentService, readonly snackbar: MatSnackBar, overlay: AppRootOverlayContainer,
    readonly dataSource: DataSourceService, private readonly globalConfig: GlobalConfigState&lt;AppOptions&gt;, cdr: ChangeDetectorRef
  ) {
    theming.initialize(el, injector);
    overlay.setRootElement(el);
    data.tissueBlockData$.subscribe();
    data.aggregateData$.subscribe();
    data.ontologyTermOccurencesData$.subscribe();
    data.cellTypeTermOccurencesData$.subscribe();
    data.sceneData$.subscribe();
    data.filter$.subscribe();
    data.technologyFilterData$.subscribe();
    data.providerFilterData$.subscribe();
    this.ontologyTerms$ &#x3D; data.filter$.pipe(pluck(&#x27;ontologyTerms&#x27;));

    combineLatest([this.theme$, this.themeMode$]).subscribe(
      ([theme, mode]) &#x3D;&gt; {
        this.theming.setTheme(&#x60;${theme}-theme-${mode}&#x60;);
        cdr.markForCheck();
      }
    );

    this.ontologyTreeModel$ &#x3D; this.dataSource.getOntologyTreeModel().pipe(shareReplay(1));
    this.cellTypeTerms$ &#x3D; data.filter$.pipe(pluck(&#x27;cellTypeTerms&#x27;));
    this.cellTypeTreeModel$ &#x3D; this.dataSource.getCellTypeTreeModel().pipe(shareReplay(1));
  }

  ngOnInit(): void {
    const snackBar &#x3D; this.snackbar.openFromComponent(TrackingPopupComponent, {
      data: {
        preClose: () &#x3D;&gt; {
          snackBar.dismiss();
        }
      },
      duration: this.consentService.consent &#x3D;&#x3D;&#x3D; &#x27;not-set&#x27; ? Infinity : 3000
    });

    if (window.matchMedia) {
      // Sets initial theme according to user theme preference
      if (window.matchMedia(&#x27;(prefers-color-scheme: dark)&#x27;).matches) {
        this.themeMode$.next(&#x27;dark&#x27;);
      } else {
        this.themeMode$.next(&#x27;light&#x27;);
      }

      // Listens for changes in user theme preference
      window.matchMedia(&#x27;(prefers-color-scheme: dark)&#x27;).addEventListener(&#x27;change&#x27;, e &#x3D;&gt; {
        this.themeMode$.next(e.matches ? &#x27;dark&#x27; : &#x27;light&#x27;);
      });
    } else {
      this.themeMode$.next(&#x27;light&#x27;);
    }
  }

  /**
   * Resets the drawers and filter components to their default state.
   *
   * @param left The left drawer component gets passed in so we can call it&#x27;s methods to control it&#x27;s state
   * @param right The right drawer component gets passed in so we can call it&#x27;s methods to control it&#x27;s state
   * @param filterbox The filter&#x27;s popover component gets passed in so we can control it&#x27;s popover&#x27;s state
   */
  reset(
    left: DrawerComponent,
    right: DrawerComponent,
    filterbox: FiltersPopoverComponent
  ): void {
    left.open();
    left.closeExpanded();
    right.open();
    right.closeExpanded();
    filterbox.removeBox();
    this.resetView();
  }

  resetView(): void {
    this.bodyUI.target &#x3D; [0, 0, 0];
    this.bodyUI.rotation &#x3D; 0;
    this.bodyUI.rotationX &#x3D; 0;
    this.bodyUI.bounds &#x3D; { x: 2.2, y: 2, z: 0.4 };
  }

  /**
   * Toggles scheme between light and dark mode
   */
  toggleScheme(): void {
    this.themeMode$.next(this.isLightTheme ? &#x27;dark&#x27; : &#x27;light&#x27;);
  }

  /**
   * Captures changes in the ontologySelection and uses them to update the results-browser label
   * and the filter object in the data store.
   *
   * @param ontologySelection the list of currently selected organ nodes
   */
  ontologySelected(ontologySelection: OntologySelection[] | undefined, type: &#x27;anatomical-structures&#x27; | &#x27;cell-type&#x27;): void {
    if (ontologySelection) {
      if (type &#x3D;&#x3D;&#x3D; &#x27;anatomical-structures&#x27;) {
        this.data.updateFilter({ ontologyTerms: ontologySelection.map(selection &#x3D;&gt; selection.id) });
        this.ontologySelectionLabel &#x3D; this.createSelectionLabel(ontologySelection);
      } else {
        this.data.updateFilter({ cellTypeTerms: ontologySelection.map(selection &#x3D;&gt; selection.id) });
        this.cellTypeSelectionLabel &#x3D; this.createSelectionLabel(ontologySelection);
      }
      if (this.ontologySelectionLabel &amp;&amp; this.cellTypeSelectionLabel) {
        this.selectionLabel &#x3D; &#x60;${this.ontologySelectionLabel} | ${this.cellTypeSelectionLabel}&#x60;;
      } else if (this.ontologySelectionLabel) {
        this.selectionLabel &#x3D; &#x60;${this.ontologySelectionLabel}&#x60;;
      } else if (this.cellTypeSelectionLabel) {
        this.selectionLabel &#x3D; &#x60;${this.cellTypeSelectionLabel}&#x60;;
      } else {
        this.selectionLabel &#x3D; &#x27;&#x27;;
      }
      if (ontologySelection[0] &amp;&amp; ontologySelection[0].label &#x3D;&#x3D;&#x3D; &#x27;body&#x27;) {
        this.resetView();
      }
      return;
    }

    this.data.updateFilter({ ontologyTerms: [], cellTypeTerms: [] });
    this.ontologySelectionLabel &#x3D; &#x27;&#x27;;
    this.cellTypeSelectionLabel &#x3D; &#x27;&#x27;;
  }

  /**
   * Creates selection label for the results-browser to display based on an
   * array of selected ontology nodes.
   */
  createSelectionLabel(ontolgySelection: OntologySelection[]): string {
    if (ontolgySelection.length &#x3D;&#x3D;&#x3D; 0) {
      return &#x27;&#x27;;
    }

    if (ontolgySelection.length &#x3D;&#x3D;&#x3D; 1) {
      return ontolgySelection[0].label;
    }

    let selectionString &#x3D; &#x27;&#x27;;
    ontolgySelection.forEach((selection, index) &#x3D;&gt; {
      selectionString +&#x3D; selection.label;

      // Don&#x27;t add a comma if it&#x27;s the last item in the array.
      if (index &lt; ontolgySelection.length - 1) {
        selectionString +&#x3D; &#x27;, &#x27;;
      }
    });
    return selectionString;
  }

  /**
   * Opens the iframe viewer with an url
   *
   * @param url The url
   */
  openiFrameViewer(url: string): void {
    const isWhitelisted &#x3D; this.acceptableViewerDomains.some(domain &#x3D;&gt; url?.startsWith(domain));
    if (isWhitelisted) {
      this.url &#x3D; url;
      this.viewerOpen &#x3D; !!url;
    } else {
      // Open link in new tab
      window.open(url, &#x27;_blank&#x27;);
      this.closeiFrameViewer();
    }
  }

  /**
   * Function to easily close the iFrame viewer.
   */
  closeiFrameViewer(): void {
    this.viewerOpen &#x3D; false;
  }

  /**
   * Gets login token
   */
  get loggedIn(): boolean {
    const token &#x3D; this.globalConfig.snapshot.hubmapToken ?? &#x27;&#x27;;
    return token.length &gt; 0;
  }
}
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'AppOptions.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       
       <script type="module" src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
